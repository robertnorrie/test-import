diff --git a/.gitignore b/.gitignore
deleted file mode 100644
index 988ea29..0000000
--- a/.gitignore
+++ /dev/null
@@ -1,6 +0,0 @@
-# Ignore files and folders that may end up in profiles/commons as part of the
-# a drush make build.
-PATCHES.txt
-libraries
-modules
-themes
\ No newline at end of file
diff --git a/.travis.yml b/.travis.yml
index 890361e..1fc5174 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -1,58 +1,142 @@
 language: php
 
 php:
-  - 5.5
   - 5.4
-  - 5.3
 
-
-notifications:
-  email:
-    - commons-bulk@acquia.com
-
-branches:
-  only:
-    - 7.x-3.x
-
-# This will create the database
 mysql:
-  database: commons
+  database: drupal
   username: root
   encoding: utf8
 
-# To be able to run a webbrowser
-# If we need anything more powerful
-# than e.g. phantomjs
-before_install:
-  - "sudo apt-get update"
-  - "export DISPLAY=:99.0"
-  - "sh -e /etc/init.d/xvfb start"
-  - "wget http://selenium.googlecode.com/files/selenium-server-standalone-2.33.0.jar -O selenium-server-standalone.jar"
-  - "java -jar selenium-server-standalone.jar > /dev/null &"
-  
+env:
+  - UPGRADE=none
+  - UPGRADE=7.x-3.9
+  - UPGRADE=7.x-3.8
+  - UPGRADE=7.x-3.7
+  - UPGRADE=7.x-3.6
+  - UPGRADE=7.x-3.5
+
+matrix:
+  allow_failures:
+    - env: UPGRADE=7.x-3.9
+    - env: UPGRADE=7.x-3.8
+    - env: UPGRADE=7.x-3.7
+    - env: UPGRADE=7.x-3.6
+    - env: UPGRADE=7.x-3.5
+
+install:
+  # Add the Google Chrome packages.
+  - wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
+  - sudo sh -c 'echo "deb http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google.list'
+  - sudo apt-get update > /dev/null
+
+  # Create a database for our Drupal site.
+  - "mysql -e 'create database drupal;'"
+
+  # Install the latest Drush 6.
+  - export PATH="$HOME/.composer/vendor/bin:$PATH"
+  - composer global require --prefer-source --no-interaction drush/drush:6.*
+
+  # Build Behat dependencies
+  - cd ./tests/behat
+  - composer install --prefer-source --no-interaction
+  - cd ../../../
+
+  # Rename the repository folder to 'commons' (to accommodate different repository names).
+  - REPO_NAME=`basename $TRAVIS_REPO_SLUG`
+  - mv $REPO_NAME commons
+
+  # Build Codebase
+  - mkdir profiles
+  - mv commons profiles/
+  - mkdir drupal
+  - mv profiles drupal/
+
+  # Test the current branch
+  - cd drupal
+  - drush make --yes profiles/commons/drupal-org-core.make --prepare-install
+  - drush make --yes profiles/commons/drupal-org.make --no-core --contrib-destination=profiles/commons
+  - mkdir sites/default/private
+  - mkdir sites/default/private/files
+  - mkdir sites/default/private/temp
+  - cd ../
+
+  # Download an old version to test upgrading from.
+  - if [[ "$UPGRADE" != none ]]; then drush dl commons-$UPGRADE; fi
+
+  # Setup files
+  - sudo chmod -R 777 drupal/sites/all
+
+  # Setup display for Selenium
+  - export DISPLAY=:99.0
+  - sh -e /etc/init.d/xvfb start
+  - sleep 5
+
+  # Get Chrome and ChromeDriver
+  - sudo apt-get install google-chrome-stable
+  - wget http://chromedriver.storage.googleapis.com/2.9/chromedriver_linux64.zip
+  - unzip -a chromedriver_linux64.zip
+
+  # Insane hack from jsdevel:
+  #   https://github.com/jsdevel/travis-debugging/blob/master/shim.bash
+  # This allows chrome-sandbox to work in side of OpenVZ, because I can't
+  # figure out how to start chrome with --no-sandbox.
+  - export CHROME_SANDBOX=/opt/google/chrome/chrome-sandbox
+  - sudo rm -f $CHROME_SANDBOX
+  - sudo wget https://googledrive.com/host/0B5VlNZ_Rvdw6NTJoZDBSVy1ZdkE -O $CHROME_SANDBOX
+  - sudo chown root:root $CHROME_SANDBOX; sudo chmod 4755 $CHROME_SANDBOX
+  - sudo md5sum $CHROME_SANDBOX
+
+  # Get Selenium
+  - wget http://selenium-release.storage.googleapis.com/2.41/selenium-server-standalone-2.41.0.jar
+  - java -jar selenium-server-standalone-2.41.0.jar -Dwebdriver.chrome.driver=`pwd`/chromedriver > /dev/null 2>&1 &
+  - sleep 5
+ 
+  # Disable sendmail
+  - echo sendmail_path=`which true` >> ~/.phpenv/versions/$(phpenv version-name)/etc/php.ini
+
 before_script:
-  # Grab drush
-  - pear channel-discover pear.drush.org
-  - pear install drush/drush
-  - phpenv rehash
-  # LAMP package installation (mysql is already started)
-  - sudo apt-get install -y --force-yes apache2 libapache2-mod-php5 php5-mysql php5-curl
-  # Apache webserver configuration
-  - sudo sed -i -e "s,/var/www,$(pwd)/packaged,g" /etc/apache2/sites-available/default
-  - sudo a2enmod rewrite
-  - sudo a2enmod actions
-  - sudo service apache2 restart
-  # Install the composer packages for behat / ...
-  - composer --working-dir=tests/ install  
+
+  # Do the site install (either the current revision or old for the upgrade).
+  - if [[ "$UPGRADE" == none ]]; then cd drupal; else cd commons-$UPGRADE; fi
+  - drush si commons --db-url=mysql://root:@127.0.0.1/drupal --account-name=admin --account-pass=admin --account-mail=admin@test.com --site-mail=noreply@test.com --site-name="Commons" --yes
+  - drush vset -y file_private_path "sites/default/private/files"
+  - drush vset -y file_temporary_path "sites/default/private/temp"
+  - cd ../drupal
+
+  # If we're an upgrade test, run the upgrade process.
+  - if [[ "$UPGRADE" != none ]]; then cp -a ../commons-$UPGRADE/sites/default/* sites/default/ && drush updb --yes; fi
+
+  - drush runserver --server=builtin 8888 > /dev/null 2>&1 &
+  - SERVER_PID=$!
+  - sleep 3
+  - cd profiles/commons/tests/behat
+
+  # Make the Travis tests repos agnostic by injecting drupal_root with BEHAT_PARAMS
+  - BUILD_OWNER=`dirname $TRAVIS_BUILD_DIR`
+  - export BEHAT_PARAMS="extensions[Drupal\\DrupalExtension\\Extension][drupal][drupal_root]=$BUILD_OWNER/drupal"
+
 script:
-  # Build distro from makefile
-  - drush make build-commons-dev.make --no-cache -y packaged
-  # Site installation. We're doing the cd-dance because drush -r throws an exception for me currently.
-  - cd packaged
-  - drush -v site-install --db-url=mysql://root@localhost/commons --site-name=QASite --account-name=admin --account-pass=commons --account-mail=admin@example.com --site-mail=site@example.com -v -y commons commons_anonymous_welcome_text_form.commons_anonymous_welcome_title="Oh hai" commons_anonymous_welcome_text_form.commons_anonymous_welcome_body="No shirts, no shoes, no service." commons_create_first_group.commons_first_group_title="Internet People" commons_create_first_group.commons_first_group_body="This is the first group on the page."
-  - cd ..
-  # Make sure the installed site responds
-  - curl localhost
-  # Start running the tests
-  - cd tests
-  - bin/behat
\ No newline at end of file
+
+  # First, run all the tests in Firefox.
+  - ./bin/behat --config behat.travis.yml
+ 
+  # Then run some Chrome-only tests.
+  - ./bin/behat --config behat.travis.yml -p chrome
+
+after_script:
+
+  # Stop the webserver so that it's not still running when MySQL is stopped.
+  - kill $SERVER_PID
+
+notifications:
+  email:
+    recipients:
+      - commons-bulk@acquia.com
+    on_success: change
+    on_failure: always
+  irc:
+    channels:
+      - "chat.freenode.net#drupal-commons"
+    on_success: change
+    on_failure: always
diff --git a/build-commons-dev.make b/build-commons-dev.make
deleted file mode 100644
index f2ed0c5..0000000
--- a/build-commons-dev.make
+++ /dev/null
@@ -1,14 +0,0 @@
-api = 2
-core = 7.x
-
-; Include the definition of how to build Drupal core directly, including patches.
-includes[] = "drupal-org-core.make"
-
-; Download the Commons install profile and recursively build all its dependencies.
-projects[commons][type] = "profile"
-projects[commons][download][type] = "git"
-projects[commons][download][url] = "http://git.drupal.org/project/commons.git"
-projects[commons][download][branch] = "7.x-3.x"
-; Provide a -dev version of the Commons make file, stopgap for nightly development snapshot
-; https://drupal.org/node/1908812
-projects[commons][patch][] = "http://drupal.org/files/1908812-commons-make-dev-59.patch"
\ No newline at end of file
diff --git a/build_distro.sh b/build_distro.sh
deleted file mode 100755
index 4a06973..0000000
--- a/build_distro.sh
+++ /dev/null
@@ -1,174 +0,0 @@
-#!/bin/bash
-modules=(commons_activity_streams commons_featured commons_notices commons_profile_social commons_user_profile_pages commons_body commons_follow commons_notify commons_q_a commons_utility_links commons_bw commons_groups commons_pages commons_radioactivity commons_wikis commons_content_moderation commons_like commons_polls commons_search commons_wysiwyg commons_documents commons_location commons_posts commons_site_homepage commons_events commons_misc commons_profile_base commons_topics commons_social_sharing commons_trusted_contacts)
-themes=(commons_origins)
-
-pull_git() {
-    cd $BUILD_PATH/commons_profile
-    if [[ -n $RESET ]]; then
-      git reset --hard HEAD
-    fi
-    git pull origin 7.x-3.x
-
-    cd $BUILD_PATH/repos/modules
-    for i in "${modules[@]}"; do
-      echo $i
-      cd $i
-      if [[ -n $RESET ]]; then
-        git reset --hard HEAD
-      fi
-      git pull origin 7.x-3.x
-      cd ..
-    done
-    cd $BUILD_PATH/repos/themes/commons_origins
-    git pull origin 7.x-3.x
-}
-
-release_notes() {
-  rm -rf rn.txt
-  pull_git $BUILD_PATH
-  OUTPUT="<h2>Release Notes for $RELEASE</h2>"
-  cd $BUILD_PATH/commons_profile
-  OUTPUT="$OUTPUT <h3>Commons Profile:</h3> `drush rn --date $FROM_DATE $TO_DATE`"
-
-  cd $BUILD_PATH/repos/modules
-  for i in "${modules[@]}"; do
-    echo $i
-    cd $i
-    RN=`drush rn --date $FROM_DATE $TO_DATE`
-    if [[ -n $RN ]]; then
-      OUTPUT="$OUTPUT <h3>$i:</h3> $RN"
-    fi
-    cd ..
-  done
-  cd $BUILD_PATH/repos/themes/commons_origins
-  RN=`drush rn --date $FROM_DATE $TO_DATE`
-  if [[ -n $RN ]]; then
-    OUTPUT="$OUTPUT <h3>commons_origins:</h3> $RN"
-  fi
-
-  echo $OUTPUT >> $BUILD_PATH/rn.txt
-}
-
-build_distro() {
-    if [[ -d $BUILD_PATH ]]; then
-        cd $BUILD_PATH
-        rm -rf ./publish
-        # do we have the profile?
-        if [[ -d $BUILD_PATH/commons_profile ]]; then
-          if [[ -d $BUILD_PATH/repos ]]; then
-            drush make commons_profile/build-commons.make --no-cache --working-copy --prepare-install ./publish
-            rm -rf publish/profiles/commons/modules/contrib/commons*
-            rm -rf publish/profiles/commons/themes/contrib/commons*
-          else
-            mkdir $BUILD_PATH/repos
-            mkdir $BUILD_PATH/repos/modules
-            cd $BUILD_PATH/repos/modules
-            for i in "${modules[@]}"; do
-              if [[ -n $USERNAME ]]; then
-                git clone --branch 7.x-3.x ${USERNAME}@git.drupal.org:project/${i}.git
-              else
-                git clone --branch 7.x-3.x http://git.drupal.org/project/${i}.git
-              fi
-            done
-            cd $BUILD_PATH/repos
-            mkdir $BUILD_PATH/repos/themes
-            cd $BUILD_PATH/repos/themes
-            for i in "${themes[@]}"; do
-              if [[ -n $USERNAME ]]; then
-                git clone --branch 7.x-3.x ${USERNAME}@git.drupal.org:project/${i}.git
-              else
-                git clone --branch 7.x-3.x http://git.drupal.org/project/${i}.git
-              fi
-            done
-            build_distro $BUILD_PATH
-          fi
-          ln -sf $BUILD_PATH/repos/modules/commons* publish/profiles/commons/modules/contrib/
-          ln -sf $BUILD_PATH/repos/themes/commons* publish/profiles/commons/themes/contrib/
-          chmod -R 777 publish/sites/default
-          # symlink the profile to our dev copy
-          rm -f publish/profiles/commons/*.*
-          rm -rf publish/profiles/commons/images
-          ln -s $BUILD_PATH/commons_profile/* publish/profiles/commons/
-        else
-          git clone http://git.drupal.org/project/commons.git commons_profile
-          build_distro $BUILD_PATH
-        fi
-    else
-      mkdir $BUILD_PATH
-      build_distro $BUILD_PATH $USERNAME
-    fi
-}
-
-# This allows you to test the make file without needing to upload it to drupal.org and run the main make file.
-update() {
-  if [[ -d $DOCROOT ]]; then
-    cd $DOCROOT
-    # do we have the profile?
-    if [[ -d $DOCROOT/profiles/commons ]]; then
-      # do we have an installed commons profile?
-        rm -f /tmp/publish.tar.gz
-        rm -f /tmp/commons.tar.gz
-        drush make --tar --drupal-org=core profiles/commons/drupal-org-core.make /tmp/publish
-        drush make --tar --drupal-org profiles/commons/drupal-org.make /tmp/commons
-        cd ..
-        tar -zxvf /tmp/publish.tar.gz
-        cd publish/profiles
-        # remove the symlinks in the repos before we execute
-        find . -mindepth 2 -type l | awk -F/ '{print $5}' | sed '/^$/d' > /tmp/repos.txt
-        # exclude repos since we're updating already by linking it to the repos directory.
-        UNTAR="tar -zxvf /tmp/commons.tar.gz -X /tmp/repos.txt"
-        eval $UNTAR
-        echo "Successfully Updated drupal from make files"
-        exit 0
-    fi
-  fi
-  echo "Unable to find Build path or drupal root. Please run build first"
-  exit 1
-}
-
-case $1 in
-  pull)
-    if [[ -n $2 ]]; then
-      BUILD_PATH=$2
-      if [[ -n $3 ]]; then
-       RESET=1
-      fi
-    else
-      echo "Usage: build_distro.sh pull [build_path]"
-      exit 1
-    fi
-    pull_git $BUILD_PATH $RESET;;
-  build)
-    if [[ -n $2 ]]; then
-      BUILD_PATH=$2
-    else
-      echo "Usage: build_distro.sh build [build_path]"
-      exit 1
-    fi
-    if [[ -n $3 ]]; then
-      USERNAME=$3
-    fi
-    build_distro $BUILD_PATH $USERNAME;;
-  rn)
-    if [[ -n $2 ]] && [[ -n $3 ]] && [[ -n $4 ]] && [[ -n $5 ]]; then
-      BUILD_PATH=$2
-      RELEASE=$3
-      FROM_DATE=$4
-      TO_DATE=$5
-    else
-      echo "Usage: build_distro.sh rn [build_path] [release] [from_date] [to_date]"
-      exit 1
-    fi
-    release_notes $BUILD_PATH $RELEASE $FROM_DATE $TO_DATE;;
-  update)
-    if [[ -n $2 ]]; then
-      DOCROOT=$2
-    else
-      echo "Usage: build_distro.sh test_makefile [build_path]"
-      exit 1
-    fi
-    if [[ -n $3 ]]; then
-      USERNAME=$3
-    fi
-    update $DOCROOT;;
-esac
\ No newline at end of file
diff --git a/commons.api.php b/commons.api.php
new file mode 100644
index 0000000..fd87fa5
--- /dev/null
+++ b/commons.api.php
@@ -0,0 +1,79 @@
+<?php
+
+/**
+ * @file
+ * Hooks provided by the Commons module.
+ */
+
+/**
+ * @addtogroup hooks
+ * @{
+ */
+
+/**
+ * Define entity integrations.
+ *
+ * This hook allows modules to register entity types and/or bundles that they
+ * provide for integration with Commons functionality. For example, a webform
+ * module could use it to register a form entity type and its "Test", "Survey"
+ * and "Suggestion" bundles.
+ *
+ * @return
+ *   An associative array of entity integrations whose keys define the entity
+ *   type for each integration and whose values contain the bundles which have
+ *   been integrated. Each bundle is itself an associative array, whose keys
+ *   define the type of integration to enable and whose values contain the
+ *   status of the integration. TRUE = enabled, FALSE = disabled.
+ *
+ * For a detailed usage example, see commons_q_a.module.
+ *
+ * @see hook_commons_entity_integration_alter()
+ */
+function hook_commons_entity_integration() {
+  // Register three of the webform entity's bundles for various integrations.
+  return array(
+    'webform' => array(
+      'test' => array(
+        'exclude_rate' => TRUE,
+        'is_group_content' => FALSE,
+      ),
+      'survey' => array(
+        'is_group_content' => TRUE,
+        'exclude_topics' => TRUE,
+      ),
+      'suggestion' => array(
+        'media' => TRUE,
+        'is_group_content' => TRUE,
+        'exclude_commons_follow' => TRUE,
+      ),
+    ),
+    'node' => array(
+      'group' => array(
+        'is_group_content' => FALSE,
+        'is_group' => TRUE,
+        'exclude_commons_follow' => TRUE,
+      ),
+    ),
+  );
+}
+
+/**
+ * Perform alterations on entity integrations.
+ *
+ * @param $integrations
+ *   An associative array of entity integrations whose keys define the entity
+ *   type for each integration and whose values contain the bundles which have
+ *   been integrated. Each bundle is itself an associative array, whose keys
+ *   define the type of integration to enable and whose values contain the
+ *   status of the integration. TRUE = enabled, FALSE = disabled.
+ *
+ * @see hook_commons_entity_integration()
+ */
+function hook_commons_entity_integration_alter(&$integrations) {
+  // Disable Media integration for the post content type.
+  $integrations['node']['post']['media'] = FALSE;
+}
+
+/**
+ * @} End of "addtogroup hooks".
+ */
diff --git a/commons.info b/commons.info
index 40489e1..25e298c 100644
--- a/commons.info
+++ b/commons.info
@@ -1,11 +1,10 @@
 name = Commons
-project = commons
-distribution_name = "Drupal Commons"
 description = Ready-to-use solution for building communities.
 core = 7.x
-php_memory_limit = 128M
+distribution_name = "Drupal Commons"
+exclusive = TRUE
 
-; Core modules.
+; Install required core modules.
 dependencies[] = block
 dependencies[] = comment
 dependencies[] = dblog
@@ -18,25 +17,33 @@ dependencies[] = menu
 dependencies[] = number
 dependencies[] = options
 dependencies[] = path
+dependencies[] = rdf
 dependencies[] = search
 dependencies[] = shortcut
 dependencies[] = taxonomy
 
-; Contributed modules.
+; Install required contributed modules.
 dependencies[] = addressfield
 dependencies[] = addressfield_tokens
 dependencies[] = breakpoints
+dependencies[] = ckeditor
 dependencies[] = ctools
 dependencies[] = custom_search
 dependencies[] = diff
+dependencies[] = elements
 dependencies[] = email_registration
 dependencies[] = entity
 dependencies[] = entityreference
 dependencies[] = entitycache
 dependencies[] = edit_profile
 dependencies[] = features
+dependencies[] = file_entity
 dependencies[] = flag
 dependencies[] = http_client
+dependencies[] = libraries
+dependencies[] = media
+dependencies[] = media_internet
+dependencies[] = media_wysiwyg
 dependencies[] = menu_attributes
 dependencies[] = message
 dependencies[] = message_notify
@@ -44,19 +51,22 @@ dependencies[] = message_subscribe
 dependencies[] = metatag
 dependencies[] = module_filter
 dependencies[] = navbar
+dependencies[] = media_oembed
 dependencies[] = og
+dependencies[] = panelizer
 dependencies[] = panels
+dependencies[] = panels_ipe
 dependencies[] = paranoia
 dependencies[] = pathauto
-dependencies[] = placeholder
 dependencies[] = privatemsg
+dependencies[] = privatemsg_realname
 dependencies[] = quicktabs
 dependencies[] = r4032login
-dependencies[] = libraries
 dependencies[] = radioactivity
 dependencies[] = realname
 dependencies[] = redirect
 dependencies[] = rules
+dependencies[] = schemaorg
 dependencies[] = sharethis
 dependencies[] = strongarm
 dependencies[] = token
@@ -64,10 +74,12 @@ dependencies[] = views
 dependencies[] = views_bulk_operations
 dependencies[] = views_ui
 dependencies[] = votingapi
-dependencies[] = advancedqueue
-dependencies[] = ckeditor
+
+; Install commons specific modules
+dependencies[] = commons_activity_page
 dependencies[] = commons_activity_streams
 dependencies[] = commons_bw
+dependencies[] = commons_content_moderation
 dependencies[] = commons_events
 dependencies[] = commons_events_pages
 dependencies[] = commons_featured
@@ -75,31 +87,33 @@ dependencies[] = commons_follow
 dependencies[] = commons_follow_group
 dependencies[] = commons_follow_node
 dependencies[] = commons_follow_term
-dependencies[] = commons_follow_user
 dependencies[] = commons_follow_ui
-dependencies[] = commons_like
-dependencies[] = commons_search
-dependencies[] = commons_search_core
+dependencies[] = commons_follow_user
 dependencies[] = commons_groups
-dependencies[] = commons_groups_pages
 dependencies[] = commons_groups_directory
+dependencies[] = commons_groups_pages
+dependencies[] = commons_like
+dependencies[] = commons_location
+dependencies[] = commons_media
+dependencies[] = commons_misc
 dependencies[] = commons_notify
-dependencies[] = commons_posts
 dependencies[] = commons_pages
-dependencies[] = commons_q_a
-dependencies[] = commons_q_a_pages
-dependencies[] = commons_wikis
 dependencies[] = commons_polls
-dependencies[] = commons_content_moderation
+dependencies[] = commons_posts
 dependencies[] = commons_profile_base
 dependencies[] = commons_profile_social
-dependencies[] = commons_utility_links
-dependencies[] = commons_user_profile_pages
+dependencies[] = commons_q_a
+dependencies[] = commons_q_a_pages
+dependencies[] = commons_search
+dependencies[] = commons_search_core
 dependencies[] = commons_site_homepage
-dependencies[] = commons_activity_page
-dependencies[] = commons_wikis_pages
-dependencies[] = commons_misc
-dependencies[] = commons_location
-dependencies[] = commons_wysiwyg
 dependencies[] = commons_social_sharing
 dependencies[] = commons_trusted_contacts
+dependencies[] = commons_user_profile_pages
+dependencies[] = commons_utility_links
+dependencies[] = commons_wikis
+dependencies[] = commons_wikis_pages
+dependencies[] = commons_wysiwyg
+
+; System Requirements.
+php_memory_limit = 128M
diff --git a/commons.install b/commons.install
index f774d11..a51fc04 100644
--- a/commons.install
+++ b/commons.install
@@ -7,13 +7,13 @@
 
 /**
  * Implements hook_requirements().
- * Set minimum 'max_execution_time' requirement
  */
 function commons_requirements($phase) {
   $requirements = array();
   // Ensure translations don't break during installation.
   $t = get_t();
   if($phase == 'install') {
+
     // Test PHP minimum execution time
     $requirements['php_max_execution_time'] = array(
       'title' => $t('PHP Max Execution Time'),
@@ -25,20 +25,613 @@ function commons_requirements($phase) {
       $requirements['php_max_execution_time']['description'] = $t('Your PHP execution time is too low, please set it greater than or equal to %time seconds.', array('%time' => DRUPAL_MINIMUM_MAX_EXECUTION_TIME));
       $requirements['php_max_execution_time']['severity'] = REQUIREMENT_ERROR;
     }
+
+    if(ini_get('apc.shm_size') != NULL) {
+      // Check for apc.shm_size = 96mb
+      $requirements['apc_shm_size'] = array(
+        'title' => $t('APC shim size'),
+        'value' => ini_get('apc.shm_size'),
+      );
+
+      $shm_size = preg_split('/[a-zA-Z]/', ini_get('apc.shm_size'));
+      $shm_size = $shm_size[0];
+
+      // only check if APC var is being set somewhere (usually apc.ini).
+      // throw error if there is less than 96MB available
+      if ($shm_size && $shm_size < COMMONS_MINIMUM_APC_CACHE) {
+        $requirements['apc_shm_size']['description'] = $t('APC is installed but %shm_size is not enough APC cache to successfully install Drupal Commons.
+           Find your <em>apc.ini</em> file and change the <em>apc.shm_size</em> value to at least <em>%min_shm_size</em>.', array('%shm_size' => $shm_size . 'M', '%min_shm_size' => COMMONS_MINIMUM_APC_CACHE . 'M'));
+        $requirements['apc_shm_size']['severity'] = REQUIREMENT_ERROR;
+      }
+    }
   }
   return $requirements;
 }
 
 /**
- * Implements hook_install().
+ * Implements hook_install_tasks().
+ */
+function commons_install_tasks() {
+  //make sure we have more memory than 196M. if not lets try to increase it.
+  if (ini_get('memory_limit') != '-1' && ini_get('memory_limit') <= '196M' && ini_get('memory_limit') >= '128M') {
+    ini_set('memory_limit', '196M');
+  }
+
+  $demo_content = variable_get('commons_install_example_content', FALSE);
+  $acquia_connector = variable_get('commons_install_acquia_connector', FALSE);
+
+  return array(
+    'commons_acquia_connector_enable' => array(
+      'display' => FALSE,
+      'type' => '',
+      'run' => $acquia_connector ? INSTALL_TASK_RUN_IF_NOT_COMPLETED : INSTALL_TASK_SKIP,
+    ),
+    'commons_installer_palette' => array(
+      'display_name' => st('Choose site color palette'),
+      'display' => TRUE,
+      'type' => 'form',
+      'function' => 'commons_installer_palette',
+    ),
+    'commons_anonymous_message_homepage' => array(
+      'display_name' => st('Enter Homepage welcome text'),
+      'display' => TRUE,
+      'type' => 'form',
+      'function' => 'commons_anonymous_welcome_text_form'
+    ),
+    'commons_revert_features' => array(
+      'display' => FALSE,
+    ),
+    'commons_demo_content' => array(
+      'display' => FALSE,
+      'type' => '',
+      'run' => $demo_content ? INSTALL_TASK_RUN_IF_NOT_COMPLETED : INSTALL_TASK_SKIP,
+    ),
+    'commons_create_first_group' => array(
+      'display_name' => st('Create the first group'),
+      'display' => TRUE,
+      'type' => 'form',
+    ),
+    'commons_admin_permissions' => array(
+      'display' => FALSE,
+    ),
+  );
+}
+
+/**
+ * Implements hook_install_tasks_alter().
+ */
+function commons_install_tasks_alter(&$tasks, $install_state) {
+  global $install_state;
+
+  // Skip profile selection step.
+  $tasks['install_select_profile']['display'] = FALSE;
+
+  // Skip language selection install step and default language to English.
+  $tasks['install_select_locale']['display'] = FALSE;
+  $tasks['install_select_locale']['run'] = INSTALL_TASK_SKIP;
+  $install_state['parameters']['locale'] = 'en';
+
+  // Override "install_finished" task to redirect people to home page.
+  $tasks['install_finished']['function'] = 'commons_install_finished';
+}
+
+/**
+ * Override of install_finished() without the useless text.
+ */
+function commons_install_finished(&$install_state) {
+  // BEGIN copy/paste from install_finished().
+  // Remove the bookmarks flag
+  $flag = flag_get_flag('bookmarks');
+  if($flag) {
+    $flag->delete();
+    $flag->disable();
+    _flag_clear_cache();
+  }
+
+  // Flush all caches to ensure that any full bootstraps during the installer
+  // do not leave stale cached data, and that any content types or other items
+  // registered by the installation profile are registered correctly.
+  drupal_flush_all_caches();
+
+  // We make custom code for the footer here because we want people to be able to freely edit it if they wish.
+  $footer_body = '<p>'. st('A Commons Community, powered by <a href="@acquia">Acquia</a>', array('@acquia' => url('https://www.acquia.com/products-services/drupal-commons-social-business-software'))) . '</p>';
+
+  $footer_block_text = array(
+    'body' => st($footer_body),
+    'info' => st('Default Footer'),
+    'format' => 'full_html',
+  );
+
+  if (drupal_write_record('block_custom', $footer_block_text)) {
+    $footer_block = array(
+      'module' => 'block',
+      'delta' => $footer_block_text['bid'],
+      'theme' => 'commons_origins',
+      'visibility' => 0,
+      'region' => 'footer',
+      'status' => 1,
+      'pages' => 0,
+      'weight' => 1,
+      'title' => variable_get('site_name', 'Drupal Commons'),
+    );
+    drupal_write_record('block', $footer_block);
+  }
+
+  // Remember the profile which was used.
+  variable_set('install_profile', drupal_get_profile());
+
+  // Installation profiles are always loaded last
+  db_update('system')
+    ->fields(array('weight' => 1000))
+    ->condition('type', 'module')
+    ->condition('name', drupal_get_profile())
+    ->execute();
+
+  // Cache a fully-built schema.
+  drupal_get_schema(NULL, TRUE);
+
+  variable_set('title_node', array(
+    'auto_attach' => array('title' => 'title'),
+    'hide_label' => array('page' => 0, 'entity' => 0),
+  ));
+
+  // Run cron to populate update status tables (if available) so that users
+  // will be warned if they've installed an out of date Drupal version.
+  // Will also trigger indexing of profile-supplied content or feeds.
+  drupal_cron_run();
+  // END copy/paste from install_finished().
+
+  if (isset($messages['error'])) {
+    $output = '<p>' . (isset($messages['error']) ? st('Review the messages above before visiting <a href="@url">your new site</a>.', array('@url' => url(''))) : st('<a href="@url">Visit your new site</a>.', array('@url' => url('')))) . '</p>';
+    return $output;
+  }
+  else {
+    // Since any module can add a drupal_set_message, this can bug the user
+    // when we redirect him to the front page. For a better user experience,
+    // remove all the message that are only "notifications" message.
+    drupal_get_messages('status', TRUE);
+    drupal_get_messages('completed', TRUE);
+
+    // If we don't install drupal using Drush, redirect the user to the front
+    // page.
+    if (!drupal_is_cli()) {
+      drupal_goto('');
+    }
+  }
+}
+
+/**
+ * Enable Acquia Connector module if selected on site configuration step.
+ */
+function commons_acquia_connector_enable() {
+  $modules = variable_get('commons_install_acquia_modules', array());
+  if (!empty($modules)) {
+    module_enable($modules, TRUE);
+  }
+}
+
+/**
+ * Allow users to select from a predefined list of color palettes during the
+ * commons installation.
+ */
+function commons_installer_palette() {
+  $form = array();
+  require_once(drupal_get_path('theme', 'commons_origins') . '/commons_origins.palettes.inc');
+
+  commons_origins_palettes_form($form);
+  $form['commons_origins_palette_fieldset']['#collapsible'] = FALSE;
+  $form['commons_origins_palette_fieldset']['#collapsed'] = FALSE;
+  $form['submit'] = array(
+    '#type' => 'submit',
+    '#value' => st('Save color palette'),
+  );
+  drupal_add_css('profiles/commons/commons_installer.css');
+
+  return $form;
+}
+
+/**
+ * Configuration form to set welcome text for the anonymous site homepage.
+ */
+function commons_anonymous_welcome_text_form() {
+  $form['commons_anonymous_welcome_explanation'] = array(
+    '#markup' => '<h2>' . st('Homepage welcome text') . '</h2>' . st("Below, enter text that will be shown on your community's homepage to help new visitors understand what your community is about and why they should join. The image below shows an example of how this text will appear. You can always change this text later."),
+    '#weight' => -1,
+  );
+  $form['commons_anonymous_welcome_example'] = array(
+    '#markup' => theme('image', array('path' => 'profiles/commons/images/commons_homepage_text_example.png', 'alt' => 'Home page example', 'alt' => 'Home page example')),
+    '#weight' => 0,
+  );
+
+  $form['commons_anonymous_welcome_title'] = array(
+    '#type' => 'textfield',
+    '#title' => st('Welcome headline'),
+    '#description' => st('A short description of the community that visitors can understand at a glance.'),
+    '#required' => TRUE,
+    '#default_value' => st('Welcome to our community'),
+  );
+
+  $form['commons_anonymous_welcome_body'] = array(
+    '#type' => 'textarea',
+    '#title' => st('Welcome body text'),
+    '#description' => st('Enter a couple of sentences elaborating about your community.'),
+    '#required' => TRUE,
+    '#default_value' => st('Share your thoughts, find answers to your questions.'),
+  );
+
+  $form['commons_install_example_content'] = array(
+    '#type' => 'checkbox',
+    '#title' => st('Install example content'),
+    '#description' => st('Install Commons with example content so that you can get a sense of what your site will look like once it becomes more active. Example content includes a group, a few users and content for that group. Example content can be modified or deleted like normal content.'),
+    '#default_value' => TRUE
+  );
+
+  $form['commons_anonymous_welcome_submit'] = array(
+    '#type'  => 'submit',
+    '#value' => st('Save and continue')
+  );
+
+  return $form;
+}
+
+/**
+ * Save the configuration form for set welcome text for anonymous users.
+ * @see commons_anonymous_welcome_text_form()
+ */
+function commons_anonymous_welcome_text_form_submit($form_id, &$form_state) {
+  variable_set('commons_anonymous_welcome_title', $form_state['values']['commons_anonymous_welcome_title']);
+  variable_set('commons_anonymous_welcome_body', $form_state['values']['commons_anonymous_welcome_body']);
+  variable_set('commons_install_example_content', $form_state['values']['commons_install_example_content']);
+}
+
+/*
+ * Revert Features after the installation.
+ */
+function commons_revert_features() {
+  // Revert Features components to ensure that they are in their default states.
+  $revert = array(
+    'commons_follow' => array('field_base'),
+    'commons_groups' => array('field_instance', 'field_base'),
+    'commons_trusted_contacts' => array('field_instance', 'field_base'),
+    'commons_wikis' => array('og_features_permission'),
+    'commons_wysiwyg' => array('user_permission', 'ckeditor_profile'),
+    'commons_events' => array('og_features_permission' , 'field_base'),
+    'commons_polls' => array('og_features_permission'),
+    'commons_q_a' => array('og_features_permission', 'field_base'),
+    'commons_posts' => array('og_features_permission'),
+  );
+
+  features_revert($revert);
+}
+
+/**
+ * This function generates demo content.
+ */
+function commons_demo_content() {
+
+  // Reset the Flag cache.
+  flag_get_flags(NULL, NULL, NULL, TRUE);
+
+  // Create demo Users
+  $demo_users = array(
+    'Jeff Noyes' => 'Jeff Noyes',
+    'Drew Robertson' => 'Drew Robertson',
+    'Lisa Rex' => 'Lisa Rex',
+    'Katelyn Fogarty' => 'Katelyn Fogarty',
+    'Dharmesh Mistry' => 'Dharmesh Mistry',
+    'Erica Ligeski' => 'Erica Ligeski',
+  );
+
+  foreach ($demo_users as $name) {
+    list($first_name, $last_name)  = explode(" ", $name);
+    $normalize_name = commons_normalize_name($name);
+    $password = user_password(8);
+
+    $fields = array(
+      'name' => $name,
+      'mail' => "{$normalize_name}@example.com",
+      'pass' => $password,
+      'status' => 1,
+      'init' => "{$normalize_name}@example.com",
+      'roles' => array(
+        DRUPAL_AUTHENTICATED_RID => 'authenticated user'
+      ),
+    );
+
+    $fields['field_name_first'][LANGUAGE_NONE][0]['value'] = $first_name;
+    $fields['field_name_last'][LANGUAGE_NONE][0]['value'] = $last_name;
+
+    $demo_users[$name] = user_save('', $fields);
+
+    // Add avatars to demo Users.
+    commons_add_user_avatar($demo_users[$name]);
+  }
+
+  // Demo Content.
+
+  // Group: Boston
+  $boston_group = new stdClass();
+  $boston_group->type = 'group';
+  node_object_prepare($boston_group);
+
+  $boston_group->title = 'Boston';
+  $boston_group->body[LANGUAGE_NONE][0]['value'] = commons_veggie_ipsum();
+  $boston_group->uid = $demo_users['Jeff Noyes']->uid;
+  $boston_group->language = LANGUAGE_NONE;
+  $boston_group->created = time() - 604800;
+  $boston_group->status = 1;
+  node_save($boston_group);
+
+  // Group: New York City
+  $nyc_group = new stdClass();
+  $nyc_group->type = 'group';
+  node_object_prepare($nyc_group);
+
+  $nyc_group->title = 'New York City';
+  $nyc_group->body[LANGUAGE_NONE][0]['value'] = commons_veggie_ipsum();
+  $nyc_group->uid = $demo_users['Drew Robertson']->uid;
+  $nyc_group->language = LANGUAGE_NONE;
+  $nyc_group->status = 1;
+  // Make the group 1 week old:
+  $nyc_group->created = time() - 604800;
+  node_save($nyc_group);
+
+
+  // Post: Best brunch places in Cambridge
+  $post = new stdClass();
+  $post->type = 'post';
+  node_object_prepare($post);
+
+  $post->title = 'Best brunch places in Cambridge';
+  $post->uid = $demo_users['Lisa Rex']->uid;
+  $post->language = LANGUAGE_NONE;
+  // 1:30 ago.
+  $post->created = time() - 5400;
+  $post->body[LANGUAGE_NONE][0]['value'] = "My aunt and I have been trying a lot of brunch places in Cambridge. Here's our favorites: <ul><li>North Street Grille for their breads
+<li>Mixtura for the souffles
+<li>The Neighborhood Restaurant for the vast quantities of food
+<li>City Girl Cafe for the ambiance <li>Bom Cafe for granola";
+  $post->body[LANGUAGE_NONE][0]['format'] = filter_default_format();
+
+  $post->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
+  $post->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy'] = 8;
+
+  $terms = array(
+    'brunch',
+    'Cambridge',
+    'dining out'
+  );
+
+  foreach ($terms as $term) {
+    $post->field_topics[LANGUAGE_NONE][]['tid'] = commons_create_topic($term);
+  }
+
+  node_save($post);
+
+  // Wiki: How to create a veggie burger
+  $wiki = new stdClass();
+  $wiki->type = 'wiki';
+  node_object_prepare($wiki);
+  $wiki->created = time() - 604800;
+  $wiki->title = 'How to create a veggie burger';
+  $wiki->uid = $demo_users['Dharmesh Mistry']->uid;
+  $wiki->language = LANGUAGE_NONE;
+  $wiki->body[LANGUAGE_NONE][0]['value'] = "Celtuce quandong gumbo coriander avocado yarrow broccoli rabe parsnip nori mung bean watercress taro pea sprouts cress. Bush tomato water spinach radish green bean okra spinach garlic cress. Cucumber squash tigernut swiss chard celery cabbage beet greens nori groundnut grape melon seakale. Earthnut pea kakadu plum chicory potato plantain fennel gumbo chickweed gourd cauliflower wakame green bean epazote taro quandong. Celery turnip kombu lotus root lettuce sierra leone bologi kale cauliflower gumbo parsnip taro welsh onion melon asparagus green bean beet greens black-eyed pea jÃ­cama. Kohlrabi lentil turnip greens plantain bush tomato leek arugula courgette amaranth yarrow.";
+  $wiki->body[LANGUAGE_NONE][0]['format'] = filter_default_format();
+
+  $wiki->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
+  $wiki->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy'] = 8;
+
+  $terms = array(
+    'vegetarian',
+    'casual',
+    'meal',
+    'recipe'
+  );
+
+  foreach ($terms as $term) {
+    $wiki->field_topics[LANGUAGE_NONE][]['tid'] = commons_create_topic($term);
+  }
+
+  node_save($wiki);
+
+  // Event: Ribfest Boston 2012
+  $event = new stdClass();
+  $event->type = 'event';
+  node_object_prepare($event);
+
+  $event->title = 'Ribfest Boston 2012';
+  $event->uid = $demo_users['Katelyn Fogarty']->uid;
+  $event->language = LANGUAGE_NONE;
+  $event->body[LANGUAGE_NONE][0]['value'] = "<strong>What ignited in 1999 as a community block party has exploded into one of Boston's most anticipated street festivals.</strong> Averaging 50,000 pounds of ribs and BBQ from more than 30 restaurants, Ribfest Boston 2013 is expected to draw more than 50,000 people. As a nationally recognized music festival, we host a hot blend of Indie, pop, Indie Roots, rock and alt country for one of the most unique band lineups in the city. Families can spend the whole weekend in Kids Square to enjoy live entertainment, inflatables, games and more.";
+  $event->body[LANGUAGE_NONE][0]['format'] = filter_default_format();
+  $event->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
+  $terms = array(
+    'bbq',
+    'music',
+    'festival'
+  );
+
+  foreach ($terms as $term) {
+    $event->field_topics[LANGUAGE_NONE][]['tid'] = commons_create_topic($term);
+  }
+
+  // The event starts 6 months from now.
+  $event->field_date[LANGUAGE_NONE][0]['value'] = format_date(REQUEST_TIME + 15552000, 'custom', 'Y-m-d 10:00:00');
+  // The event ends 6 months and one day from now.
+  $event->field_date[LANGUAGE_NONE][0]['value2'] = format_date(REQUEST_TIME + 15638400, 'custom', 'Y-m-d 10:00:00');
+
+  $event->field_address[LANGUAGE_NONE][0]['thoroughfare'] = '25 Corporate Drive';
+  $event->field_address[LANGUAGE_NONE][0]['premise'] = '4th floor';
+  $event->field_address[LANGUAGE_NONE][0]['postal_code'] = '01803';
+  $event->field_address[LANGUAGE_NONE][0]['country'] = 'US';
+  $event->field_address[LANGUAGE_NONE][0]['location'] = 'Waterfront';
+  $event->field_address[LANGUAGE_NONE][0]['administrative_area']  = 'MA';
+  $event->field_address[LANGUAGE_NONE][0]['locality'] = 'Boston';
+  $event->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
+  node_save($event);
+
+  // Don't display the 'registration settings have been saved' message.
+  drupal_get_messages('status', TRUE);
+  drupal_get_messages('completed', TRUE);
+
+  // Delete the demo content variable
+  variable_del('commons_install_example_content');
+
+  // Make sure the admin user is also a group.
+  // @todo: Move to a better place.
+  $wrapper = entity_metadata_wrapper('user', 1);
+  $wrapper->{OG_GROUP_FIELD}->set(TRUE);
+  $wrapper->save();
+}
+
+/**
+ * Let the admin user create the first group as part of the installation process.
+ */
+function commons_create_first_group() {
+  $form['commons_first_group_explanation'] = array(
+    '#markup' => '<h2>' . st('Create the first group in your new community.') . '</h2>' . st("Commons uses groups to collect community members and content related to a particular interest, working goal or geographic area."),
+    '#weight' => -1,
+  );
+
+  $form['commons_fist_group_example'] = array(
+    '#markup' => theme('image', array('path' => 'profiles/commons/images/commons_group_description_sample.png', 'alt' => 'Group description page example', 'alt' => 'Group description example')),
+    '#weight' => 0,
+  );
+
+  $form['commons_first_group_title'] = array(
+    '#type' => 'textfield',
+    '#title' => st("Group name"),
+    '#description' => st('For example: "Boston food lovers" or "Engineering team."'),
+    '#required' => TRUE,
+    '#default_value' => st('Engineering team'),
+  );
+
+  $form['commons_first_group_body'] = array(
+    '#type' => 'textarea',
+    '#title' => st('Group description'),
+    '#description' => st("This text will appear on the group's homepage and helps new contributors to become familiar with the purpose of the group. You can always change this text or add another group later."),
+    '#required' => TRUE,
+    '#default_value' => st('The online home for our Engineering team'),
+  );
+
+  $form['commons_first_group_submit'] = array(
+    '#type'  => 'submit',
+    '#value' => st('Save and continue')
+  );
+
+  return $form;
+}
+
+/**
+ * Save the first group form.
  *
- * Perform actions to set up the site for this profile.
+ * @see commons_create_first_group().
+ */
+function commons_create_first_group_submit($form_id, &$form_state) {
+  $values = $form_state['values'];
+
+  $first_group = new stdClass();
+  $first_group->type = 'group';
+  node_object_prepare($first_group);
+
+  $first_group->title = $values['commons_first_group_title'];
+  $first_group->body[LANGUAGE_NONE][0]['value'] = $values['commons_first_group_body'];
+  $first_group->uid = 1;
+  $first_group->language = LANGUAGE_NONE;
+  $first_group->status = 1;
+  node_save($first_group);
+}
+
+function commons_admin_permissions() {
+  //get the administrator role, we set this in the install file
+  $admin_role = user_role_load_by_name('administrator');
+  user_role_grant_permissions($admin_role->rid, array_keys(module_invoke_all('permission')));
+}
+
+function commons_add_user_avatar($account) {
+  global $base_url;
+
+  if ($account->uid) {
+    $picture_directory =  file_default_scheme() . '://' . variable_get('user_picture_path', 'pictures');
+    if(file_prepare_directory($picture_directory, FILE_CREATE_DIRECTORY)){
+      $picture_result = drupal_http_request($base_url . '/profiles/commons/images/avatars/avatar-' . commons_normalize_name($account->name) . '.png');
+      $picture_path = file_stream_wrapper_uri_normalize($picture_directory . '/picture-' . $account->uid . '-' . REQUEST_TIME . '.jpg');
+      $picture_file = file_save_data($picture_result->data, $picture_path, FILE_EXISTS_REPLACE);
+
+      // Check to make sure the picture isn't too large for the site settings.
+      $validators = array(
+        'file_validate_is_image' => array(),
+        'file_validate_image_resolution' => array(variable_get('user_picture_dimensions', '85x85')),
+        'file_validate_size' => array(variable_get('user_picture_file_size', '30') * 1024),
+      );
+
+      // attach photo to user's account.
+      $errors = file_validate($picture_file, $validators);
+
+      if (empty($errors)) {
+        // Update the user record.
+        $picture_file->uid = $account->uid;
+        $picture_file = file_save($picture_file);
+        file_usage_add($picture_file, 'user', 'user', $account->uid);
+        db_update('users')
+          ->fields(array(
+            'picture' => $picture_file->fid,
+          ))
+          ->condition('uid', $account->uid)
+          ->execute();
+        $account->picture = $picture_file->fid;
+      }
+    }
+  }
+}
+
+/**
+ * Helper function to generate a machine name similar to the user's full name.
+ */
+function commons_normalize_name($name) {
+  return drupal_strtolower(str_replace(' ','_', $name));
+}
+
+/**
+ * Generate some filler content.
+ */
+function commons_veggie_ipsum() {
+  $content = "Veggies sunt bona vobis, proinde vos postulo esse magis spinach kale scallion lettuce cucumber black-eyed pea onion.
+
+Bamboo shoot green bean wattle seed okra kakadu plum peanut ricebean celtuce. Azuki bean desert raisin bush tomato turnip peanut sweet pepper courgette horseradish. Garlic kombu beet greens celery courgette carrot mung bean.";
+  return $content;
+}
+
+/**
+ * This function create a taxonomy topic, is used for create a demo content for
+ * a new installations of Drupal Commons.
  *
- * @see system_install()
+ * @see commons_demo_content().
+ */
+function commons_create_topic($topic_name = '') {
+  $term = new stdClass();
+  $term->name = $topic_name;
+  $term->vid = 1;
+  // Pathauto aliasing can cause a menu_rebuild(), causing the request to
+  // exceeed the max execution time. Specify a manual alias instead.
+  // http://drupal.org/node/1867172.
+  $term->path['pathauto'] = FALSE;
+  taxonomy_term_save($term);
+  $path = array(
+    'source' => 'taxonomy/term/' . $term->tid,
+    'alias' => 'topics/' . drupal_html_class($topic_name),
+  );
+  path_save($path);
+  return $term->tid;
+}
+
+/**
+ * Implements hook_install().
  */
 function commons_install() {
   // Enable the Origins theme and set it as the default.
-  theme_enable(array('adaptivetheme', 'commons_origins', 'adaptivetheme_admin'));
+  theme_enable(array('adaptivetheme', 'commons_origins'));
 
     // The Bartik theme is automatically enabled during installation. Disable it.
   db_update('system')
@@ -50,7 +643,7 @@ function commons_install() {
   // Set the default and administration themes.
   variable_set('theme_default', 'commons_origins');
   // Set a default administrative theme:
-  variable_set('admin_theme', 'adaptivetheme_admin');
+  variable_set('admin_theme', 'ember');
   variable_set('node_admin_theme', FALSE);
 
   // Do not use the administration theme when editing or creating content.
@@ -85,19 +678,6 @@ function commons_install() {
   );
   drupal_write_record('block', $search_block);
 
-  // Create a default role for site administrators, with all available permissions assigned.
-  $admin_role = new stdClass();
-  $admin_role->name = 'administrator';
-  $admin_role->weight = 2;
-  user_role_save($admin_role);
-  // Set this as the administrator role.
-  variable_set('user_admin_role', $admin_role->rid);
-
-  // Assign user 1 the "administrator" role.
-  db_insert('users_roles')
-    ->fields(array('uid' => 1, 'rid' => $admin_role->rid))
-    ->execute();
-
   // AdaptiveTheme requires that the system theme settings form
   // be submitted in order for its themes' settings to be properly set
   // and the resulting css files generated.
@@ -112,6 +692,35 @@ function commons_install() {
 }
 
 /**
+ * Set a default user avatar as a managed file object.
+ */
+function commons_set_default_avatar() {
+  global $base_url;
+  $picture_directory =  file_default_scheme() . '://' . variable_get('user_picture_path', 'pictures');
+  if(file_prepare_directory($picture_directory, FILE_CREATE_DIRECTORY)){
+    $picture_result = drupal_http_request($base_url . '/profiles/commons/images/avatars/user-avatar.png');
+    $picture_path = file_stream_wrapper_uri_normalize($picture_directory . '/picture-default.jpg');
+    $picture_file = file_save_data($picture_result->data, $picture_path, FILE_EXISTS_REPLACE);
+
+    // Check to make sure the picture isn't too large for the site settings.
+    $validators = array(
+      'file_validate_is_image' => array(),
+      'file_validate_image_resolution' => array(variable_get('user_picture_dimensions', '85x85')),
+      'file_validate_size' => array(variable_get('user_picture_file_size', '30') * 1024),
+    );
+
+    // attach photo to user's account.
+    $errors = file_validate($picture_file, $validators);
+
+    if (empty($errors)) {
+      // Update the user record.
+      $picture_file = file_save($picture_file);
+      variable_set('user_picture_default', $picture_path);
+    }
+  }
+}
+
+/**
  * Enable the Origins theme and set it as the default. *
  */
 function commons_update_3101() {
@@ -197,4 +806,113 @@ function commons_update_3106() {
   $module_list = array('addressfield', 'addressfield_tokens');
   module_enable($module_list);
   return array();
-}
\ No newline at end of file
+}
+
+/**
+ * Rebuild the registry to accommodate Commons modules merging into the profile.
+ */
+function commons_update_3107() {
+  registry_rebuild();
+}
+
+/**
+ * Make the OG relationship required so that browsing widget
+ * tabs on the site homepage show an accurate count of content in each tab.
+ */
+function commons_update_3108() {
+    $revert = array(
+    'commons_posts' => array('views_view'),
+    'commons_documents' => array('views_view'),
+    'commons_polls' => array('views_view'),
+    'commons_wikis' => array('views_view'),
+    'commons_q_a' => array('views_view')
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Replace the Placeholder module with the Elements module.
+ */
+function commons_update_3109() {
+  if (module_exists('placeholder')) {
+    module_disable(array('placeholder'));
+  }
+  module_enable(array('elements'));
+  return array();
+}
+
+/**
+ * Change the administration theme to Ember.
+ */
+function commons_update_3111() {
+  variable_set('admin_theme', 'ember');
+  return array();
+}
+
+/*
+ * Revert Message types to use the correct title field token.
+ */
+function commons_update_3112() {
+  $revert = array(
+    'commons_wikis' => array('message_type'),
+    'commons_q_a' => array('message_type'),
+    'commons_posts' => array('message_type'),
+    'commons_notify' => array('message_type'),
+    'commons_like' => array('message_type'),
+    'commons_activity_streams' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/*
+ * Delete the AdvancedQueue class variable for sites that did not uninstall AdvancedQueue.
+ */
+function commons_update_3113() {
+  if (variable_get('queue_default_class', '') == 'AdvancedQueue') {
+    variable_del('queue_default_class');
+  }
+  return array();
+}
+
+/*
+ * Automatically use field_title for all nodes instead of the node base title.
+ */
+function commons_update_3114() {
+  variable_set('title_node', array(
+    'auto_attach' => array('title' => 'title'),
+    'hide_label' => array('page' => 0, 'entity' => 0),
+  ));
+
+  foreach (node_type_get_types() as $node_type) {
+    // Set the title as "Replaced by title_field".
+    if (!title_field_replacement_enabled('node', $node_type->type, 'title')) {
+      title_field_replacement_toggle('node', $node_type->type, 'title');
+    }
+
+    // Migrate the titles to the title field.
+    title_field_replacement_batch_set('node', $node_type->type, 'title');
+  }
+
+  drupal_flush_all_caches();
+}
+
+/*
+ * Replace the oEmbed module with the Media: oEmbed module.
+ */
+function commons_update_3115() {
+  if (module_exists('oembed')) {
+    module_disable(array('oembed'));
+  }
+  module_enable(array('media_oembed'));
+  return array();
+}
+
+/*
+ * Enable the Commons: Media and Media: WYSIWYG modules.
+ */
+function commons_update_3116() {
+  module_enable(array('commons_media', 'media_wysiwyg'));
+  return array();
+}
diff --git a/commons.profile b/commons.profile
index ac78972..cb67f82 100644
--- a/commons.profile
+++ b/commons.profile
@@ -1,4 +1,5 @@
 <?php
+
 /**
  * @file
  * Enables modules and site configuration for a Commons site installation.
@@ -9,6 +10,11 @@
  */
 define('DRUPAL_MINIMUM_MAX_EXECUTION_TIME', 120);
 
+/*
+ * Define commons minimum APC cache required to operate.
+ */
+define('COMMONS_MINIMUM_APC_CACHE', 96);
+
 /**
  * Implements hook_admin_paths_alter().
  */
@@ -19,21 +25,42 @@ function commons_admin_paths_alter(&$paths) {
 }
 
 /**
- * Implements hook_install_tasks_alter().
+ * Implements hook_update_projects_alter().
  */
-function commons_install_tasks_alter(&$tasks, $install_state) {
-  global $install_state;
-
-  // Skip profile selection step.
-  $tasks['install_select_profile']['display'] = FALSE;
-
-  // Skip language selection install step and default language to English.
-  $tasks['install_select_locale']['display'] = FALSE;
-  $tasks['install_select_locale']['run'] = INSTALL_TASK_SKIP;
-  $install_state['parameters']['locale'] = 'en';
+function commons_update_projects_alter(&$projects) {
+  // Enable update status for the Commons profile.
+  $modules = system_rebuild_module_data();
+  // The module object is shared in the request, so we need to clone it here.
+  $commons = clone $modules['commons'];
+  $commons->info['hidden'] = FALSE;
+  _update_process_info_list($projects, array('commons' => $commons), 'module', TRUE);
+}
 
-  // Override "install_finished" task to redirect people to home page.
-  $tasks['install_finished']['function'] = 'commons_install_finished';
+/**
+ * Get Commons entity integration information.
+ *
+ * @param $entity_type
+ *   (optional) The entity type to load, e.g. node or user.
+ *
+ * @return
+ *   An associative array of entity integrations whose keys define the entity
+ *   type for each integration and whose values contain the bundles which have
+ *   been integrated. Each bundle is itself an associative array, whose keys
+ *   define the type of integration to enable and whose values contain the
+ *   status of the integration. TRUE = enabled, FALSE = disabled.
+ */
+function commons_entity_integration_info($entity_type = NULL) {
+  $info = &drupal_static(__FUNCTION__);
+  if (!$info) {
+    $info = module_invoke_all('commons_entity_integration');
+    drupal_alter('commons_entity_integration', $info);
+  }
+  if ($entity_type) {
+    return isset($info[$entity_type]) ? $info[$entity_type] : array();
+  }
+  else {
+    return $info;
+  }
 }
 
 /**
@@ -42,8 +69,10 @@ function commons_install_tasks_alter(&$tasks, $install_state) {
  * Allows the profile to alter the site configuration form.
  */
 function commons_form_install_configure_form_alter(&$form, $form_state) {
-  // Flush all 'notification' messages, no need to show them to the user.
-  commons_clear_messages();
+  // Clear all non-error messages that might be set by enabled modules
+  drupal_get_messages('status', TRUE);
+  drupal_get_messages('completed', TRUE);
+
   // Pre-populate the site name with the server name.
   $form['site_information']['site_name']['#default_value'] = $_SERVER['SERVER_NAME'];
 
@@ -96,170 +125,6 @@ function commons_form_install_configure_form_alter(&$form, $form_state) {
   $form['#submit'][] = 'commons_check_acquia_connector';
 }
 
-
-/**
- * Implements hook_update_projects_alter().
- */
-function commons_update_projects_alter(&$projects) {
-  // Enable update status for the Commons profile.
-  $modules = system_rebuild_module_data();
-  // The module object is shared in the request, so we need to clone it here.
-  $commons = clone $modules['commons'];
-  $commons->info['hidden'] = FALSE;
-  _update_process_info_list($projects, array('commons' => $commons), 'module', TRUE);
-}
-
-/**
- * Implements hook_install_tasks().
- *
- * Allows the user to set a welcome message for anonymous users
- */
-function commons_install_tasks() {
-  // Suppress any status messages generated during batch install.
-  commons_clear_messages();
-
-  //make sure we have more memory than 196M. if not lets try to increase it.
-  if (ini_get('memory_limit') != '-1' && ini_get('memory_limit') <= '196M' && ini_get('memory_limit') >= '128M') {
-    ini_set('memory_limit', '196M');
-  }
-
-  $demo_content = variable_get('commons_install_example_content', FALSE);
-  $acquia_connector = variable_get('commons_install_acquia_connector', FALSE);
-
-  return array(
-    'commons_acquia_connector_enable' => array(
-      'display' => FALSE,
-      'type' => '',
-      'run' => $acquia_connector ? INSTALL_TASK_RUN_IF_NOT_COMPLETED : INSTALL_TASK_SKIP,
-    ),
-    'commons_installer_palette' => array(
-      'display_name' => st('Choose site color palette'),
-      'display' => TRUE,
-      'type' => 'form',
-      'function' => 'commons_installer_palette',
-    ),
-    'commons_anonymous_message_homepage' => array(
-      'display_name' => st('Enter Homepage welcome text'),
-      'display' => TRUE,
-      'type' => 'form',
-      'function' => 'commons_anonymous_welcome_text_form'
-    ),
-    'commons_revert_features' => array(
-      'display' => FALSE,
-    ),
-    'commons_demo_content' => array(
-      'display' => FALSE,
-      'type' => '',
-      'run' => $demo_content ? INSTALL_TASK_RUN_IF_NOT_COMPLETED : INSTALL_TASK_SKIP,
-    ),
-    'commons_create_first_group' => array(
-      'display_name' => st('Create the first group'),
-      'display' => TRUE,
-      'type' => 'form',
-    ),
-    'commons_admin_permissions' => array(
-      'display' => FALSE,
-    ),
-  );
-}
-
-/**
- * Allow users to select from a predefined list of color palettes during
- * the commons installation.
- */
-function commons_installer_palette() {
-  $form = array();
-  require_once(drupal_get_path('theme', 'commons_origins') . '/commons_origins.palettes.inc');
-
-  commons_origins_palettes_form($form);
-  $form['commons_origins_palette_fieldset']['#collapsible'] = FALSE;
-  $form['commons_origins_palette_fieldset']['#collapsed'] = FALSE;
-  $form['submit'] = array(
-    '#type' => 'submit',
-    '#value' => st('Save color palette'),
-  );
-  drupal_add_css('profiles/commons/commons_installer.css');
-
-  return $form;
-}
-/**
- * Let the admin user create the first group as part of the installation process
- */
-function commons_create_first_group() {
-  $form['commons_first_group_explanation'] = array(
-    '#markup' => '<h2>' . st('Create the first group in your new community.') . '</h2>' . st("Commons uses groups to collect community members and content related to a particular interest, working goal or geographic area."),
-    '#weight' => -1,
-  );
-
-  $form['commons_fist_group_example'] = array(
-    '#markup' => theme('image', array('path' => 'profiles/commons/images/commons_group_description_sample.png', 'alt' => 'Group description page example', 'alt' => 'Group description example')),
-    '#weight' => 0,
-  );
-
-  $form['commons_first_group_title'] = array(
-    '#type' => 'textfield',
-    '#title' => st("Group name"),
-    '#description' => st('For example: "Boston food lovers" or "Engineering team."'),
-    '#required' => TRUE,
-    '#default_value' => st('Engineering team'),
-  );
-
-  $form['commons_first_group_body'] = array(
-    '#type' => 'textarea',
-    '#title' => st('Group description'),
-    '#description' => st("This text will appear on the group's homepage and helps new contributors to become familiar with the purpose of the group. You can always change this text or add another group later."),
-    '#required' => TRUE,
-    '#default_value' => st('The online home for our Engineering team'),
-  );
-
-  $form['commons_first_group_submit'] = array(
-    '#type'  => 'submit',
-    '#value' => st('Save and continue')
-  );
-
-  return $form;
-}
-
-/**
- * Save the first group form
- *
- * @see commons_create_first_group().
- */
-function commons_create_first_group_submit($form_id, &$form_state) {
-  $values = $form_state['values'];
-
-  $first_group = new stdClass();
-  $first_group->type = 'group';
-  node_object_prepare($first_group);
-
-  $first_group->title = $values['commons_first_group_title'];
-  $first_group->body[LANGUAGE_NONE][0]['value'] = $values['commons_first_group_body'];
-  $first_group->uid = 1;
-  $first_group->language = LANGUAGE_NONE;
-  $first_group->status = 1;
-  node_save($first_group);
-}
-
-/*
- * Revert Features after the installation.
- */
-function commons_revert_features() {
-  // Revert Features components to ensure that they are in their default states.
-  $revert = array(
-    'commons_groups' => array('field_instance'),
-    'commons_trusted_contacts' => array('field_instance'),
-    'commons_wikis' => array('og_features_permission'),
-    'commons_wysiwyg' => array('user_permission', 'ckeditor_profile'),
-  );
-  features_revert($revert);
-}
-
-function commons_admin_permissions() {
-  //get the administrator role, we set this in the install file
-  $admin_role = user_role_load_by_name('administrator');
-  user_role_grant_permissions($admin_role->rid, array_keys(module_invoke_all('permission')));
-}
-
 /**
  * Save the full name of the first user.
  */
@@ -285,441 +150,3 @@ function commons_check_acquia_connector($form_id, &$form_state) {
     variable_set('commons_install_acquia_modules', array_keys($options));
   }
 }
-
-/**
- * Configuration form to set welcome text for the anonymous site homepage.
- */
-function commons_anonymous_welcome_text_form() {
-  $form['commons_anonymous_welcome_explanation'] = array(
-    '#markup' => '<h2>' . st('Homepage welcome text') . '</h2>' . st("Below, enter text that will be shown on your community's homepage to help new visitors understand what your community is about and why they should join. The image below shows an example of how this text will appear. You can always change this text later."),
-    '#weight' => -1,
-  );
-  $form['commons_anonymous_welcome_example'] = array(
-    '#markup' => theme('image', array('path' => 'profiles/commons/images/commons_homepage_text_example.png', 'alt' => 'Home page example', 'alt' => 'Home page example')),
-    '#weight' => 0,
-  );
-
-  $form['commons_anonymous_welcome_title'] = array(
-    '#type' => 'textfield',
-    '#title' => st('Welcome headline'),
-    '#description' => st('A short description of the community that visitors can understand at a glance.'),
-    '#required' => TRUE,
-    '#default_value' => st('Welcome to our community'),
-  );
-
-  $form['commons_anonymous_welcome_body'] = array(
-    '#type' => 'textarea',
-    '#title' => st('Welcome body text'),
-    '#description' => st('Enter a couple of sentences elaborating about your community.'),
-    '#required' => TRUE,
-    '#default_value' => st('Share your thoughts, find answers to your questions.'),
-  );
-
-  $form['commons_install_example_content'] = array(
-    '#type' => 'checkbox',
-    '#title' => st('Install example content'),
-    '#description' => st('Install Commons with example content so that you can get a sense of what your site will look like once it becomes more active. Example content includes a group, a few users and content for that group. Example content can be modified or deleted like normal content.'),
-    '#default_value' => TRUE
-  );
-
-  $form['commons_anonymous_welcome_submit'] = array(
-    '#type'  => 'submit',
-    '#value' => st('Save and continue')
-  );
-
-  return $form;
-}
-
-/**
- * Save the configuration form for set welcome text for anonymous users
- * @see commons_anonymous_welcome_text_form()
- */
-function commons_anonymous_welcome_text_form_submit($form_id, &$form_state) {
-  variable_set('commons_anonymous_welcome_title', $form_state['values']['commons_anonymous_welcome_title']);
-  variable_set('commons_anonymous_welcome_body', $form_state['values']['commons_anonymous_welcome_body']);
-  variable_set('commons_install_example_content', $form_state['values']['commons_install_example_content']);
-}
-
-/**
- * Helper function to generate a machine name similar to the user's full name.
- */
-function commons_normalize_name($name) {
-  return drupal_strtolower(str_replace(' ','_', $name));
-}
-/**
- * This function generate a demo content
- */
-function commons_demo_content() {
-
-  // Reset the Flag cache.
-  flag_get_flags(NULL, NULL, NULL, TRUE);
-
-  // Create demo Users
-  $demo_users = array(
-    'Jeff Noyes' => 'Jeff Noyes',
-    'Drew Robertson' => 'Drew Robertson',
-    'Lisa Rex' => 'Lisa Rex',
-    'Katelyn Fogarty' => 'Katelyn Fogarty',
-    'Dharmesh Mistry' => 'Dharmesh Mistry',
-    'Erica Ligeski' => 'Erica Ligeski',
-  );
-
-
-  foreach ($demo_users as $name) {
-    list($first_name, $last_name)  = explode(" ", $name);
-    $normalize_name = commons_normalize_name($name);
-    $password = user_password(8);
-
-
-    $fields = array(
-      'name' => $name,
-      'mail' => "{$normalize_name}@example.com",
-      'pass' => $password,
-      'status' => 1,
-      'init' => "{$normalize_name}@example.com",
-      'roles' => array(
-        DRUPAL_AUTHENTICATED_RID => 'authenticated user'
-      ),
-    );
-
-    $fields['field_name_first'][LANGUAGE_NONE][0]['value'] = $first_name;
-    $fields['field_name_last'][LANGUAGE_NONE][0]['value'] = $last_name;
-
-    $demo_users[$name] = user_save('', $fields);
-
-    // Add avatars to demo Users.
-    commons_add_user_avatar($demo_users[$name]);
-  }
-
-  // Demo Content.
-
-  // Group: Boston
-  $boston_group = new stdClass();
-  $boston_group->type = 'group';
-  node_object_prepare($boston_group);
-
-  $boston_group->title = 'Boston';
-  $boston_group->body[LANGUAGE_NONE][0]['value'] = commons_veggie_ipsum();
-  $boston_group->uid = $demo_users['Jeff Noyes']->uid;
-  $boston_group->language = LANGUAGE_NONE;
-  $boston_group->created = time() - 604800;
-  $boston_group->status = 1;
-  node_save($boston_group);
-
-  // Group: New York City
-  $nyc_group = new stdClass();
-  $nyc_group->type = 'group';
-  node_object_prepare($nyc_group);
-
-  $nyc_group->title = 'New York City';
-  $nyc_group->body[LANGUAGE_NONE][0]['value'] = commons_veggie_ipsum();
-  $nyc_group->uid = $demo_users['Drew Robertson']->uid;
-  $nyc_group->language = LANGUAGE_NONE;
-  $nyc_group->status = 1;
-  // Make the group 1 week old:
-  $nyc_group->created = time() - 604800;
-  node_save($nyc_group);
-
-
-  // Post: Best brunch places in Cambridge
-  $post = new stdClass();
-  $post->type = 'post';
-  node_object_prepare($post);
-
-  $post->title = 'Best brunch places in Cambridge';
-  $post->uid = $demo_users['Lisa Rex']->uid;
-  $post->language = LANGUAGE_NONE;
-  // 1:30 ago.
-  $post->created = time() - 5400;
-  $post->body[LANGUAGE_NONE][0]['value'] = "My aunt and I have been trying a lot of brunch places in Cambridge. Here's our favorites: <ul><li>North Street Grille for their breads
-<li>Mixtura for the souffles
-<li>The Neighborhood Restaurant for the vast quantities of food
-<li>City Girl Cafe for the ambiance <li>Bom Cafe for granola";
-  $post->body[LANGUAGE_NONE][0]['format'] = filter_default_format();
-
-  $post->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
-  $post->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy'] = 8;
-
-  $terms = array(
-    'brunch',
-    'Cambridge',
-    'dining out'
-  );
-
-  foreach ($terms as $term) {
-    $post->field_topics[LANGUAGE_NONE][]['tid'] = commons_create_topic($term);
-  }
-
-  node_save($post);
-
-
-  // Wiki: How to create a veggie burger
-  $wiki = new stdClass();
-  $wiki->type = 'wiki';
-  node_object_prepare($wiki);
-  $wiki->created = time() - 604800;
-  $wiki->title = 'How to create a veggie burger';
-  $wiki->uid = $demo_users['Dharmesh Mistry']->uid;
-  $wiki->language = LANGUAGE_NONE;
-  $wiki->body[LANGUAGE_NONE][0]['value'] = "Celtuce quandong gumbo coriander avocado yarrow broccoli rabe parsnip nori mung bean watercress taro pea sprouts cress. Bush tomato water spinach radish green bean okra spinach garlic cress. Cucumber squash tigernut swiss chard celery cabbage beet greens nori groundnut grape melon seakale. Earthnut pea kakadu plum chicory potato plantain fennel gumbo chickweed gourd cauliflower wakame green bean epazote taro quandong. Celery turnip kombu lotus root lettuce sierra leone bologi kale cauliflower gumbo parsnip taro welsh onion melon asparagus green bean beet greens black-eyed pea jÃ­cama. Kohlrabi lentil turnip greens plantain bush tomato leek arugula courgette amaranth yarrow.";
-  $wiki->body[LANGUAGE_NONE][0]['format'] = filter_default_format();
-
-  $wiki->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
-  $wiki->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy'] = 8;
-
-  $terms = array(
-    'vegetarian',
-    'casual',
-    'meal',
-    'recipe'
-  );
-
-  foreach ($terms as $term) {
-    $wiki->field_topics[LANGUAGE_NONE][]['tid'] = commons_create_topic($term);
-  }
-
-  node_save($wiki);
-
-  // Event: Ribfest Boston 2012
-  $event = new stdClass();
-  $event->type = 'event';
-  node_object_prepare($event);
-
-  $event->title = 'Ribfest Boston 2012';
-  $event->uid = $demo_users['Katelyn Fogarty']->uid;
-  $event->language = LANGUAGE_NONE;
-  $event->body[LANGUAGE_NONE][0]['value'] = "<strong>What ignited in 1999 as a community block party has exploded into one of Boston's most anticipated street festivals.</strong> Averaging 50,000 pounds of ribs and BBQ from more than 30 restaurants, Ribfest Boston 2013 is expected to draw more than 50,000 people. As a nationally recognized music festival, we host a hot blend of Indie, pop, Indie Roots, rock and alt country for one of the most unique band lineups in the city. Families can spend the whole weekend in Kids Square to enjoy live entertainment, inflatables, games and more.";
-  $event->body[LANGUAGE_NONE][0]['format'] = filter_default_format();
-  $event->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
-  $terms = array(
-    'bbq',
-    'music',
-    'festival'
-  );
-
-  foreach ($terms as $term) {
-    $event->field_topics[LANGUAGE_NONE][]['tid'] = commons_create_topic($term);
-  }
-
-  $event->field_date[LANGUAGE_NONE][0]['value'] = '2014-01-12 10:00:00';
-  $event->field_date[LANGUAGE_NONE][0]['value2'] = '2014-01-13 13:00:00';
-
-  $event->field_address[LANGUAGE_NONE][0]['thoroughfare'] = '25 Corporate Drive';
-  $event->field_address[LANGUAGE_NONE][0]['premise'] = '4th floor';
-  $event->field_address[LANGUAGE_NONE][0]['postal_code'] = '01803';
-  $event->field_address[LANGUAGE_NONE][0]['country'] = 'US';
-  $event->field_address[LANGUAGE_NONE][0]['location'] = 'Waterfront';
-  $event->field_address[LANGUAGE_NONE][0]['administrative_area']  = 'MA';
-  $event->field_address[LANGUAGE_NONE][0]['locality'] = 'Boston';
-  $event->og_group_ref[LANGUAGE_NONE][0]['target_id'] = $boston_group->nid;
-  node_save($event);
-  // Don't display the 'registration settings have been saved' message.
-  commons_clear_messages();
-
-  // Delete the demo content variable
-  variable_del('commons_install_example_content');
-
-  // Make sure the admin user is also a group.
-  // @todo: Move to a better place.
-  $wrapper = entity_metadata_wrapper('user', 1);
-  $wrapper->{OG_GROUP_FIELD}->set(TRUE);
-  $wrapper->save();
-}
-
-function commons_add_user_avatar($account) {
-  global $base_url;
-
-  if ($account->uid) {
-    $picture_directory =  file_default_scheme() . '://' . variable_get('user_picture_path', 'pictures');
-    if(file_prepare_directory($picture_directory, FILE_CREATE_DIRECTORY)){
-      $picture_result = drupal_http_request($base_url . '/profiles/commons/images/avatars/avatar-' . commons_normalize_name($account->name) . '.png');
-      $picture_path = file_stream_wrapper_uri_normalize($picture_directory . '/picture-' . $account->uid . '-' . REQUEST_TIME . '.jpg');
-      $picture_file = file_save_data($picture_result->data, $picture_path, FILE_EXISTS_REPLACE);
-
-      // Check to make sure the picture isn't too large for the site settings.
-      $validators = array(
-        'file_validate_is_image' => array(),
-        'file_validate_image_resolution' => array(variable_get('user_picture_dimensions', '85x85')),
-        'file_validate_size' => array(variable_get('user_picture_file_size', '30') * 1024),
-      );
-
-      // attach photo to user's account.
-      $errors = file_validate($picture_file, $validators);
-
-      if (empty($errors)) {
-        // Update the user record.
-        $picture_file->uid = $account->uid;
-        $picture_file = file_save($picture_file);
-        file_usage_add($picture_file, 'user', 'user', $account->uid);
-        db_update('users')
-          ->fields(array(
-          'picture' => $picture_file->fid,
-          ))
-          ->condition('uid', $account->uid)
-          ->execute();
-        $account->picture = $picture_file->fid;
-      }
-    }
-  }
-}
-
-/**
-  * Generate some filler content.
- */
-function commons_veggie_ipsum() {
-  $content = "Veggies sunt bona vobis, proinde vos postulo esse magis spinach kale scallion lettuce cucumber black-eyed pea onion.
-
-Bamboo shoot green bean wattle seed okra kakadu plum peanut ricebean celtuce. Azuki bean desert raisin bush tomato turnip peanut sweet pepper courgette horseradish. Garlic kombu beet greens celery courgette carrot mung bean.";
-  return $content;
-}
-
-/**
- * This function create a taxonomy topic, is used for create a demo content
- * for a new instalations of Drupal Commons
- *
- * @see commons_demo_content().
- */
-function commons_create_topic($topic_name = '') {
-  $term = new stdClass();
-  $term->name = $topic_name;
-  $term->vid = 1;
-  // Pathauto aliasing can cause a menu_rebuild(), causing the request to
-  // exceeed the max execution time. Specify a manual alias instead.
-  // http://drupal.org/node/1867172.
-  $term->path['pathauto'] = FALSE;
-  taxonomy_term_save($term);
-  $path = array(
-    'source' => 'taxonomy/term/' . $term->tid,
-    'alias' => 'topics/' . drupal_html_class($topic_name),
-  );
-  path_save($path);
-  return $term->tid;
-}
-
-/**
- * Enable Acquia Connector module if selected on site configuration step.
- */
-function commons_acquia_connector_enable() {
-  $modules = variable_get('commons_install_acquia_modules', array());
-  if (!empty($modules)) {
-    module_enable($modules, TRUE);
-    commons_clear_messages();
-  }
-}
-
-/**
- * Override of install_finished() without the useless text.
- */
-function commons_install_finished(&$install_state) {
-  // BEGIN copy/paste from install_finished().
-  // Remove the bookmarks flag
-  $flag = flag_get_flag('bookmarks');
-  if($flag) {
-    $flag->delete();
-    $flag->disable();
-    _flag_clear_cache();
-  }
-
-  // Flush all caches to ensure that any full bootstraps during the installer
-  // do not leave stale cached data, and that any content types or other items
-  // registered by the installation profile are registered correctly.
-  drupal_flush_all_caches();
-
-  // We make custom code for the footer here because we want people to be able to freely edit it if they wish.
-  $footer_body = '<p>'. st('A Commons Community, powered by <a href="@acquia">Acquia</a>', array('@acquia' => url('https://www.acquia.com/products-services/drupal-commons-social-business-software'))) . '</p>';
-
-  $footer_block_text = array(
-    'body' => st($footer_body),
-    'info' => st('Default Footer'),
-    'format' => 'full_html',
-  );
-
-  if (drupal_write_record('block_custom', $footer_block_text)) {
-    $footer_block = array(
-      'module' => 'block',
-      'delta' => $footer_block_text['bid'],
-      'theme' => 'commons_origins',
-      'visibility' => 0,
-      'region' => 'footer',
-      'status' => 1,
-      'pages' => 0,
-      'weight' => 1,
-      'title' => variable_get('site_name', 'Drupal Commons'),
-    );
-    drupal_write_record('block', $footer_block);
-  }
-
-  // Remember the profile which was used.
-  variable_set('install_profile', drupal_get_profile());
-
-  // Installation profiles are always loaded last
-  db_update('system')
-    ->fields(array('weight' => 1000))
-    ->condition('type', 'module')
-    ->condition('name', drupal_get_profile())
-    ->execute();
-
-  // Cache a fully-built schema.
-  drupal_get_schema(NULL, TRUE);
-
-  // Run cron to populate update status tables (if available) so that users
-  // will be warned if they've installed an out of date Drupal version.
-  // Will also trigger indexing of profile-supplied content or feeds.
-  drupal_cron_run();
-  // END copy/paste from install_finished().
-
-  if (isset($messages['error'])) {
-    $output = '<p>' . (isset($messages['error']) ? st('Review the messages above before visiting <a href="@url">your new site</a>.', array('@url' => url(''))) : st('<a href="@url">Visit your new site</a>.', array('@url' => url('')))) . '</p>';
-    return $output;
-  }
-  else {
-    // Since any module can add a drupal_set_message, this can bug the user
-    // when we redirect him to the front page. For a better user experience,
-    // remove all the message that are only "notifications" message.
-    commons_clear_messages();
-    // If we don't install drupal using Drush, redirect the user to the front
-    // page.
-    if (!drupal_is_cli()) {
-      drupal_goto('');
-    }
-  }
-}
-
-/**
- * Clear all 'notification' type messages that may have been set.
- */
-function commons_clear_messages() {
-  drupal_get_messages('status', TRUE);
-  drupal_get_messages('completed', TRUE);
-  // Migrate adds its messages under the wrong type, see #1659150.
-  drupal_get_messages('ok', TRUE);
-}
-
-/**
- * Set a default user avatar as a managed file object.
- */
-function commons_set_default_avatar() {
-  global $base_url;
-  $picture_directory =  file_default_scheme() . '://' . variable_get('user_picture_path', 'pictures');
-  if(file_prepare_directory($picture_directory, FILE_CREATE_DIRECTORY)){
-    $picture_result = drupal_http_request($base_url . '/profiles/commons/images/avatars/user-avatar.png');
-    $picture_path = file_stream_wrapper_uri_normalize($picture_directory . '/picture-default.jpg');
-    $picture_file = file_save_data($picture_result->data, $picture_path, FILE_EXISTS_REPLACE);
-
-    // Check to make sure the picture isn't too large for the site settings.
-    $validators = array(
-      'file_validate_is_image' => array(),
-      'file_validate_image_resolution' => array(variable_get('user_picture_dimensions', '85x85')),
-      'file_validate_size' => array(variable_get('user_picture_file_size', '30') * 1024),
-    );
-
-    // attach photo to user's account.
-    $errors = file_validate($picture_file, $validators);
-
-    if (empty($errors)) {
-      // Update the user record.
-      $picture_file = file_save($picture_file);
-      variable_set('user_picture_default', $picture_path);
-    }
-  }
-}
diff --git a/drupal-org-core.make b/drupal-org-core.make
index 570df35..2862d2b 100644
--- a/drupal-org-core.make
+++ b/drupal-org-core.make
@@ -3,17 +3,7 @@ core = 7.x
 
 ; Download Drupal core and apply core patches if needed.
 projects[drupal][type] = "core"
-projects[drupal][version] = "7.23"
-
-; Hide the profiles under /profiles, so Commons is the only one. This allows
-; the installation to start at the Language selection screen, bypassing a
-; baffling and silly choice, especially for non-native speakers.
-; http://drupal.org/node/1780598#comment-6480088
-projects[drupal][patch][] = http://drupal.org/files/spark-install-1780598-5.patch
-; This requires a core bug fix to not show the profile selection page when only
-; one profile is visible.
-; http://drupal.org/node/1074108#comment-6463662
-projects[drupal][patch][] = http://drupal.org/files/1074108-skip-profile-16-7.x-do-not-test.patch
+projects[drupal][version] = 7.27
 
 ; This patch allows install profile to list requirements on the install page
 ; http://drupal.org/node/1971072
@@ -25,4 +15,12 @@ projects[drupal][patch][] = http://drupal.org/files/drupal-7.x-allow_profile_cha
 
 ; Allow to specify SCRIPT HTML element attributes through drupal_add_js()
 ; http://drupal.org/node/1664602#comment-6221066
-projects[drupal][patch][] = http://drupal.org/files/1664602-1.patch
\ No newline at end of file
+projects[drupal][patch][] = http://drupal.org/files/1664602-1.patch
+
+; Optimize node access queries.
+; https://drupal.org/comment/8516319#comment-8516319
+projects[drupal][patch][] = https://drupal.org/files/issues/drupal-optimize_node_access_queries-106721-D7-71-do-not-test.patch
+
+; Statically cache node access grants
+; https://drupal.org/comment/8495029#comment-8495029
+projects[drupal][patch][] = https://drupal.org/files/issues/node_access_grants-static-cache-11.patch
\ No newline at end of file
diff --git a/drupal-org.make b/drupal-org.make
index 212c86b..5d8d0e3 100644
--- a/drupal-org.make
+++ b/drupal-org.make
@@ -3,32 +3,35 @@ core = 7.x
 
 ; Contributed modules.
 
+projects[acquia_connector][type] = "module"
+projects[acquia_connector][subdir] = "contrib"
+projects[acquia_connector][version] = "2.14"
+
 projects[addressfield][type] = "module"
 projects[addressfield][subdir] = "contrib"
-projects[addressfield][version] = "1.0-beta4"
+projects[addressfield][version] = "1.0-beta5"
 
 projects[addressfield_tokens][type] = "module"
 projects[addressfield_tokens][subdir] = "contrib"
 projects[addressfield_tokens][version] = "1.3"
 
-projects[acquia_connector][type] = "module"
-projects[acquia_connector][subdir] = "contrib"
-projects[acquia_connector][version] = "2.10"
-
-projects[advancedqueue][type] = "module"
-projects[advancedqueue][subdir] = "contrib"
-projects[advancedqueue][version] = "1.0-alpha2"
+projects[admin_icons][type] = "module"
+projects[admin_icons][subdir] = "contrib"
+projects[admin_icons][download][type] = "git"
+projects[admin_icons][download][url] = "http://git.drupal.org/project/admin_icons.git"
+projects[admin_icons][download][branch] = "7.x-1.x"
+projects[admin_icons][download][revision] = "60d9f28801533fecc92216a60d444d89d80e7611"
 
 projects[apachesolr][type] = "module"
 projects[apachesolr][subdir] = "contrib"
-projects[apachesolr][version] = "1.4"
+projects[apachesolr][version] = "1.6"
 
 projects[apachesolr_og][type] = "module"
 projects[apachesolr_og][subdir] = "contrib"
 projects[apachesolr_og][download][type] = "git"
 projects[apachesolr_og][download][url] = "http://git.drupal.org/project/apachesolr_og.git"
 projects[apachesolr_og][download][branch] = "7.x-1.x"
-projects[apachesolr_og][download]revision] = "49820b4a4fcff7c1c4efe449da033fb6d8711ac5"
+projects[apachesolr_og][download][revision] = "49820b4a4fcff7c1c4efe449da033fb6d8711ac5"
 
 projects[apachesolr_proximity][type] = "module"
 projects[apachesolr_proximity][subdir] = "contrib"
@@ -41,9 +44,16 @@ projects[apachesolr_user][download][url] = "http://git.drupal.org/project/apache
 projects[apachesolr_user][download][branch] = "7.x-1.x"
 projects[apachesolr_user][download]revision] = "a86c5aebfceaf4a3fc53544762a36ca1b70809d5"
 
+; Check the user object before trying to display a result.
+; https://drupal.org/node/2077281#comment-7807937
+projects[apachesolr_user][patch][] = "http://drupal.org/files/2077281-apache-solr-user-check-3.patch"
+
 projects[breakpoints][type] = "module"
 projects[breakpoints][subdir] = "contrib"
-projects[breakpoints][version] = "1.1"
+projects[breakpoints][download][type] = "git"
+projects[breakpoints][download][url] = "http://git.drupal.org/project/breakpoints.git"
+projects[breakpoints][download][branch] = "7.x-1.x"
+projects[breakpoints][download][revision] = "c4f3665"
 
 projects[connector][type] = "module"
 projects[connector][subdir] = "contrib"
@@ -51,27 +61,41 @@ projects[connector][version] = "1.0-beta2"
 
 projects[ckeditor][type] = "module"
 projects[ckeditor][subdir] = "contrib"
-projects[ckeditor][version] = "1.13"
+projects[ckeditor][download][type] = "git"
+projects[ckeditor][download][url] = "http://git.drupal.org/project/ckeditor.git"
+projects[ckeditor][download][branch] = "7.x-1.x"
+projects[ckeditor][download][revision] = "b69a9ac"
+
+; Only load CSS when necessary.
+; https://drupal.org/node/1370894
+projects[ckeditor][patch][] = "https://drupal.org/files/issues/attach-ckeditor-css-1370894-8.patch"
+
+; Accomodate latest Media changes.
+; https://drupal.org/node/2159403
+projects[ckeditor][patch][] = "https://drupal.org/files/issues/ckeditor-accomodate-latest-media-changes-0.patch"
+
+; Remove redundant external plugin declarations.
+; https://drupal.org/comment/8284591#comment-8284591
+projects[ckeditor][patch][] = "https://drupal.org/files/issues/ckeditor-remove-external-plugin-declarations-1-alt.patch"
 
 projects[ctools][type] = "module"
 projects[ctools][subdir] = "contrib"
-projects[ctools][version] = "1.3"
+projects[ctools][download][type] = "git"
+projects[ctools][download][url] = "http://git.drupal.org/project/ctools.git"
+projects[ctools][download][branch] = "7.x-1.x"
+projects[ctools][download][revision] = "e720f61d"
 
 projects[custom_search][type] = "module"
 projects[custom_search][subdir] = "contrib"
-projects[custom_search][download][type] = "git"
-projects[custom_search][download][url] = "http://git.drupal.org/project/custom_search.git"
-projects[custom_search][download][branch] = "7.x-1.x"
-projects[custom_search][download][revision] = "20144e64494c83a448067d587e59df5d7e4780bb"
+projects[custom_search][version] = "1.16"
 
 ; Avoid akward sanitization of user-entered search strings.
 ; https://drupal.org/node/2012210
 projects[custom_search][patch][] = "http://drupal.org/files/commons_search_js_encode.patch"
 
-
 projects[date][type] = "module"
 projects[date][subdir] = "contrib"
-projects[date][version] = "2.6"
+projects[date][version] = "2.7"
 
 projects[date_facets][type] = "module"
 projects[date_facets][subdir] = "contrib"
@@ -86,83 +110,131 @@ projects[diff][type] = "module"
 projects[diff][subdir] = "contrib"
 projects[diff][version] = "3.2"
 
+; Profile has no recommended release.
+projects[edit_profile][type] = "module"
+projects[edit_profile][subdir] = "contrib"
+projects[edit_profile][version] = "1.0-beta2"
+
+projects[elements][type] = "module"
+projects[elements][subdir] = "contrib"
+projects[elements][version] = "1.4"
+
 projects[email_registration][type] = "module"
 projects[email_registration][subdir] = "contrib"
-projects[email_registration][version] = "1.1"
+projects[email_registration][version] = "1.2"
 
 projects[entity][type] = "module"
 projects[entity][subdir] = "contrib"
-projects[entity][version] = "1.2"
-
-; Force LANGUAGE_NONE entities to still display within rendered entities.
-; http://drupal.org/node/1782134
-projects[entity][patch][] = "http://drupal.org/files/entity-translatable_fields_not_overriding_und_with_empty_values.patch"
+projects[entity][version] = "1.5"
 
 projects[entitycache][type] = "module"
 projects[entitycache][subdir] = "contrib"
-projects[entitycache][download][type] = "git"
-projects[entitycache][download][url] = "http://git.drupal.org/project/entitycache.git"
-projects[entitycache][download][branch] = "7.x-1.x"
-projects[entitycache][download][revision] = "7e390b5"
+projects[entitycache][version] = "1.2"
+
+; Fix core translation support.
+; http://drupal.org/node/1349566#comment-7781063
+projects[entitycache][patch][] = "http://drupal.org/files/add-translation-information-on-each-request-1349566-12.patch"
 
 projects[entityreference][type] = "module"
 projects[entityreference][subdir] = "contrib"
-projects[entityreference][download][type] = "git"
-projects[entityreference][download][url] = "http://git.drupal.org/project/entityreference.git"
-projects[entityreference][download][branch] = "7.x-1.x"
-projects[entityreference][download][revision] = "1c176daef3e7483389cbebeb34784b3af6521f7f"
-
-; Profile has no recommended release
-projects[edit_profile][type] = "module"
-projects[edit_profile][subdir] = "contrib"
-projects[edit_profile][version] = "1.0-beta2"
+projects[entityreference][version] = "1.1"
 
 projects[entityreference_prepopulate][type] = "module"
 projects[entityreference_prepopulate][subdir] = "contrib"
-projects[entityreference_prepopulate][version] = "1.3"
+projects[entityreference_prepopulate][version] = "1.5"
+
+projects[entity_translation][type] = "module"
+projects[entity_translation][subdir] = "contrib"
+projects[entity_translation][version] = "1.0-beta3"
+
+projects[facetapi][type] = "module"
+projects[facetapi][subdir] = "contrib"
+projects[facetapi][version] = "1.3"
 
 projects[features][type] = "module"
 projects[features][subdir] = "contrib"
-projects[features][version] = "2.0-rc2"
+projects[features][version] = "2.0"
 
-; Issue #1921982: Add 'customized' to the fields we check when comparing a menu_link feature
-; http://drupal.org/node/1921982
-projects[features][patch][] = "http://drupal.org/files/menu_links_customized-927576-8.patch"
+projects[file_entity][type] = "module"
+projects[file_entity][subdir] = "contrib"
+projects[file_entity][version] = "2.0-alpha3"
+
+; Issue #2081713: Fix undefined index errors with empty (remote) files.
+; https://drupal.org/node/2081713
+projects[file_entity][patch][] = "https://drupal.org/files/issues/add-filesize-checks-2081713-13.patch"
 
 projects[flag][type] = "module"
 projects[flag][subdir] = "contrib"
-projects[flag][version] = "2.1"
+projects[flag][version] = "2.2"
 
 ; Issue #1965760: Manually set taxonomy term flag types because its different.
 ; http://drupal.org/node/1965760
-projects[flag][patch][] = "http://drupal.org/files/1965760-flag-taxonomy-types.patch"
+projects[flag][patch][] = "https://drupal.org/files/issues/1965760.29.flag_.entity-tokens.patch"
 
 projects[flag_abuse][type] = "module"
 projects[flag_abuse][subdir] = "contrib"
-projects[flag_abuse][version] = "2.0-alpha1"
+projects[flag_abuse][version] = "2.0"
 
-projects[redirect][type] = "module"
-projects[redirect][subdir] = "contrib"
-projects[redirect][version] = "1.0-rc1"
+projects[gravatar][type] = "module"
+projects[gravatar][subdir] = "contrib"
+projects[gravatar][download][type] = "git"
+projects[gravatar][download][url] = "http://git.drupal.org/project/gravatar.git"
+projects[gravatar][download][branch] = "7.x-1.x"
+projects[gravatar][download][revision] = "bb2f81e6"
 
 projects[http_client][type] = "module"
 projects[http_client][subdir] = "contrib"
 projects[http_client][version] = "2.4"
 
-projects[admin_icons][type] = "module"
-projects[admin_icons][subdir] = "contrib"
-projects[admin_icons][download][type] = "git"
-projects[admin_icons][download][url] = "http://git.drupal.org/project/admin_icons.git"
-projects[admin_icons][download][branch] = "7.x-1.x"
-projects[admin_icons][download][revision] = "60d9f28801533fecc92216a60d444d89d80e7611"
+projects[i18n][type] = "module"
+projects[i18n][subdir] = "contrib"
+projects[i18n][version] = "1.11"
+
+projects[i18nviews][type] = "module"
+projects[i18nviews][subdir] = "contrib"
+projects[i18nviews][download][type] = "git"
+projects[i18nviews][download][url] = "http://git.drupal.org/project/i18nviews.git"
+projects[i18nviews][download][branch] = "7.x-3.x"
+projects[i18nviews][download][revision] = "26bd52c"
+
+projects[kissmetrics][type] = "module"
+projects[kissmetrics][subdir] = "contrib"
+projects[kissmetrics][version] = "1.0-rc3"
+
+projects[l10n_update][type] = "module"
+projects[l10n_update][subdir] = "contrib"
+projects[l10n_update][version] = "1.0"
 
 projects[libraries][type] = "module"
 projects[libraries][subdir] = "contrib"
-projects[libraries][version] = "2.1"
+projects[libraries][version] = "2.2"
+
+projects[lingotek][type] = "module"
+projects[lingotek][subdir] = "contrib"
+projects[lingotek][version] = "5.04"
 
 projects[link][type] = "module"
 projects[link][subdir] = "contrib"
-projects[link][version] = "1.1"
+projects[link][version] = "1.2"
+
+projects[media][type] = "module"
+projects[media][subdir] = "contrib"
+projects[media][download][type] = "git"
+projects[media][download][url] = "http://git.drupal.org/project/media.git"
+projects[media][download][branch] = "7.x-2.x"
+projects[media][download][revision] = "b2c2d78"
+
+; New filelfield browser widget is massively confusing the user
+; https://drupal.org/comment/8570379#comment-8570379
+projects[media][patch][] = "https://drupal.org/files/issues/automatically-attach-files-2216329-2.patch"
+
+projects[media_oembed][type] = "module"
+projects[media_oembed][subdir] = "contrib"
+projects[media_oembed][version] = "2.1"
+
+projects[memcache][type] = "module"
+projects[memcache][subdir] = "contrib"
+projects[memcache][version] = "1.0"
 
 projects[menu_attributes][type] = "module"
 projects[menu_attributes][subdir] = "contrib"
@@ -176,30 +248,21 @@ projects[message][version] = "1.9"
 ; http://drupal.org/node/1920560#comment-7080942
 projects[message][patch][] = "http://drupal.org/files/1920560-message-access-alterable.patch"
 
+; Add support for the undefined language.
+; http://drupal.org/node/2006702#comment-7842259
+projects[message][patch][] = "http://drupal.org/files/message_field_undefined-lang.2006702-14.patch"
+
 projects[message_notify][type] = "module"
 projects[message_notify][subdir] = "contrib"
-projects[message_notify][download][type] = "git"
-projects[message_notify][download][url] = "http://git.drupal.org/project/message_notify.git"
-projects[message_notify][download][branch] = "7.x-2.x"
-projects[message_notify][download][revision] = "e546b0a6e3d2dfd48f4fd3a4d45806c066c9a9bc"
+projects[message_notify][version] = "2.5"
 
 projects[message_subscribe][type] = "module"
 projects[message_subscribe][subdir] = "contrib"
-projects[message_subscribe][download][type] = "git"
-projects[message_subscribe][download][url] = "http://git.drupal.org/project/message_subscribe.git"
-projects[message_subscribe][download][branch] = "7.x-1.x"
-
-projects[memcache][type] = "module"
-projects[memcache][subdir] = "contrib"
-projects[memcache][version] = "1.0"
+projects[message_subscribe][version] = "1.0-rc2"
 
 projects[metatag][type] = "module"
 projects[metatag][subdir] = "contrib"
-projects[metatag][version] = "1.0-beta7"
-
-; Support for rel=author link in head.
-; http://drupal.org/node/1865228#comment-6839604
-projects[metatag][patch][] = "http://drupal.org/files/metatag-n1865228-3.patch"
+projects[metatag][version] = "1.0-beta9"
 
 projects[module_filter][type] = "module"
 projects[module_filter][subdir] = "contrib"
@@ -207,122 +270,170 @@ projects[module_filter][version] = "1.8"
 
 projects[mollom][type] = "module"
 projects[mollom][subdir] = "contrib"
-projects[mollom][version] = "2.7"
+projects[mollom][version] = "2.9"
 
 projects[navbar][type] = "module"
 projects[navbar][subdir] = "contrib"
-projects[navbar][download][type] = "git"
-projects[navbar][download][url] = "http://git.drupal.org/project/navbar.git"
-projects[navbar][download][branch] = "7.x-1.x"
-projects[navbar][download][revision] = "dd542e1a74d9c9b3a9b5bd699aad9a4b65e5c5b7"
+projects[navbar][version] = "1.4"
+
+; Change I-beam cursors in the navbar to be a pointer instead.
+; https://drupal.org/node/2173041
+projects[navbar][patch][] = "https://drupal.org/files/issues/2173041-3-i-beam-menu-hover.patch"
 
 projects[oauth][type] = "module"
 projects[oauth][subdir] = "contrib"
-projects[oauth][version] = "3.1"
+projects[oauth][version] = "3.2"
 
 projects[oauthconnector][type] = "module"
 projects[oauthconnector][subdir] = "contrib"
 projects[oauthconnector][download][type] = "git"
 projects[oauthconnector][download][url] = "http://git.drupal.org/project/oauthconnector.git"
 projects[oauthconnector][download][branch] = "7.x-1.x"
-projects[oauthconnector][download][revision] = "0ce7ac9614710c0f68d0a58cb4ae4667f8bd6fa7"
+projects[oauthconnector][download][revision] = "42c6f66"
+
+projects[oembed][type] = "module"
+projects[oembed][subdir] = "contrib"
+projects[oembed][download][type] = "git"
+projects[oembed][download][url] = "http://git.drupal.org/project/oembed.git"
+projects[oembed][download][branch] = "7.x-1.x"
+projects[oembed][download][revision] = "9aa5303"
 
 projects[og][type] = "module"
 projects[og][subdir] = "contrib"
-projects[og][version] = "2.3"
+projects[og][download][type] = "git"
+projects[og][download][url] = "http://git.drupal.org/project/og.git"
+projects[og][download][branch] = "7.x-2.x"
+projects[og][download][revision] = "10647461ce6"
 
 ; Auto-assign role to group manager broken on groups with overridden roles.
 ; https://drupal.org/node/2005800#comment-7684873
-projects[og][patch][] = "http://drupal.org/files/og-default-role-member-2005800-21.patch"
+projects[og][patch][] = "http://drupal.org/files/issues/og-default-role-member-2005800-25.patch"
 
-; og_ui should give users the theme, not admin ui when creating groups
+; og_ui should give users the theme, not admin ui when creating groups.
 ; http://drupal.org/node/1800208
 projects[og][patch][] = "http://drupal.org/files/og_ui-group_node_add_theme-1800208-5.patch"
 
-; _og_access_verify_access_field_existence() assumes node group type, throws an exception rebuilding node access.
-projects[og][patch][] = "http://drupal.org/files/og-access-rebuild-exception-group-type.patch"
-
 projects[panelizer][type] = "module"
 projects[panelizer][subdir] = "contrib"
 projects[panelizer][version] = "3.1"
 
 projects[panels][type] = "module"
 projects[panels][subdir] = "contrib"
-projects[panels][version] = "3.3"
-
-; Fatal error: Call to undefined function panels_get_layouts()
-; http://drupal.org/node/1828684#comment-6694732
-projects[panels][patch][] = "http://drupal.org/files/1828684-layout-fix-6.patch"
-
-; PHP 5.3.9 Strict Warning on Panels Empty Value
-; http://drupal.org/node/1632898#comment-6412840
-projects[panels][patch][] = "http://drupal.org/files/panels-n1632898-15.patch"
+projects[panels][download][type] = "git"
+projects[panels][download][url] = "http://git.drupal.org/project/panels.git"
+projects[panels][download][branch] = "7.x-3.x"
+projects[panels][download][revision] = "8059bda2b"
 
 projects[paranoia][type] = "module"
 projects[paranoia][subdir] = "contrib"
-projects[paranoia][version] = "1.2"
+projects[paranoia][version] = "1.3"
 
 projects[pathauto][type] = "module"
 projects[pathauto][subdir] = "contrib"
 projects[pathauto][version] = "1.2"
 
-projects[placeholder][type] = "module"
-projects[placeholder][subdir] = "contrib"
-projects[placeholder][version] = "1.0"
+projects[picture][type] = "module"
+projects[picture][subdir] = "contrib"
+projects[picture][download][type] = "git"
+projects[picture][download][url] = "http://git.drupal.org/project/picture.git"
+projects[picture][download][branch] = "7.x-1.x"
+projects[picture][download][revision] = "18b94b9"
+
+; Add ctools as a dependency
+; https://drupal.org/node/2173043
+projects[picture][patch][] = "https://drupal.org/files/issues/add-ctools-dependency-2173043-1.patch"
+
+; Allow filter tips to be translated
+; https://drupal.org/node/2139459
+projects[picture][patch][] = "https://drupal.org/files/issues/translate-filter-tips-2139459-1.patch"
+
+; Move hook_uninstall() to picture.install to fix issues on uninstall.
+; https://drupal.org/node/2173015
+projects[picture][patch][] = "https://drupal.org/files/issues/move-uninstall-hook-implementation-2173015-1.patch"
+
+; Remove implementation of hook_file_formatter_info() to remove duplicate file formatter.
+; https://drupal.org/node/2172841
+projects[picture][patch][] = "https://drupal.org/files/issues/remove-file-formatter-hook-implementation-2172831-1.patch"
+
+; Remove implementation of hook_ctools_plugin_api() to fix issues with features.
+; https://drupal.org/node/2172831
+projects[picture][patch][] = "https://drupal.org/files/issues/remove-ctools-hook-implementation-2172831-1.patch"
 
 projects[pm_existing_pages][type] = "module"
 projects[pm_existing_pages][subdir] = "contrib"
 projects[pm_existing_pages][version] = "1.4"
 
+projects[potx][type] = "module"
+projects[potx][subdir] = "contrib"
+projects[potx][version] = "1.0"
+
 projects[privatemsg][type] = "module"
 projects[privatemsg][subdir] = "contrib"
 projects[privatemsg][version] = "1.4"
 
-; Add preliminary Views integration
+; Add preliminary Views integration.
 ; http://drupal.org/node/1573000
 projects[privatemsg][patch][] = "http://drupal.org/files/privatemsg-1573000-64.patch"
 
+; Enable privatemsg_realname when realname is enabled.
+; https://drupal.org/node/2070719
+projects[privatemsg][patch][] = "http://drupal.org/files/2077223-privatemsg-realname-enabled-1.patch"
+
 projects[quicktabs][type] = "module"
 projects[quicktabs][subdir] = "contrib"
-projects[quicktabs][download][type] = "git"
-projects[quicktabs][download][url] = "http://git.drupal.org/project/quicktabs.git"
-projects[quicktabs][download][branch] = "7.x-3.x"
-projects[quicktabs][download][revision] = "89f7fd0b7313782d0f7504996daa36bde798ec79"
+projects[quicktabs][version] = "3.6"
+projects[quicktabs][patch][] = "http://drupal.org/files/2104643-revert-qt-487518-5.patch"
+
+projects[r4032login][type] = "module"
+projects[r4032login][subdir] = "contrib"
+projects[r4032login][version] = "1.7"
 
 projects[radioactivity][type] = "module"
 projects[radioactivity][subdir] = "contrib"
 projects[radioactivity][download][type] = "git"
 projects[radioactivity][download][url] = "http://git.drupal.org/project/radioactivity.git"
 projects[radioactivity][download][branch] = "7.x-2.x"
-projects[radioactivity][download][revision] = "aee21dbed4f54d0e626e3c19ecc550bf1ec656f6"
-
-; Radioactivity not compatible with Memcache module
-; http://drupal.org/node/1860216
-projects[radioactivity][patch][] = "http://drupal.org/files/radioactivity-memcache.patch"
-
-projects[r4032login][type] = "module"
-projects[r4032login][subdir] = "contrib"
-projects[r4032login][version] = "1.5"
+projects[radioactivity][download][revision] = "e3705c6ce9f07ec58fc6b7c66f39eb4f2fc51b68"
 
 projects[rate][type] = "module"
 projects[rate][subdir] = "contrib"
-projects[rate][version] = "1.6"
+projects[rate][version] = "1.7"
 
-; Add widget to node/comment $links
+; Add widget to node/comment $links.
 ; http://drupal.org/node/947516#comment-6979780
 projects[rate][patch][] = "http://drupal.org/files/947516-rate-node-links-15.patch"
 
+; Only load CSS when necessary.
+; https://drupal.org/node/2180853
+projects[rate][patch][] = "https://drupal.org/files/issues/attach-rate-css-2180853-3.patch"
+
 projects[realname][type] = "module"
 projects[realname][subdir] = "contrib"
-projects[realname][version] = "1.1"
+projects[realname][version] = "1.2"
+
+; Realname entityreference autocomplete API update
+; https://drupal.org/node/2225889
+projects[realname][patch][] = "https://drupal.org/files/issues/2225889-realname-correct-menu-2.patch"
+
+projects[redirect][type] = "module"
+projects[redirect][subdir] = "contrib"
+projects[redirect][version] = "1.0-rc1"
 
 projects[registration][subdir] = "contrib"
 projects[registration][type] = "module"
-projects[registration][version] = "1.2"
+projects[registration][version] = "1.3"
+
+projects[rich_snippets][type] = "module"
+projects[rich_snippets][subdir] = "contrib"
+projects[rich_snippets][version] = "1.0-beta3"
 
 projects[rules][type] = "module"
 projects[rules][subdir] = "contrib"
-projects[rules][version] = "2.3"
+projects[rules][version] = "2.6"
+
+projects[schemaorg][type] = "module"
+projects[schemaorg][subdir] = "contrib"
+projects[schemaorg][version] = "1.0-beta4"
 
 projects[search_facetapi][type] = "module"
 projects[search_facetapi][subdir] = "contrib"
@@ -330,23 +441,11 @@ projects[search_facetapi][version] = "1.0-beta2"
 
 projects[sharethis][type] = "module"
 projects[sharethis][subdir] = "contrib"
-projects[sharethis][version] = "2.5"
-
-projects[facetapi][type] = "module"
-projects[facetapi][subdir] = "contrib"
-projects[facetapi][version] = "1.3"
-
-projects[rich_snippets][type] = "module"
-projects[rich_snippets][subdir] = "contrib"
-projects[rich_snippets][version] = "1.0-beta3"
+projects[sharethis][version] = "2.6"
 
-; Remove snippets from non-node type searches:
-; http://drupal.org/node/1923904#comment-7094488
-projects[rich_snippets][patch][] = "http://drupal.org/files/1923904-search-nodes-only.patch"
-
-projects[schemaorg][type] = "module"
-projects[schemaorg][subdir] = "contrib"
-projects[schemaorg][version] = "1.0-beta3"
+projects[smartcrop][type] = "module"
+projects[smartcrop][subdir] = "contrib"
+projects[smartcrop][version] = "1.0-beta2"
 
 projects[strongarm][type] = "module"
 projects[strongarm][subdir] = "contrib"
@@ -357,13 +456,9 @@ projects[strongarm][download][revision] = "5a2326ba67e59923ecce63d9bb5e0ed6548ab
 
 projects[timeago][type] = "module"
 projects[timeago][subdir] = "contrib"
-projects[timeago][version] = "2.x-dev"
-projects[timeago][download][type] = "git"
-projects[timeago][download][url] = "http://git.drupal.org/project/timeago.git"
-projects[timeago][download][branch] = "7.x-2.x"
-projects[timeago][download][revision] = "768ea66"
+projects[timeago][version] = "2.2"
 
-; Provide a dedicated date type:
+; Provide a dedicated date type.
 ; http://drupal.org/node/1427226#comment-6638836
 projects[timeago][patch][] = "http://drupal.org/files/1427226-timeago-date-type.patch"
 
@@ -375,122 +470,49 @@ projects[token][type] = "module"
 projects[token][subdir] = "contrib"
 projects[token][version] = "1.5"
 
+projects[translation_helpers][type] = "module"
+projects[translation_helpers][subdir] = "contrib"
+projects[translation_helpers][version] = "1.0"
+
+projects[variable][type] = "module"
+projects[variable][subdir] = "contrib"
+projects[variable][version] = "2.5"
+
 projects[views][type] = "module"
 projects[views][subdir] = "contrib"
 projects[views][version] = "3.7"
 
-projects[views_field_view][type] = "module"
-projects[views_field_view][subdir] = "contrib"
-projects[views_field_view][version] = "1.1"
-
-projects[views_load_more][type] = "module"
-projects[views_load_more][subdir] = "contrib"
-projects[views_load_more][version] = "1.1"
+; Update Views Content access filter per core performance improvements.
+; https://drupal.org/comment/8516039#comment-8516039
+projects[views][patch][] = "https://drupal.org/files/issues/2204257-views-content-access-filter-core-depends-on-core-patch.patch"
 
 projects[views_bulk_operations][type] = "module"
 projects[views_bulk_operations][subdir] = "contrib"
-projects[views_bulk_operations][version] = "3.1"
+projects[views_bulk_operations][version] = "3.2"
+
+projects[views_field_view][type] = "module"
+projects[views_field_view][subdir] = "contrib"
+projects[views_field_view][version] = "1.1"
 
 projects[views_litepager][type] = "module"
 projects[views_litepager][subdir] = "contrib"
 projects[views_litepager][version] = "3.0"
 
-; We have the version of voting api at the top so it doesn't get included in our dev make patch.
-projects[votingapi][version] = "2.11"
-projects[votingapi][type] = "module"
-projects[votingapi][subdir] = "contrib"
-
-; Commons contrib modules.
-; We don't tag a release here because want them to auto-increment.
-projects[commons_activity_streams][type] = "module"
-projects[commons_activity_streams][subdir] = "contrib"
-
-projects[commons_body][type] = "module"
-projects[commons_body][subdir] = "contrib"
-
-projects[commons_bw][type] = "module"
-projects[commons_bw][subdir] = "contrib"
-
-projects[commons_content_moderation][type] = "module"
-projects[commons_content_moderation][subdir] = "contrib"
-
-projects[commons_documents][type] = "module"
-projects[commons_documents][subdir] = "contrib"
-
-projects[commons_groups][type] = "module"
-projects[commons_groups][subdir] = "contrib"
-
-projects[commons_events][type] = "module"
-projects[commons_events][subdir] = "contrib"
-
-projects[commons_featured][type] = "module"
-projects[commons_featured][subdir] = "contrib"
-
-projects[commons_follow][type] = "module"
-projects[commons_follow][subdir] = "contrib"
-
-projects[commons_location][type] = "module"
-projects[commons_location][subdir] = "contrib"
-
-projects[commons_misc][type] = "module"
-projects[commons_misc][subdir] = "contrib"
-
-projects[commons_notices][type] = "module"
-projects[commons_notices][subdir] = "contrib"
-
-projects[commons_notify][type] = "module"
-projects[commons_notify][subdir] = "contrib"
-
-projects[commons_pages][type] = "module"
-projects[commons_pages][subdir] = "contrib"
-
-projects[commons_posts][subdir] = "contrib"
-projects[commons_posts][type] = "module"
-
-projects[commons_polls][type] = "module"
-projects[commons_polls][subdir] = "contrib"
-
-projects[commons_profile_base][type] = "module"
-projects[commons_profile_base][subdir] = "contrib"
-
-projects[commons_profile_social][type] = "module"
-projects[commons_profile_social][subdir] = "contrib"
-
-projects[commons_q_a][type] = "module"
-projects[commons_q_a][subdir] = "contrib"
-
-projects[commons_radioactivity][type] = "module"
-projects[commons_radioactivity][subdir] = "contrib"
-
-projects[commons_like][type] = "module"
-projects[commons_like][subdir] = "contrib"
-
-projects[commons_search][type] = "module"
-projects[commons_search][subdir] = "contrib"
-
-projects[commons_social_sharing][type] = "module"
-projects[commons_social_sharing][subdir] = "contrib"
-
-projects[commons_site_homepage][type] = "module"
-projects[commons_site_homepage][subdir] = "contrib"
-
-projects[commons_trusted_contacts][type] = "module"
-projects[commons_trusted_contacts][subdir] = "contrib"
-
-projects[commons_utility_links][type] = "module"
-projects[commons_utility_links][subdir] = "contrib"
-
-projects[commons_user_profile_pages][type] = "module"
-projects[commons_user_profile_pages][subdir] = "contrib"
+projects[views_load_more][type] = "module"
+projects[views_load_more][subdir] = "contrib"
+projects[views_load_more][version] = "1.2"
 
-projects[commons_wikis][type] = "module"
-projects[commons_wikis][subdir] = "contrib"
+; Suppress notice error when loading more content from views_load_more.
+; https://drupal.org/node/2207467
+projects[views_load_more][patch][] = "https://drupal.org/files/issues/fix-notice-undefined-index-2152935-3.patch"
 
-projects[commons_wysiwyg][type] = "module"
-projects[commons_wysiwyg][subdir] = "contrib"
+projects[votingapi][type] = "module"
+projects[votingapi][subdir] = "contrib"
+projects[votingapi][version] = "2.11"
 
-projects[commons_topics][type] = "module"
-projects[commons_topics][subdir] = "contrib"
+projects[voting_rules][type] = "module"
+projects[voting_rules][subdir] = "contrib"
+projects[voting_rules][version] = "1.0-alpha1"
 
 ; Contributed themes.
 
@@ -499,37 +521,50 @@ projects[adaptivetheme][subdir] = "contrib"
 projects[adaptivetheme][download][type] = "git"
 projects[adaptivetheme][download][url] = "http://git.drupal.org/project/adaptivetheme.git"
 projects[adaptivetheme][download][branch] = "7.x-3.x"
-projects[adaptivetheme][download][revision] = "b4b38c3"
+projects[adaptivetheme][download][revision] = "18693ff59db7cb3171f282a982d04fe6544b63a1"
 
-; Remove link around comment creation date.
-; http://drupal.org/node/1427226#comment-6638836
-projects[adaptivetheme][patch][] = "http://drupal.org/files/remove-comment-creation-link-2018081-1.patch"
+projects[ember][type] = "theme"
+projects[ember][subdir] = "contrib"
+projects[ember][download][type] = "git"
+projects[ember][download][url] = "http://git.drupal.org/project/ember.git"
+projects[ember][download][branch] = "7.x-2.x"
+projects[ember][download][revision] = "caf4df7"
 
 projects[sky][type] = "theme"
 projects[sky][subdir] = "contrib"
-projects[sky][version] = "3.0-rc1"
-
-projects[commons_origins][type] = "theme"
-projects[commons_origins][subdir] = "contrib"
+projects[sky][version] = "3.0"
 
 ; Libraries.
 ; NOTE: These need to be listed in http://drupal.org/packaging-whitelist.
-libraries[underscore][download][type] = "get"
-libraries[underscore][type] = "libraries"
-libraries[underscore][download][url] = "https://github.com/jashkenas/underscore/archive/1.4.4.zip"
 
 libraries[backbone][download][type] = "get"
 libraries[backbone][type] = "libraries"
-libraries[backbone][download][url] = "https://github.com/jashkenas/backbone/archive/1.0.0.tar.gz"
+libraries[backbone][download][url] = "https://github.com/jashkenas/backbone/archive/1.1.0.tar.gz"
 
 libraries[ckeditor][download][type] = "get"
-libraries[ckeditor][download][url] = "http://download.cksource.com/CKEditor/CKEditor/CKEditor%204.0/ckeditor_4.0_standard.tar.gz"
+libraries[ckeditor][download][url] = "http://download.cksource.com/CKEditor/CKEditor/CKEditor%204.3.4/ckeditor_4.3.4_full.zip"
 libraries[ckeditor][type] = "libraries"
 
-libraries[placeholder][download][type] = "get"
-libraries[placeholder][type] = "libraries"
-libraries[placeholder][download][url] = "https://github.com/mathiasbynens/jquery-placeholder/archive/v2.0.7.tar.gz"
+libraries[ckeditor_lineutils][download][type] = "get"
+libraries[ckeditor_lineutils][download][url] = "http://download.ckeditor.com/lineutils/releases/lineutils_4.3.4.zip"
+libraries[ckeditor_lineutils][type] = "libraries"
+libraries[ckeditor_lineutils][subdir] = "ckeditor/plugins"
+libraries[ckeditor_lineutils][directory_name] = "lineutils"
+
+libraries[ckeditor_widget][download][type] = "get"
+libraries[ckeditor_widget][download][url] = "http://download.ckeditor.com/widget/releases/widget_4.3.4.zip"
+libraries[ckeditor_widget][type] = "libraries"
+libraries[ckeditor_widget][subdir] = "ckeditor/plugins"
+libraries[ckeditor_widget][directory_name] = "widget"
+
+libraries[modernizr][download][type] = "get"
+libraries[modernizr][type] = "libraries"
+libraries[modernizr][download][url] = "https://github.com/Modernizr/Modernizr/archive/v2.7.1.tar.gz"
 
 libraries[timeago][download][type] = "get"
 libraries[timeago][type] = "libraries"
-libraries[timeago][download][url] = "https://raw.github.com/rmm5t/jquery-timeago/v1.3.0/jquery.timeago.js"
+libraries[timeago][download][url] = "https://raw.github.com/rmm5t/jquery-timeago/v1.4.0/jquery.timeago.js"
+
+libraries[underscore][download][type] = "get"
+libraries[underscore][type] = "libraries"
+libraries[underscore][download][url] = "https://github.com/jashkenas/underscore/archive/1.5.2.zip"
diff --git a/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.features.inc b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.features.inc
new file mode 100644
index 0000000..05903a2
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.features.inc
@@ -0,0 +1,14 @@
+<?php
+/**
+ * @file
+ * commons_activity_page.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_activity_page_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.info b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.info
new file mode 100644
index 0000000..d8620ea
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.info
@@ -0,0 +1,11 @@
+name = Commons Activity Page
+description = Allows users to view a stream of site-wide and personalized activity.
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_activity_streams
+dependencies[] = commons_featured
+dependencies[] = ctools
+dependencies[] = page_manager
+features[ctools][] = page_manager:pages_default:1
+features[features_api][] = api:2
+features[page_manager_pages][] = commons_activity_streams_activity
diff --git a/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.module b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.module
new file mode 100644
index 0000000..0a72c76
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Activity Page feature.
+ */
+
+include_once 'commons_activity_page.features.inc';
diff --git a/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.pages_default.inc b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.pages_default.inc
new file mode 100644
index 0000000..032e672
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_page/commons_activity_page.pages_default.inc
@@ -0,0 +1,130 @@
+<?php
+/**
+ * @file
+ * commons_activity_page.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_pages().
+ */
+function commons_activity_page_default_page_manager_pages() {
+  $page = new stdClass();
+  $page->disabled = FALSE; /* Edit this to true to make a default page disabled initially */
+  $page->api_version = 1;
+  $page->name = 'commons_activity_streams_activity';
+  $page->task = 'page';
+  $page->admin_title = 'Activity';
+  $page->admin_description = '';
+  $page->path = 'activity';
+  $page->access = array(
+    'type' => 'none',
+    'settings' => NULL,
+  );
+  $page->menu = array();
+  $page->arguments = array();
+  $page->conf = array(
+    'admin_paths' => FALSE,
+  );
+  $page->default_handlers = array();
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'page_commons_activity_streams_activity_panel_context';
+  $handler->task = 'page';
+  $handler->subtask = 'commons_activity_streams_activity';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'Activity',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = 'Recent site activity';
+  $display->uuid = '5421dc96-4e35-5794-5539-fc6123374548';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-6251a6df-20d2-5034-f9d8-a66cd04f16e9';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_activity_streams_activity-panel_pane_3';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '6251a6df-20d2-5034-f9d8-a66cd04f16e9';
+    $display->content['new-6251a6df-20d2-5034-f9d8-a66cd04f16e9'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-6251a6df-20d2-5034-f9d8-a66cd04f16e9';
+    $pane = new stdClass();
+    $pane->pid = 'new-6668ecda-9f18-0744-71cb-afcb5fb5114d';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_featured-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '6668ecda-9f18-0744-71cb-afcb5fb5114d';
+    $display->content['new-6668ecda-9f18-0744-71cb-afcb5fb5114d'] = $pane;
+    $display->panels['two_66_33_second'][0] = 'new-6668ecda-9f18-0744-71cb-afcb5fb5114d';
+    $pane = new stdClass();
+    $pane->pid = 'new-e5d75ae1-dae7-bb04-0977-6e6c5a230f3d';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_groups_contributors-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = 'e5d75ae1-dae7-bb04-0977-6e6c5a230f3d';
+    $display->content['new-e5d75ae1-dae7-bb04-0977-6e6c5a230f3d'] = $pane;
+    $display->panels['two_66_33_second'][1] = 'new-e5d75ae1-dae7-bb04-0977-6e6c5a230f3d';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = 'new-6251a6df-20d2-5034-f9d8-a66cd04f16e9';
+  $handler->conf['display'] = $display;
+  $page->default_handlers[$handler->name] = $handler;
+  $pages['commons_activity_streams_activity'] = $page;
+
+  return $pages;
+
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.features.field_instance.inc b/modules/commons/commons_activity_streams/commons_activity_streams.features.field_instance.inc
new file mode 100644
index 0000000..2f4f612
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.features.field_instance.inc
@@ -0,0 +1,210 @@
+<?php
+/**
+ * @file
+ * commons_activity_streams.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_activity_streams_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_activity_streams_comment_created-field_target_comments'
+  $field_instances['message-commons_activity_streams_comment_created-field_target_comments'] = array(
+    'bundle' => 'commons_activity_streams_comment_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_comments',
+    'label' => 'Target comment',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_activity_streams_comment_created-field_target_nodes'
+  $field_instances['message-commons_activity_streams_comment_created-field_target_nodes'] = array(
+    'bundle' => 'commons_activity_streams_comment_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 1,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 3,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_activity_streams_node_created-field_target_nodes'
+  $field_instances['message-commons_activity_streams_node_created-field_target_nodes'] = array(
+    'bundle' => 'commons_activity_streams_node_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 2,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 3,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_activity_streams_user_profile_updated-field_target_users'
+  $field_instances['message-commons_activity_streams_user_profile_updated-field_target_users'] = array(
+    'bundle' => 'commons_activity_streams_user_profile_updated',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 2,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_users',
+    'label' => 'Target users',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 42,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Target comment');
+  t('Target nodes');
+  t('Target users');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.features.inc b/modules/commons/commons_activity_streams/commons_activity_streams.features.inc
new file mode 100644
index 0000000..23366ab
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.features.inc
@@ -0,0 +1,111 @@
+<?php
+/**
+ * @file
+ * commons_activity_streams.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_activity_streams_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_activity_streams_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_activity_streams_default_message_type() {
+  $items = array();
+  $items['commons_activity_streams_comment_created'] = entity_import('message_type', '{
+    "name" : "commons_activity_streams_comment_created",
+    "description" : "commons_activity_streams_comment_created",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E commented on \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E commented on \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E"
+        },
+        {
+          "value" : "[commons-groups:in-groups-text]",
+          "format" : "full_html",
+          "safe_value" : "[commons-groups:in-groups-text]"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['commons_activity_streams_node_created'] = entity_import('message_type', '{
+    "name" : "commons_activity_streams_node_created",
+    "description" : "commons_activity_streams_node_created",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E created \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E created \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E"
+        },
+        {
+          "value" : "[commons-groups:in-groups-text]",
+          "format" : "full_html",
+          "safe_value" : "[commons-groups:in-groups-text]"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['commons_activity_streams_user_profile_updated'] = entity_import('message_type', '{
+    "name" : "commons_activity_streams_user_profile_updated",
+    "description" : "commons_activity_streams_user_profile_updated",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E has an updated profile",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E has an updated profile"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.info b/modules/commons/commons_activity_streams/commons_activity_streams.info
new file mode 100644
index 0000000..665ad02
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.info
@@ -0,0 +1,39 @@
+name = Commons Activity Streams
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_follow
+dependencies[] = ctools
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = message
+dependencies[] = strongarm
+dependencies[] = timeago
+dependencies[] = token
+dependencies[] = views
+dependencies[] = views_content
+dependencies[] = views_load_more
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_instance][] = message-commons_activity_streams_comment_created-field_target_comments
+features[field_instance][] = message-commons_activity_streams_comment_created-field_target_nodes
+features[field_instance][] = message-commons_activity_streams_node_created-field_target_nodes
+features[field_instance][] = message-commons_activity_streams_user_profile_updated-field_target_users
+features[message_type][] = commons_activity_streams_comment_created
+features[message_type][] = commons_activity_streams_node_created
+features[message_type][] = commons_activity_streams_user_profile_updated
+features[variable][] = field_bundle_settings_message__commons_activity_streams_comment_created
+features[variable][] = field_bundle_settings_message__commons_activity_streams_node_created
+features[variable][] = field_bundle_settings_message__commons_activity_streams_user_profile_updated
+features[variable][] = timeago_comment
+features[variable][] = timeago_node
+features[views_view][] = commons_activity_streams_activity
+features[views_view][] = commons_activity_streams_user_activity
+features_exclude[field][message-commons_activity_streams_comment_created-field_target_comments] = message-commons_activity_streams_comment_created-field_target_comments
+features_exclude[field][message-commons_activity_streams_comment_created-field_target_nodes] = message-commons_activity_streams_comment_created-field_target_nodes
+features_exclude[field][message-commons_activity_streams_node_created-field_target_nodes] = message-commons_activity_streams_node_created-field_target_nodes
+features_exclude[field][message-commons_activity_streams_user_profile_updated-field_target_users] = message-commons_activity_streams_user_profile_updated-field_target_users
+features_exclude[field_base][field_target_nodes] = field_target_nodes
+features_exclude[field_base][field_target_comments] = field_target_comments
+features_exclude[views_view][commons_bw_all] = commons_bw_all
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.install b/modules/commons/commons_activity_streams/commons_activity_streams.install
new file mode 100644
index 0000000..bc0e8ec
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.install
@@ -0,0 +1,54 @@
+<?php
+
+/**
+* Update the "User follows user" message type.
+*/
+function commons_activity_streams_update_3101() {
+  features_revert(array('commons_activity_streams' => array('message_type', 'field_instance')));
+  return array();
+}
+
+/**
+ * Set activity stream user pictures to 35x35 image style.
+ */
+function commons_activity_streams_update_3102() {
+  $revert = array(
+    'commons_activity_streams' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Reset field instances to hide the target users field from the updated profile message.
+ */
+function commons_activity_streams_update_3103() {
+  $revert = array(
+    'commons_activity_streams' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Enable timeago for nodes and comments.
+ */
+function commons_activity_streams_update_3104() {
+  $revert = array(
+    'commons_activity_streams' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Remove duplicative node access filters from Commons Activity Streams views.
+ */
+function commons_activity_streams_update_3105() {
+  $revert = array(
+    'commons_activity_streams' => array('views_view'),
+    'commons_activity_streams_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.module b/modules/commons/commons_activity_streams/commons_activity_streams.module
new file mode 100644
index 0000000..0f0641b
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.module
@@ -0,0 +1,265 @@
+<?php
+
+include_once 'commons_activity_streams.features.inc';
+
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_activity_streams_form_alter(&$form, &$form_state, $form_id) {
+  // Customize the text on the filter for Activity landing page.
+  if ($form_id == 'views_exposed_form' && $form['#id'] == 'views-exposed-form-commons-activity-streams-activity-panel-pane-3') {
+    $form['following']['#options'][0] = t("activity I'm not following");
+    $form['following']['#options'][1] = t("activity I'm following");
+  }
+
+  if ($form_id == 'edit_profile_user_profile_form') {
+    // Store default values in form state storage for change detection.
+    static $profile_form_state;
+    if (!isset($profile_form_state)) {
+      // Use a copy of $form and $form_state for prepare and process.
+      $profile_form = array_merge(array(), $form);
+      $profile_form_state = array_merge(array(), $form_state);
+      drupal_prepare_form('edit_profile_user_profile_form', $profile_form, $profile_form_state);
+      drupal_process_form('edit_profile_user_profile_form', $profile_form, $profile_form_state);
+      $form_state['storage']['values'] = $profile_form_state['values'];
+    }
+    $form['#submit'][] = 'commons_activity_streams_user_profile_submit';
+  }
+}
+
+/**
+ * Implements hook_node_insert().
+ */
+function commons_activity_streams_node_insert($node) {
+  // Create a message when a user creates a new node.
+  $account = user_load($node->uid);
+  // Allow other modules to change the message type used for this event.
+  $hook = 'node_insert';
+  $message_type = 'commons_activity_streams_node_created';
+  drupal_alter('commons_activity_streams_message_selection', $message_type, $hook, $node);
+  $message = message_create($message_type, array('uid' => $account->uid, 'timestamp' => $node->created));
+  // Save reference to the node in the node reference field, and the
+  $wrapper = entity_metadata_wrapper('message', $message);
+  // We use a multiple value field in case we wish to use the same
+  // field for grouping messages in the future
+  // (eg http://drupal.org/node/1757060).
+  $wrapper->field_target_nodes[] = $node;
+  $wrapper->save();
+}
+
+/**
+ * Implements hook_comment_insert().
+ */
+function commons_activity_streams_comment_insert($comment) {
+  $account = user_load($comment->uid);
+  $node = node_load($comment->nid);
+  // Allow other modules to change the message type used for this event.
+  $hook = 'comment_insert';
+  $message_type = 'commons_activity_streams_comment_created';
+  drupal_alter('commons_activity_streams_message_selection', $message_type, $hook, $node);
+  $message = message_create($message_type, array('uid' => $account->uid, 'timestamp' => $comment->created));
+
+  // Save reference to the node in the node reference field, and the
+  // "publish" state (i.e. if the node is published or unpublished).
+  $wrapper = entity_metadata_wrapper('message', $message);
+  $wrapper->field_target_nodes[] = $node;
+  $wrapper->field_target_comments[] = $comment;
+
+  // The message should be published only if the node and the comment are
+  // both published.
+  // @todo: Deal with message publishing/unpublishing.
+  /*
+  $published = $node->status && $comment->status;
+  $wrapper->field_published->set($published);
+  */
+  $wrapper->save();
+}
+
+/**
+ * Implements hook_comment_delete().
+ */
+function commons_activity_streams_comment_delete($comment) {
+  // Delete the activity stream message created when this comment
+  // was posted.
+  if ($mids = commons_activity_streams_existing_messages($comment->uid, array($comment->cid), 'field_target_comments', 'commons_activity_streams_comment_created')) {
+    message_delete_multiple($mids);
+  }
+}
+
+/**
+ * Implements hook_message_access_alter().
+ */
+function commons_activity_streams_message_access_alter(&$access, $context) {
+  // We're only interested in the 'view' operation.
+  if ($context['op'] != 'view') {
+    return;
+  }
+
+  $message = $context['entity'];
+  // Verify view access to nodes referenced in the message.
+  if (isset($message->field_target_nodes)) {
+    foreach ($message->field_target_nodes[LANGUAGE_NONE] as $key => $value) {
+      $node = node_load($value['target_id']);
+      if (!node_access('view', $node, $context['account'])) {
+        // If the user cannot view any nodes in the message,
+        // deny access to the entire message;
+        $access = FALSE;
+        return;
+      }
+    }
+  }
+}
+
+/**
+* Find existing messages that match certain parameters.
+*/
+function commons_activity_streams_existing_messages($acting_uid, $target_ids, $target_field, $message_type) {
+  $query = new EntityFieldQuery();
+  $query->entityCondition('entity_type', 'message', '=')
+   ->propertyCondition('uid', $acting_uid)
+   ->propertyCondition('type', $message_type, '=')
+   ->fieldCondition($target_field, 'target_id', $target_ids, 'IN')
+   ->execute();
+
+  if (!empty($query->ordered_results)) {
+    $mids = array();
+    foreach($query->ordered_results as $result) {
+      $mids[] = $result->entity_id;
+    }
+    return $mids;
+  }
+  return FALSE;
+}
+
+/**
+ * Create an activity stream message when a user updates her profile.
+ */
+function commons_activity_streams_user_profile_submit($form, &$form_state) {
+  global $user;
+
+  // Fields to ignore in $form_state['values'] when detecting changes.
+  $remove_keys = array(
+    'uid',
+    'name',
+    'pass',
+    'current_pass_required_values',
+    'current_pass',
+    'status',
+    'roles',
+    'notify',
+    'signature',
+    'picture_delete',
+    'message_subscribe_email',
+    'og_user_node',
+    'cancel',
+    'metatags',
+    'timezone',
+    'signature_format',
+    'form_token',
+    'form_id',
+    'form_build_id',
+    'picture_upload',
+    'submit'
+  );
+  $profile_values = array_diff_key($form_state['values'], array_flip($remove_keys));
+  ksort($profile_values);
+  $profile_data = serialize($profile_values);
+
+  $stored_profile_values = array_diff_key($form_state['storage']['values'], array_flip($remove_keys));
+  ksort($stored_profile_values);
+  $stored_profile_data = serialize($stored_profile_values);
+
+  // Do not generate a message if
+  //  - the user did not submit their own form
+  //  - no changes were detected
+  //  - a profile update message created within the last 15 minutes
+  $time_ago = time() - 900;
+  $query = new EntityFieldQuery();
+  $query->entityCondition('entity_type', 'message')
+    ->propertyCondition('uid', $form_state['user']->uid)
+    ->propertyCondition('type', 'commons_activity_streams_user_profile_updated')
+    ->propertyCondition('timestamp', $time_ago, '>')
+    ->count();
+  $count = $query->execute();
+
+  if ($user->uid != $form_state['user']->uid ||
+    $profile_data == $stored_profile_data ||
+    $count > 0) {
+    return;
+  }
+
+  $account = $form_state['user'];
+  // Allow other modules to change the message type used for this event.
+  $hook = 'user_profile_update';
+  $message_type = 'commons_activity_streams_user_profile_updated';
+  drupal_alter('commons_activity_streams_message_selection', $message_type, $hook, $account);
+  $message = message_create($message_type, array('uid' => $account->uid, 'timestamp' => REQUEST_TIME));
+  // Save reference to the node in the node reference field, and the
+  $wrapper = entity_metadata_wrapper('message', $message);
+  $wrapper->field_target_users[] = $account;
+  $wrapper->save();
+}
+
+/**
+ * Implements hook_token_info().
+ */
+function commons_activity_streams_token_info() {
+  $styles = image_styles();
+  $tokens = array();
+  foreach ($styles as $style_name => $style) {
+    $tokens['picture:' . $style_name] = array(
+      'name' => t('Picture: @st image style', array('@st' => $style_name)),
+      'description' => t('Picture: @st image style', array('@st' => $style_name)),
+    );
+  }
+  return array(
+    'tokens' => array(
+      'user' => $tokens,
+    ),
+  );
+}
+
+/**
+ * Implements hook_tokens().
+ */
+function commons_activity_streams_tokens($type, $tokens, array $data = array(), array $options = array()) {
+  $replacements = array();
+  if ($type == 'user' && isset($data['user'])) {
+    $user = $data['user'];
+    $user_wrapper = entity_metadata_wrapper('user', $user);
+    $alt = $user->name;
+    if (isset($user->field_name_first)) {
+      $alt = $user_wrapper->field_name_first->value();
+      if (isset($user->field_name_last)) {
+        $alt .= " " . $user_wrapper->field_name_last->value();
+      }
+    }
+    $alt = t("@name's picture", array('@name' => $alt));
+    foreach ($tokens as $token => $original) {
+      if (strpos($token, 'picture:') !== FALSE) {
+        list( , $style) = explode(':', $token);
+        $path = variable_get('user_picture_default', '/profiles/commons/images/avatars/user-avatar.png');
+        if (!empty($user->picture)) {
+          $path = image_style_url($style, $user->picture->uri);
+        }
+        $image_variables = array(
+          'path' => $path,
+          'alt' => $alt,
+          'title' => $alt,
+          'class' => array('image-style-none'),
+        );
+        $image = theme('image', $image_variables);
+        $user_path = user_uri($user);
+        $link_options = array(
+          'attributes' => array(
+            'title' => t('View user profile.'),
+          ),
+          'html' => TRUE,
+        );
+        $replacements[$original] = "<div class='user-picture'>" . l($image, $user_path['path'], $link_options) . "</div>";
+      }
+    }
+  }
+  return $replacements;
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.strongarm.inc b/modules/commons/commons_activity_streams/commons_activity_streams.strongarm.inc
new file mode 100644
index 0000000..13df9ef
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.strongarm.inc
@@ -0,0 +1,130 @@
+<?php
+/**
+ * @file
+ * commons_activity_streams.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_activity_streams_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_activity_streams_comment_created';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_activity_streams_comment_created'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_activity_streams_node_created';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_activity_streams_node_created'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_activity_streams_user_profile_updated';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_activity_streams_user_profile_updated'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'timeago_comment';
+  $strongarm->value = 1;
+  $export['timeago_comment'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'timeago_node';
+  $strongarm->value = 1;
+  $export['timeago_node'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams.views_default.inc b/modules/commons/commons_activity_streams/commons_activity_streams.views_default.inc
new file mode 100644
index 0000000..f8d811d
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams.views_default.inc
@@ -0,0 +1,320 @@
+<?php
+/**
+ * @file
+ * commons_activity_streams.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_activity_streams_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_activity_streams_activity';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'message';
+  $view->human_name = 'Commons Activity Streams - Activity (Site-wide)';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Recent site activity';
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['link_display'] = 'custom_url';
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No activity matched the filters you selected.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Entity Reference: Referenced Entity */
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['id'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['table'] = 'field_data_field_target_nodes';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['field'] = 'field_target_nodes_target_id';
+  /* Field: Message: Rendered Message */
+  $handler->display->display_options['fields']['rendered_entity']['id'] = 'rendered_entity';
+  $handler->display->display_options['fields']['rendered_entity']['table'] = 'views_entity_message';
+  $handler->display->display_options['fields']['rendered_entity']['field'] = 'rendered_entity';
+  $handler->display->display_options['fields']['rendered_entity']['label'] = '';
+  $handler->display->display_options['fields']['rendered_entity']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['rendered_entity']['link_to_entity'] = 1;
+  $handler->display->display_options['fields']['rendered_entity']['display'] = 'view';
+  $handler->display->display_options['fields']['rendered_entity']['view_mode'] = 'full';
+  /* Field: Message: Timestamp */
+  $handler->display->display_options['fields']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['fields']['timestamp']['table'] = 'message';
+  $handler->display->display_options['fields']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['fields']['timestamp']['label'] = '';
+  $handler->display->display_options['fields']['timestamp']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['timestamp']['date_format'] = 'time_ago_dynamic';
+  /* Sort criterion: Message: Timestamp */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'message';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: Message: Message ID */
+  $handler->display->display_options['arguments']['mid']['id'] = 'mid';
+  $handler->display->display_options['arguments']['mid']['table'] = 'message';
+  $handler->display->display_options['arguments']['mid']['field'] = 'mid';
+  $handler->display->display_options['arguments']['mid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['mid']['default_argument_type'] = 'commons_follow_message';
+  $handler->display->display_options['arguments']['mid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['mid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['mid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['mid']['break_phrase'] = TRUE;
+  /* Filter criterion: Content: Published or admin */
+  $handler->display->display_options['filters']['status_extra']['id'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['table'] = 'node';
+  $handler->display->display_options['filters']['status_extra']['field'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['relationship'] = 'field_target_nodes_target_id';
+  /* Filter criterion: Message: User Follow */
+  $handler->display->display_options['filters']['cf_user_follow_message']['id'] = 'cf_user_follow_message';
+  $handler->display->display_options['filters']['cf_user_follow_message']['table'] = 'message';
+  $handler->display->display_options['filters']['cf_user_follow_message']['field'] = 'cf_user_follow_message';
+  $handler->display->display_options['filters']['cf_user_follow_message']['value'] = '0';
+  $handler->display->display_options['filters']['cf_user_follow_message']['exposed'] = TRUE;
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['operator_id'] = '';
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['label'] = 'Show';
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['operator'] = 'cf_user_follow_message_op';
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['identifier'] = 'following';
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['required'] = TRUE;
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['remember'] = TRUE;
+  $handler->display->display_options['filters']['cf_user_follow_message']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+  );
+  /* Filter criterion: Message: Message category */
+  $handler->display->display_options['filters']['type_category']['id'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['table'] = 'message';
+  $handler->display->display_options['filters']['type_category']['field'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['value'] = array(
+    'message_type' => 'message_type',
+  );
+
+  /* Display: Activity (Sidebar) */
+  $handler = $view->new_display('panel_pane', 'Activity (Sidebar)', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['use_more'] = FALSE;
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_text'] = FALSE;
+  $handler->display->display_options['link_url'] = 'activity';
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '5';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['defaults']['relationships'] = FALSE;
+  /* Relationship: Entity Reference: Referenced Entity */
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['id'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['table'] = 'field_data_field_target_nodes';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['field'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['defaults']['arguments'] = FALSE;
+  $handler->display->display_options['defaults']['filter_groups'] = FALSE;
+  $handler->display->display_options['defaults']['filters'] = FALSE;
+  /* Filter criterion: Message: Message category */
+  $handler->display->display_options['filters']['type_category']['id'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['table'] = 'message';
+  $handler->display->display_options['filters']['type_category']['field'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['value'] = array(
+    'message_type' => 'message_type',
+  );
+  /* Filter criterion: Content: Published or admin */
+  $handler->display->display_options['filters']['status_extra']['id'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['table'] = 'node';
+  $handler->display->display_options['filters']['status_extra']['field'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['relationship'] = 'field_target_nodes_target_id';
+
+  /* Display: Activity - Full view */
+  $handler = $view->new_display('panel_pane', 'Activity - Full view', 'panel_pane_3');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['inherit_panels_path'] = '1';
+  $translatables['commons_activity_streams_activity'] = array(
+    t('Master'),
+    t('Recent site activity'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No activity matched the filters you selected.'),
+    t('Content entity referenced from field_target_nodes'),
+    t('All'),
+    t('Show'),
+    t('Activity (Sidebar)'),
+    t('Commons'),
+    t('Activity - Full view'),
+  );
+  $export['commons_activity_streams_activity'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_activity_streams_user_activity';
+  $view->description = '';
+  $view->tag = 'commons';
+  $view->base_table = 'message';
+  $view->human_name = 'Commons Activity Streams (User-specific activity)';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Recent site activity';
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['link_display'] = 'custom_url';
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'This person doesn\'t have any activity on the site yet.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Entity Reference: Referenced Entity */
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['id'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['table'] = 'field_data_field_target_nodes';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['field'] = 'field_target_nodes_target_id';
+  /* Field: Message: Rendered Message */
+  $handler->display->display_options['fields']['rendered_entity']['id'] = 'rendered_entity';
+  $handler->display->display_options['fields']['rendered_entity']['table'] = 'views_entity_message';
+  $handler->display->display_options['fields']['rendered_entity']['field'] = 'rendered_entity';
+  $handler->display->display_options['fields']['rendered_entity']['label'] = '';
+  $handler->display->display_options['fields']['rendered_entity']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['rendered_entity']['link_to_entity'] = 1;
+  $handler->display->display_options['fields']['rendered_entity']['display'] = 'view';
+  $handler->display->display_options['fields']['rendered_entity']['view_mode'] = 'full';
+  /* Field: Message: Timestamp */
+  $handler->display->display_options['fields']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['fields']['timestamp']['table'] = 'message';
+  $handler->display->display_options['fields']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['fields']['timestamp']['label'] = '';
+  $handler->display->display_options['fields']['timestamp']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['timestamp']['date_format'] = 'time_ago_dynamic';
+  /* Sort criterion: Message: Timestamp */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'message';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: Message: User uid */
+  $handler->display->display_options['arguments']['user']['id'] = 'user';
+  $handler->display->display_options['arguments']['user']['table'] = 'message';
+  $handler->display->display_options['arguments']['user']['field'] = 'user';
+  $handler->display->display_options['arguments']['user']['default_action'] = 'not found';
+  $handler->display->display_options['arguments']['user']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['user']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['user']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['user']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published or admin */
+  $handler->display->display_options['filters']['status_extra']['id'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['table'] = 'node';
+  $handler->display->display_options['filters']['status_extra']['field'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['relationship'] = 'field_target_nodes_target_id';
+  /* Filter criterion: Message: Message category */
+  $handler->display->display_options['filters']['type_category']['id'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['table'] = 'message';
+  $handler->display->display_options['filters']['type_category']['field'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['value'] = array(
+    'message_type' => 'message_type',
+  );
+
+  /* Display: Activity (Sidebar) */
+  $handler = $view->new_display('panel_pane', 'Activity (Sidebar)', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['use_more'] = FALSE;
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_text'] = FALSE;
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '5';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['argument_input'] = array(
+    'user' => array(
+      'type' => 'context',
+      'context' => 'entity:user.uid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'Message: User uid',
+    ),
+  );
+
+  /* Display: Activity - Full view */
+  $handler = $view->new_display('panel_pane', 'Activity - Full view', 'panel_pane_3');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $translatables['commons_activity_streams_user_activity'] = array(
+    t('Master'),
+    t('Recent site activity'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('This person doesn\'t have any activity on the site yet.'),
+    t('Content entity referenced from field_target_nodes'),
+    t('All'),
+    t('Activity (Sidebar)'),
+    t('Commons'),
+    t('Activity - Full view'),
+  );
+  $export['commons_activity_streams_user_activity'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.features.inc b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.features.inc
new file mode 100644
index 0000000..e5a7598
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.features.inc
@@ -0,0 +1,12 @@
+<?php
+/**
+ * @file
+ * commons_activity_streams_groups.features.inc
+ */
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_activity_streams_groups_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.info b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.info
new file mode 100644
index 0000000..b6b2ea0
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.info
@@ -0,0 +1,11 @@
+name = Commons Activity Streams Groups
+description = Contains Organic Groups integration for Commons Activity Streams
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_activity_streams
+dependencies[] = entity
+dependencies[] = views
+dependencies[] = views_content
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[views_view][] = activity_group
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.module b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.module
new file mode 100644
index 0000000..ebfd5eb
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Activity Streams Groups feature.
+ */
+
+include_once 'commons_activity_streams_groups.features.inc';
diff --git a/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.views_default.inc b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.views_default.inc
new file mode 100644
index 0000000..002e115
--- /dev/null
+++ b/modules/commons/commons_activity_streams/commons_activity_streams_groups/commons_activity_streams_groups.views_default.inc
@@ -0,0 +1,141 @@
+<?php
+/**
+ * @file
+ * commons_activity_streams_groups.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_activity_streams_groups_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'activity_group';
+  $view->description = '';
+  $view->tag = 'Commons';
+  $view->base_table = 'message';
+  $view->human_name = 'Commons Activity Streams - Group activity';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Recent activity in this group';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '4';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: Entity Reference: Referenced Entity */
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['id'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['table'] = 'field_data_field_target_nodes';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['field'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['relationships']['field_target_nodes_target_id']['required'] = TRUE;
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['relationship'] = 'field_target_nodes_target_id';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Message: Rendered Message */
+  $handler->display->display_options['fields']['rendered_entity']['id'] = 'rendered_entity';
+  $handler->display->display_options['fields']['rendered_entity']['table'] = 'views_entity_message';
+  $handler->display->display_options['fields']['rendered_entity']['field'] = 'rendered_entity';
+  $handler->display->display_options['fields']['rendered_entity']['label'] = '';
+  $handler->display->display_options['fields']['rendered_entity']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['rendered_entity']['link_to_entity'] = 0;
+  $handler->display->display_options['fields']['rendered_entity']['display'] = 'view';
+  $handler->display->display_options['fields']['rendered_entity']['view_mode'] = 'full';
+  /* Field: Message: Timestamp */
+  $handler->display->display_options['fields']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['fields']['timestamp']['table'] = 'message';
+  $handler->display->display_options['fields']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['fields']['timestamp']['label'] = '';
+  $handler->display->display_options['fields']['timestamp']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['timestamp']['date_format'] = 'time_ago_dynamic';
+  /* Sort criterion: Message: Timestamp */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'message';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_action'] = 'not found';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published or admin */
+  $handler->display->display_options['filters']['status_extra']['id'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['table'] = 'node';
+  $handler->display->display_options['filters']['status_extra']['field'] = 'status_extra';
+  $handler->display->display_options['filters']['status_extra']['relationship'] = 'field_target_nodes_target_id';
+  /* Filter criterion: Message: Message category */
+  $handler->display->display_options['filters']['type_category']['id'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['table'] = 'message';
+  $handler->display->display_options['filters']['type_category']['field'] = 'type_category';
+  $handler->display->display_options['filters']['type_category']['value'] = array(
+    'message_type' => 'message_type',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['allow']['use_pager'] = 0;
+  $handler->display->display_options['allow']['items_per_page'] = 'items_per_page';
+  $handler->display->display_options['allow']['offset'] = 0;
+  $handler->display->display_options['allow']['link_to_view'] = 0;
+  $handler->display->display_options['allow']['more_link'] = 0;
+  $handler->display->display_options['allow']['path_override'] = 0;
+  $handler->display->display_options['allow']['title_override'] = 0;
+  $handler->display->display_options['allow']['exposed_form'] = 0;
+  $handler->display->display_options['allow']['fields_override'] = 0;
+  $handler->display->display_options['argument_input'] = array(
+    'gid' => array(
+      'type' => 'user',
+      'context' => 'entity:comment.author',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'OG membership: Group ID',
+    ),
+  );
+  $translatables['activity_group'] = array(
+    t('Master'),
+    t('Recent activity in this group'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Content entity referenced from field_target_nodes'),
+    t('OG membership from node'),
+    t('All'),
+    t('Content pane'),
+    t('Commons'),
+  );
+  $export['activity_group'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_body/commons_body.features.field_base.inc b/modules/commons/commons_body/commons_body.features.field_base.inc
new file mode 100644
index 0000000..08b6813
--- /dev/null
+++ b/modules/commons/commons_body/commons_body.features.field_base.inc
@@ -0,0 +1,43 @@
+<?php
+/**
+ * @file
+ * commons_body.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_body_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'body'
+  $field_bases['body'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(
+      0 => 'node',
+    ),
+    'field_name' => 'body',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'text',
+    'settings' => array(),
+    'translatable' => 0,
+    'type' => 'text_with_summary',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_body/commons_body.info b/modules/commons/commons_body/commons_body.info
new file mode 100644
index 0000000..03c3d20
--- /dev/null
+++ b/modules/commons/commons_body/commons_body.info
@@ -0,0 +1,9 @@
+name = Commons Body Field
+description = Provides a simple body field for re-use by various Commons content types
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = features
+dependencies[] = field_sql_storage
+dependencies[] = text
+features[features_api][] = api:2
+features[field_base][] = body
diff --git a/modules/commons/commons_body/commons_body.module b/modules/commons/commons_body/commons_body.module
new file mode 100644
index 0000000..44788b0
--- /dev/null
+++ b/modules/commons/commons_body/commons_body.module
@@ -0,0 +1,5 @@
+<?php
+/**
+ * @file
+ * Drupal needs this blank file.
+ */
diff --git a/modules/commons/commons_bw/.gitignore b/modules/commons/commons_bw/.gitignore
new file mode 100644
index 0000000..b09a4b1
--- /dev/null
+++ b/modules/commons/commons_bw/.gitignore
@@ -0,0 +1,4 @@
+/plugins/quicktabs_styles/commons_origins/.sass-cache/
+/plugins/quicktabs_styles/commons_origins_tabs/.sass-cache/
+/plugins/quicktabs_styles/commons_pills/.sass-cache/
+/plugins/quicktabs_styles/commons_tabs/.sass-cache/
\ No newline at end of file
diff --git a/modules/commons/commons_bw/commons_bw.features.field_base.inc b/modules/commons/commons_bw/commons_bw.features.field_base.inc
new file mode 100644
index 0000000..34f1a3b
--- /dev/null
+++ b/modules/commons/commons_bw/commons_bw.features.field_base.inc
@@ -0,0 +1,43 @@
+<?php
+/**
+ * @file
+ * commons_bw.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_bw_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'title_field'
+  $field_bases['title_field'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'title_field',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'text',
+    'settings' => array(
+      'max_length' => 255,
+    ),
+    'translatable' => 1,
+    'type' => 'text',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_bw/commons_bw.features.field_instance.inc b/modules/commons/commons_bw/commons_bw.features.field_instance.inc
new file mode 100644
index 0000000..7189faf
--- /dev/null
+++ b/modules/commons/commons_bw/commons_bw.features.field_instance.inc
@@ -0,0 +1,73 @@
+<?php
+/**
+ * @file
+ * commons_bw.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_bw_field_default_field_instances() {
+  $field_instances = array();
+
+  foreach (node_type_get_types() as $node_type) {
+    if (commons_bw_node_auto_title_instance($node_type->type)) {
+      commons_bw_field_definition($field_instances, $node_type->type);
+    }
+  }
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Title');
+
+  return $field_instances;
+}
+
+/**
+ * Creates field instance definitions for all node types.
+ */
+function commons_bw_field_definition(&$field_instances, $bundle) {
+  // Exported field_instance: 'node-[Bundle]-title_field'
+  $field_instances["node-$bundle-title_field"] = array(
+    'bundle' => $bundle,
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 12,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'display_in_partial_form' => !empty($display_in_partial_form[$bundle]),
+    'entity_type' => 'node',
+    'field_name' => 'title_field',
+    'label' => 'Title',
+    'required' => 1,
+    'settings' => array(
+      'hide_label' => array(
+        'entity' => 0,
+        'page' => 0,
+      ),
+      'text_processing' => '0',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => '60',
+      ),
+      'type' => 'text_textfield',
+      'weight' => -5,
+    ),
+  );
+}
diff --git a/modules/commons/commons_bw/commons_bw.info b/modules/commons/commons_bw/commons_bw.info
new file mode 100644
index 0000000..2ce9fb3
--- /dev/null
+++ b/modules/commons/commons_bw/commons_bw.info
@@ -0,0 +1,13 @@
+name = Commons Tabbed Browsing Widget
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_groups
+dependencies[] = features
+dependencies[] = og
+dependencies[] = quicktabs
+dependencies[] = quicktabs_tabstyles
+dependencies[] = title
+features[features_api][] = api:2
+features[field_base][] = title_field
+files[] = includes/views/handlers/commons_bw_handler_node_partial_form.inc
+; Views handlers
diff --git a/modules/commons/commons_bw/commons_bw.install b/modules/commons/commons_bw/commons_bw.install
new file mode 100644
index 0000000..a297a0c
--- /dev/null
+++ b/modules/commons/commons_bw/commons_bw.install
@@ -0,0 +1,34 @@
+<?php
+
+/**
+ * Add the Title field to all browsing widget-enabled content types.
+ * per http://drupal.org/node/1969088.
+ */
+function commons_bw_update_7301() {
+  module_enable(array('title'));
+  $revert = array(
+    'commons_bw' => array(
+      'field_base', 'field_instance',
+    ),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Make sure existing nodes titles are migrated to the title field.
+ * per http://drupal.org/node/1969088.
+ */
+function commons_bw_update_7302() {
+  foreach (node_type_get_types() as $node_type) {
+    // Set the title as "Replaced by title_field".
+    if (!title_field_replacement_enabled('node', $node_type->type, 'title')) {
+      title_field_replacement_toggle('node', $node_type->type, 'title');
+    }
+
+    // Migrate the titles to the title field.
+    title_field_replacement_batch_set('node', $node_type->type, 'title');
+  }
+
+  drupal_flush_all_caches();
+}
diff --git a/modules/commons/commons_bw/commons_bw.module b/modules/commons/commons_bw/commons_bw.module
new file mode 100644
index 0000000..0c32197
--- /dev/null
+++ b/modules/commons/commons_bw/commons_bw.module
@@ -0,0 +1,401 @@
+<?php
+
+/**
+ * Implements hook_system_info_alter().
+ */
+function commons_bw_system_info_alter(&$info, $file, $type) {
+  if ($file->name == 'commons_bw') {
+    foreach (node_type_get_types() as $node_type) {
+      $type = $node_type->type;
+      if (commons_bw_node_auto_title_instance($type)) {
+        $info['features']['field_instance'][] = "node-$type-title_field";
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_ctools_plugin_directory().
+ */
+function commons_bw_ctools_plugin_directory($module, $plugin) {
+  if ($module == 'ctools' && $plugin == 'content_types') {
+    return 'plugins/' . $plugin;
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_bw_views_api() {
+  return array(
+    'api' => 3,
+    'path' => drupal_get_path('module', 'commons_bw') . '/includes/views',
+  );
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_bw_form_alter(&$form, &$form_state, $form_id) {
+  // Implements tweaks to exposed filters and sorts per the Commons designs.
+  if ($form_id != 'views_exposed_form' || strpos($form['#id'],'views-exposed-form-commons-bw') !== 0) {
+    return;
+  }
+
+  // Remove the sort order (eg, descending vs ascending).
+  $form['sort_order']['#access'] = FALSE;
+
+  $form['sort_by']['#title'] = t('Sorted by');
+}
+
+/**
+ * Implements hook_forms().
+ *
+ * The bundle is added to the partial node form ID, to prevent duplicate IDs on
+ * the same page, but all of the partial forms are built with the same function.
+ */
+function commons_bw_forms($form_id, $args) {
+  $forms = array();
+  if (strpos($form_id, 'commons_bw_partial_node_form__') === 0) {
+    $forms[$form_id] = array(
+      'callback' => 'commons_bw_partial_node_form',
+    );
+  }
+
+  return $forms;
+}
+
+/**
+ * Partial node form for the browsing widget.
+ *
+ * @param $bundle
+ *   The node bundle.
+ */
+function commons_bw_partial_node_form($form, &$form_state, $bundle, $group_id = NULL) {
+  global $user;
+  global $language;
+
+  if (!$group_id) {
+    // Reset the og_field_widget_form cache because otherwise it ignores
+    // multiple tries to render the same group audience widget (We have the
+    // same group audience widget on the All and Posts tabs, when displaying
+    // this form without group context).
+    drupal_static_reset('og_field_widget_form');
+  }
+
+  if ($group_id) {
+    $form_state['group_id'] = $group_id;
+  }
+
+  $instances = field_info_instances('node', $bundle);
+
+  // Remove all fields except those marked as "display_in_partial_form".
+  foreach($instances as $field_name => $instance) {
+    if (empty($instance['display_in_partial_form'])) {
+      unset($instances[$field_name]);
+    }
+  }
+  // Make sure there's a field left to display.
+  if (empty($instances)) {
+    return $form;
+  }
+
+  // Create a dummy node for field_attach_form().
+  $node = new stdClass();
+  $node->type = $bundle;
+  node_object_prepare($node);
+
+  if (module_exists('locale')) {
+    if (locale_multilingual_node_type($node->type)) {
+      $node->language = $language->language;
+    }
+    else {
+      $default = language_default();
+      $node->language = $default->language;
+    }
+  }
+  else {
+    $node->language = LANGUAGE_NONE;
+  }
+
+  field_attach_form('node', $node, $form, $form_state, entity_language('node', $node));
+
+  foreach(element_children($form) as $field_name) {
+    if (empty($instances[$field_name])) {
+      $form[$field_name]['#access'] = FALSE;
+    }
+  }
+
+  if (!empty($form['#metatags'])) {
+    unset($form['#metatags']);
+  }
+
+  // When not in a group context, enable the group audience widget.
+  $form[OG_AUDIENCE_FIELD]['#weight'] = 100;
+  $form[OG_AUDIENCE_FIELD]['#access'] = !$group_id;
+
+  // Form title.
+  $bundles = field_info_bundles('node');
+  $form['title'] = array(
+    '#markup' => '<h3>' . t('Create a @bundle', array('@bundle' => strtolower($bundles[$bundle]['label']))) . '</h3>',
+    '#weight' => -50,
+  );
+
+  // Display the user's picture.
+  $wrapper = entity_metadata_wrapper('user', $user);
+  $path = empty($user->picture) ? variable_get('user_picture_default') : $wrapper->value()->picture->uri;
+  $form['user_picture'] = array(
+    '#theme' => 'image_style',
+    '#style_name' => '50x50_avatar',
+    '#path' => $path,
+    '#prefix' => '<div class="user-picture">',
+    '#suffix' => '</div>',
+    '#weight' => -20,
+  );
+
+  $form['actions'] = array(
+    '#type' => 'actions',
+    '#weight' => 200,
+  );
+  $form['actions']['submit'] = array(
+    '#type' => 'submit',
+    '#value' => t('Save'),
+  );
+
+  // Add in some descriptive classes for css down the line.
+  $form['#attributes']['class'][] = 'node';
+  $form['#attributes']['class'][] = 'commons-bw-partial-node-form';
+  $form['#attributes']['class'][] = 'commons-bw-partial-node-form-' . $bundle;
+
+  // Add a link to the full node form.
+  $form['full_form'] = array(
+    '#theme' => 'link',
+    '#text' => t('Go to full form'),
+    '#path' => 'node/add/' . str_replace('_', '-', $bundle),
+    '#options' => array(
+      'attributes' => array('class' => array('full-form')),
+      'html' => FALSE,
+    ),
+    '#weight' => 100,
+  );
+
+  if ($group_id) {
+    $form['full_form']['#options']['query'] = array(OG_AUDIENCE_FIELD => $group_id);
+  }
+
+  // Add the commons_bw after build first, in case other pre-renders needs need
+  // to address fields by there CSS ID.
+  array_unshift($form['#pre_render'], 'commons_bw_partial_node_form_after_build');
+  $form['#validate'][] = 'commons_bw_partial_node_form_validate';
+  return $form;
+}
+
+/**
+ * After-build call-back. See commons_bw_partial_node_form().
+ */
+function commons_bw_partial_node_form_after_build($form) {
+  $bundle = $form['#bundle'];
+  // Add the node's bundle to the IDs of inputs, to avoid having duplicate IDs.
+  $id_suffix = '-' . str_replace('_', '-', $bundle);
+
+  foreach(element_children($form) as $field_name) {
+    if (!empty($form[$field_name]['#language'])) {
+      $language = $form[$field_name]['#language'];
+
+      if (!empty($form[$field_name][$language][0]['value']['#id'])) {
+        $form[$field_name][$language][0]['value']['#id'] .= $id_suffix;
+      }
+
+      if (!empty($form[$field_name][$language][0]['default']['#id'])) {
+        $form[$field_name][$language][0]['default']['#id'] .= $id_suffix;
+      }
+    }
+  }
+
+  // Set the form action to the form's tab.
+  $tabs = commons_bw_get_tab_definitions();
+  // Search for the tab displaying the current bundle.
+  foreach ($tabs as $tab_id => $settings) {
+    if ($settings['bundle'] == $bundle) {
+      break;
+    }
+  }
+  $form['#action'] = url(current_path(), array('query' => array('qt-commons_bw' => $tab_id)));
+
+  return $form;
+}
+
+/**
+ * Validation handler; Attach the node validation to the partial node form.
+ */
+function commons_bw_partial_node_form_validate($form, $form_state) {
+  $node = $form['#entity'];
+  field_attach_validate('node', $node);
+  node_validate($node, $form, $form_state);
+  if ((!module_exists('commons_trusted_contacts') || (module_exists('commons_trusted_contacts') && !module_exists('og_access'))) && empty($form_state['group_id']) && empty($form_state['values'][OG_AUDIENCE_FIELD][LANGUAGE_NONE][0])) {
+    form_set_error(OG_AUDIENCE_FIELD, t('Please enter one or more groups where this content will be posted.'));
+    return FALSE;
+  }
+}
+
+/**
+ * Submit handler; Create a node from the partial node form.
+ */
+function commons_bw_partial_node_form_submit($form, $form_state) {
+  $node = $form['#entity'];
+  // Mark the node as created with the partial form
+  $node->partial_node_form = TRUE;
+  field_attach_submit('node', $node, $form, $form_state);
+
+  $wrapper = entity_metadata_wrapper('node', $node);
+
+  // If the node has a body and doesn't has a title, create a title from the
+  // body.
+  if ((empty($wrapper->title_field) || !$wrapper->title_field->value()) && empty($node->title)) {
+    if (!empty($wrapper->body) && $wrapper->body->value()) {
+      $title = htmlspecialchars_decode($wrapper->body->value->value());
+      // Strip tags and whitespaces.
+      $title = preg_replace('/[\t\n\r\0\x0B]/', '', strip_tags($title));
+      // Shorten the title.
+      $node->title = truncate_utf8($title, 30, TRUE, TRUE);
+    }
+  }
+
+  // Set the group audience.
+  if (!empty($form_state['group_id'])) {
+    $wrapper->{OG_AUDIENCE_FIELD}->set(array($form_state['group_id']));
+  }
+
+  $node->form_state = $form_state;
+
+  $wrapper->save();
+
+  // Notify about the node creation.
+  $arguments = array('@type' => node_type_get_name($node), '%title' => $node->title);
+  drupal_set_message(t('@type %title has been created.', $arguments));
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ *
+ * Add a setting to group content fields, to determine whether they will be
+ * displayed on the mini node form of the browsing widget.
+ */
+function commons_bw_form_field_ui_field_edit_form_alter(&$form, &$form_state) {
+  if (!og_is_group_content_type($form['instance']['entity_type']['#value'], $form['instance']['bundle']['#value'])) {
+    return;
+  }
+
+  // See if we're building for the first time, or getting pre-saved values.
+  $field_name = $form['#field']['field_name'];
+  if(!empty($form_state['field'][$field_name][LANGUAGE_NONE]['instance']['display_in_partial_form'])) {
+    $display_default = $form_state['field'][$field_name][LANGUAGE_NONE]['instance']['display_in_partial_form'];
+  }
+  else if (isset($form_state['build_info']['args'][0]['display_in_partial_form'])) {
+    $display_default = $form_state['build_info']['args'][0]['display_in_partial_form'];
+  }
+  else {
+    $display_default = FALSE;
+  }
+
+  $form['instance']['display_in_partial_form'] = array(
+    '#type' => 'checkbox',
+    '#title' => t('Display in the browsing widget mini-form'),
+    '#default_value' => $display_default,
+  );
+}
+
+/**
+* Get a list of modules that add content to a particular type of widget.
+* The only currently supported widget type is 'group', but this
+* could be extended to support other entities.
+*/
+function commons_bw_get_tab_definitions($widget_type = 'group') {
+  $hook_name = 'commons_bw_' . $widget_type . '_widget';
+  $tabs = module_invoke_all($hook_name);
+  drupal_alter($hook_name, $tabs);
+  return $tabs;
+}
+
+
+/**
+ * Helper function to determine whether Commons_BW should define a title
+ * field instance on behalf of a content type.
+ */
+function commons_bw_node_auto_title_instance($node_type) {
+  $commons_groups_entity_types = commons_groups_get_group_content_entity_types();
+  $return = isset($commons_groups_entity_types['node'][$node_type]['auto_title_instance']) ? $commons_groups_entity_types['node'][$node_type]['auto_title_instance'] : TRUE;
+  return $return;
+}
+/**
+ * Provides a styled content creation dropdown widget for the 'all'
+ * tab of the group homepage browsing widget.
+ */
+function commons_bw_create_all_widget($group) {
+  $links = array();
+  // Collect definitions from implementing modules.
+  $items = module_invoke_all('commons_bw_create_all_widget', $group);
+  uasort($items, 'element_sort');
+  foreach ($items as $module => $item) {
+    $links[] = $item['link'] . ' ' . $item['text'];
+    // Populate the default content creation link.
+    if (isset($item['default']) && $item['default']) {
+      $default = $item;
+    }
+  }
+  $output = '';
+  if (!empty($default)) {
+    $output .= $default['link'] . '<a class="commons-bw-create-choose"><span></span></a>';
+  }
+  $output .= '<div class="commons-bw-create-choose-bg"></div><div class="commons-bw-create-choose-holder">' . theme('item_list', array('items' => $links, 'type' => 'ul', 'attributes' => array('class' => 'commons-bw-create-all-widget-types'))) . '</div>';
+  return $output;
+}
+
+/**
+ * Generate a renderable group widget.
+ */
+function commons_bw_generate_group_widget($group = NULL) {
+  // The partial_node_form.js should be after quicktabs.js.
+  drupal_add_js(drupal_get_path('module', 'commons_bw') . '/js/partial_node_form.js', array('weight' => 100));
+
+  $settings = array('style' => 'Commons Pills', 'ajax' => FALSE, 'html' => TRUE);
+  // Load the default tab definitions.
+  $tabs = commons_bw_get_tab_definitions('group');
+  foreach ($tabs as $key => $tab) {
+    // Populate the group argument.
+    $tabs[$key]['args'] = $group ? $group->nid : 0;
+
+    // Add the result count for Tabs that are of the type 'view';
+    if ($tab['type'] == 'view') {
+      $view = views_get_view($tab['vid']);
+      if (isset($tab['display'])) {
+        $view->set_display($tab['display']);
+      }
+      if ($group) {
+        $view->set_arguments(array($group->nid));
+      }
+      $view->display_handler->options['filters']['flagged']['value'] = 'All';
+      $view->get_total_rows = TRUE;
+      $view->execute();
+      $tabs[$key]['title'] = $tabs[$key]['title'] . ' <span class="commons-bw-result-count">'. $view->total_rows . '</span>';
+    }
+    // Set the default tab.
+    if (isset($tabs[$key]['default']) && $tabs[$key]['default']) {
+      $settings['default_tab'] = $key;
+    }
+  }
+
+  // Generate the Quicktabs instance.
+  return quicktabs_build_quicktabs('commons_bw', $settings, $tabs);
+}
+
+/**
+ * Implements hook_quicktabs_tabstyles().
+ */
+function commons_bw_quicktabs_tabstyles() {
+  $path = drupal_get_path('module', 'commons_bw');
+  return array(
+    $path . '/plugins/quicktabs_styles/commons_pills/commons_pills.css' => t('Commons Pills'),
+    $path . '/plugins/quicktabs_styles/commons_tabs/commons_tabs.css' => t('Commons Tabs'),
+  );
+}
diff --git a/modules/commons/commons_bw/includes/views/commons_bw.views.inc b/modules/commons/commons_bw/includes/views/commons_bw.views.inc
new file mode 100644
index 0000000..8989587
--- /dev/null
+++ b/modules/commons/commons_bw/includes/views/commons_bw.views.inc
@@ -0,0 +1,18 @@
+<?php
+
+/**
+ * Implements hook_views_data()
+ */
+function commons_bw_views_data() {
+  $data = array();
+
+  $data['views']['commons_bw_node_partial_form'] = array(
+    'title' => t('Node partial form'),
+    'help' => t('Display a minified node creation form.'),
+    'area' => array(
+      'handler' => 'commons_bw_handler_node_partial_form',
+    ),
+  );
+
+  return $data;
+}
diff --git a/modules/commons/commons_bw/includes/views/handlers/commons_bw_handler_node_partial_form.inc b/modules/commons/commons_bw/includes/views/handlers/commons_bw_handler_node_partial_form.inc
new file mode 100644
index 0000000..f96b1c0
--- /dev/null
+++ b/modules/commons/commons_bw/includes/views/handlers/commons_bw_handler_node_partial_form.inc
@@ -0,0 +1,52 @@
+<?php
+
+/**
+ * Minified node creation form.
+ */
+class commons_bw_handler_node_partial_form extends views_handler_area {
+
+  function option_definition() {
+    $options = parent::option_definition();
+    $options['bundle'] = array('default' => NULL);
+    return $options;
+  }
+
+  function options_form(&$form, &$form_state) {
+    $bundles = og_get_all_group_content_bundle();
+
+    $form['bundle'] = array(
+      '#type' => 'select',
+      '#title' => t('Node type'),
+      '#options' => !empty($bundles['node']) ? $bundles['node'] : array(),
+      '#default_value' => $this->options['bundle'],
+      '#required' => TRUE,
+    );
+  }
+
+  function render($empty = FALSE) {
+    $cache = &drupal_static(__METHOD__, array());
+
+    $bundle = $this->options['bundle'];
+    $group_id = !empty($this->view->args[0]) ? $this->view->args[0] : NULL;
+
+    // Verify content creation access.
+    $permission = "create $bundle content";
+    if ($group_id && !og_user_access('node', $group_id, $permission)) {
+      return;
+    }
+    elseif (!user_access($permission)) {
+      return;
+    }
+
+    // Avoid rendering a form for the same bundle twice; Instead, mark that it
+    // should be moved to this position from previously rendered form.
+    // See partial_node_form.js.
+    if (!empty($cache[$bundle])) {
+      return '<div class="partial-node-form-placeholder" data-bundle="' . $bundle . '"></div>';
+    }
+    $cache[$bundle] = TRUE;
+
+    $form = drupal_get_form("commons_bw_partial_node_form__$bundle", $bundle, $group_id);
+    return render($form);
+  }
+}
diff --git a/modules/commons/commons_bw/js/partial_node_form.js b/modules/commons/commons_bw/js/partial_node_form.js
new file mode 100644
index 0000000..2c4d1a8
--- /dev/null
+++ b/modules/commons/commons_bw/js/partial_node_form.js
@@ -0,0 +1,82 @@
+(function ($) {
+
+/**
+ * Handles presentation of multiple partial forms of the same node bundle; When
+ * showing a tab, check if it has a form's placeholder and if so, move the form
+ * to the current tab and move the placeholder to the former form's tab.
+ */
+Drupal.behaviors.commonsBwPartialNodeForm = {
+  attach: function (context, settings) {
+    $('.quicktabs-tabs a', context).click(function(){
+      var $activeTab = $('#quicktabs-container-commons_bw .quicktabs-tabpage:not(.quicktabs-hide)', context);
+      // Check for a form placeholder.
+      var $placeholder = $activeTab.find('.partial-node-form-placeholder');
+      if (!$placeholder.length) {
+        return;
+      }
+
+      var $form = $('.commons-bw-partial-node-form-' + $placeholder.data('bundle'), context);
+      var $originalParent = $form.parent();
+      // Replace the placeholder and the form.
+      $form.appendTo($placeholder.parent());
+      $placeholder.appendTo($originalParent);
+    });
+  }
+}
+
+/**
+ * Expand a form when it is focused.
+ */
+Drupal.behaviors.commonsBwExpandableForm = {
+  attach: function (context, settings) {
+    $('.commons-bw-partial-node-form', context).once('commonsBwExpandableForm', function () {
+      // Assemble the variables.
+      var form = $(this),
+          toggleText = Drupal.t('Collapse the form'),
+          toggle = $('<a/>').attr({
+            'class': 'expandable-form-toggle element-hidden',
+            'href': '#',
+            'title': toggleText
+          }).append(toggleText),
+          triggerField = form.find('.trigger-field'),
+          fullFormLink = form.find('a.full-form'),
+          hideables = form.find('.hideable-field'),
+          errors = form.find('.error');
+
+      // Determine if the form has any errors.
+      if (!errors.length) {
+        // Forms with errors are shown expanded, so only add the toggle link to
+        // the top of forms which are error free.
+        form.prepend(toggle).addClass('expandable-form compact-form');
+
+        // Hide the hidden fields on load.
+        hideables.addClass('element-invisible');
+      }
+      else {
+        // The full form link is only shown on collapsed forms so it is hidden
+        // for consistency.
+        fullFormLink.addClass('element-hidden');
+      }
+
+      // Make all hidden fields visible when the trigger field comes into
+      // focus.
+      triggerField.find('textarea, input').focus(function () {
+        form.addClass('expanded-form').removeClass('compact-form');
+        toggle.removeClass('element-hidden');
+        hideables.removeClass('element-invisible');
+        fullFormLink.addClass('element-hidden');
+      });
+
+      // Hide all the hidden fields when the trigger link is clicked.
+      toggle.click(function () {
+        form.addClass('compact-form').removeClass('expanded-form');
+        toggle.addClass('element-hidden');
+        hideables.addClass('element-invisible');
+        fullFormLink.removeClass('element-hidden');
+        return false;
+      });
+    });
+  }
+}
+
+})(jQuery);
diff --git a/modules/commons/commons_bw/plugins/content_types/commons_bw_group.inc b/modules/commons/commons_bw/plugins/content_types/commons_bw_group.inc
new file mode 100644
index 0000000..b6f73b0
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/content_types/commons_bw_group.inc
@@ -0,0 +1,42 @@
+<?php
+
+/**
+ * Plugins are described by creating a $plugin array which will be used
+ * by the system that includes this file.
+ */
+$plugin = array(
+  'title' => t('Commons Group Browsing widget'),
+  'description' => t('Commons Group Browsing widget.'),
+  'category' => t('Commons'),
+  'single' => TRUE,
+  'content type' => 'commons_bw_group',
+  'all contexts' => TRUE,
+);
+ 
+/**
+* Output function for the '[content_type]' content type.
+*/
+function commons_bw_commons_bw_group_content_type_render($subtype, $conf, $panel_args, $context) {
+  $context = array_shift($context);
+  $node = !empty($context->data) ? $context->data : NULL;
+
+  $block = new stdClass();
+  $block->title = '';
+  $widget = commons_bw_generate_group_widget($node);
+  $block->content = drupal_render($widget['content']);
+  return $block;
+}
+ 
+/**
+* Returns an edit form for the custom type.
+*/
+function commons_bw_commons_bw_group_content_type_edit_form($form, $form_state) {
+  return $form;
+}
+ 
+/**
+* Returns an edit form for the custom type.
+*/
+function commons_bw_commons_bw_group_content_type_edit_form_submit($form, $form_state) {
+  return $form;
+}
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/commons_pills.css b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/commons_pills.css
new file mode 100644
index 0000000..4281fca
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/commons_pills.css
@@ -0,0 +1,149 @@
+.quicktabs-style-commons-pills ul.quicktabs-tabs {
+  margin: 0 0 30px 0;
+  padding: 0;
+}
+.block-content .quicktabs-style-commons-pills ul.quicktabs-tabs {
+  padding: 0;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li {
+  display: inline-block;
+  padding: 0;
+  margin: 0 12px 0 0;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a {
+  background-color: #f1f1f1;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  padding: 3px 10px 3px 6px;
+  display: block;
+  color: #a5a3a3;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover {
+  text-decoration: none;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a span {
+  color: #3f3d3d;
+  font-size: .7em;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a {
+  background-color: #00568c;
+  color: #fff;
+  position: relative;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a:after {
+  content: '';
+  width: 0px;
+  height: 0px;
+  display: block;
+  border-style: solid;
+  border-width: 5px 7.5px 0 7.5px;
+  border-color: #00568c transparent transparent transparent;
+  position: absolute;
+  top: 100%;
+  left: 50%;
+  margin-left: -7.5px;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span {
+  color: #fff;
+}
+
+#quicktabs-tab-commons_bw-commons_all:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 -99px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_all:before {
+  background-position: 0 -163px;
+}
+
+#quicktabs-tab-commons_bw-commons_posts:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 -322px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_posts:before {
+  background-position: 0 -353px;
+}
+
+#quicktabs-tab-commons_bw-commons_documents:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 -384px no-repeat;
+  width: 9px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_documents:before {
+  background-position: 0 -416px;
+}
+
+#quicktabs-tab-commons_bw-commons_q_a:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 -66px no-repeat;
+  width: 13px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_q_a:before {
+  background-position: 0 -130px;
+}
+
+#quicktabs-tab-commons_bw-commons_ideas:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 -225px no-repeat;
+  width: 8px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_ideas:before {
+  background-position: 0 -289px;
+}
+
+#quicktabs-tab-commons_bw-commons_wikis:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 0 no-repeat;
+  width: 13px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_wikis:before {
+  background-position: 0 -33px;
+}
+
+#quicktabs-tab-commons_bw-commons_polls:before {
+  content: '';
+  background: url('images/icons-s2238b17da1.png') 0 -194px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+ul.quicktabs-style-commons-pills li.active #quicktabs-tab-commons_bw-commons_polls:before {
+  background-position: 0 -258px;
+}
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/commons_pills.scss b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/commons_pills.scss
new file mode 100644
index 0000000..b54b322
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/commons_pills.scss
@@ -0,0 +1,155 @@
+@import 'compass';
+
+$icons: sprite-map('icons/*.png', $spacing: 20px);
+
+@mixin sprite_url_height_width($sprite_name, $image_name) {
+  background: sprite($sprite_name, $image_name) no-repeat;
+  width: image-width(sprite-file($sprite_name, $image_name));
+  height: image-height(sprite-file($sprite_name, $image_name));
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+@mixin sprite_url_position($sprite_name, $image_name) {
+  background-position: sprite-position($sprite_name, $image_name);
+}
+
+$link_color: #a5a3a3;
+
+.quicktabs-style-commons-pills {
+
+  ul.quicktabs-tabs {
+    margin: 0 0 30px 0;
+    padding: 0;
+
+    .block-content & {
+      padding: 0;
+    }
+
+    li {
+      display: inline-block;
+      padding: 0;
+      margin: 0 12px 0 0;
+
+      a {
+        background-color: #f1f1f1;
+        @include border-radius(3px);
+        padding: 3px 10px 3px 6px;
+        display: block;
+        color: $link_color;
+
+        &:hover {
+          text-decoration: none;
+        }
+
+        span {
+          color: darken($link_color, 40%);
+          font-size: .7em;
+        }
+      }
+
+      &.active a {
+        background-color: #00568c;
+        color: #fff;
+        position: relative;
+
+        &:after {
+          content: '';
+          width: 0px;
+          height: 0px;
+          display: block;
+          border-style: solid;
+          border-width: 5px 7.5px 0 7.5px;
+          border-color: #00568c transparent transparent transparent;
+          position: absolute;
+          top: 100%;
+          left: 50%;
+          margin-left: -7.5px;
+        }
+
+        span {
+          color: #fff;
+        }
+      }
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_all {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, all);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, all-active);
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_posts {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, posts);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, posts-active);
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_documents {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, docs);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, docs-active);
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_q_a {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, qa);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, qa-active);
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_ideas {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, ideas);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, ideas-active);
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_wikis {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, wikis);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, wikis-active);
+    }
+  }
+}
+
+#quicktabs-tab-commons_bw-commons_polls {
+  &:before {
+    content: '';
+    @include sprite_url_height_width($icons, polls);
+
+    ul.quicktabs-style-commons-pills li.active & {
+      @include sprite_url_position($icons, polls-active);
+    }
+  }
+}
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/config.rb b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/config.rb
new file mode 100644
index 0000000..78b78bf
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/config.rb
@@ -0,0 +1,27 @@
+# Require any additional compass plugins here.
+
+# Set this to the root of your project when deployed:
+http_path = "/"
+css_dir = "/"
+sass_dir = "/"
+images_dir = "images"
+
+# output_style = :expanded or :nested or :compact or :compressed
+output_style = :expanded
+environment = :production
+
+relative_assets = true
+
+# To enable relative paths to assets via compass helper functions. Uncomment:
+# relative_assets = true
+
+# To disable debugging comments that display the original location of your selectors. Uncomment:
+# line_comments = false
+color_output = false
+
+
+# If you prefer the indented syntax, you might want to regenerate this
+# project again passing --syntax sass, or you can uncomment this:
+# preferred_syntax = :sass
+# and then run:
+# sass-convert -R --from scss --to sass sass scss && rm -rf sass && mv scss sass
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons-s2238b17da1.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons-s2238b17da1.png
new file mode 100644
index 0000000..68e7163
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons-s2238b17da1.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/all-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/all-active.png
new file mode 100644
index 0000000..da83e57
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/all-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/all.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/all.png
new file mode 100644
index 0000000..6d7fcae
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/all.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/docs-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/docs-active.png
new file mode 100644
index 0000000..2dd6e5e
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/docs-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/docs.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/docs.png
new file mode 100644
index 0000000..a93f71e
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/docs.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/ideas-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/ideas-active.png
new file mode 100644
index 0000000..354b62b
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/ideas-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/ideas.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/ideas.png
new file mode 100644
index 0000000..ab58f60
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/ideas.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/polls-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/polls-active.png
new file mode 100644
index 0000000..ac5b016
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/polls-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/polls.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/polls.png
new file mode 100644
index 0000000..da6c9ab
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/polls.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/posts-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/posts-active.png
new file mode 100644
index 0000000..a9f6303
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/posts-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/posts.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/posts.png
new file mode 100644
index 0000000..92d02ee
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/posts.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/qa-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/qa-active.png
new file mode 100644
index 0000000..b13d328
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/qa-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/qa.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/qa.png
new file mode 100644
index 0000000..33fc2b5
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/qa.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/wikis-active.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/wikis-active.png
new file mode 100644
index 0000000..a671665
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/wikis-active.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/wikis.png b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/wikis.png
new file mode 100644
index 0000000..1443adc
Binary files /dev/null and b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_pills/images/icons/wikis.png differ
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/commons_tabs.css b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/commons_tabs.css
new file mode 100644
index 0000000..93e8725
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/commons_tabs.css
@@ -0,0 +1,89 @@
+.quicktabs-style-commons-tabs ul.quicktabs-tabs {
+  margin: 0;
+  padding: 0;
+  position: relative;
+  top: 1px;
+}
+.block-content .quicktabs-style-commons-tabs ul.quicktabs-tabs {
+  padding: 0;
+}
+.quicktabs-style-commons-tabs ul.quicktabs-tabs li {
+  display: inline-block;
+  padding: 0;
+  margin: 0 5px 0 0;
+}
+.quicktabs-style-commons-tabs ul.quicktabs-tabs li a {
+  background-color: #dddddd;
+  border: 1px solid #dddddd;
+  -webkit-border-radius: 3px 3px 0 0;
+  -moz-border-radius: 3px 3px 0 0;
+  -ms-border-radius: 3px 3px 0 0;
+  -o-border-radius: 3px 3px 0 0;
+  border-radius: 3px 3px 0 0;
+  padding: 10px;
+  display: block;
+  font-size: 1.1em;
+  color: #2683b8;
+}
+.quicktabs-style-commons-tabs ul.quicktabs-tabs li a:hover {
+  text-decoration: none;
+}
+.quicktabs-style-commons-tabs ul.quicktabs-tabs li a span {
+  background: #dddddd;
+  font-size: 1.1em;
+  line-height: 1.1em;
+  color: #4d4d4d;
+  font-style: italic;
+  display: inline-block;
+  padding: 2px 6px;
+  border: 1px solid #c4c4c4;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  margin-left: 2px;
+}
+.quicktabs-style-commons-tabs ul.quicktabs-tabs li.active a {
+  background-color: #f1f1f1;
+  color: #333333;
+  border-bottom-color: #f1f1f1;
+}
+.quicktabs-style-commons-tabs .quicktabs-tabpage {
+  border: 1px solid #dddddd;
+  background-color: #f1f1f1;
+  -webkit-border-radius: 0 3px 3px 3px;
+  -moz-border-radius: 0 3px 3px 3px;
+  -ms-border-radius: 0 3px 3px 3px;
+  -o-border-radius: 0 3px 3px 3px;
+  border-radius: 0 3px 3px 3px;
+  padding: 10px;
+}
+.quicktabs-style-commons-tabs table {
+  margin-top: 0;
+  border: none;
+}
+.quicktabs-style-commons-tabs td {
+  padding: 10px 7px;
+}
+.quicktabs-style-commons-tabs tbody tr {
+  border-top: none;
+}
+.quicktabs-style-commons-tabs tr {
+  background: none;
+}
+.quicktabs-style-commons-tabs tr.odd {
+  background: none;
+}
+.quicktabs-style-commons-tabs tr.even {
+  background: #ececec;
+}
+.quicktabs-style-commons-tabs tr.even, .quicktabs-style-commons-tabs tr.odd {
+  border-bottom: 1px dashed #dddddd;
+}
+.quicktabs-style-commons-tabs tr.even.views-row-last, .quicktabs-style-commons-tabs tr.odd.views-row-last {
+  border-bottom: none;
+}
+.quicktabs-style-commons-tabs tr.even td.active, .quicktabs-style-commons-tabs tr.odd td.active {
+  background: none;
+}
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/commons_tabs.scss b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/commons_tabs.scss
new file mode 100644
index 0000000..cf368b4
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/commons_tabs.scss
@@ -0,0 +1,108 @@
+@import 'compass';
+
+$link_color: #2683B8;
+$gray: #f1f1f1;
+$gray_darker: #ececec;
+$gray_darkest: #dddddd;
+$black: #333333;
+
+.quicktabs-style-commons-tabs {
+
+  ul.quicktabs-tabs {
+    margin: 0;
+    padding: 0;
+    position: relative;
+    top: 1px;
+
+    .block-content & {
+      padding: 0;
+    }
+
+    li {
+      display: inline-block;
+      padding: 0;
+      margin: 0 5px 0 0;
+
+      a {
+        background-color: $gray_darkest;
+        border: 1px solid $gray_darkest;
+        @include border-radius(3px 3px 0 0);
+        padding: 10px;
+        display: block;
+        font-size: 1.1em;
+        color: $link_color;
+
+        &:hover {
+          text-decoration: none;
+        }
+
+        span {
+          background: $gray_darkest;
+          font-size: 1.1em;
+          line-height: 1.1em;
+          color: lighten($black, 10%);
+          font-style: italic;
+          display: inline-block;
+          padding: 2px 6px;
+          border: 1px solid darken($gray_darkest, 10%);
+          @include border-radius(3px);
+          margin-left: 2px;
+        }
+      }
+
+      &.active a {
+        background-color: $gray;
+        color: $black;
+        border-bottom-color: $gray;
+
+        span {
+          // color: #fff;
+        }
+      }
+    }
+  }
+
+  .quicktabs-tabpage {
+    border: 1px solid $gray_darkest;
+    background-color: $gray;
+    @include border-radius(0 3px 3px 3px);
+    padding: 10px
+  }
+
+  table {
+    margin-top: 0;
+    border: none;
+  }
+
+  td {
+    padding: 10px 7px;
+  }
+
+  tbody tr {
+    border-top: none;
+  }
+
+  tr {
+    background: none;
+
+    &.odd {
+      background: none;
+    }
+
+    &.even {
+      background: $gray_darker;
+    }
+
+    &.even, &.odd {
+      border-bottom: 1px dashed $gray_darkest;
+
+      &.views-row-last {
+        border-bottom: none;
+      }
+
+      & td.active {
+        background: none;
+      }
+    }
+  }
+}
diff --git a/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/config.rb b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/config.rb
new file mode 100644
index 0000000..85c9626
--- /dev/null
+++ b/modules/commons/commons_bw/plugins/quicktabs_styles/commons_tabs/config.rb
@@ -0,0 +1,26 @@
+# Require any additional compass plugins here.
+
+# Set this to the root of your project when deployed:
+http_path = "/"
+css_dir = "/"
+sass_dir = "/"
+
+# output_style = :expanded or :nested or :compact or :compressed
+output_style = :expanded
+environment = :production
+
+relative_assets = true
+
+# To enable relative paths to assets via compass helper functions. Uncomment:
+# relative_assets = true
+
+# To disable debugging comments that display the original location of your selectors. Uncomment:
+# line_comments = false
+color_output = false
+
+
+# If you prefer the indented syntax, you might want to regenerate this
+# project again passing --syntax sass, or you can uncomment this:
+# preferred_syntax = :sass
+# and then run:
+# sass-convert -R --from scss --to sass sass scss && rm -rf sass && mv scss sass
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.features.inc b/modules/commons/commons_content_moderation/commons_content_moderation.features.inc
new file mode 100644
index 0000000..3a75218
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.features.inc
@@ -0,0 +1,115 @@
+<?php
+/**
+ * @file
+ * commons_content_moderation.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_content_moderation_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_content_moderation_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_flag_default_flags().
+ */
+function commons_content_moderation_flag_default_flags() {
+  $flags = array();
+  // Exported flag: "Comment inappropriate".
+  $flags['inappropriate_comment'] = array(
+    'content_type' => 'comment',
+    'title' => 'Comment inappropriate',
+    'global' => 0,
+    'types' => array(
+      0 => 'comment_node_answer',
+      1 => 'comment_node_event',
+      2 => 'comment_node_group',
+      3 => 'comment_node_page',
+      4 => 'comment_node_post',
+      5 => 'comment_node_question',
+      6 => 'comment_node_wiki',
+    ),
+    'flag_short' => 'Report as inappropriate',
+    'flag_long' => 'Report this comment as inappropriate.',
+    'flag_message' => '',
+    'unflag_short' => 'Cancel report as inappropriate',
+    'unflag_long' => 'Cancel reporting as inappropriate.',
+    'unflag_message' => '',
+    'unflag_denied_text' => '',
+    'link_type' => 'confirm',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => 0,
+    'show_on_form' => 0,
+    'access_author' => 'comment_others',
+    'show_on_comment' => 1,
+    'flag_confirmation' => 'Are you sure you want to report this comment as inappropriate?',
+    'unflag_confirmation' => 'Are you sure you want to cancel reporting this comment as inappropriate?',
+    'module' => 'commons_content_moderation',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  // Exported flag: "Node inappropriate".
+  $flags['inappropriate_node'] = array(
+    'content_type' => 'node',
+    'title' => 'Node inappropriate',
+    'global' => 0,
+    'types' => array(
+      0 => 'event',
+      1 => 'group',
+      2 => 'page',
+      3 => 'post',
+      4 => 'wiki',
+    ),
+    'flag_short' => 'Report as inappropriate',
+    'flag_long' => 'Report this content as inappropriate.',
+    'flag_message' => '',
+    'unflag_short' => 'Cancel report as inappropriate',
+    'unflag_long' => 'Report this content as appropriate',
+    'unflag_message' => '',
+    'unflag_denied_text' => '',
+    'link_type' => 'confirm',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => 0,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_page' => 1,
+    'show_on_teaser' => 0,
+    'show_contextual_link' => FALSE,
+    'i18n' => 0,
+    'flag_confirmation' => 'Are you sure you want to report this content as inappropriate?',
+    'unflag_confirmation' => 'Are you sure you want cancel reporting this content as inappropriate?',
+    'module' => 'commons_content_moderation',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  return $flags;
+
+}
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.features.user_role.inc b/modules/commons/commons_content_moderation/commons_content_moderation.features.user_role.inc
new file mode 100644
index 0000000..b1bff9e
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.features.user_role.inc
@@ -0,0 +1,20 @@
+<?php
+/**
+ * @file
+ * commons_content_moderation.features.user_role.inc
+ */
+
+/**
+ * Implements hook_user_default_roles().
+ */
+function commons_content_moderation_user_default_roles() {
+  $roles = array();
+
+  // Exported role: content moderator.
+  $roles['content moderator'] = array(
+    'name' => 'content moderator',
+    'weight' => 2,
+  );
+
+  return $roles;
+}
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.info b/modules/commons/commons_content_moderation/commons_content_moderation.info
new file mode 100644
index 0000000..3dd7cef
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.info
@@ -0,0 +1,19 @@
+name = Commons Content moderation
+description = Commons Content moderation
+core = 7.x
+package = Commons - Building Blocks
+dependencies[] = ctools
+dependencies[] = flag
+dependencies[] = flag_abuse
+dependencies[] = strongarm
+dependencies[] = views
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[flag][] = inappropriate_comment
+features[flag][] = inappropriate_node
+features[user_role][] = content moderator
+features[variable][] = flag_abuse_flags
+features[views_view][] = commons_content_moderation_reported_comments
+features[views_view][] = commons_content_moderation_reported_nodes
+features_exclude[dependencies][features] = features
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.install b/modules/commons/commons_content_moderation/commons_content_moderation.install
new file mode 100644
index 0000000..ed3d510
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.install
@@ -0,0 +1,20 @@
+<?php
+
+/**
+ * Change content moderation views permission.
+ */
+function commons_content_moderation_update_7001() {
+  $revert = array(
+    'commons_content_moderation' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Clear views cache to have content moderation view use new permission.
+ */
+function commons_content_moderation_update_7002() {
+  cache_clear_all('*', 'cache_views', TRUE);
+}
+
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.module b/modules/commons/commons_content_moderation/commons_content_moderation.module
new file mode 100644
index 0000000..b76ff26
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.module
@@ -0,0 +1,117 @@
+<?php
+/**
+ * @file
+ * Drupal needs this blank file.
+ */
+
+include_once 'commons_content_moderation.features.inc';
+
+/**
+ * Implements hook_action_info().
+ */
+function commons_content_moderation_action_info() {
+  return array(
+    'commons_content_moderation_delete_node_block_user' => array(
+      'type' => 'node',
+      'label' => t("Delete content and block author's account."),
+      'configurable' => FALSE,
+      'behavior' => array(''),
+      'triggers' => array(''),
+    ),
+    'commons_content_moderation_delete_comment_block_user' => array(
+      'type' => 'comment',
+      'label' => t("Delete comment and block author's account."),
+      'configurable' => FALSE,
+      'behavior' => array(''),
+      'triggers' => array(''),
+    ),
+  );
+}
+
+
+function commons_content_moderation_delete_node_block_user(&$entity, $context = array()) {
+  // Block users other than the anonymous user and UID 1.
+  if ($entity->uid > 1) {
+    $author = user_load($entity->uid);
+    if ($author->status) {
+      $author = user_save($author, array('status' => 0));
+      watchdog('action', 'Blocked user %name.', array('%name' => $author->name));
+    }
+  }
+  // If the Mollom module is enabled and configured, report
+  // the content to Mollom.
+  if (module_exists('mollom') && _mollom_status()) {
+    $mollom_return = mollom_data_report('node', $entity->nid, 'spam');
+  }
+  // We're done with this node. We can delete it.
+  node_delete($entity->nid);
+  watchdog('action', 'Deleted @type %title.', array('@type' => node_type_get_name($entity), '%title' => $entity->title));
+}
+
+function commons_content_moderation_delete_comment_block_user(&$entity, $context = array()) {
+ // Block users other than the anonymous user and UID 1.
+  if ($entity->uid > 1) {
+    $author = user_load($entity->uid);
+    if ($author->status) {
+      $author = user_save($author, array('status' => 0));
+      watchdog('action', 'Blocked user %name.', array('%name' => $author->name));
+    }
+  }
+  // If the Mollom module is enabled and configured, report
+  // the content to Mollom.
+  if (module_exists('mollom') && _mollom_status()) {
+    $mollom_return = mollom_data_report('comment', $comment->cid, 'spam');
+  }
+  // We're done with this node. We can delete it.
+  comment_delete($entity->cid);
+  watchdog('action', 'Deleted comment %title.', array('@type' => node_type_get_name($entity), '%title' => $entity->title));
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ */
+function commons_content_moderation_views_default_views_alter(&$views) {
+  // We're providing alternatives to these views.
+  foreach (array('all_flag_abuse_node', 'all_flag_abuse_comment') as $view_name) {
+    if (!empty($views[$view_name])) {
+      $views[$view_name]->disabled = TRUE;
+    }
+  }
+}
+
+/**
+ * Implements hook_views_pre_build().
+ *
+ * A check when VBO is being used on the content moderation views, make sure
+ * the user has the correct permissions.
+ */
+function commons_content_moderation_views_pre_build(&$view) {
+
+  if ($view->name == 'commons_content_moderation_reported_nodes'
+    && !module_exists('actions_permissions')
+    && (!user_access('administer content') || !user_access('administer users'))) {
+    unset($view->field['views_bulk_operations']);
+    unset($view->display_handler->handlers['field']['views_bulk_operations']);
+  }
+}
+
+/**
+ * Implements hook_views_bulk_operations_form_alter().
+ */
+function commons_content_moderation_views_bulk_operations_form_alter(&$form, $form_state, $vbo) {
+  if (!isset($vbo->options['vbo_operations']['action::commons_content_moderation_delete_node_block_user'])) {
+    return;
+  }
+  if ($form_state['step'] == 'views_form_views_form' && $vbo->options['vbo_operations']['action::commons_content_moderation_delete_node_block_user']['selected'] == 1) {
+    if (module_exists('mollom') && _mollom_status()) {
+      $form['mollom_text'] = array(
+        '#markup' => t('Deleted content will be reported to Mollom.'),
+      );
+    }
+    else {
+     $form['mollom_text'] = array(
+        '#markup' => t('When the !mollom module is installed and configured, content deleted here will also be reported to Mollom.', array('!mollom' => l('Mollom', 'http://drupal.org/project/mollom'))),
+      );
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.strongarm.inc b/modules/commons/commons_content_moderation/commons_content_moderation.strongarm.inc
new file mode 100644
index 0000000..31bccba
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.strongarm.inc
@@ -0,0 +1,30 @@
+<?php
+/**
+ * @file
+ * commons_content_moderation.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_content_moderation_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'flag_abuse_flags';
+  $strongarm->value = array(
+    'inappropriate_node' => 'inappropriate_node',
+    'inappropriate_comment' => 'inappropriate_comment',
+    'commons_follow_user' => 0,
+    'commons_follow_term' => 0,
+    'commons_follow_group' => 0,
+    'commons_follow_node' => 0,
+    'bookmarks' => 0,
+    'abuse_user' => 0,
+  );
+  $export['flag_abuse_flags'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_content_moderation/commons_content_moderation.views_default.inc b/modules/commons/commons_content_moderation/commons_content_moderation.views_default.inc
new file mode 100644
index 0000000..50f6eee
--- /dev/null
+++ b/modules/commons/commons_content_moderation/commons_content_moderation.views_default.inc
@@ -0,0 +1,632 @@
+<?php
+/**
+ * @file
+ * commons_content_moderation.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_content_moderation_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_content_moderation_reported_comments';
+  $view->description = 'View for flag: Comment Abuse ';
+  $view->tag = 'flag.abuse';
+  $view->base_table = 'comment';
+  $view->human_name = 'Commons reported comments';
+  $view->core = 0;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Defaults */
+  $handler = $view->new_display('default', 'Defaults', 'default');
+  $handler->display->display_options['title'] = 'Comments';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'administer nodes';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = 25;
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'subject' => 'subject',
+    'title' => 'title',
+    'count' => 'count',
+    'last_updated' => 'last_updated',
+    'name_2' => 'name_2',
+    'entity_id' => 'entity_id',
+  );
+  $handler->display->display_options['style_options']['default'] = '-1';
+  $handler->display->display_options['style_options']['info'] = array(
+    'subject' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'title' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'count' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'last_updated' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'name_2' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'entity_id' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['text']['id'] = 'text';
+  $handler->display->display_options['empty']['text']['table'] = 'views';
+  $handler->display->display_options['empty']['text']['field'] = 'area';
+  $handler->display->display_options['empty']['text']['content'] = 'No comments have been reported...';
+  $handler->display->display_options['empty']['text']['format'] = 'plain_text';
+  /* Relationship: Flags: inappropriate_comment */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'comment';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'inappropriate_comment';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Relationship: Comment: Content */
+  $handler->display->display_options['relationships']['nid']['id'] = 'nid';
+  $handler->display->display_options['relationships']['nid']['table'] = 'comment';
+  $handler->display->display_options['relationships']['nid']['field'] = 'nid';
+  $handler->display->display_options['relationships']['nid']['required'] = TRUE;
+  /* Relationship: Flags: inappropriate_comment counter */
+  $handler->display->display_options['relationships']['flag_count_rel']['id'] = 'flag_count_rel';
+  $handler->display->display_options['relationships']['flag_count_rel']['table'] = 'comment';
+  $handler->display->display_options['relationships']['flag_count_rel']['field'] = 'flag_count_rel';
+  $handler->display->display_options['relationships']['flag_count_rel']['flag'] = 'inappropriate_comment';
+  /* Field: Bulk operations: Comment */
+  $handler->display->display_options['fields']['views_bulk_operations']['id'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['table'] = 'comment';
+  $handler->display->display_options['fields']['views_bulk_operations']['field'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['display_type'] = '1';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['enable_select_all_pages'] = 1;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['force_single'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['entity_load_capacity'] = '10';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_operations'] = array(
+    'action::commons_content_moderation_delete_comment_block_user' => array(
+      'selected' => 1,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_delete_item' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::system_message_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_script_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::flag_comment_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_modify_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'show_all_tokens' => 1,
+        'display_values' => array(
+          '_all_' => '_all_',
+        ),
+      ),
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_argument_selector_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'url' => '',
+      ),
+    ),
+    'action::comment_publish_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::system_goto_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::comment_save_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::system_send_email_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::panelizer_set_status_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::comment_unpublish_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::comment_unpublish_by_keyword_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+  );
+  /* Field: Comment: Title */
+  $handler->display->display_options['fields']['subject']['id'] = 'subject';
+  $handler->display->display_options['fields']['subject']['table'] = 'comment';
+  $handler->display->display_options['fields']['subject']['field'] = 'subject';
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['relationship'] = 'nid';
+  $handler->display->display_options['fields']['title']['label'] = 'Comment on';
+  /* Field: Comment: Author */
+  $handler->display->display_options['fields']['name_2']['id'] = 'name_2';
+  $handler->display->display_options['fields']['name_2']['table'] = 'comment';
+  $handler->display->display_options['fields']['name_2']['field'] = 'name';
+  $handler->display->display_options['fields']['name_2']['label'] = 'Comment Author';
+  /* Field: Comment: Comment */
+  $handler->display->display_options['fields']['entity_id']['id'] = 'entity_id';
+  $handler->display->display_options['fields']['entity_id']['table'] = 'field_data_comment_body';
+  $handler->display->display_options['fields']['entity_id']['field'] = 'comment_body';
+  /* Sort criterion: Flags: Flagged time */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'flag_content';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['relationship'] = 'flag_content_rel';
+  /* Filter criterion: Comment: Approved */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'comment';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+
+  /* Display: Page: Reported comments */
+  $handler = $view->new_display('page', 'Page: Reported comments', 'page_abuse_comment');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['path'] = 'admin/content/comment/reported';
+  $handler->display->display_options['menu']['type'] = 'tab';
+  $handler->display->display_options['menu']['title'] = 'Reported comments';
+  $handler->display->display_options['menu']['weight'] = '0';
+  $handler->display->display_options['menu']['context'] = 0;
+  $handler->display->display_options['tab_options']['type'] = 'tab';
+  $handler->display->display_options['tab_options']['title'] = 'Reported comments';
+  $handler->display->display_options['tab_options']['weight'] = '10';
+  $translatables['commons_content_moderation_reported_comments'] = array(
+    t('Defaults'),
+    t('Comments'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No comments have been reported...'),
+    t('flag'),
+    t('Content'),
+    t('counter'),
+    t('Comment'),
+    t('Title'),
+    t('Comment on'),
+    t('Comment Author'),
+    t('Page: Reported comments'),
+  );
+  $export['commons_content_moderation_reported_comments'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_content_moderation_reported_nodes';
+  $view->description = 'View for flag: Node Abuse';
+  $view->tag = 'flag.abuse';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons reported nodes';
+  $view->core = 0;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Defaults */
+  $handler = $view->new_display('default', 'Defaults', 'default');
+  $handler->display->display_options['title'] = 'Reported content';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'administer nodes';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['distinct'] = TRUE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'none';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'views_bulk_operations' => 'views_bulk_operations',
+    'type' => 'type',
+    'title' => 'title',
+    'count' => 'count',
+    'last_updated' => 'last_updated',
+    'name' => 'name',
+    'body' => 'body',
+  );
+  $handler->display->display_options['style_options']['default'] = 'last_updated';
+  $handler->display->display_options['style_options']['info'] = array(
+    'views_bulk_operations' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'type' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'title' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'count' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'last_updated' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'name' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'body' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['text']['id'] = 'area';
+  $handler->display->display_options['empty']['text']['table'] = 'views';
+  $handler->display->display_options['empty']['text']['field'] = 'area';
+  $handler->display->display_options['empty']['text']['content'] = 'No content has been reported.';
+  $handler->display->display_options['empty']['text']['format'] = '1';
+  /* Relationship: Flags: inappropriate_node */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['label'] = 'abuse_node';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'inappropriate_node';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Relationship: Content: Author */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'node';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['required'] = TRUE;
+  /* Relationship: Flags: inappropriate_node counter */
+  $handler->display->display_options['relationships']['flag_count_rel']['id'] = 'flag_count_rel';
+  $handler->display->display_options['relationships']['flag_count_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['flag_count_rel']['field'] = 'flag_count_rel';
+  $handler->display->display_options['relationships']['flag_count_rel']['flag'] = 'inappropriate_node';
+  /* Field: Bulk operations: Content */
+  $handler->display->display_options['fields']['views_bulk_operations']['id'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['table'] = 'node';
+  $handler->display->display_options['fields']['views_bulk_operations']['field'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['display_type'] = '1';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['enable_select_all_pages'] = 1;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['force_single'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['entity_load_capacity'] = '10';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_operations'] = array(
+    'action::node_assign_owner_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::commons_content_moderation_delete_node_block_user' => array(
+      'selected' => 1,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_delete_item' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::system_message_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_script_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::flag_node_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_make_sticky_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_make_unsticky_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_modify_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'show_all_tokens' => 1,
+        'display_values' => array(
+          '_all_' => '_all_',
+        ),
+      ),
+      'postpone_processing' => 0,
+    ),
+    'action::views_bulk_operations_argument_selector_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'url' => '',
+      ),
+    ),
+    'action::node_promote_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_publish_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::system_goto_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_unpromote_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_save_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::system_send_email_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::panelizer_set_status_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_unpublish_action' => array(
+      'selected' => 1,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+    'action::node_unpublish_by_keyword_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'postpone_processing' => 0,
+    ),
+  );
+  /* Field: Content: Type */
+  $handler->display->display_options['fields']['type']['id'] = 'type';
+  $handler->display->display_options['fields']['type']['table'] = 'node';
+  $handler->display->display_options['fields']['type']['field'] = 'type';
+  $handler->display->display_options['fields']['type']['exclude'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  /* Field: Flags: Flag counter */
+  $handler->display->display_options['fields']['count']['id'] = 'count';
+  $handler->display->display_options['fields']['count']['table'] = 'flag_counts';
+  $handler->display->display_options['fields']['count']['field'] = 'count';
+  $handler->display->display_options['fields']['count']['relationship'] = 'flag_count_rel';
+  $handler->display->display_options['fields']['count']['label'] = '# of Reports';
+  /* Field: Flags: Time last flagged */
+  $handler->display->display_options['fields']['last_updated']['id'] = 'last_updated';
+  $handler->display->display_options['fields']['last_updated']['table'] = 'flag_counts';
+  $handler->display->display_options['fields']['last_updated']['field'] = 'last_updated';
+  $handler->display->display_options['fields']['last_updated']['relationship'] = 'flag_count_rel';
+  $handler->display->display_options['fields']['last_updated']['label'] = 'Last reported';
+  $handler->display->display_options['fields']['last_updated']['date_format'] = 'time ago';
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = 'Author';
+  /* Field: Content: Body */
+  $handler->display->display_options['fields']['body']['id'] = 'body';
+  $handler->display->display_options['fields']['body']['table'] = 'field_data_body';
+  $handler->display->display_options['fields']['body']['field'] = 'body';
+  $handler->display->display_options['fields']['body']['type'] = 'text_summary_or_trimmed';
+  $handler->display->display_options['fields']['body']['settings'] = array(
+    'trim_length' => '600',
+  );
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = '0';
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'page_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['path'] = 'admin/content/reported';
+  $handler->display->display_options['menu']['type'] = 'tab';
+  $handler->display->display_options['menu']['title'] = 'Reported content';
+  $handler->display->display_options['menu']['weight'] = '0';
+  $handler->display->display_options['menu']['name'] = 'management';
+  $handler->display->display_options['menu']['context'] = 0;
+  $handler->display->display_options['tab_options']['title'] = 'Reported content';
+  $handler->display->display_options['tab_options']['weight'] = '';
+  $translatables['commons_content_moderation_reported_nodes'] = array(
+    t('Defaults'),
+    t('Reported content'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('No content has been reported.'),
+    t('abuse_node'),
+    t('author'),
+    t('counter'),
+    t('Content'),
+    t('Type'),
+    t('Title'),
+    t('# of Reports'),
+    t('.'),
+    t(','),
+    t('Last reported'),
+    t('Author'),
+    t('Body'),
+    t('Page'),
+  );
+  $export['commons_content_moderation_reported_nodes'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_documents/commons_documents.features.field_base.inc b/modules/commons/commons_documents/commons_documents.features.field_base.inc
new file mode 100644
index 0000000..0621f77
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.features.field_base.inc
@@ -0,0 +1,45 @@
+<?php
+/**
+ * @file
+ * commons_documents.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_documents_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_document_file'
+  $field_bases['field_document_file'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_document_file',
+    'foreign keys' => array(
+      'fid' => array(
+        'columns' => array(
+          'fid' => 'fid',
+        ),
+        'table' => 'file_managed',
+      ),
+    ),
+    'indexes' => array(
+      'fid' => array(
+        0 => 'fid',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'file',
+    'settings' => array(
+      'display_default' => 1,
+      'display_field' => 0,
+      'uri_scheme' => 'public',
+    ),
+    'translatable' => 0,
+    'type' => 'file',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_documents/commons_documents.features.field_instance.inc b/modules/commons/commons_documents/commons_documents.features.field_instance.inc
new file mode 100644
index 0000000..008013d
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.features.field_instance.inc
@@ -0,0 +1,107 @@
+<?php
+/**
+ * @file
+ * commons_documents.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_documents_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'node-document-body'
+  $field_instances['node-document-body'] = array(
+    'bundle' => 'document',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 1,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => FALSE,
+    'settings' => array(
+      'display_summary' => FALSE,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'node-document-field_document_file'
+  $field_instances['node-document-field_document_file'] = array(
+    'bundle' => 'document',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'file',
+        'settings' => array(),
+        'type' => 'file_default',
+        'weight' => 4,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'field_document_file',
+    'label' => 'File',
+    'required' => 1,
+    'settings' => array(
+      'description_field' => 1,
+      'file_directory' => '',
+      'file_extensions' => 'txt doc docx xls xlsx ppt pptx odt odp ods pdf',
+      'max_filesize' => '',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'file',
+      'settings' => array(
+        'progress_indicator' => 'throbber',
+      ),
+      'type' => 'file_generic',
+      'weight' => 2,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+  t('File');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_documents/commons_documents.features.inc b/modules/commons/commons_documents/commons_documents.features.inc
new file mode 100644
index 0000000..68c0736
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.features.inc
@@ -0,0 +1,38 @@
+<?php
+/**
+ * @file
+ * commons_documents.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_documents_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_documents_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_documents_node_info() {
+  $items = array(
+    'document' => array(
+      'name' => t('Document'),
+      'base' => 'node_content',
+      'description' => t('Upload and display files or attachments to share with others.'),
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_documents/commons_documents.features.og_features_permission.inc b/modules/commons/commons_documents/commons_documents.features.og_features_permission.inc
new file mode 100644
index 0000000..ab5b04c
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.features.og_features_permission.inc
@@ -0,0 +1,52 @@
+<?php
+/**
+ * @file
+ * commons_documents.features.og_features_permission.inc
+ */
+
+/**
+ * Implements hook_og_features_default_permissions().
+ */
+function commons_documents_og_features_default_permissions() {
+  $permissions = array();
+
+  // Exported og permission: 'node:group:create document content'
+  $permissions['node:group:create document content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any document content'
+  $permissions['node:group:delete any document content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own document content'
+  $permissions['node:group:delete own document content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any document content'
+  $permissions['node:group:update any document content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own document content'
+  $permissions['node:group:update own document content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_documents/commons_documents.features.user_permission.inc b/modules/commons/commons_documents/commons_documents.features.user_permission.inc
new file mode 100644
index 0000000..f048d79
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.features.user_permission.inc
@@ -0,0 +1,62 @@
+<?php
+/**
+ * @file
+ * commons_documents.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_documents_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'create document content'.
+  $permissions['create document content'] = array(
+    'name' => 'create document content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete any document content'.
+  $permissions['delete any document content'] = array(
+    'name' => 'delete any document content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own document content'.
+  $permissions['delete own document content'] = array(
+    'name' => 'delete own document content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit any document content'.
+  $permissions['edit any document content'] = array(
+    'name' => 'edit any document content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit own document content'.
+  $permissions['edit own document content'] = array(
+    'name' => 'edit own document content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_documents/commons_documents.info b/modules/commons/commons_documents/commons_documents.info
new file mode 100644
index 0000000..4ab55b1
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.info
@@ -0,0 +1,46 @@
+name = Commons Documents
+core = 7.x
+package = Commons - Content types
+dependencies[] = commons_body
+dependencies[] = commons_groups
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = file
+dependencies[] = og
+dependencies[] = og_ui
+dependencies[] = strongarm
+dependencies[] = views
+dependencies[] = views_litepager
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_base][] = field_document_file
+features[field_instance][] = node-document-body
+features[field_instance][] = node-document-field_document_file
+features[node][] = document
+features[og_features_permission][] = node:group:create document content
+features[og_features_permission][] = node:group:delete any document content
+features[og_features_permission][] = node:group:delete own document content
+features[og_features_permission][] = node:group:update any document content
+features[og_features_permission][] = node:group:update own document content
+features[user_permission][] = create document content
+features[user_permission][] = delete any document content
+features[user_permission][] = delete own document content
+features[user_permission][] = edit any document content
+features[user_permission][] = edit own document content
+features[variable][] = comment_anonymous_document
+features[variable][] = comment_default_mode_document
+features[variable][] = comment_default_per_page_document
+features[variable][] = comment_document
+features[variable][] = comment_form_location_document
+features[variable][] = comment_preview_document
+features[variable][] = comment_subject_field_document
+features[variable][] = field_bundle_settings_node__document
+features[variable][] = menu_options_document
+features[variable][] = menu_parent_document
+features[variable][] = node_options_document
+features[variable][] = node_preview_document
+features[variable][] = node_submitted_document
+features[views_view][] = commons_bw_documents
diff --git a/modules/commons/commons_documents/commons_documents.install b/modules/commons/commons_documents/commons_documents.install
new file mode 100644
index 0000000..3b00af8
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.install
@@ -0,0 +1,78 @@
+<?php
+
+/**
+ * Disable summary on Document nodes.
+ */
+function commons_documents_update_7000() {
+    $revert = array(
+      'commons_documents' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Disable default frontpage promotion of Document nodes.
+ */
+function commons_documents_update_7001() {
+    $revert = array(
+      'commons_documents' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Remove unused view displays.
+ */
+function commons_documents_update_7002() {
+    $revert = array(
+      'commons_documents' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Standardize Browsing Widget views.
+ */
+function commons_documents_update_7003() {
+  $revert = array(
+    'commons_documents' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Display sticky content at top of lists.
+ */
+function commons_documents_update_7004() {
+  $revert = array(
+    'commons_documents' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Add .txt to the list of allowed file extensions.
+ */
+function commons_documents_update_7005() {
+  $revert = array(
+    'commons_documents' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Add links to node teasers in the browsing widget.
+ */
+function commons_documents_update_7006() {
+  $revert = array(
+    'commons_documents' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_documents/commons_documents.module b/modules/commons/commons_documents/commons_documents.module
new file mode 100644
index 0000000..ec586e2
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.module
@@ -0,0 +1,98 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Documents feature.
+ */
+
+include_once 'commons_documents.features.inc';
+
+/**
+ * Implements hook_commons_bw_group_widget().
+ */
+function commons_documents_commons_bw_group_widget() {
+  return array(
+    'commons_documents' => array(
+      'title' => t('Documents'),
+      'type' => 'view',
+      'vid' => 'commons_bw_documents',
+      'display' => 'default',
+      'weight' => 6,
+      'bundle' => 'document',
+    ),
+  );
+}
+
+/**
+ * Implements hook_form_FROM_ID_alter().
+ */
+function commons_documents_form_commons_bw_partial_node_form_alter(&$form, &$form_state) {
+  if (empty($form['#entity']) || $form['#entity']->type != 'document') {
+    return;
+  }
+
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#title_display'] = 'invisible';
+  $form['body'][$language][0]['#required'] = TRUE;
+  $form['body'][$language][0]['#placeholder'] = t('Describe the document');
+  $form['body'][$language][0]['#resizable'] = FALSE;
+
+  // Set fields as hideable so the forms can be compacted.
+  $form['body']['#attributes']['class'][] = 'trigger-field';
+  foreach (array('field_image', 'og_group_ref', 'field_document_file', 'actions') as $field) {
+    if (isset($form[$field])) {
+      $form[$field]['#attributes']['class'][] = 'hideable-field';
+    }
+  }
+
+  $form['#pre_render'][] = 'commons_documents_form_commons_bw_partial_node_form_after_build';
+}
+
+/**
+ * After-build call-back.
+ * See commons_documents_form_commons_bw_partial_node_form_alter().
+ */
+function commons_documents_form_commons_bw_partial_node_form_after_build($form) {
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#pre_render'] = array();
+  $form['body'][$language][0]['format']['#access'] = FALSE;
+  $form['body'][$language][0]['value']['#rows'] = 3;
+
+  return $form;
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ *
+ * Display documents on the browsing widget main view.
+ */
+function commons_documents_views_default_views_alter(&$views) {
+  if (!empty($views['commons_bw_all'])) {
+    $views['commons_bw_all']->display['default']->display_options['filters']['type']['value']['document'] = 'document';
+  }
+}
+
+/**
+ * Implements hook_views_pre_render().
+ *
+ * Correct the empty text when commons_bw_wikis is shown without group context.
+ */
+function commons_documents_views_pre_render(&$view) {
+  // TODO: Would have been better to enable og_context to check for missing
+  // group context instead of checking for empty first argument.
+  if (empty($view->args[0]) && $view->name == 'commons_bw_documents') {
+    $view->display_handler->handlers['empty']['area']->options['content'] = t('No documents have been created.');
+  }
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_documents_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'document' => array(
+        'is_group_content' => TRUE,
+      ),
+    ),
+  );
+}
diff --git a/modules/commons/commons_documents/commons_documents.strongarm.inc b/modules/commons/commons_documents/commons_documents.strongarm.inc
new file mode 100644
index 0000000..bee3f8b
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.strongarm.inc
@@ -0,0 +1,119 @@
+<?php
+/**
+ * @file
+ * commons_documents.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_documents_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_document';
+  $strongarm->value = 0;
+  $export['comment_anonymous_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_document';
+  $strongarm->value = 1;
+  $export['comment_default_mode_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_document';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_document';
+  $strongarm->value = '2';
+  $export['comment_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_document';
+  $strongarm->value = 1;
+  $export['comment_form_location_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_document';
+  $strongarm->value = '1';
+  $export['comment_preview_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_document';
+  $strongarm->value = 1;
+  $export['comment_subject_field_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__document';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '0',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_document';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_document';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_document';
+  $strongarm->value = array(
+    0 => 'status',
+  );
+  $export['node_options_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_document';
+  $strongarm->value = '1';
+  $export['node_preview_document'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_document';
+  $strongarm->value = 1;
+  $export['node_submitted_document'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_documents/commons_documents.views_default.inc b/modules/commons/commons_documents/commons_documents.views_default.inc
new file mode 100644
index 0000000..faa8352
--- /dev/null
+++ b/modules/commons/commons_documents/commons_documents.views_default.inc
@@ -0,0 +1,134 @@
+<?php
+/**
+ * @file
+ * commons_documents.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_documents_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_bw_documents';
+  $view->description = 'Commons Documents listing for the group browsing widget.';
+  $view->tag = 'Commons Documents, Commons Browsing Widget';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Browsing Widget - Documents';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['query_comment'] = FALSE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '5';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* Header: Global: Node partial form */
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['id'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['table'] = 'views';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['field'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['bundle'] = 'document';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['content'] = 'No documents have been added to this group.';
+  $handler->display->display_options['empty']['area']['format'] = 'plain_text';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Sticky */
+  $handler->display->display_options['sorts']['sticky']['id'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['table'] = 'node';
+  $handler->display->display_options['sorts']['sticky']['field'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['order'] = 'DESC';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'Post date';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'document' => 'document',
+  );
+  $handler->display->display_options['filters']['type']['group'] = 1;
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+  $handler->display->display_options['filters']['group_type']['group'] = 1;
+  $translatables['commons_bw_documents'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No documents have been added to this group.'),
+    t('OG membership from node'),
+    t('following'),
+    t('Post date'),
+    t('most active'),
+    t('All'),
+    t('Following'),
+  );
+
+  $export['commons_bw_documents'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/README.txt b/modules/commons/commons_events/README.txt
new file mode 100644
index 0000000..597bc2b
--- /dev/null
+++ b/modules/commons/commons_events/README.txt
@@ -0,0 +1 @@
+See the 7.x-1.x branch.
diff --git a/modules/commons/commons_events/commons_events.features.field_base.inc b/modules/commons/commons_events/commons_events.features.field_base.inc
new file mode 100644
index 0000000..b8a0fa6
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.features.field_base.inc
@@ -0,0 +1,240 @@
+<?php
+/**
+ * @file
+ * commons_events.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_events_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_date'
+  $field_bases['field_date'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_date',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => 0,
+    'module' => 'date',
+    'settings' => array(
+      'cache_count' => 4,
+      'cache_enabled' => 0,
+      'granularity' => array(
+        'day' => 'day',
+        'hour' => 'hour',
+        'minute' => 'minute',
+        'month' => 'month',
+        'second' => 0,
+        'year' => 'year',
+      ),
+      'timezone_db' => 'UTC',
+      'todate' => 'required',
+      'tz_handling' => 'site',
+    ),
+    'translatable' => 0,
+    'type' => 'datetime',
+  );
+
+  // Exported field_base: 'field_location'
+  $field_bases['field_location'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_location',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        'physical' => 'Physical Address',
+        'online' => 'Online',
+        'online_physical' => 'Online and Physical Address',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => 0,
+    'type' => 'list_text',
+  );
+
+  // Exported field_base: 'field_logo'
+  $field_bases['field_logo'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_logo',
+    'foreign keys' => array(
+      'fid' => array(
+        'columns' => array(
+          'fid' => 'fid',
+        ),
+        'table' => 'file_managed',
+      ),
+    ),
+    'indexes' => array(
+      'fid' => array(
+        0 => 'fid',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'image',
+    'settings' => array(
+      'default_image' => 0,
+      'uri_scheme' => 'public',
+    ),
+    'translatable' => 0,
+    'type' => 'image',
+  );
+
+  // Exported field_base: 'field_number_of_attendees'
+  $field_bases['field_number_of_attendees'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_number_of_attendees',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => 0,
+    'module' => 'number',
+    'settings' => array(),
+    'translatable' => 0,
+    'type' => 'number_integer',
+  );
+
+  // Exported field_base: 'field_offsite_url'
+  $field_bases['field_offsite_url'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_offsite_url',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'text',
+    'settings' => array(
+      'max_length' => 255,
+    ),
+    'translatable' => 0,
+    'type' => 'text',
+  );
+
+  // Exported field_base: 'field_organizers'
+  $field_bases['field_organizers'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_organizers',
+    'foreign keys' => array(
+      'users' => array(
+        'columns' => array(
+          'target_id' => 'uid',
+        ),
+        'table' => 'users',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'target_type' => 'user',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'field_registration'
+  $field_bases['field_registration'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_registration',
+    'foreign keys' => array(
+      'registration_type' => array(
+        'columns' => array(
+          'registration_type' => 'name',
+        ),
+        'table' => 'registration_type',
+      ),
+    ),
+    'indexes' => array(
+      'registration_type' => array(
+        0 => 'registration_type',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'registration',
+    'settings' => array(),
+    'translatable' => 0,
+    'type' => 'registration',
+  );
+
+  // Exported field_base: 'field_registration_type'
+  $field_bases['field_registration_type'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_registration_type',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        'onsite' => 'On this site',
+        'external' => 'On another site',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => 0,
+    'type' => 'list_text',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_events/commons_events.features.field_instance.inc b/modules/commons/commons_events/commons_events.features.field_instance.inc
new file mode 100644
index 0000000..168e0a2
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.features.field_instance.inc
@@ -0,0 +1,534 @@
+<?php
+/**
+ * @file
+ * commons_events.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_events_field_default_field_instances() {
+  $field_instances = array();
+
+  // Because the 'site_default_country' variable gets set, but is empty when no
+  // default country is set, we'll need to do some checks to see if its empty
+  // and display a default country on our own. 
+  // See https://drupal.org/node/2068957#comment-7773019 for more info.
+  $default_country = variable_get('site_default_country', 'US');
+
+  // Exported field_instance: 'node-event-body'
+  $field_instances['node-event-body'] = array(
+    'bundle' => 'event',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 5,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 3,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Description',
+    'required' => 1,
+    'settings' => array(
+      'display_summary' => FALSE,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_address'
+  $field_instances['node-event-field_address'] = array(
+    'bundle' => 'event',
+    'default_value' => array(
+      0 => array(
+        'element_key' => 'node|event|field_address|und|0',
+        'thoroughfare' => '',
+        'premise' => '',
+        'locality' => '',
+        'administrative_area' => '',
+        'postal_code' => '',
+        'country' => !empty($default_country) ? $default_country : 'US',
+      ),
+    ),
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'addressfield_tokens',
+        'settings' => array(
+          'components' => array(
+            'administrative_area' => 'administrative_area',
+            'locality' => 'locality',
+            'postal_code' => 'postal_code',
+            'thoroughfare' => 'thoroughfare',
+          ),
+          'separator' => ', ',
+        ),
+        'type' => 'addressfield_components',
+        'weight' => 2,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'addressfield_tokens',
+        'settings' => array(
+          'components' => array(
+            'administrative_area' => 'administrative_area',
+            'locality' => 'locality',
+            'postal_code' => 'postal_code',
+            'thoroughfare' => 'thoroughfare',
+          ),
+          'separator' => ', ',
+        ),
+        'type' => 'addressfield_components',
+        'weight' => 2,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_address',
+    'label' => 'Address',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'addressfield',
+      'settings' => array(
+        'available_countries' => array(),
+        'format_handlers' => array(
+          'address' => 'address',
+          'address-hide-country' => 0,
+          'organisation' => 0,
+          'name-full' => 0,
+          'name-oneline' => 0,
+        ),
+      ),
+      'type' => 'addressfield_standard',
+      'weight' => 8,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_date'
+  $field_instances['node-event-field_date'] = array(
+    'bundle' => 'event',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'date',
+        'settings' => array(
+          'format_type' => 'event_datetime',
+          'fromto' => 'both',
+          'multiple_from' => '',
+          'multiple_number' => '',
+          'multiple_to' => '',
+        ),
+        'type' => 'date_default',
+        'weight' => 1,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'date',
+        'settings' => array(
+          'format_type' => 'event_datetime',
+          'fromto' => 'both',
+          'multiple_from' => '',
+          'multiple_number' => '',
+          'multiple_to' => '',
+        ),
+        'type' => 'date_default',
+        'weight' => 1,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_date',
+    'label' => 'Date',
+    'required' => 1,
+    'settings' => array(
+      'default_value' => 'now',
+      'default_value2' => 'same',
+      'default_value_code' => '',
+      'default_value_code2' => '',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'date',
+      'settings' => array(
+        'increment' => 15,
+        'input_format' => 'm/d/Y - H:i:s',
+        'input_format_custom' => 'd M Y - h:i:s a',
+        'label_position' => 'above',
+        'text_parts' => array(),
+        'year_range' => '-3:+3',
+      ),
+      'type' => 'date_popup',
+      'weight' => 5,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_location'
+  $field_instances['node-event-field_location'] = array(
+    'bundle' => 'event',
+    'default_value' => array(
+      0 => array(
+        'value' => 'online_physical',
+      ),
+    ),
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 9,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_location',
+    'label' => 'Location',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_select',
+      'weight' => 7,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_logo'
+  $field_instances['node-event-field_logo'] = array(
+    'bundle' => 'event',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'image',
+        'settings' => array(
+          'image_link' => '',
+          'image_style' => '50x50',
+        ),
+        'type' => 'image',
+        'weight' => 0,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'image',
+        'settings' => array(
+          'image_link' => '',
+          'image_style' => '50x50',
+        ),
+        'type' => 'image',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_logo',
+    'label' => 'Event logo',
+    'required' => 0,
+    'settings' => array(
+      'alt_field' => 0,
+      'default_image' => 0,
+      'file_directory' => '',
+      'file_extensions' => 'png gif jpg jpeg',
+      'max_filesize' => '2 MB',
+      'max_resolution' => '',
+      'min_resolution' => '',
+      'title_field' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'image',
+      'settings' => array(
+        'preview_image_style' => '50x50',
+        'progress_indicator' => 'throbber',
+      ),
+      'type' => 'image_image',
+      'weight' => 9,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_number_of_attendees'
+  $field_instances['node-event-field_number_of_attendees'] = array(
+    'bundle' => 'event',
+    'default_value' => array(
+      0 => array(
+        'value' => 0,
+      ),
+    ),
+    'deleted' => 0,
+    'description' => 'Enter 0 for unlimited',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 8,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_number_of_attendees',
+    'label' => 'Maximum number of attendees',
+    'required' => 1,
+    'settings' => array(
+      'max' => '',
+      'min' => 0,
+      'prefix' => '',
+      'suffix' => '',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'number',
+      'settings' => array(),
+      'type' => 'number',
+      'weight' => 12,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_offsite_url'
+  $field_instances['node-event-field_offsite_url'] = array(
+    'bundle' => 'event',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 4,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_offsite_url',
+    'label' => 'URL',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => 60,
+      ),
+      'type' => 'text_textfield',
+      'weight' => 3,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_organizers'
+  $field_instances['node-event-field_organizers'] = array(
+    'bundle' => 'event',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'hidden',
+        'weight' => 12,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_organizers',
+    'label' => 'Organizers',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete_tags',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_registration'
+  $field_instances['node-event-field_registration'] = array(
+    'bundle' => 'event',
+    'default_value' => array(
+      0 => array(
+        'registration_type' => 'event',
+      ),
+    ),
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 10,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_registration',
+    'label' => 'Registration bundle',
+    'required' => 0,
+    'settings' => array(
+      'default_registration_settings' => array(
+        'capacity' => 0,
+        'reminder' => array(
+          'reminder_settings' => array(
+            'reminder_date' => '',
+            'reminder_template' => '',
+          ),
+          'send_reminder' => 0,
+        ),
+        'scheduling' => array(
+          'close' => '',
+          'open' => '',
+        ),
+        'settings' => array(
+          'from_address' => 'admin@example.com',
+          'multiple_registrations' => 0,
+        ),
+        'status' => 1,
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'registration',
+      'settings' => array(),
+      'type' => 'registration_select',
+      'weight' => 10,
+    ),
+  );
+
+  // Exported field_instance: 'node-event-field_registration_type'
+  $field_instances['node-event-field_registration_type'] = array(
+    'bundle' => 'event',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 11,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_registration_type',
+    'label' => 'Registration type',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_select',
+      'weight' => 11,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Address');
+  t('Date');
+  t('Description');
+  t('Enter 0 for unlimited');
+  t('Event logo');
+  t('Location');
+  t('Maximum number of attendees');
+  t('Organizers');
+  t('Registration bundle');
+  t('Registration type');
+  t('URL');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_events/commons_events.features.inc b/modules/commons/commons_events/commons_events.features.inc
new file mode 100644
index 0000000..7bbc0c4
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.features.inc
@@ -0,0 +1,143 @@
+<?php
+/**
+ * @file
+ * commons_events.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_events_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_events_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_events_node_info() {
+  $items = array(
+    'event' => array(
+      'name' => t('Event'),
+      'base' => 'node_content',
+      'description' => t('Post information about planned activities or meetings.'),
+      'has_title' => '1',
+      'title_label' => t('Event title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
+
+/**
+ * Implements hook_default_registration_type().
+ */
+function commons_events_default_registration_type() {
+  $items = array();
+  $items['event'] = entity_import('registration_type', '{
+    "name" : "event",
+    "label" : "Event",
+    "locked" : "0",
+    "weight" : "0",
+    "data" : null,
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
+
+/**
+ * Implements hook_rdf_default_mappings().
+ */
+function commons_events_rdf_default_mappings() {
+  $schemaorg = array();
+
+  // Exported RDF mapping: event
+  $schemaorg['node']['event'] = array(
+    'rdftype' => array(
+      0 => 'schema:Event',
+      1 => 'sioc:Item',
+      2 => 'foaf:Document',
+    ),
+    'title' => array(
+      'predicates' => array(
+        0 => 'schema:name',
+      ),
+    ),
+    'created' => array(
+      'predicates' => array(
+        0 => 'dc:date',
+        1 => 'dc:created',
+      ),
+      'datatype' => 'xsd:dateTime',
+      'callback' => 'date_iso8601',
+    ),
+    'changed' => array(
+      'predicates' => array(
+        0 => 'dc:modified',
+      ),
+      'datatype' => 'xsd:dateTime',
+      'callback' => 'date_iso8601',
+    ),
+    'body' => array(
+      'predicates' => array(
+        0 => 'content:encoded',
+      ),
+    ),
+    'uid' => array(
+      'predicates' => array(
+        0 => 'sioc:has_creator',
+      ),
+      'type' => 'rel',
+    ),
+    'name' => array(
+      'predicates' => array(
+        0 => 'schema:name',
+      ),
+    ),
+    'comment_count' => array(
+      'predicates' => array(
+        0 => 'sioc:num_replies',
+      ),
+      'datatype' => 'xsd:integer',
+    ),
+    'last_activity' => array(
+      'predicates' => array(
+        0 => 'sioc:last_activity_date',
+      ),
+      'datatype' => 'xsd:dateTime',
+      'callback' => 'date_iso8601',
+    ),
+    'field_date' => array(
+      'predicates' => array(
+        0 => 'schema:startDate',
+      ),
+    ),
+    'url' => array(
+      'predicates' => array(
+        0 => 'schema:url',
+      ),
+      'type' => 'rel',
+    ),
+    'field_location' => array(
+      'predicates' => array(),
+    ),
+    'field_address' => array(
+      'predicates' => array(
+        0 => 'schema:location',
+      ),
+    ),
+  );
+
+  return $schemaorg;
+}
diff --git a/modules/commons/commons_events/commons_events.features.menu_links.inc b/modules/commons/commons_events/commons_events.features.menu_links.inc
new file mode 100644
index 0000000..1b1fc2a
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.features.menu_links.inc
@@ -0,0 +1,37 @@
+<?php
+/**
+ * @file
+ * commons_events.features.menu_links.inc
+ */
+
+/**
+ * Implements hook_menu_default_menu_links().
+ */
+function commons_events_menu_default_menu_links() {
+  $menu_links = array();
+
+  // Exported menu link: main-menu:events
+  $menu_links['main-menu:events'] = array(
+    'menu_name' => 'main-menu',
+    'link_path' => 'events',
+    'router_path' => 'events',
+    'link_title' => 'Events',
+    'options' => array(
+      'attributes' => array(),
+      'identifier' => 'main-menu:events',
+    ),
+    'module' => 'menu',
+    'hidden' => 0,
+    'external' => 0,
+    'has_children' => 0,
+    'expanded' => 0,
+    'weight' => 2,
+    'customized' => 1,
+  );
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Events');
+
+
+  return $menu_links;
+}
diff --git a/modules/commons/commons_events/commons_events.features.og_features_permission.inc b/modules/commons/commons_events/commons_events.features.og_features_permission.inc
new file mode 100644
index 0000000..5f1240b
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.features.og_features_permission.inc
@@ -0,0 +1,52 @@
+<?php
+/**
+ * @file
+ * commons_events.features.og_features_permission.inc
+ */
+
+/**
+ * Implements hook_og_features_default_permissions().
+ */
+function commons_events_og_features_default_permissions() {
+  $permissions = array();
+
+  // Exported og permission: 'node:group:create event content'
+  $permissions['node:group:create event content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any event content'
+  $permissions['node:group:delete any event content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own event content'
+  $permissions['node:group:delete own event content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any event content'
+  $permissions['node:group:update any event content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own event content'
+  $permissions['node:group:update own event content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_events/commons_events.features.user_permission.inc b/modules/commons/commons_events/commons_events.features.user_permission.inc
new file mode 100644
index 0000000..40d60d0
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.features.user_permission.inc
@@ -0,0 +1,94 @@
+<?php
+/**
+ * @file
+ * commons_events.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_events_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'create event content'.
+  $permissions['create event content'] = array(
+    'name' => 'create event content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'create event registration'.
+  $permissions['create event registration'] = array(
+    'name' => 'create event registration',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'registration',
+  );
+
+  // Exported permission: 'delete own event content'.
+  $permissions['delete own event content'] = array(
+    'name' => 'delete own event content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own event registration'.
+  $permissions['delete own event registration'] = array(
+    'name' => 'delete own event registration',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'registration',
+  );
+
+  // Exported permission: 'edit own event content'.
+  $permissions['edit own event content'] = array(
+    'name' => 'edit own event content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'update own event registration'.
+  $permissions['update own event registration'] = array(
+    'name' => 'update own event registration',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'registration',
+  );
+
+  // Exported permission: 'view event registration'.
+  $permissions['view event registration'] = array(
+    'name' => 'view event registration',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'registration',
+  );
+
+  // Exported permission: 'view own event registration'.
+  $permissions['view own event registration'] = array(
+    'name' => 'view own event registration',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'registration',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_events/commons_events.info b/modules/commons/commons_events/commons_events.info
new file mode 100644
index 0000000..cb67595
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.info
@@ -0,0 +1,101 @@
+name = Commons Events
+description = Provides the Event features for Drupal Commons.
+core = 7.x
+package = Commons - Content types
+dependencies[] = addressfield
+dependencies[] = addressfield_tokens
+dependencies[] = block
+dependencies[] = commons_body
+dependencies[] = commons_follow_node
+dependencies[] = commons_groups
+dependencies[] = commons_location
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = date
+dependencies[] = date_api
+dependencies[] = date_popup
+dependencies[] = date_views
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = field_sql_storage
+dependencies[] = image
+dependencies[] = list
+dependencies[] = menu
+dependencies[] = node
+dependencies[] = number
+dependencies[] = og
+dependencies[] = options
+dependencies[] = page_manager
+dependencies[] = radioactivity
+dependencies[] = registration
+dependencies[] = registration_views
+dependencies[] = strongarm
+dependencies[] = taxonomy
+dependencies[] = text
+dependencies[] = views
+dependencies[] = views_content
+dependencies[] = views_load_more
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_base][] = field_date
+features[field_base][] = field_location
+features[field_base][] = field_logo
+features[field_base][] = field_number_of_attendees
+features[field_base][] = field_offsite_url
+features[field_base][] = field_organizers
+features[field_base][] = field_registration
+features[field_base][] = field_registration_type
+features[field_instance][] = node-event-body
+features[field_instance][] = node-event-field_address
+features[field_instance][] = node-event-field_date
+features[field_instance][] = node-event-field_location
+features[field_instance][] = node-event-field_logo
+features[field_instance][] = node-event-field_number_of_attendees
+features[field_instance][] = node-event-field_offsite_url
+features[field_instance][] = node-event-field_organizers
+features[field_instance][] = node-event-field_registration
+features[field_instance][] = node-event-field_registration_type
+features[menu_links][] = main-menu:events
+features[node][] = event
+features[og_features_permission][] = node:group:create event content
+features[og_features_permission][] = node:group:delete any event content
+features[og_features_permission][] = node:group:delete own event content
+features[og_features_permission][] = node:group:update any event content
+features[og_features_permission][] = node:group:update own event content
+features[page_manager_pages][] = views_events_landing_page
+features[registration_type][] = event
+features[schemaorg][] = node-event
+features[user_permission][] = create event content
+features[user_permission][] = create event registration
+features[user_permission][] = delete own event content
+features[user_permission][] = delete own event registration
+features[user_permission][] = edit own event content
+features[user_permission][] = update own event registration
+features[user_permission][] = view event registration
+features[user_permission][] = view own event registration
+features[variable][] = comment_anonymous_event
+features[variable][] = comment_default_mode_event
+features[variable][] = comment_default_per_page_event
+features[variable][] = comment_event
+features[variable][] = comment_form_location_event
+features[variable][] = comment_preview_event
+features[variable][] = comment_subject_field_event
+features[variable][] = field_bundle_settings_node__event
+features[variable][] = menu_options_event
+features[variable][] = menu_parent_event
+features[variable][] = node_options_event
+features[variable][] = node_preview_event
+features[variable][] = node_submitted_event
+features[views_view][] = commons_events_event_attendee_list
+features[views_view][] = commons_events_organizers
+features[views_view][] = commons_events_upcoming
+features[views_view][] = commons_events_user_upcoming_events
+files[] = commons_events.features.inc
+files[] = commons_events.features.field_base.inc
+files[] = commons_events.features.field_instance.inc
+files[] = commons_events.strongarm.inc
+files[] = includes/commons_events.forms.inc
+files[] = includes/commons_events.theme.inc
diff --git a/modules/commons/commons_events/commons_events.install b/modules/commons/commons_events/commons_events.install
new file mode 100644
index 0000000..5e3359a
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.install
@@ -0,0 +1,214 @@
+<?php
+
+/**
+ * Implements hook_install().
+ * Creates a default datetime format for events.
+ */
+function commons_events_install() {
+  db_insert('date_formats')
+    ->fields(array(
+      'format' => 'M d Y, g:ia T',
+      'type' => 'event_datetime',
+      'locked' => 1,
+    ))
+    ->execute();
+
+  db_insert('date_format_type')
+    ->fields(array(
+      'type' => 'event_datetime',
+      'title' => 'Event Datetime',
+      'locked' => 0,
+    ))
+    ->execute();
+
+  variable_set('date_format_event_datetime', 'M d Y, g:ia T');
+}
+
+/**
+ * Disable summary on Event nodes.
+ */
+function commons_events_update_7000() {
+  $revert = array(
+    'commons_events' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Switch attendee view and event logo to use 50x50 image style.
+ */
+function commons_events_update_7001() {
+  $revert = array(
+    'commons_events' => array('views', 'node'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Add the Organizers entity reference field to Events and update existing nodes
+ * with the event's creator as the default value.
+ */
+function commons_events_update_7002() {
+  // Revert node and views to use default implementations. This resets field
+  // weights to configuration due to new Organizers field.
+  $revert = array(
+    'commons_events' => array('node'),
+  );
+  features_revert($revert);
+  if (field_info_field('field_organizers') == NULL) {
+    // Create the field so we can update the default values for existing events.
+    module_load_include('inc', 'commons_events', 'commons_events.features.field_base');
+    $fields = commons_events_field_default_field_bases();
+    field_create_field($fields['field_organizers']);
+  }
+  if (field_info_instance('node', 'field_organizers', 'event') == NULL) {
+    // Create the instance on Events.
+    module_load_include('inc', 'commons_events', 'commons_events.features.field_instance');
+    $instances = commons_events_field_default_field_instances();
+    field_create_instance($instances['node-event-field_organizers']);
+  }
+  // Now update all existing Events to have the creator as the default organizer.
+  $events = new EntityFieldQuery();
+  $events->entityCondition('entity_type', 'node')
+    ->entityCondition('bundle', 'event');
+  $events = $events->execute();
+  $events = entity_load('node', array_keys($events['node']));
+  foreach($events as $nid => $event) {
+    if (!property_exists($event, 'field_organizers') || empty($event->field_organizers)) {
+      $event->field_organizers = array(
+        $event->language => array(
+          0 => array(
+            'target_id' => $event->uid
+          )
+        ),
+      );
+      node_save($event);
+    }
+  }
+  return array();
+}
+
+/**
+ * Change event teaser display to show logo, date, and address.
+ */
+function commons_events_update_7003() {
+  $revert = array(
+    'commons_events' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Create the event_datetime date format.
+ */
+function commons_events_update_7004() {
+  db_insert('date_formats')
+    ->fields(array(
+      'format' => 'M d Y - g:ia T',
+      'type' => 'event_datetime',
+      'locked' => 1,
+    ))
+    ->execute();
+
+  db_insert('date_format_type')
+    ->fields(array(
+      'type' => 'event_datetime',
+      'title' => 'Event Datetime',
+      'locked' => 0,
+    ))
+    ->execute();
+
+  variable_set('date_format_event_datetime', 'M d Y - g:ia T');
+
+  // Revert commons_events to make sure its referencing the event_datetime module.
+  $revert = array(
+    'commons_events' => array('field_instance'),
+    'commons_events' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Set event nodes to use site default country set during install as default.
+ */
+function commons_events_update_7005() {
+  $revert = array(
+    'commons_events' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Upcoming events view pane exposed sort should redirect to the view pane and
+ * not the feed.
+ */
+function commons_events_update_7006() {
+  $revert = array(
+    'commons_events' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Change event displays to abbreviate state names.
+ */
+function commons_events_update_7007() {
+  $revert = array(
+    'commons_events' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/*
+ * Alter the event display formatter, it should be a ',' and not '-'
+ */
+/**
+ * Create the event_datetime date format.
+ */
+function commons_events_update_7008() {
+  db_update('date_formats')
+    ->fields(array(
+      'format' => 'M d Y, g:ia T',
+      'type' => 'event_datetime',
+      'locked' => 1,
+    ))
+    ->condition('format', 'M d Y - g:ia T', '=')
+    ->condition('type', 'event_datetime', '=')
+    ->execute();
+
+  variable_set('date_format_event_datetime', 'M d Y, g:ia T');
+
+  // Revert commons_events to make sure its referencing the event_datetime module.
+  $revert = array(
+    'commons_events' => array('field_instance'),
+    'commons_events' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Need to force update so that Drupal sees the new hook_forms implementation.
+ */
+function commons_events_update_7009() {
+  cache_clear_all('module_implements', 'cache_bootstrap');
+  return array();
+}
+
+/**
+ * Display current events in addition to upcoming events.
+ */
+function commons_events_update_7010() {
+  $revert = array(
+    'commons_events' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_events/commons_events.module b/modules/commons/commons_events/commons_events.module
new file mode 100644
index 0000000..592955a
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.module
@@ -0,0 +1,609 @@
+<?php
+/**
+ * @file
+ * Drupal Commons Events feature.
+ */
+
+include_once 'commons_events.features.inc';
+
+/**
+ * Implements hook_forms().
+ */
+function commons_events_forms($form_id, $args) {
+  // The attend and cancel event forms need to have a dynamic form ID to allow
+  // for multiple forms to be shown on the same page and have them work.
+  foreach (array('commons_events_attend_event_form', 'commons_events_cancel_event_form') as $form) {
+    if (substr($form_id, 0, strlen($form)) == $form) {
+      return array(
+        $form_id => array(
+          'callback' => $form,
+        ),
+      );
+    }
+  }
+}
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_events_menu_alter(&$items) {
+  // Hide the "Register" tab since we expose an "Attend" button.
+  $items['node/%/register']['access callback'] = FALSE;
+}
+
+/**
+ * Access callback for showing the Attendees tab.
+ */
+function commons_events_attendee_access($event_node) {
+  if ($event_node->type == 'event') {
+    return TRUE;
+  }
+  return FALSE;
+}
+
+/**
+ * Page callback for full event attendee listing.
+ */
+function commons_events_event_attendees_page($event_node) {
+  return theme('commons_events_event_attendees',
+    array(
+      'event_nid' => $event_node->nid,
+      'display' => 'full',
+    ));
+}
+
+/**
+ * Implements hook_theme().
+ */
+function commons_events_theme($existing, $type, $theme, $path) {
+  return array(
+    'commons_events_attending_event' => array(
+      'variables' => array(
+        'event' => NULL,
+        'attendee_count' => NULL,
+      ),
+      'file' => '/includes/commons_events.theme.inc',
+    ),
+    'commons_events_event_attendees' => array(
+      'variables' => array(
+        'display' => NULL,
+        'event_nid' => NULL,
+      ),
+      'file' => '/includes/commons_events.theme.inc',
+    ),
+    'commons_events_date_display_range_advanced' => array(
+      'variables' => array(
+        'date1' => NULL,
+        'date2' => NULL,
+        'timezone' => NULL,
+        'dates' => NULL,
+        // HTML attributes that will be applied to both the start and end dates
+        // (unless overridden).
+        'attributes' => array(),
+        // HTML attributes that will be applied to the start date only.
+        'attributes_start' => array(),
+        // HTML attributes that will be applied to the end date only.
+        'attributes_end' => array(),
+        'rdf_mapping' => NULL,
+        'add_rdf' => NULL,
+      ),
+    ),
+    'commons_events_date_display_range_simple' => array(
+      'variables' => array(
+        'date1' => NULL,
+        'date2' => NULL,
+        'timezone' => NULL,
+        'dates' => NULL,
+        // HTML attributes that will be applied to both the start and end dates
+        // (unless overridden).
+        'attributes' => array(),
+        // HTML attributes that will be applied to the start date only.
+        'attributes_start' => array(),
+        // HTML attributes that will be applied to the end date only.
+        'attributes_end' => array(),
+        'rdf_mapping' => NULL,
+        'add_rdf' => NULL,
+      ),
+    ),
+  );
+}
+
+/**
+ * Implements hook_theme_registry_alter().
+ * Gives us the ability to insert our pretty date formatter for the dates we choose below.
+ */
+function commons_events_theme_registry_alter(&$theme_registry) {
+  $theme_registry['date_display_range']['theme path'] = drupal_get_path('module', 'commons_events');
+  $theme_registry['date_display_range']['function'] = 'theme_commons_events_date_display_range_advanced';
+  $theme_registry['date_display_single']['theme path'] = drupal_get_path('module', 'commons_events');
+  $theme_registry['date_display_single']['function'] = 'theme_commons_events_date_display_single';
+}
+
+/**
+ * Implements hook_element_info_alter().
+ */
+function commons_events_element_info_alter(&$type) {
+  // Extend date_combo processing to alter the label text on the fields.
+  if (isset($type['date_combo'])) {
+    $type['date_combo']['#process'][] = 'commons_events_date_combo_element_process';
+  }
+
+  // Extend date_popup processing to remove the redundant descriptions on
+  // fields.
+  if (isset($type['date_popup'])) {
+    $type['date_popup']['#process'][] = 'commons_events_date_popup_element_process';
+  }
+}
+
+/**
+ * Process date_combo field output.
+ *
+ * This is an extension of the Date module's own processing.
+ *
+ * @see date_combo_element_process()
+ * @see commons_events_element_info_alter()
+ */
+function commons_events_date_combo_element_process($element, &$form_state, $form) {
+  $field = field_widget_field($element, $form_state);
+
+  // Change the labels for from and to dates to something more meaningful.
+  if (!empty($field['settings']['todate'])) {
+    $element['value']['#title'] = t('Start date');
+    $element['value2']['#title'] = t('End date');
+  }
+
+  return $element;
+}
+
+/**
+ * Process date_popup field output.
+ *
+ * This is an extension of the Date module's own processing.
+ *
+ * @see date_popup_element_process()
+ * @see commons_events_element_info_alter()
+ */
+function commons_events_date_popup_element_process($element, &$form_state, $form) {
+  // If a date_popup field is part of a larger range widget, simplify the
+  // output.
+  if (!empty($element['#field']['settings']['todate'])) {
+    foreach (array('date', 'time') as $type) {
+      if (!empty($element[$type])) {
+        // The description and title are unnecessary.
+        unset($element[$type]['#description']);
+        $element[$type]['#title'] = '';
+      }
+    }
+  }
+  return $element;
+}
+
+/**
+ * Implements hook_entity_view_alter().
+ */
+function commons_events_entity_view_alter(&$build, $type) {
+  if ($build['#entity_type'] == 'node' && $build['#bundle'] == 'event') {
+
+    $build['attending'] = array(
+      0 => theme('commons_events_attending_event', array('event' => $build['#node'], 'attendee_count' => commons_events_get_raw_attendee_count($build['#node']))),
+      '#weight' => -10,
+    );
+    $vars = array(
+      'event_nid' => $build['#node']->nid,
+    );
+    // Don't show the address if the event location is only online.
+    $field_location = field_view_field('node', $build['#node'], 'field_location');
+    if (isset($field_location['#items']['0']['value']) && $field_location['#items']['0']['value'] == 'online') {
+      unset($build['field_address']);
+    }
+  }
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ */
+function commons_events_form_node_form_alter(&$form, &$form_state) {
+  if ($form_state['node']->type == 'event') {
+    $form['#attached']['css'] = array(
+      drupal_get_path('module', 'commons_events') . '/css/commons_events.css',
+    );
+    $form['#attached']['js'] = array(
+      drupal_get_path('module', 'commons_events') . '/js/commons_events.js',
+    );
+    // Remove the '-None-' option from all the dropdowns.
+    unset($form['field_location'][$form['field_location']['#language']]['#options']['_none']);
+    unset($form['field_registration_type'][$form['field_registration_type']['#language']]['#options']['_none']);
+    // Hide the Registration type field.
+    $form['field_registration']['#disabled'] = commons_events_event_type_disabled($form_state['node']);
+    // Address field should be hidden if event is only online.
+    $form['field_address']['#states'] = array(
+      'invisible' => array(
+        ':input[name^="field_location"]' => array('value' => 'online'),
+      ),
+    );
+    // Status and attendee limit are shown if registration is onsite.
+    $node_registration_status = 1;
+    if (isset($form_state['node']->nid)) {
+      $settings = registration_entity_settings('node', $form_state['node']->nid);
+      $node_registration_status = $settings['status'];
+    }
+    $form['field_status'] = array(
+      '#type' => 'select',
+      '#title' => t('Status'),
+      '#options' => array(
+        1 => t('Open to new attendees'),
+        0 => t('Closed'),
+      ),
+      '#default_value' => $node_registration_status,
+      '#states' => array(
+        'visible' => array(
+          ':input[name^="field_registration_type"]' => array('value' => 'onsite'),
+        ),
+      ),
+      '#weight' => 10,
+    );
+    $form['field_number_of_attendees']['#states'] = $form['field_status']['#states'];
+    $form['field_registration']['#states'] = $form['field_status']['#states'];
+    $form['field_number_of_attendees']['#states']['visible'][':input[name="field_status"]'] = array(
+      'value' => 1,
+    );
+    $form['field_number_of_attendees']['#weight'] = 11;
+    $form['#validate'] = array_merge(array('commons_events_node_form_validate'), $form['#validate']);
+    $form['#submit'][] = 'commons_events_node_form_submit';
+    // Move registration settings into a fieldset so we can move the group.
+    $form['event_registration_settings'] = array(
+      '#type' => 'fieldset',
+      '#collapsible' => TRUE,
+      '#collapsed' => FALSE,
+      '#title' => t('Registration settings'),
+      '#group' => 'additional_settings',
+      '#weight' => -10,
+    );
+    if (empty($form['field_organizers'][$form['field_organizers']['#language']]['#default_value'])) {
+      global $user;
+      $form['field_organizers'][$form['field_organizers']['#language']]['#default_value'] = format_username($user) . " (" . $user->uid . ")";
+    }
+    $form['event_registration_settings']['field_organizers'] = $form['field_organizers'];
+    $form['event_registration_settings']['field_registration_type'] = $form['field_registration_type'];
+    $form['event_registration_settings']['field_status'] = $form['field_status'];
+    $form['event_registration_settings']['field_number_of_attendees'] = $form['field_number_of_attendees'];
+    unset($form['field_registration'][$form['field_registration']['#language']]['0']['registration_type']['#description']);
+    $form['event_registration_settings']['field_registration'] = $form['field_registration'];
+    $form['field_organizers'] = array('#language' => NULL);
+    $form['field_registration_type'] = array('#language' => NULL);
+    $form['field_status'] = array('#language' => NULL);
+    $form['field_number_of_attendees'] = array('#language' => NULL);
+    $form['field_registration'] = array('#language' => NULL);
+  }
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_events_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'event' => array(
+        'is_group_content' => TRUE,
+      ),
+    ),
+  );
+}
+
+/**
+ * Custom node form validation handler.
+ */
+function commons_events_node_form_validate($form, &$form_state) {
+  $lng = (isset($form_state['language']) ? $form_state['language'] : LANGUAGE_NONE);
+  switch ($form_state['values']['field_registration_type'][$lng]['0']['value']) {
+    case 'onsite':
+      // Max attendees must be entered if the registration status is open and
+      // registration is done onsite.
+      if ((int) $form_state['values']['field_status'] == 1
+        && (!is_numeric($form_state['values']['field_number_of_attendees'][$lng]['0']['value']))) {
+          form_set_error('field_number_of_attendees',
+            t('Maximum number of attendees must be set for registrations to be accepted.'));
+          return FALSE;
+        }
+      break;
+  }
+  return TRUE;
+}
+
+/**
+ * Custom node form submit handler.
+ */
+function commons_events_node_form_submit($form, $form_state) {
+  $node = $form_state['node'];
+  $lng = (isset($form_state['language']) ? $form_state['language'] : LANGUAGE_NONE);
+  if (isset($node->nid)) {
+    $settings = registration_entity_settings('node', $node->nid);
+    $settings['status'] = (int) $form_state['values']['field_status'];
+    if ($form_state['values']['field_registration_type'][$lng]['0']['value'] == 'external') {
+      $settings['status'] = 0;
+    }
+    if (!empty($form_state['values']['field_number_of_attendees'][$lng]['0']['value'])
+      && is_numeric($form_state['values']['field_number_of_attendees'][$lng]['0']['value'])) {
+      $settings['capacity'] = (int) $form_state['values']['field_number_of_attendees'][$lng]['0']['value'];
+    }
+    $settings['settings'] = serialize($settings['settings']);
+    registration_update_entity_settings('node', $node->nid, $settings);
+    // Automatically register the node creator for the event.
+    $registration_type = registration_get_entity_registration_type('node', $node);
+    $registration = entity_get_controller('registration')->create(array(
+      'entity_type' => 'node',
+      'entity_id' => $node->nid,
+      'type' => $registration_type,
+    ));
+    if (!isset($node->uid)) {
+      global $user;
+      $uid = $user->uid;
+    }
+    else {
+      $uid = $node->uid;
+    }
+    if ($settings['status'] == 1
+      && !registration_is_registered($registration, NULL, $uid)) {
+      $registration->user_uid = $uid;
+      $registration->author_uid = $uid;
+      $registration->state = NULL;
+      $registration->count = 1;
+      registration_save($registration);
+    }
+  }
+}
+
+/**
+ * Implements hook_token_info().
+ */
+function commons_events_token_info_alter(&$tokens) {
+  $tokens['tokens']['node']['attend-form'] = array(
+    'name' => t('Attending event form'),
+    'description' => t('Displays the appropriate form for attending or cancelling event attendance'),
+  );
+}
+
+/**
+ * Implements hook_commons_bw_create_all_widget().
+ */
+function commons_events_commons_bw_create_all_widget($group) {
+  if (og_user_access('node', $group->nid, 'create event content')) {
+    $link = l(t('List an event'),'node/add/event',
+      array('attributes' => array('class' => 'commons-events-create'), 'query' => array('og_group_ref' => $group->nid))
+    );
+    return array(
+      'commons_events' => array(
+        'link' => $link,
+        'text' => t('Create in-person or online meetups'),
+        '#weight' => 6,
+      ),
+    );
+  }
+}
+
+/**
+ * Implements hook_tokens().
+ */
+function commons_events_tokens($type, $tokens, array $data = array(), array $options = array()) {
+  $replacements = array();
+  if ($type == 'node' && !empty($data['node'])) {
+    $event = $data['node'];
+    foreach ($tokens as $name => $original) {
+      if ($name == 'attend-form') {
+        $replacements[$original] = theme('commons_events_attending_event', array('event' => $event, 'attendee_count' => commons_events_get_raw_attendee_count($event)));
+      }
+    }
+  }
+  return $replacements;
+}
+
+/**
+ * Generates the 'more' link for upcoming events in a specific group.
+ */
+function commons_events_upcoming_more_link($group_id) {
+  if (module_exists('commons_events_solr')) {
+    $options = array(
+      'query' => array(
+        'f[1]' => 'sm_og_group_ref:node:' . $group_id,
+      ),
+    );
+    return l(t('more'), 'events', $options);
+  }
+  $options = array(
+    'query' => array(
+      'gid' => $group_id,
+    ),
+  );
+  return l(t('more'), 'events', $options);
+}
+
+/**
+ * Implements hook_views_post_execute().
+ */
+function commons_events_views_post_execute(&$view) {
+  if ($view->name == 'commons_events_upcoming'
+    && $view->current_display == 'panel_pane_1') {
+    $view->attachment_after = '<div class="more-link">' . commons_events_upcoming_more_link($view->args[0]) . '</div>';
+  }
+  else if ($view->name == 'commons_events_upcoming'
+    && $view->current_display == 'panel_pane_2') {
+    $view->attachment_before = '<div class="commons-event-count">' . format_plural(count($view->result), '1 event', '@count events') . '</div>';
+  }
+}
+
+/**
+ * Implements hook_block_info().
+ */
+function commons_events_block_info() {
+  $blocks = array(
+    'commons_events_create_event_link' => array(
+      'info' => t('"Create an event" call to action'),
+      'cache' => DRUPAL_CACHE_GLOBAL,
+    ),
+    'commons_events_anonymous_login' => array(
+      'info' => t('"Login to create an event" call to action'),
+      'cache' => DRUPAL_CACHE_GLOBAL,
+    ),
+  );
+  return $blocks;
+}
+
+/**
+ * Implements hook_block_view().
+ */
+function commons_events_block_view($delta = '') {
+  global $user;
+  if ($delta == 'commons_events_create_event_link'
+    && node_access('create', 'event')) {
+    $options = array(
+      'query' => array(
+        'destination' => 'events',
+      ),
+    );
+    return array(
+      'subject' => NULL,
+      'content' => l(t('List an event'), 'node/add/event', $options),
+    );
+  }
+  else if ($delta == 'commons_events_anonymous_login'
+    && empty($user->uid)) {
+    return array(
+      'subject' => NULL,
+      'content' => t('You must !login in order to list events.', array('!login' => l(t('log in'), 'user'))),
+    );
+  }
+}
+
+/**
+ * Returns specific HTML for a date element formatted with the event formatter M j Y - g:ia.
+ * We the do some awesome stuff with regular expressions to take all the
+ * different formats available to us and format it pretty.
+ */
+function theme_commons_events_date_display_range_simple($variables) {
+  // Use the regular date formatter if we are any other date format than below.
+  $date1 = $variables['dates']['value']['formatted_date'];
+  $date2 = $variables['dates']['value2']['formatted_date'];
+  $time1 = $variables['dates']['value']['formatted_time'];
+  $time2 = $variables['dates']['value2']['formatted_time'];
+
+  $timezone = $variables['timezone'];
+  $attributes_start = $variables['attributes_start'];
+  $attributes_end = $variables['attributes_end'];
+
+  if($date1 == $date2) {
+    // Wrap the result with the attributes.
+    return t('!start-time - !end-time', array(
+      '!start-time' => '<span class="date-display-start"' . drupal_attributes($attributes_start) . '>' . $time1 . '</span>',
+      '!end-time' => '<span class="date-display-end"' . drupal_attributes($attributes_end) . '>' . $time2 . $timezone . '</span>',
+    ));
+  }
+
+  // Wrap the result with the attributes.
+  return t('!start-date to !end-date, !start-time - !end-time', array(
+    '!start-date' => '<span class="date-display-start"' . drupal_attributes($attributes_start) . '>' . $date1 . '</span>',
+    '!end-date' => '<span class="date-display-end"' . drupal_attributes($attributes_end) . '>' . $date2 . '</span>',
+    '!start-time' => '<span class="date-display-start"' . drupal_attributes($attributes_start) . '>' . $time1 . '</span>',
+    '!end-time' => '<span class="date-display-end"' . drupal_attributes($attributes_end) . '>' . $time2 . $timezone . '</span>',
+  ));
+}
+
+function theme_commons_events_date_display_single($variables) {
+  return $variables['date'];
+}
+/**
+ * Returns specific HTML for a date element formatted with the event formatter.
+ * We parse the date segments and return it at the bottom, or use the simple
+ * formatter (above) if parts of the date are too complicated.
+ */
+function theme_commons_events_date_display_range_advanced($variables) {
+  $timezone = $variables['timezone'];
+  $attributes_start = $variables['attributes_start'];
+  $attributes_end = $variables['attributes_end'];
+
+  // Time is always formatted the same.
+  $time1 = $variables['dates']['value']['formatted_time'];
+  $time2 = $variables['dates']['value2']['formatted_time'];
+
+  // See date.theme line 168 -- regarding formatting time for same date events.
+  if ($variables['dates']['value']['formatted_date'] === $variables['dates']['value2']['formatted_date']) {
+    return theme('commons_events_date_display_range_simple',$variables);
+  }
+  // If the difference is over a year, use the simple formatter.
+  if ($variables['dates']['value']['db']['object']->difference($variables['dates']['value2']['db']['object'], 'years') > 0) {
+    return theme('commons_events_date_display_range_simple',$variables);
+  }
+  else if ($variables['dates']['value']['db']['object']->difference($variables['dates']['value2']['db']['object'], 'months') > 0) {
+    $variables['dates']['value']['db']['object']->limitGranularity(array('day','month'));
+    $variables['dates']['value2']['db']['object']->limitGranularity(array('day','month', 'year'));
+
+    $date1 = $variables['dates']['value']['db']['object']->format($variables['dates']['format'],FALSE);
+    $date2 = $variables['dates']['value2']['db']['object']->format($variables['dates']['format'],FALSE);
+  }
+  else if ($variables['dates']['value']['db']['object']->difference($variables['dates']['value2']['db']['object'], 'days') > 0) {
+    // If the Day is before the month (Europe, etc) then switch the granularity.
+    if (strpos($variables['dates']['format'],'M') != 0 || strpos($variables['dates']['format'],'m') != 0 ||
+       strpos($variables['dates']['format'],'F') != 0 || strpos($variables['dates']['format'],'n') != 0) {
+      $variables['dates']['value']['db']['object']->limitGranularity(array('day'));
+      $variables['dates']['value2']['db']['object']->limitGranularity(array('day', 'month', 'year'));
+    } else {
+      $variables['dates']['value']['db']['object']->limitGranularity(array('month','day'));
+      $variables['dates']['value2']['db']['object']->limitGranularity(array('day', 'year'));
+    }
+
+    $date1 = $variables['dates']['value']['db']['object']->format($variables['dates']['format'],FALSE);
+    $date2 = $variables['dates']['value2']['db']['object']->format($variables['dates']['format'],FALSE);
+
+    // If we are match 'D' or 'l', then we have a 'day' in there (eg Monday),
+    // we want the whole date because it looks funky otherwise.
+    if (strpbrk($variables['dates']['format'], 'Dl')) {
+      return theme('commons_events_date_display_range_simple',$variables);
+    }
+  }
+  else {
+    return theme('commons_events_date_display_range_simple',$variables);
+  }
+  // Wrap the result with the attributes.
+  return t('!start-date to !end-date, !start-time - !end-time', array(
+    '!start-date' => '<span class="date-display-start"' . drupal_attributes($attributes_start) . '>' . $date1 . '</span>',
+    '!end-date' => '<span class="date-display-end"' . drupal_attributes($attributes_end) . '>' . $date2 . '</span>',
+    '!start-time' => '<span class="date-display-start"' . drupal_attributes($attributes_start) . '>' . $time1 . '</span>',
+    '!end-time' => '<span class="date-display-end"' . drupal_attributes($attributes_end) . '>' . $time2 . $timezone . '</span>',
+  ));
+}
+
+/**
+ * Check whether to allow switching the event's registration type.
+ * If there are registrations for the event, disallow changing the type. This
+ * keeps registrations for an event consistent.
+ */
+function commons_events_event_type_disabled($node) {
+  if (!isset($node->nid) || empty($node->nid)) {
+    return FALSE;
+  }
+  $registrations = db_select('registration', 'r')
+    ->fields('r')
+    ->condition('entity_type', 'node')
+    ->condition('entity_id', $node->nid)
+    ->countQuery()
+    ->execute()
+    ->fetchCol();
+  if ($registrations[0] > 0) {
+    return TRUE;
+  }
+  return FALSE;
+}
+
+/**
+ * Helper function go get the raw number of attendees.
+ */
+function commons_events_get_raw_attendee_count($node) {
+  $attendee_count = db_select('registration', 'r')
+    ->fields('r')
+    ->condition('entity_id', $node->nid)
+    ->condition('entity_type', 'node')
+    ->countQuery()
+    ->execute()
+    ->fetchField();
+
+  return $attendee_count;
+}
\ No newline at end of file
diff --git a/modules/commons/commons_events/commons_events.pages_default.inc b/modules/commons/commons_events/commons_events.pages_default.inc
new file mode 100644
index 0000000..659bc2e
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.pages_default.inc
@@ -0,0 +1,193 @@
+<?php
+/**
+ * @file
+ * commons_events.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_pages().
+ */
+function commons_events_default_page_manager_pages() {
+  $page = new stdClass();
+  $page->disabled = FALSE; /* Edit this to true to make a default page disabled initially */
+  $page->api_version = 1;
+  $page->name = 'views_events_landing_page';
+  $page->task = 'page';
+  $page->admin_title = 'Views Events Landing Page';
+  $page->admin_description = '';
+  $page->path = 'events';
+  $page->access = array(
+    'type' => 'none',
+    'settings' => NULL,
+  );
+  $page->menu = array();
+  $page->arguments = array();
+  $page->conf = array(
+    'admin_paths' => FALSE,
+  );
+  $page->default_handlers = array();
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'page_views_events_landing_page_panel_context';
+  $handler->task = 'page';
+  $handler->subtask = 'views_events_landing_page';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'Panel',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = 'Events';
+  $display->uuid = 'f084cd6c-0d66-7ca4-c971-3c5cf182d2ec';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-e72884a7-369b-1954-2d1f-d69207c4d6ff';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_upcoming-panel_pane_2';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'e72884a7-369b-1954-2d1f-d69207c4d6ff';
+    $display->content['new-e72884a7-369b-1954-2d1f-d69207c4d6ff'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-e72884a7-369b-1954-2d1f-d69207c4d6ff';
+    $pane = new stdClass();
+    $pane->pid = 'new-b91ad246-669c-2e14-fd32-5728153b0ed8';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'block';
+    $pane->subtype = 'commons_events-commons_events_create_event_link';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'b91ad246-669c-2e14-fd32-5728153b0ed8';
+    $display->content['new-b91ad246-669c-2e14-fd32-5728153b0ed8'] = $pane;
+    $display->panels['two_66_33_second'][0] = 'new-b91ad246-669c-2e14-fd32-5728153b0ed8';
+    $pane = new stdClass();
+    $pane->pid = 'new-d776b637-24a9-7e74-712c-8bc27d399c3e';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'block';
+    $pane->subtype = 'commons_events-commons_events_anonymous_login';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = 'd776b637-24a9-7e74-712c-8bc27d399c3e';
+    $display->content['new-d776b637-24a9-7e74-712c-8bc27d399c3e'] = $pane;
+    $display->panels['two_66_33_second'][1] = 'new-d776b637-24a9-7e74-712c-8bc27d399c3e';
+    $pane = new stdClass();
+    $pane->pid = 'new-9118fc7d-3da5-cf54-5152-5d66043812b2';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_user_upcoming_events-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = '9118fc7d-3da5-cf54-5152-5d66043812b2';
+    $display->content['new-9118fc7d-3da5-cf54-5152-5d66043812b2'] = $pane;
+    $display->panels['two_66_33_second'][2] = 'new-9118fc7d-3da5-cf54-5152-5d66043812b2';
+    $pane = new stdClass();
+    $pane->pid = 'new-ef7caf29-a6a8-e654-5997-6b969eba407a';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_user_upcoming_events-panel_pane_2';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 3;
+    $pane->locks = array();
+    $pane->uuid = 'ef7caf29-a6a8-e654-5997-6b969eba407a';
+    $display->content['new-ef7caf29-a6a8-e654-5997-6b969eba407a'] = $pane;
+    $display->panels['two_66_33_second'][3] = 'new-ef7caf29-a6a8-e654-5997-6b969eba407a';
+    $pane = new stdClass();
+    $pane->pid = 'new-80f087dc-fe84-7354-e19b-23e398080db9';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_user_upcoming_events-panel_pane_3';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 4;
+    $pane->locks = array();
+    $pane->uuid = '80f087dc-fe84-7354-e19b-23e398080db9';
+    $display->content['new-80f087dc-fe84-7354-e19b-23e398080db9'] = $pane;
+    $display->panels['two_66_33_second'][4] = 'new-80f087dc-fe84-7354-e19b-23e398080db9';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = 'new-9118fc7d-3da5-cf54-5152-5d66043812b2';
+  $handler->conf['display'] = $display;
+  $page->default_handlers[$handler->name] = $handler;
+  $pages['views_events_landing_page'] = $page;
+
+  return $pages;
+
+}
diff --git a/modules/commons/commons_events/commons_events.strongarm.inc b/modules/commons/commons_events/commons_events.strongarm.inc
new file mode 100644
index 0000000..a613917
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.strongarm.inc
@@ -0,0 +1,147 @@
+<?php
+/**
+ * @file
+ * commons_events.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_events_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_event';
+  $strongarm->value = 0;
+  $export['comment_anonymous_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_event';
+  $strongarm->value = 1;
+  $export['comment_default_mode_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_event';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_event';
+  $strongarm->value = '2';
+  $export['comment_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_event';
+  $strongarm->value = 1;
+  $export['comment_form_location_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_event';
+  $strongarm->value = '1';
+  $export['comment_preview_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_event';
+  $strongarm->value = 1;
+  $export['comment_subject_field_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__event';
+  $strongarm->value = array(
+    'view_modes' => array(
+      'teaser' => array(
+        'custom_settings' => TRUE,
+      ),
+      'full' => array(
+        'custom_settings' => FALSE,
+      ),
+      'rss' => array(
+        'custom_settings' => FALSE,
+      ),
+      'search_index' => array(
+        'custom_settings' => FALSE,
+      ),
+      'search_result' => array(
+        'custom_settings' => FALSE,
+      ),
+      'token' => array(
+        'custom_settings' => FALSE,
+      ),
+    ),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '0',
+        ),
+        'metatags' => array(
+          'weight' => '15',
+        ),
+        'path' => array(
+          'weight' => '14',
+        ),
+        'redirect' => array(
+          'weight' => '13',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_event';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_event';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_event';
+  $strongarm->value = array(
+    0 => 'status',
+  );
+  $export['node_options_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_event';
+  $strongarm->value = '1';
+  $export['node_preview_event'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_event';
+  $strongarm->value = 1;
+  $export['node_submitted_event'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/commons_events.views_default.inc b/modules/commons/commons_events/commons_events.views_default.inc
new file mode 100644
index 0000000..539a764
--- /dev/null
+++ b/modules/commons/commons_events/commons_events.views_default.inc
@@ -0,0 +1,782 @@
+<?php
+/**
+ * @file
+ * commons_events.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_events_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_events_event_attendee_list';
+  $view->description = 'List attendees for a given event.';
+  $view->tag = 'commons_events';
+  $view->base_table = 'registration';
+  $view->human_name = 'Commons Events - Event Attendee List';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Attendees';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '4';
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: Registration: Registration to Node */
+  $handler->display->display_options['relationships']['registration_related_node']['id'] = 'registration_related_node';
+  $handler->display->display_options['relationships']['registration_related_node']['table'] = 'registration';
+  $handler->display->display_options['relationships']['registration_related_node']['field'] = 'registration_related_node';
+  /* Relationship: Registration: User */
+  $handler->display->display_options['relationships']['user_uid']['id'] = 'user_uid';
+  $handler->display->display_options['relationships']['user_uid']['table'] = 'registration';
+  $handler->display->display_options['relationships']['user_uid']['field'] = 'user_uid';
+  $handler->display->display_options['relationships']['user_uid']['required'] = TRUE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['relationship'] = 'user_uid';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50';
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'user_uid';
+  $handler->display->display_options['fields']['name']['label'] = '';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Contextual filter: Content: Nid */
+  $handler->display->display_options['arguments']['nid']['id'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['table'] = 'node';
+  $handler->display->display_options['arguments']['nid']['field'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['relationship'] = 'registration_related_node';
+  $handler->display->display_options['arguments']['nid']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['nid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['nid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['nid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['nid']['summary_options']['items_per_page'] = '25';
+
+  /* Display: Full Attendee List Block */
+  $handler = $view->new_display('block', 'Full Attendee List Block', 'commons_events_full_attendee_list');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'none';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['allow']['use_pager'] = 'use_pager';
+  $handler->display->display_options['allow']['items_per_page'] = 'items_per_page';
+  $handler->display->display_options['allow']['offset'] = 'offset';
+  $handler->display->display_options['allow']['link_to_view'] = 0;
+  $handler->display->display_options['allow']['more_link'] = 0;
+  $handler->display->display_options['allow']['path_override'] = 0;
+  $handler->display->display_options['allow']['title_override'] = 0;
+  $handler->display->display_options['allow']['exposed_form'] = 0;
+  $handler->display->display_options['allow']['fields_override'] = 0;
+  $handler->display->display_options['argument_input'] = array(
+    'null' => array(
+      'type' => 'fixed',
+      'context' => 'entity:comment.author',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => 'node',
+      'label' => 'Global: Null',
+    ),
+    'nid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'Content: Nid',
+    ),
+  );
+  $translatables['commons_events_event_attendee_list'] = array(
+    t('Master'),
+    t('Attendees'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('node from Registration'),
+    t('User'),
+    t('All'),
+    t('Full Attendee List Block'),
+    t('Content pane'),
+    t('View panes'),
+  );
+  $export['commons_events_event_attendee_list'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_events_organizers';
+  $view->description = 'Event organizer panel pane.';
+  $view->tag = 'commons_events';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Events - Organizers';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Organizers';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'none';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: Entity Reference: Referenced Entity */
+  $handler->display->display_options['relationships']['field_organizers_target_id']['id'] = 'field_organizers_target_id';
+  $handler->display->display_options['relationships']['field_organizers_target_id']['table'] = 'field_data_field_organizers';
+  $handler->display->display_options['relationships']['field_organizers_target_id']['field'] = 'field_organizers_target_id';
+  $handler->display->display_options['relationships']['field_organizers_target_id']['required'] = TRUE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['relationship'] = 'field_organizers_target_id';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50';
+  /* Contextual filter: Content: Nid */
+  $handler->display->display_options['arguments']['nid']['id'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['table'] = 'node';
+  $handler->display->display_options['arguments']['nid']['field'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['default_action'] = 'not found';
+  $handler->display->display_options['arguments']['nid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['nid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['nid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['nid']['summary_options']['items_per_page'] = '25';
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['argument_input'] = array(
+    'nid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'Content: Nid',
+    ),
+  );
+  $translatables['commons_events_organizers'] = array(
+    t('Master'),
+    t('Organizers'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('User entity referenced from field_organizers'),
+    t('All'),
+    t('Content pane'),
+    t('View panes'),
+  );
+  $export['commons_events_organizers'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_events_upcoming';
+  $view->description = 'Display upcoming events site-wide, or per-group.';
+  $view->tag = 'commons_events';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Events - Upcoming Events';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Events';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '5';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Date */
+  $handler->display->display_options['fields']['field_date']['id'] = 'field_date';
+  $handler->display->display_options['fields']['field_date']['table'] = 'field_data_field_date';
+  $handler->display->display_options['fields']['field_date']['field'] = 'field_date';
+  $handler->display->display_options['fields']['field_date']['label'] = '';
+  $handler->display->display_options['fields']['field_date']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_date']['settings'] = array(
+    'format_type' => 'event_datetime',
+    'fromto' => 'both',
+    'multiple_number' => '',
+    'multiple_from' => '',
+    'multiple_to' => '',
+  );
+  /* Field: Registration Settings: Spaces used */
+  $handler->display->display_options['fields']['capacity_used']['id'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['table'] = 'node';
+  $handler->display->display_options['fields']['capacity_used']['field'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['label'] = '';
+  $handler->display->display_options['fields']['capacity_used']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['capacity_used']['separator'] = '';
+  $handler->display->display_options['fields']['capacity_used']['suffix'] = ' attendees';
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['alter']['text'] = '[comment_count] comments';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  /* Sort criterion: Content: Date -  start date (field_date) */
+  $handler->display->display_options['sorts']['field_date_value']['id'] = 'field_date_value';
+  $handler->display->display_options['sorts']['field_date_value']['table'] = 'field_data_field_date';
+  $handler->display->display_options['sorts']['field_date_value']['field'] = 'field_date_value';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'event' => 'event',
+  );
+  /* Filter criterion: Content: Date -  start date (field_date) */
+  $handler->display->display_options['filters']['field_date_value']['id'] = 'field_date_value';
+  $handler->display->display_options['filters']['field_date_value']['table'] = 'field_data_field_date';
+  $handler->display->display_options['filters']['field_date_value']['field'] = 'field_date_value';
+  $handler->display->display_options['filters']['field_date_value']['operator'] = '>=';
+  $handler->display->display_options['filters']['field_date_value']['form_type'] = 'date_text';
+  $handler->display->display_options['filters']['field_date_value']['default_date'] = 'now';
+
+  /* Display: Feed */
+  $handler = $view->new_display('feed', 'Feed', 'feed');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['style_plugin'] = 'rss';
+  $handler->display->display_options['row_plugin'] = 'node_rss';
+  $handler->display->display_options['path'] = 'events-upcoming.xml';
+  $handler->display->display_options['displays'] = array(
+    'default' => 'default',
+    'page' => 'page',
+  );
+
+  /* Display: Global Block */
+  $handler = $view->new_display('block', 'Global Block', 'commons_events_upcoming_global_block');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'Upcoming events';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '5';
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+
+  /* Display: Group pane */
+  $handler = $view->new_display('panel_pane', 'Group pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'Upcoming events';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '3';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['row_options']['inline'] = array(
+    'capacity_used' => 'capacity_used',
+    'comment_count' => 'comment_count',
+  );
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['defaults']['relationships'] = FALSE;
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Date */
+  $handler->display->display_options['fields']['field_date']['id'] = 'field_date';
+  $handler->display->display_options['fields']['field_date']['table'] = 'field_data_field_date';
+  $handler->display->display_options['fields']['field_date']['field'] = 'field_date';
+  $handler->display->display_options['fields']['field_date']['label'] = '';
+  $handler->display->display_options['fields']['field_date']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_date']['settings'] = array(
+    'format_type' => 'event_datetime',
+    'fromto' => 'both',
+    'multiple_number' => '',
+    'multiple_from' => '',
+    'multiple_to' => '',
+  );
+  /* Field: Registration Settings: Spaces used */
+  $handler->display->display_options['fields']['capacity_used']['id'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['table'] = 'node';
+  $handler->display->display_options['fields']['capacity_used']['field'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['label'] = '';
+  $handler->display->display_options['fields']['capacity_used']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['capacity_used']['separator'] = '';
+  $handler->display->display_options['fields']['capacity_used']['suffix'] = ' attendees,';
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['alter']['text'] = '[comment_count] comments';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  $handler->display->display_options['defaults']['arguments'] = FALSE;
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['argument_input'] = array(
+    'gid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'OG membership: Group ID',
+    ),
+  );
+
+  /* Display: Landing Page pane */
+  $handler = $view->new_display('panel_pane', 'Landing Page pane', 'panel_pane_2');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['exposed_form'] = FALSE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['exposed_form']['options']['expose_sort_order'] = FALSE;
+  $handler->display->display_options['exposed_form']['options']['autosubmit'] = TRUE;
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'node';
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['defaults']['header'] = FALSE;
+  $handler->display->display_options['defaults']['sorts'] = FALSE;
+  /* Sort criterion: Content: Promoted to front page */
+  $handler->display->display_options['sorts']['promote']['id'] = 'promote';
+  $handler->display->display_options['sorts']['promote']['table'] = 'node';
+  $handler->display->display_options['sorts']['promote']['field'] = 'promote';
+  $handler->display->display_options['sorts']['promote']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['promote']['expose']['label'] = 'Featured';
+  /* Sort criterion: Content: Date -  start date (field_date) */
+  $handler->display->display_options['sorts']['field_date_value']['id'] = 'field_date_value';
+  $handler->display->display_options['sorts']['field_date_value']['table'] = 'field_data_field_date';
+  $handler->display->display_options['sorts']['field_date_value']['field'] = 'field_date_value';
+  $handler->display->display_options['sorts']['field_date_value']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['field_date_value']['expose']['label'] = 'Date';
+  $handler->display->display_options['inherit_panels_path'] = '1';
+  $translatables['commons_events_upcoming'] = array(
+    t('Master'),
+    t('Events'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('.'),
+    t(' attendees'),
+    t('[comment_count] comments'),
+    t(','),
+    t('Feed'),
+    t('Global Block'),
+    t('Upcoming events'),
+    t('Group pane'),
+    t('OG membership from node'),
+    t(' attendees,'),
+    t('All'),
+    t('Commons'),
+    t('Landing Page pane'),
+    t('Featured'),
+    t('Date'),
+    t('View panes'),
+  );
+  $export['commons_events_upcoming'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_events_user_upcoming_events';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Events - User Upcoming Events';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'role';
+  $handler->display->display_options['access']['role'] = array(
+    2 => '2',
+  );
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '2';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'You are not attending any upcoming events.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Registration: Node to Registration */
+  $handler->display->display_options['relationships']['registration_rel']['id'] = 'registration_rel';
+  $handler->display->display_options['relationships']['registration_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['registration_rel']['field'] = 'registration_rel';
+  $handler->display->display_options['relationships']['registration_rel']['required'] = TRUE;
+  /* Relationship: Registration: User */
+  $handler->display->display_options['relationships']['user_uid']['id'] = 'user_uid';
+  $handler->display->display_options['relationships']['user_uid']['table'] = 'registration';
+  $handler->display->display_options['relationships']['user_uid']['field'] = 'user_uid';
+  $handler->display->display_options['relationships']['user_uid']['relationship'] = 'registration_rel';
+  $handler->display->display_options['relationships']['user_uid']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Contextual filter: Registration: User */
+  $handler->display->display_options['arguments']['user_uid']['id'] = 'user_uid';
+  $handler->display->display_options['arguments']['user_uid']['table'] = 'registration';
+  $handler->display->display_options['arguments']['user_uid']['field'] = 'user_uid';
+  $handler->display->display_options['arguments']['user_uid']['relationship'] = 'registration_rel';
+  $handler->display->display_options['arguments']['user_uid']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['user_uid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['user_uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['user_uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['user_uid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'event' => 'event',
+  );
+
+  /* Display: Block */
+  $handler = $view->new_display('block', 'Block', 'block');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+
+  /* Display: You're attending - pane */
+  $handler = $view->new_display('panel_pane', 'You\'re attending - pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'You\'re attending';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['row_options']['inline'] = array(
+    'capacity_used' => 'capacity_used',
+    'comment_count' => 'comment_count',
+  );
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['defaults']['empty'] = FALSE;
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Address */
+  $handler->display->display_options['fields']['field_address']['id'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['table'] = 'field_data_field_address';
+  $handler->display->display_options['fields']['field_address']['field'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['label'] = '';
+  $handler->display->display_options['fields']['field_address']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_address']['click_sort_column'] = 'country';
+  $handler->display->display_options['fields']['field_address']['settings'] = array(
+    'use_widget_handlers' => 1,
+    'format_handlers' => array(
+      'address' => 'address',
+    ),
+  );
+  /* Field: Registration Settings: Spaces used */
+  $handler->display->display_options['fields']['capacity_used']['id'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['table'] = 'node';
+  $handler->display->display_options['fields']['capacity_used']['field'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['label'] = '';
+  $handler->display->display_options['fields']['capacity_used']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['capacity_used']['alter']['text'] = '<strong>[capacity_used]</strong> attendees,';
+  $handler->display->display_options['fields']['capacity_used']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['capacity_used']['separator'] = '';
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['alter']['text'] = '<strong>[comment_count]</strong> comments';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['comment_count']['separator'] = '';
+  $handler->display->display_options['defaults']['arguments'] = FALSE;
+  /* Contextual filter: Registration: User */
+  $handler->display->display_options['arguments']['user_uid']['id'] = 'user_uid';
+  $handler->display->display_options['arguments']['user_uid']['table'] = 'registration';
+  $handler->display->display_options['arguments']['user_uid']['field'] = 'user_uid';
+  $handler->display->display_options['arguments']['user_uid']['relationship'] = 'registration_rel';
+  $handler->display->display_options['arguments']['user_uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['user_uid']['default_argument_type'] = 'current_user';
+  $handler->display->display_options['arguments']['user_uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['user_uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['user_uid']['summary_options']['items_per_page'] = '25';
+
+  /* Display: You created - pane */
+  $handler = $view->new_display('panel_pane', 'You created - pane', 'panel_pane_2');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'You created';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['row_options']['inline'] = array(
+    'capacity_used' => 'capacity_used',
+    'comment_count' => 'comment_count',
+  );
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['defaults']['empty'] = FALSE;
+  $handler->display->display_options['defaults']['relationships'] = FALSE;
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Address */
+  $handler->display->display_options['fields']['field_address']['id'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['table'] = 'field_data_field_address';
+  $handler->display->display_options['fields']['field_address']['field'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['label'] = '';
+  $handler->display->display_options['fields']['field_address']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_address']['click_sort_column'] = 'country';
+  $handler->display->display_options['fields']['field_address']['settings'] = array(
+    'use_widget_handlers' => 1,
+    'format_handlers' => array(
+      'address' => 'address',
+    ),
+  );
+  /* Field: Registration Settings: Spaces used */
+  $handler->display->display_options['fields']['capacity_used']['id'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['table'] = 'node';
+  $handler->display->display_options['fields']['capacity_used']['field'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['label'] = '';
+  $handler->display->display_options['fields']['capacity_used']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['capacity_used']['alter']['text'] = '<strong>[capacity_used]</strong> attendees,';
+  $handler->display->display_options['fields']['capacity_used']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['capacity_used']['separator'] = '';
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['alter']['text'] = '<strong>[comment_count]</strong> comments';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['comment_count']['separator'] = '';
+  $handler->display->display_options['defaults']['arguments'] = FALSE;
+  /* Contextual filter: Content: Author uid */
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'node';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'current_user';
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+
+  /* Display: You follow - pane */
+  $handler = $view->new_display('panel_pane', 'You follow - pane', 'panel_pane_3');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'You follow';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['row_options']['inline'] = array(
+    'capacity_used' => 'capacity_used',
+    'comment_count' => 'comment_count',
+  );
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['defaults']['empty'] = FALSE;
+  $handler->display->display_options['defaults']['relationships'] = FALSE;
+  /* Relationship: Flags: commons_follow_node */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_node';
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Address */
+  $handler->display->display_options['fields']['field_address']['id'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['table'] = 'field_data_field_address';
+  $handler->display->display_options['fields']['field_address']['field'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['label'] = '';
+  $handler->display->display_options['fields']['field_address']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_address']['click_sort_column'] = 'country';
+  $handler->display->display_options['fields']['field_address']['settings'] = array(
+    'use_widget_handlers' => 1,
+    'format_handlers' => array(
+      'address' => 'address',
+    ),
+  );
+  /* Field: Registration Settings: Spaces used */
+  $handler->display->display_options['fields']['capacity_used']['id'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['table'] = 'node';
+  $handler->display->display_options['fields']['capacity_used']['field'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['label'] = '';
+  $handler->display->display_options['fields']['capacity_used']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['capacity_used']['alter']['text'] = '<strong>[capacity_used]</strong> attendees,';
+  $handler->display->display_options['fields']['capacity_used']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['capacity_used']['separator'] = '';
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['alter']['text'] = '<strong>[comment_count]</strong> comments';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['comment_count']['separator'] = '';
+  $handler->display->display_options['defaults']['arguments'] = FALSE;
+  $translatables['commons_events_user_upcoming_events'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('You are not attending any upcoming events.'),
+    t('node being the Registration'),
+    t('User'),
+    t('All'),
+    t('Block'),
+    t('You\'re attending - pane'),
+    t('You\'re attending'),
+    t('<strong>[capacity_used]</strong> attendees,'),
+    t('.'),
+    t('<strong>[comment_count]</strong> comments'),
+    t('View panes'),
+    t('You created - pane'),
+    t('You created'),
+    t('You follow - pane'),
+    t('You follow'),
+    t('flag'),
+  );
+  $export['commons_events_user_upcoming_events'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/css/commons_events.css b/modules/commons/commons_events/css/commons_events.css
new file mode 100644
index 0000000..cbc4253
--- /dev/null
+++ b/modules/commons/commons_events/css/commons_events.css
@@ -0,0 +1,42 @@
+#edit-events-sidebar legend .summary {
+  width: 25em;
+  overflow: hidden;
+  line-height: 1em;
+  height: 1em;
+}
+
+#edit-events-sidebar .fieldset-legend .fieldset-title {
+  display: block;
+}
+
+#legend-registration-type:after {
+  content: ', ';
+}
+
+.view-commons-events-event-attendee-list {
+  background-color: #fff;
+}
+
+/**
+ * Fix fieldset margins for date and address field since they have weird
+ * spacing issues.
+ */
+#edit-field-date .fieldset-description {
+  display: none;
+}
+#edit-field-date .date-padding {
+  padding: 0px;
+}
+#edit-field-date .fieldset-wrapper .form-item:first-child,
+#edit-field-date .form-item .form-item, 
+#edit-field-address .fieldset-wrapper .form-item:first-child,
+#edit-field-address .form-item {
+  margin-top: 0em;
+}
+
+form.commons-events-form-float {
+  float: right;
+}
+.commons-events-button {
+  margin-left: 5px;
+}
diff --git a/modules/commons/commons_events/includes/commons_events.forms.inc b/modules/commons/commons_events/includes/commons_events.forms.inc
new file mode 100644
index 0000000..d7004b7
--- /dev/null
+++ b/modules/commons/commons_events/includes/commons_events.forms.inc
@@ -0,0 +1,121 @@
+<?php
+/**
+ * @file
+ * Commons Events form declarations.
+ */
+
+ /**
+ * Form builder for Attend call to action on events, as long as registration
+ * is available onsite.
+ */
+function commons_events_attend_event_form($form, &$form_state, $event_node, $registration = NULL, $attendee_count = 0) {
+  $form_state['event_node'] = $event_node;
+  if (!registration_status('node', $event_node->nid, TRUE)) {
+    return array();
+  }
+  if (!isset($registration)) {
+    $registration_type = registration_get_entity_registration_type('node', $event_node);
+    $registration = entity_get_controller('registration')->create(array(
+      'entity_type' => 'node',
+      'entity_id' => $event_node->nid,
+      'type' => $registration_type,
+    ));
+  }
+  $form_state['registration'] = $registration;
+  $form['submit'] = array(
+    '#type' => 'submit',
+    '#value' => t('Attend'),
+  );
+  $form['attending'] = array(
+    '#theme_wrappers' => array('container'),
+    '#attributes' => array(
+      'class' => array('commons-event-status'),
+    ),
+    '#markup' => format_plural($attendee_count, '<span class="commons-event-count">1</span> attendee', '<span class="commons-event-count">@count</span> attendees'),
+  );
+  $form['#attached']['css'] = array(
+    drupal_get_path('module', 'commons_events') . '/css/commons_events.css',
+  );
+  $form['#attributes'] = array('class' => array('commons-events-form-float'));
+  return $form;
+}
+
+/**
+ * Validation handler for attending an event.
+ * Checks to make sure that space is available for attending, and that it
+ * didn't fill up after the page load.
+ */
+function commons_events_attend_event_form_validate($form, &$form_state) {
+  global $user;
+  if (!registration_status('node', $form_state['event_node']->nid, TRUE)
+    || !registration_has_room('node', $form_state['event_node']->nid)) {
+    form_set_error('submit', t('The event you are registering for is unavailable.'));
+    return FALSE;
+  }
+  else if (registration_is_registered($form_state['registration'], NULL, $user->uid)) {
+    form_set_error('submit', t('You are already registered for this event.'));
+    return FALSE;
+  }
+  return TRUE;
+}
+
+/**
+ * Submission handler for attending an event.
+ */
+function commons_events_attend_event_form_submit($form, $form_state) {
+  global $user;
+  $registration = $form_state['registration'];
+  $registration->user_uid = $user->uid;
+  $registration->author_uid = $user->uid;
+  $registration->state = NULL;
+  $registration->count = 1;
+  if (registration_save($registration)) {
+    drupal_set_message(t('Your registration was saved.'));
+    commons_follow_node_follow_node($registration->entity_id, 'event', $user->uid);
+  }
+  else {
+    drupal_set_message(t('There was an error saving your registration.'));
+  }
+}
+
+/**
+ * Form to cancel a registration for an event.
+ */
+function commons_events_cancel_event_form($form, &$form_state, $event) {
+  $form_state['event'] = $event;
+  $form['#attributes'] = array('class' => array('commons-events-form-float'));
+  $form['#attached']['css'] = array(
+    drupal_get_path('module', 'commons_events') . '/css/commons_events.css',
+  );
+  $form['submit'] = array(
+    '#type' => 'submit',
+    '#value' => t('Cancel'),
+  );
+  $form['submit']['#attributes']['class'][] = 'commons-events-button';
+  $form['attending'] = array(
+    '#theme_wrappers' => array('container'),
+    '#attributes' => array(
+      'class' => array('commons-event-status'),
+    ),
+    '#markup' => t('You are attending.'),
+  );
+  return $form;
+}
+
+/**
+ * Event cancel attendance form submit handler.
+ */
+function commons_events_cancel_event_form_submit($form, $form_state) {
+  global $user;
+  $event = $form_state['event'];
+  $query = new EntityFieldQuery();
+  $query->entityCondition('entity_type', 'registration')
+    ->propertyCondition('user_uid', $user->uid)
+    ->propertyCondition('entity_id', $event->nid)
+    ->propertyCondition('entity_type', 'node');
+  $result = $query->execute();
+  if (isset($result['registration'])) {
+    registration_delete_multiple(array_keys($result['registration']));
+    drupal_set_message(t('Your registration has been cancelled.'));
+  }
+}
diff --git a/modules/commons/commons_events/includes/commons_events.theme.inc b/modules/commons/commons_events/includes/commons_events.theme.inc
new file mode 100644
index 0000000..22a52b8
--- /dev/null
+++ b/modules/commons/commons_events/includes/commons_events.theme.inc
@@ -0,0 +1,55 @@
+<?php
+/**
+ * @file
+ * Commons Events theme functions.
+ */
+
+/**
+ * Theme callback to display that a user is attending an event.
+ */
+function theme_commons_events_attending_event($variables = array()) {
+  global $user;
+  $event = $variables['event'];
+  $attendee_count = isset($variables['attendee_count']) ? $variables['attendee_count'] : 0;
+
+  $registration_type = registration_get_entity_registration_type('node', $event);
+  $registration = entity_get_controller('registration')->create(array(
+    'entity_type' => 'node',
+    'entity_id' => $event->nid,
+    'type' => $registration_type,
+    'author_uid' => $user->uid,
+  ));
+
+  if (!function_exists('commons_events_attend_event_form')
+    || !function_exists('commons_events_cancel_event_form')) {
+    module_load_include('inc', 'commons_events', 'includes/commons_events.forms');
+  }
+  if (!registration_is_registered($registration, NULL, $user->uid)
+    && registration_access('create', $registration, $user, $registration->type)
+    && registration_status('node', $event->nid, TRUE)) {
+    return drupal_get_form('commons_events_attend_event_form_' . $event->nid, $event, $registration, $attendee_count);
+  }
+  else if (registration_is_registered($registration, NULL, $user->uid) &&
+    registration_access('delete', $registration, $user, $registration->type)) {
+    return drupal_get_form('commons_events_cancel_event_form_' . $event->nid, $event);
+  }
+  return "";
+}
+
+/**
+ * Theme the event attendees list.
+ */
+function theme_commons_events_event_attendees($variables = array()) {
+  $title = '<p class="commons-events-attendees-title">' . t('Attendees') . '</p>';
+  $event_nid = $variables['event_nid'];
+  if (!isset($variables['display'])
+    || $variables['display'] != 'full') {
+    return $title . views_embed_view('commons_events_event_attendee_list', 'default', $event_nid)
+      . '<p class="commons-events-all-attendees"><a href="/node/' . $event_nid . '/attendees">'
+      . t('See all attendees') . '</a></p>';
+  }
+  return $title . views_embed_view(
+    'commons_events_event_attendee_list',
+    'commons_events_full_attendee_list',
+    $event_nid);
+}
diff --git a/modules/commons/commons_events/js/commons_events.js b/modules/commons/commons_events/js/commons_events.js
new file mode 100644
index 0000000..ba0ae77
--- /dev/null
+++ b/modules/commons/commons_events/js/commons_events.js
@@ -0,0 +1,18 @@
+(function ($) {
+  Drupal.behaviors.commons_events_update_registration_settings_legend = {
+    attach: function (context, settings) {
+      $(':input[name^="field_registration_type"]').change(function() {
+        $("[id^='edit-event-registration-settings'] .summary").text($(':input[name^="field_registration_type"] :selected').text());
+        if ($(':input[name^="field_registration_type"]').val() == 'external') {
+          $(':input[name^="field_status"]').val('0').change();
+        }
+      });
+      $(':input[name^="field_status"]').change(function() {
+        var cur = $(':input[name^="field_registration_type"] :selected').text();
+        $("[id^='edit-event-registration-settings'] .summary").text(cur + ', ' + $(':input[name="field_status"] :selected').text());
+      });
+      $(':input[name^="field_registration_type"]').change();
+      $(':input[name^="field_status"]').change();
+    }
+  };
+})(jQuery);
diff --git a/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.features.inc b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.features.inc
new file mode 100644
index 0000000..ccd853e
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.features.inc
@@ -0,0 +1,17 @@
+<?php
+/**
+ * @file
+ * commons_events_pages.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_events_pages_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "panelizer" && $api == "panelizer") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.info b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.info
new file mode 100644
index 0000000..d2db9b5
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.info
@@ -0,0 +1,14 @@
+name = Commons Events Pages
+description = Provides the panelized Event page feature.
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_events
+dependencies[] = panelizer
+dependencies[] = strongarm
+features[ctools][] = panelizer:panelizer:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[panelizer_defaults][] = node:event:default
+features[variable][] = panelizer_defaults_node_event
+files[] = commons_events_pages.features.inc
+files[] = commons_events_pages.strongarm.inc
diff --git a/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.install b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.install
new file mode 100644
index 0000000..804bf68
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.install
@@ -0,0 +1,9 @@
+<?php
+
+/**
+* Add page title.
+*/
+function commons_events_pages_update_7301() {
+  features_revert(array('commons_events_pages' => array('page_manager_pages')));
+  return array();
+}
diff --git a/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.module b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.module
new file mode 100644
index 0000000..41e7844
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Commons Events Pages module.
+ */
+
+include_once 'commons_events_pages.features.inc';
diff --git a/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.panelizer.inc b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.panelizer.inc
new file mode 100644
index 0000000..049ab3b
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.panelizer.inc
@@ -0,0 +1,134 @@
+<?php
+/**
+ * @file
+ * commons_events_pages.panelizer.inc
+ */
+
+/**
+ * Implements hook_panelizer_defaults().
+ */
+function commons_events_pages_panelizer_defaults() {
+  $export = array();
+
+  $panelizer = new stdClass();
+  $panelizer->disabled = FALSE; /* Edit this to true to make a default panelizer disabled initially */
+  $panelizer->api_version = 1;
+  $panelizer->name = 'node:event:default';
+  $panelizer->title = 'Default';
+  $panelizer->panelizer_type = 'node';
+  $panelizer->panelizer_key = 'event';
+  $panelizer->no_blocks = FALSE;
+  $panelizer->css_id = '';
+  $panelizer->css = '';
+  $panelizer->pipeline = 'ipe';
+  $panelizer->contexts = array();
+  $panelizer->relationships = array();
+  $panelizer->access = array();
+  $panelizer->view_mode = 'page_manager';
+  $panelizer->css_class = '';
+  $panelizer->title_element = 'H2';
+  $panelizer->link_to_entity = TRUE;
+  $panelizer->extra = array();
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '%node:title';
+  $display->uuid = '0d63be4d-5605-1644-fd5c-3872c8b1d8b6';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-f259289a-8ef0-6aa4-2592-c59928474958';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'node_content';
+    $pane->subtype = 'node_content';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'links' => 1,
+      'no_extras' => 0,
+      'override_title' => 0,
+      'override_title_text' => '',
+      'identifier' => '',
+      'link' => 0,
+      'leave_node_title' => 1,
+      'build_mode' => 'full',
+      'context' => 'panelizer',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'f259289a-8ef0-6aa4-2592-c59928474958';
+    $display->content['new-f259289a-8ef0-6aa4-2592-c59928474958'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-f259289a-8ef0-6aa4-2592-c59928474958';
+    $pane = new stdClass();
+    $pane->pid = 'new-a2912068-e5e2-c804-b1ba-3260dc059c9b';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_organizers-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'context' => array(
+        0 => 'panelizer',
+      ),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'a2912068-e5e2-c804-b1ba-3260dc059c9b';
+    $display->content['new-a2912068-e5e2-c804-b1ba-3260dc059c9b'] = $pane;
+    $display->panels['two_66_33_second'][0] = 'new-a2912068-e5e2-c804-b1ba-3260dc059c9b';
+    $pane = new stdClass();
+    $pane->pid = 'new-aef85835-68a5-2494-b107-136f1cb92749';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_event_attendee_list-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'use_pager' => 1,
+      'pager_id' => '0',
+      'items_per_page' => '20',
+      'offset' => '0',
+      'context' => array(
+        0 => 'panelizer',
+      ),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = 'aef85835-68a5-2494-b107-136f1cb92749';
+    $display->content['new-aef85835-68a5-2494-b107-136f1cb92749'] = $pane;
+    $display->panels['two_66_33_second'][1] = 'new-aef85835-68a5-2494-b107-136f1cb92749';
+  $display->hide_title = PANELS_TITLE_NONE;
+  $display->title_pane = '0';
+  $panelizer->display = $display;
+  $export['node:event:default'] = $panelizer;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.strongarm.inc b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.strongarm.inc
new file mode 100644
index 0000000..d09ae51
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_pages/commons_events_pages.strongarm.inc
@@ -0,0 +1,40 @@
+<?php
+/**
+ * @file
+ * commons_events_pages.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_events_pages_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'panelizer_defaults_node_event';
+  $strongarm->value = array(
+    'status' => 1,
+    'view modes' => array(
+      'page_manager' => array(
+        'status' => 1,
+        'default' => 1,
+        'choice' => 0,
+      ),
+      'default' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+      'teaser' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+    ),
+  );
+  $export['panelizer_defaults_node_event'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.apachesolr_search_defaults.inc b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.apachesolr_search_defaults.inc
new file mode 100644
index 0000000..877d502
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.apachesolr_search_defaults.inc
@@ -0,0 +1,37 @@
+<?php
+/**
+ * @file
+ * commons_events_solr.apachesolr_search_defaults.inc
+ */
+
+/**
+ * Implements hook_apachesolr_search_default_searchers().
+ */
+function commons_events_solr_apachesolr_search_default_searchers() {
+  $export = array();
+
+  $searcher = new stdClass();
+  $searcher->disabled = FALSE; /* Edit this to true to make a default searcher disabled initially */
+  $searcher->api_version = 3;
+  $searcher->page_id = 'solr_events';
+  $searcher->label = 'Solr Events';
+  $searcher->description = '';
+  $searcher->search_path = 'events';
+  $searcher->page_title = 'Events';
+  $searcher->env_id = apachesolr_default_environment();
+  $searcher->settings = array(
+    'fq' => array(
+      0 => 'bundle:event',
+    ),
+    'apachesolr_search_custom_enable' => 1,
+    'apachesolr_search_search_type' => 'custom',
+    'apachesolr_search_search_box' => 0,
+    'apachesolr_search_per_page' => '10',
+    'apachesolr_search_browse' => 'results',
+    'apachesolr_search_spellcheck' => 0,
+    'apachesolr_search_allow_user_input' => 0,
+  );
+  $export['solr_events'] = $searcher;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.features.inc b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.features.inc
new file mode 100644
index 0000000..92e5042
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.features.inc
@@ -0,0 +1,26 @@
+<?php
+/**
+ * @file
+ * commons_events_solr.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_events_solr_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "apachesolr_search" && $api == "apachesolr_search_defaults") {
+    return array("version" => "3");
+  }
+  if ($module == "facetapi" && $api == "facetapi_defaults") {
+    return array("version" => "1");
+  }
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  if ($module == "pm_existing_pages" && $api == "pm_existing_pages") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.info b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.info
new file mode 100644
index 0000000..4cc30fb
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.info
@@ -0,0 +1,21 @@
+name = Commons Events - Solr
+description = Provides the Solr based faceted search for events
+core = 7.x
+package = Commons - Search
+dependencies[] = apachesolr_search
+dependencies[] = commons_events
+dependencies[] = ctools
+dependencies[] = facetapi
+dependencies[] = page_manager
+dependencies[] = pm_existing_pages
+dependencies[] = strongarm
+features[apachesolr_search_page][] = solr_events
+features[ctools][] = apachesolr_search:apachesolr_search_defaults:3
+features[ctools][] = facetapi:facetapi_defaults:1
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = pm_existing_pages:pm_existing_pages:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[page_manager_existing_pages][] = solr_events_search
+features[page_manager_handlers][] = pm_existing_pages_solr_events_search_panel_context
+features[variable][] = pm_existing_pages_disabled_solr_events_search
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.install b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.install
new file mode 100644
index 0000000..3b84af9
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.install
@@ -0,0 +1,43 @@
+<?php
+/**
+ * @file
+ * Commons Events Solr install script.
+ */
+
+/**
+ * Implements hook_install().
+ */
+function commons_events_solr_install() {
+  // Set module weight to be below rich_snippets, so we can disable snippeting
+  // on the Solr events landing page.
+  db_update('system')
+    ->fields(array('weight' => 5))
+    ->condition('name', 'commons_events_solr')
+    ->execute();
+}
+
+/**
+ * Implements hook_enable().
+ */
+function commons_events_solr_enable() {
+  module_load_include('inc', 'page_manager', 'plugins/tasks/page');
+  $page = page_manager_page_load('views_events_landing_page');
+  ctools_include('export');
+  ctools_export_set_object_status($page, TRUE);
+  // Revert base Events feature so that the Events menu link is recreated.
+  features_revert(array('commons_events' => array('menu_links')));
+  menu_cache_clear_all();
+}
+
+/**
+ * Implements hook_disable().
+ */
+function commons_events_solr_disable() {
+  module_load_include('inc', 'page_manager', 'plugins/tasks/page');
+  $page = page_manager_page_load('views_events_landing_page');
+  ctools_include('export');
+  ctools_export_set_object_status($page, FALSE);
+  // Revert base Events feature so that the Events menu link is recreated.
+  features_revert(array('commons_events' => array('menu_links')));
+  menu_cache_clear_all();
+}
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.module b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.module
new file mode 100644
index 0000000..48f0fe3
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.module
@@ -0,0 +1,288 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Events - Solr feature.
+ */
+
+include_once 'commons_events_solr.features.inc';
+
+/**
+ * Get the search adapter and Solr environment for dynamic faceting.
+ */
+function commons_events_solr_search_environment() {
+  return "apachesolr@" . apachesolr_default_environment();
+}
+
+/**
+ * Dynamically create facets rather than let Features do it, so we can have
+ * facets based on the current default Solr environment.
+ */
+function commons_events_solr_create_facets($env_id = NULL) {
+  $facets = commons_events_solr_facet_definitions();
+  // Add each facet to the database with a merge so we don't have duplicates.
+  if (empty($env_id)) {
+    $env_id = commons_events_solr_search_environment();
+  }
+  foreach($facets as $facet) {
+    $facet['settings'] = serialize($facet['settings']);
+    $facet['name'] = $env_id . $facet['name'];
+    $facet['searcher'] = $env_id;
+    $merge = db_merge('facetapi')
+      ->key(array('name' => $facet['name']))
+      ->fields($facet)
+      ->execute();
+  }
+}
+
+/**
+ * Base facet definitions.
+ */
+function commons_events_solr_facet_definitions() {
+  $facets = array();
+
+  $facets[] = array(
+    'name' => '::dm_field_date',
+    'searcher' => commons_events_solr_search_environment(),
+    'realm' => '',
+    'facet' => 'dm_field_date',
+    'enabled' => 1,
+    'settings' => array(
+      'operator' => 'and',
+      'hard_limit' => '50',
+      'dependencies' => array(
+        'roles' => array(),
+      ),
+      'facet_mincount' => 1,
+      'facet_missing' => 0,
+      'flatten' => 0,
+      'query_type' => 'date_range',
+    ),
+  );
+  $facets[] = array(
+    'name' => ':block:dm_field_date',
+    'searcher' => commons_events_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'dm_field_date',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'date_range',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'indexed' => 'indexed',
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'indexed' => -49,
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'indexed' => 4,
+        'count' => 4,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+      'empty_text' => array(
+        'value' => '',
+        'format' => 'filtered_html',
+      ),
+    ),
+  );
+  $facets[] = array(
+    'name' => ':block:sm_field_location',
+    'searcher' => commons_events_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'sm_field_location',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+    ),
+  );
+  $facets[] = array(
+    'name' => ':block:im_field_topics',
+    'searcher' => commons_events_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'im_field_topics',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+        'indexed' => 0,
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+        'indexed' => 0,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+        'indexed' => 4,
+      ),
+      'empty_behavior' => 'text',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+      'empty_text' => array(
+        'value' => 'None available',
+        'format' => 'filtered_html',
+      ),
+    ),
+  );
+  $facets[] = array(
+    'name' => '::im_field_topics',
+    'searcher' => commons_events_solr_search_environment(),
+    'realm' => '',
+    'facet' => 'im_field_topics',
+    'enabled' => 0,
+    'settings' => array(
+      'operator' => 'and',
+      'hard_limit' => 50,
+      'dependencies' => array(
+        'roles' => array(),
+      ),
+      'facet_mintcount' => 1,
+      'facet_missing' => 0,
+      'flatten' => 0,
+      'query_type' => 'term',
+    ),
+  );
+  $facets[] = array(
+    'name' => ':block:sm_og_group_ref',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'sm_og_group_ref',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+    ),
+  );
+
+  return $facets;
+}
+
+/**
+ * Get the panels subtype for the facet block.
+ */
+function commons_events_solr_panel_facet_subtype($facet_name) {
+  $facet_name = commons_events_solr_search_environment() . ':block:' . $facet_name;
+  return 'facetapi-' . facetapi_hash_delta($facet_name);
+}
+
+/**
+ * Implements hook_theme_registry_alter().
+ */
+function commons_events_solr_theme_registry_alter(&$registry) {
+  $registry['apachesolr_search_noresults']['function'] = 'commons_events_solr_apachesolr_search_noresults';
+}
+
+/**
+ * Implements hook_preprocess_hook().
+ */
+function commons_events_solr_process_search_results(&$variables) {
+  if ($variables['search_page']['page_id'] == 'solr_events') {
+    $variables['title'] = format_plural(count($variables['results']), '1 event', '@count events');
+  }
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_events_solr_form_apachesolr_environment_edit_form_alter(&$form, &$form_state) {
+  $form['actions']['save']['#submit'][] = 'commons_events_solr_environment_form_submit';
+}
+
+/**
+ * Friendlier empty text when there are no events.
+ */
+function commons_events_solr_apachesolr_search_noresults() {
+  $destination = drupal_get_destination();
+  if ($destination['destination'] != 'events') {
+    // Have to call the actual function since we overrode it to use the current
+    // function instead.
+    return theme_apachesolr_search_noresults();
+  }
+  $options = array('!create' => 'create one');
+  if (node_access('create', 'event')) {
+    $options['!create'] = l('create one', 'node/add/event');
+  }
+  return t('There are no events. Be the first to !create!', $options);
+}
+
+/**
+ * When the environment changes, create facets for that environment.
+ */
+function commons_events_solr_environment_form_submit($form, $form_state) {
+  if ($form_state['values']['make_default'] == 1) {
+    commons_events_solr_create_facets('apachesolr@' . $form_state['build_info']['args']['0']['env_id']);
+    // Need to clear caches so we can rebuild block definitions.
+    cache_clear_all('*', 'cache_block', TRUE);
+    cache_clear_all('*', 'cache_apachesolr', TRUE);
+  }
+}
+
+/**
+ *  Implements hook_node_presave to display a message warning the user that results won't occur immediately
+ */
+function commons_events_solr_node_presave($node) {
+  if ($node->type == 'event') {
+    drupal_set_message(t('Your event may take a few minutes to appear on the listing page.'));
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.pages_default.inc b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.pages_default.inc
new file mode 100644
index 0000000..3eacc22
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.pages_default.inc
@@ -0,0 +1,271 @@
+<?php
+/**
+ * @file
+ * commons_events_solr.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_handlers().
+ */
+function commons_events_solr_default_page_manager_handlers() {
+  $export = array();
+
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'pm_existing_pages_solr_events_search_panel_context';
+  $handler->task = 'pm_existing_pages';
+  $handler->subtask = 'solr_events_search';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'Event Search',
+    'no_blocks' => 0,
+    'pipeline' => 'standard',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'three_25_50_25';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'three_25_50_25_top' => NULL,
+      'three_25_50_25_first' => NULL,
+      'three_25_50_25_second' => NULL,
+      'three_25_50_25_third' => NULL,
+      'three_25_50_25_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = 'bf4f354a-dc68-cab4-a139-49e172b1c4ed';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-2edbeade-1d05-fbd4-f526-68239a54433f';
+    $pane->panel = 'three_25_50_25_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_events_solr_panel_facet_subtype('sm_field_location');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Attendance',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '2edbeade-1d05-fbd4-f526-68239a54433f';
+    $display->content['new-2edbeade-1d05-fbd4-f526-68239a54433f'] = $pane;
+    $display->panels['three_25_50_25_first'][0] = 'new-2edbeade-1d05-fbd4-f526-68239a54433f';
+    $pane = new stdClass();
+    $pane->pid = 'new-06093184-ccdb-9a84-1da8-e9f2dff0d882';
+    $pane->panel = 'three_25_50_25_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_events_solr_panel_facet_subtype('dm_field_date');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Date',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '06093184-ccdb-9a84-1da8-e9f2dff0d882';
+    $display->content['new-06093184-ccdb-9a84-1da8-e9f2dff0d882'] = $pane;
+    $display->panels['three_25_50_25_first'][1] = 'new-06093184-ccdb-9a84-1da8-e9f2dff0d882';
+    $pane = new stdClass();
+    $pane->pid = 'new-c84b8b32-c6d5-9ce4-bdec-f2735c5045b8';
+    $pane->panel = 'three_25_50_25_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_events_solr_panel_facet_subtype('im_field_topics');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Topic',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = 'c84b8b32-c6d5-9ce4-bdec-f2735c5045b8';
+    $display->content['new-c84b8b32-c6d5-9ce4-bdec-f2735c5045b8'] = $pane;
+    $display->panels['three_25_50_25_first'][2] = 'new-c84b8b32-c6d5-9ce4-bdec-f2735c5045b8';
+    $pane = new stdClass();
+    $pane->pid = 'new-c46f0562-0218-76c4-b969-3abdc98f24fa';
+    $pane->panel = 'three_25_50_25_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_events_solr_panel_facet_subtype('sm_og_group_ref');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Group',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 3;
+    $pane->locks = array();
+    $pane->uuid = 'c46f0562-0218-76c4-b969-3abdc98f24fa';
+    $display->content['new-c46f0562-0218-76c4-b969-3abdc98f24fa'] = $pane;
+    $display->panels['three_25_50_25_first'][3] = 'new-c46f0562-0218-76c4-b969-3abdc98f24fa';
+    $pane = new stdClass();
+    $pane->pid = 'new-ba67e9d1-00ed-07b4-49df-bff421094214';
+    $pane->panel = 'three_25_50_25_second';
+    $pane->type = 'pm_existing_pages';
+    $pane->subtype = 'pm_existing_pages';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      0 => 'task_id',
+      1 => 'pane_title_from_menu',
+      'task_id' => 'solr_events_search',
+      'pane_title_from_menu' => 0,
+      'override_title' => 1,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'ba67e9d1-00ed-07b4-49df-bff421094214';
+    $display->content['new-ba67e9d1-00ed-07b4-49df-bff421094214'] = $pane;
+    $display->panels['three_25_50_25_second'][0] = 'new-ba67e9d1-00ed-07b4-49df-bff421094214';
+    $pane = new stdClass();
+    $pane->pid = 'new-f5cb9927-def5-8f94-098b-ca9d83eaf9fa';
+    $pane->panel = 'three_25_50_25_third';
+    $pane->type = 'block';
+    $pane->subtype = 'commons_events-commons_events_create_event_link';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'f5cb9927-def5-8f94-098b-ca9d83eaf9fa';
+    $display->content['new-f5cb9927-def5-8f94-098b-ca9d83eaf9fa'] = $pane;
+    $display->panels['three_25_50_25_third'][0] = 'new-f5cb9927-def5-8f94-098b-ca9d83eaf9fa';
+    $pane = new stdClass();
+    $pane->pid = 'new-a9b484b9-8f95-46e4-d930-64dc3d093f3d';
+    $pane->panel = 'three_25_50_25_third';
+    $pane->type = 'block';
+    $pane->subtype = 'commons_events-commons_events_anonymous_login';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = 'a9b484b9-8f95-46e4-d930-64dc3d093f3d';
+    $display->content['new-a9b484b9-8f95-46e4-d930-64dc3d093f3d'] = $pane;
+    $display->panels['three_25_50_25_third'][1] = 'new-a9b484b9-8f95-46e4-d930-64dc3d093f3d';
+    $pane = new stdClass();
+    $pane->pid = 'new-ae313741-a577-f194-9dd7-868986d44baf';
+    $pane->panel = 'three_25_50_25_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_user_upcoming_events-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = 'ae313741-a577-f194-9dd7-868986d44baf';
+    $display->content['new-ae313741-a577-f194-9dd7-868986d44baf'] = $pane;
+    $display->panels['three_25_50_25_third'][2] = 'new-ae313741-a577-f194-9dd7-868986d44baf';
+    $pane = new stdClass();
+    $pane->pid = 'new-6c32c82b-82f2-97f4-55b1-bc38ddc2e4b6';
+    $pane->panel = 'three_25_50_25_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_user_upcoming_events-panel_pane_2';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 3;
+    $pane->locks = array();
+    $pane->uuid = '6c32c82b-82f2-97f4-55b1-bc38ddc2e4b6';
+    $display->content['new-6c32c82b-82f2-97f4-55b1-bc38ddc2e4b6'] = $pane;
+    $display->panels['three_25_50_25_third'][3] = 'new-6c32c82b-82f2-97f4-55b1-bc38ddc2e4b6';
+    $pane = new stdClass();
+    $pane->pid = 'new-0e2c9d7d-abfe-e314-9dba-e9c8dae6fc74';
+    $pane->panel = 'three_25_50_25_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_events_user_upcoming_events-panel_pane_3';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 4;
+    $pane->locks = array();
+    $pane->uuid = '0e2c9d7d-abfe-e314-9dba-e9c8dae6fc74';
+    $display->content['new-0e2c9d7d-abfe-e314-9dba-e9c8dae6fc74'] = $pane;
+    $display->panels['three_25_50_25_third'][4] = 'new-0e2c9d7d-abfe-e314-9dba-e9c8dae6fc74';
+  $display->hide_title = PANELS_TITLE_NONE;
+  $display->title_pane = 'new-ba67e9d1-00ed-07b4-49df-bff421094214';
+  $handler->conf['display'] = $display;
+  $export['pm_existing_pages_solr_events_search_panel_context'] = $handler;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.pm_existing_pages.inc b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.pm_existing_pages.inc
new file mode 100644
index 0000000..977ba04
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.pm_existing_pages.inc
@@ -0,0 +1,22 @@
+<?php
+/**
+ * @file
+ * commons_events_solr.pm_existing_pages.inc
+ */
+
+/**
+ * Implements hook_pm_existing_pages_info().
+ */
+function commons_events_solr_pm_existing_pages_info() {
+  $export = array();
+
+  $pm_existing_page = new stdClass();
+  $pm_existing_page->api_version = 1;
+  $pm_existing_page->name = 'solr_events_search';
+  $pm_existing_page->label = 'Solr Events Search';
+  $pm_existing_page->context = '';
+  $pm_existing_page->paths = 'events';
+  $export['solr_events_search'] = $pm_existing_page;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.strongarm.inc b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.strongarm.inc
new file mode 100644
index 0000000..ec6ebe5
--- /dev/null
+++ b/modules/commons/commons_events/modules/commons_events_solr/commons_events_solr.strongarm.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * commons_events_solr.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_events_solr_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'pm_existing_pages_disabled_solr_events_search';
+  $strongarm->value = FALSE;
+  $export['pm_existing_pages_disabled_solr_events_search'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_events/profile_empty.png b/modules/commons/commons_events/profile_empty.png
new file mode 100644
index 0000000..32402e6
Binary files /dev/null and b/modules/commons/commons_events/profile_empty.png differ
diff --git a/modules/commons/commons_featured/commons_featured.features.inc b/modules/commons/commons_featured/commons_featured.features.inc
new file mode 100644
index 0000000..5c9f7a8
--- /dev/null
+++ b/modules/commons/commons_featured/commons_featured.features.inc
@@ -0,0 +1,12 @@
+<?php
+/**
+ * @file
+ * commons_featured.features.inc
+ */
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_featured_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_featured/commons_featured.info b/modules/commons/commons_featured/commons_featured.info
new file mode 100644
index 0000000..5edbd0e
--- /dev/null
+++ b/modules/commons/commons_featured/commons_featured.info
@@ -0,0 +1,9 @@
+name = Commons Featured Content
+description = Allows community managers to display certain pieces of content more prominently on the site.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = views
+dependencies[] = views_content
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[views_view][] = commons_featured
diff --git a/modules/commons/commons_featured/commons_featured.module b/modules/commons/commons_featured/commons_featured.module
new file mode 100644
index 0000000..dd3bf33
--- /dev/null
+++ b/modules/commons/commons_featured/commons_featured.module
@@ -0,0 +1,17 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Featured Content feature.
+ */
+
+include_once 'commons_featured.features.inc';
+
+/**
+* Implements hook_form_alter().
+*/
+function commons_featured_form_alter(&$form, &$form_state, $form_id) {
+  // Change "Promoted to front page" to "Featured".
+  if (isset($form['#node']) && substr($form_id, -10) == '_node_form' && isset($form['options']['promote'])) {
+    $form['options']['promote']['#title'] = t('Featured');
+  }
+}
diff --git a/modules/commons/commons_featured/commons_featured.views_default.inc b/modules/commons/commons_featured/commons_featured.views_default.inc
new file mode 100644
index 0000000..cabd633
--- /dev/null
+++ b/modules/commons/commons_featured/commons_featured.views_default.inc
@@ -0,0 +1,190 @@
+<?php
+/**
+ * @file
+ * commons_featured.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_featured_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_featured';
+  $view->description = 'Display featured content on the site.';
+  $view->tag = 'commons_featured';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Featured Content';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Featured on this site';
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '3';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* Field: Content: Type */
+  $handler->display->display_options['fields']['type']['id'] = 'type';
+  $handler->display->display_options['fields']['type']['table'] = 'node';
+  $handler->display->display_options['fields']['type']['field'] = 'type';
+  $handler->display->display_options['fields']['type']['label'] = '';
+  $handler->display->display_options['fields']['type']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['type']['element_label_colon'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  $handler->display->display_options['fields']['title']['element_class'] = 'type-[type]';
+  $handler->display->display_options['fields']['title']['element_label_colon'] = FALSE;
+  /* Field: Content: Date */
+  $handler->display->display_options['fields']['field_date']['id'] = 'field_date';
+  $handler->display->display_options['fields']['field_date']['table'] = 'field_data_field_date';
+  $handler->display->display_options['fields']['field_date']['field'] = 'field_date';
+  $handler->display->display_options['fields']['field_date']['label'] = '';
+  $handler->display->display_options['fields']['field_date']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_date']['hide_empty'] = TRUE;
+  $handler->display->display_options['fields']['field_date']['settings'] = array(
+    'format_type' => 'short',
+    'fromto' => 'both',
+    'multiple_number' => '',
+    'multiple_from' => '',
+    'multiple_to' => '',
+  );
+  /* Field: Content: Address */
+  $handler->display->display_options['fields']['field_address']['id'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['table'] = 'field_data_field_address';
+  $handler->display->display_options['fields']['field_address']['field'] = 'field_address';
+  $handler->display->display_options['fields']['field_address']['label'] = '';
+  $handler->display->display_options['fields']['field_address']['alter']['alter_text'] = TRUE;
+  $handler->display->display_options['fields']['field_address']['alter']['text'] = '[field_address-locality], [field_address-administrative_area]';
+  $handler->display->display_options['fields']['field_address']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_address']['hide_empty'] = TRUE;
+  $handler->display->display_options['fields']['field_address']['hide_alter_empty'] = FALSE;
+  $handler->display->display_options['fields']['field_address']['click_sort_column'] = 'country';
+  $handler->display->display_options['fields']['field_address']['settings'] = array(
+    'use_widget_handlers' => 1,
+    'format_handlers' => array(
+      'address' => 'address',
+    ),
+  );
+  /* Field: Registration Settings: Spaces used */
+  $handler->display->display_options['fields']['capacity_used']['id'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['table'] = 'node';
+  $handler->display->display_options['fields']['capacity_used']['field'] = 'capacity_used';
+  $handler->display->display_options['fields']['capacity_used']['label'] = '';
+  $handler->display->display_options['fields']['capacity_used']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['capacity_used']['hide_empty'] = TRUE;
+  $handler->display->display_options['fields']['capacity_used']['empty_zero'] = TRUE;
+  $handler->display->display_options['fields']['capacity_used']['format_plural'] = TRUE;
+  $handler->display->display_options['fields']['capacity_used']['format_plural_singular'] = '@count attendee';
+  $handler->display->display_options['fields']['capacity_used']['format_plural_plural'] = '@count attendees';
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['comment_count']['hide_empty'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['format_plural'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['format_plural_singular'] = '@count comment';
+  $handler->display->display_options['fields']['comment_count']['format_plural_plural'] = '@count comments';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  /* Filter criterion: Content: Promoted to front page */
+  $handler->display->display_options['filters']['promote']['id'] = 'promote';
+  $handler->display->display_options['filters']['promote']['table'] = 'node';
+  $handler->display->display_options['filters']['promote']['field'] = 'promote';
+  $handler->display->display_options['filters']['promote']['value'] = '1';
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'commons_home_featured_page');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '15';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'node';
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['path'] = 'featured';
+  $handler->display->display_options['menu']['title'] = 'Events';
+  $handler->display->display_options['menu']['weight'] = '0';
+  $handler->display->display_options['menu']['name'] = 'main-menu';
+  $handler->display->display_options['menu']['context'] = 0;
+
+  /* Display: Feed */
+  $handler = $view->new_display('feed', 'Feed', 'commons_home_featured_feed');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['style_plugin'] = 'rss';
+  $handler->display->display_options['row_plugin'] = 'node_rss';
+  $handler->display->display_options['path'] = 'featured.xml';
+  $handler->display->display_options['displays'] = array(
+    'default' => 'default',
+    'page' => 'page',
+  );
+  $handler->display->display_options['sitename_title'] = 1;
+
+  /* Display: Featured content */
+  $handler = $view->new_display('panel_pane', 'Featured content', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['row_options']['inline'] = array(
+    'capacity_used' => 'capacity_used',
+    'comment_count' => 'comment_count',
+  );
+  $handler->display->display_options['row_options']['separator'] = ',';
+  $handler->display->display_options['row_options']['hide_empty'] = TRUE;
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $translatables['commons_featured'] = array(
+    t('Master'),
+    t('Featured on this site'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('[field_address-locality], [field_address-administrative_area]'),
+    t('.'),
+    t(','),
+    t('Page'),
+    t('Feed'),
+    t('Featured content'),
+    t('Commons'),
+  );
+  $export['commons_featured'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_follow/commons-follow-otheruser-flag.tpl.php b/modules/commons/commons_follow/commons-follow-otheruser-flag.tpl.php
new file mode 100644
index 0000000..7a028bd
--- /dev/null
+++ b/modules/commons/commons_follow/commons-follow-otheruser-flag.tpl.php
@@ -0,0 +1,3 @@
+<span class="<?php print $flag_wrapper_classes; ?>">
+   <span class="<?php print $flag_classes ?>"><?php print $link_text; ?></span>
+</span>
diff --git a/modules/commons/commons_follow/commons_follow.features.field_base.inc b/modules/commons/commons_follow/commons_follow.features.field_base.inc
new file mode 100644
index 0000000..3e58098
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow.features.field_base.inc
@@ -0,0 +1,152 @@
+<?php
+/**
+ * @file
+ * commons_follow.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_follow_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_target_comments'
+  $field_bases['field_target_comments'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_target_comments',
+    'field_permissions' => array(
+      'type' => 0,
+    ),
+    'foreign keys' => array(
+      'comment' => array(
+        'columns' => array(
+          'target_id' => 'cid',
+        ),
+        'table' => 'comment',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'handler_submit' => 'Change handler',
+      'target_type' => 'comment',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'field_target_nodes'
+  $field_bases['field_target_nodes'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_target_nodes',
+    'field_permissions' => array(
+      'type' => 0,
+    ),
+    'foreign keys' => array(
+      'node' => array(
+        'columns' => array(
+          'target_id' => 'nid',
+        ),
+        'table' => 'node',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'handler_submit' => 'Change handler',
+      'target_type' => 'node',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'field_target_users'
+  $field_bases['field_target_users'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_target_users',
+    'field_permissions' => array(
+      'type' => 0,
+    ),
+    'foreign keys' => array(
+      'users' => array(
+        'columns' => array(
+          'target_id' => 'uid',
+        ),
+        'table' => 'users',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'direction' => 'ASC',
+          'field' => 'og_user_group_ref:target_id',
+          'property' => 'uid',
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'handler_submit' => 'Change handler',
+      'target_type' => 'user',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_follow/commons_follow.features.inc b/modules/commons/commons_follow/commons_follow.features.inc
new file mode 100644
index 0000000..75926cd
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow.features.inc
@@ -0,0 +1,46 @@
+<?php
+/**
+ * @file
+ * commons_follow.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_follow_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_image_default_styles().
+ */
+function commons_follow_image_default_styles() {
+  $styles = array();
+
+  // Exported image style: 50x50_avatar.
+  $styles['50x50_avatar'] = array(
+    'label' => '50x50_avatar',
+    'name' => '50x50_avatar',
+    'effects' => array(
+      3 => array(
+        'label' => 'Scale and crop',
+        'help' => 'Scale and crop will maintain the aspect-ratio of the original image, then crop the larger dimension. This is most useful for creating perfectly square thumbnails without stretching the image.',
+        'effect callback' => 'image_scale_and_crop_effect',
+        'dimensions callback' => 'image_resize_dimensions',
+        'form callback' => 'image_resize_form',
+        'summary theme' => 'image_resize_summary',
+        'module' => 'image',
+        'name' => 'image_scale_and_crop',
+        'data' => array(
+          'width' => 50,
+          'height' => 50,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  return $styles;
+}
diff --git a/modules/commons/commons_follow/commons_follow.info b/modules/commons/commons_follow/commons_follow.info
new file mode 100644
index 0000000..b76b195
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow.info
@@ -0,0 +1,25 @@
+name = Commons Follow
+description = Views and Field integration for Commons Following functionality.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = field_sql_storage
+dependencies[] = message_subscribe
+dependencies[] = strongarm
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[field_base][] = field_target_comments
+features[field_base][] = field_target_nodes
+features[field_base][] = field_target_users
+features[image][] = 50x50_avatar
+features[variable][] = message_subscribe_flag_prefix
+features_exclude[dependencies][image] = image
+files[] = includes/views/commons_follow.views.inc
+files[] = includes/views/handlers/commons_follow_handler_filter_follow.inc
+files[] = includes/views/handlers/commons_follow_plugin_argument_default_node.inc
+files[] = includes/views/handlers/commons_follow_plugin_argument_default_message.inc
+files[] = includes/views/handlers/commons_follow_user_follow_filter.inc
+files[] = includes/views/handlers/commons_follow_user_follow_filter_message.inc
+files[] = includes/views/handlers/commons_follow_handler_field_ops.inc
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow.module b/modules/commons/commons_follow/commons_follow.module
new file mode 100644
index 0000000..e301be2
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow.module
@@ -0,0 +1,322 @@
+<?php
+
+include_once 'commons_follow.features.inc';
+
+/**
+ * Implements hook_theme().
+ */
+function commons_follow_theme() {
+  return array(
+    'commons_follow_otheruser_flag' => array(
+      'variables' => array(
+        'is_flagged' => NULL,
+        'link_text' => NULL,
+        'flag_wrapper_classes' => NULL,
+        'flag_classes' => NULL,
+      ),
+      'template' => 'commons-follow-otheruser-flag',
+    ),
+  );
+}
+
+/**
+ * Implements hook_features_pipe_alter().
+ *
+ */
+function commons_follow_features_pipe_alter(&$pipe, $data, $export) {
+  $commons_follow_fields = array(
+    'field_target_users', 'field_target_nodes', 'field_target_comments',
+  );
+  // Prevent Commons Follow fields from being piped in features
+  // when a content type includes those fields.
+  if (!empty($pipe['field_instance'])) {
+    foreach ($pipe['field_instance'] as $delta => $value) {
+      $args = explode('-', $value);
+      $field_name = $args[2];
+      if (in_array($field_name, $commons_follow_fields)) {
+        unset($pipe['field_instance'][$delta]);
+      }
+    }
+  }
+  if (!empty($pipe['field_base'])) {
+    foreach ($pipe['field_base'] as $delta => $value) {
+      if (in_array($delta, $commons_follow_fields)) {
+        unset($pipe['field_base'][$delta]);
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ *
+ * Adding the "Following" filter to the group-browsing-widget views.
+ */
+function commons_follow_views_default_views_alter(&$views) {
+  // Add a "most active" exposed sort to Commons BW views.
+  foreach ($views as $view_id => $view) {
+    if (strpos($view_id, 'commons_bw_') !== 0) {
+      continue;
+    }
+
+    $handler = $views[$view_id]->display['default']->handler;
+
+    // Relationship to the "Following" flag.
+    $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+    $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'node';
+    $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+    $handler->display->display_options['relationships']['flag_content_rel']['ui_name'] = 'Following';
+    $handler->display->display_options['relationships']['flag_content_rel']['label'] = 'following';
+    $handler->display->display_options['relationships']['flag_content_rel']['required'] = 0;
+    $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_node';
+
+    // Exposed "Following" filter.
+    $handler->display->display_options['filters']['flagged']['id'] = 'flagged';
+    $handler->display->display_options['filters']['flagged']['table'] = 'flag_content';
+    $handler->display->display_options['filters']['flagged']['field'] = 'flagged';
+    $handler->display->display_options['filters']['flagged']['relationship'] = 'flag_content_rel';
+    $handler->display->display_options['filters']['flagged']['ui_name'] = 'Following';
+    $handler->display->display_options['filters']['flagged']['value'] = '1';
+    $handler->display->display_options['filters']['flagged']['exposed'] = TRUE;
+    $handler->display->display_options['filters']['flagged']['expose']['operator_id'] = '';
+    $handler->display->display_options['filters']['flagged']['expose']['label'] = 'Following';
+    $handler->display->display_options['filters']['flagged']['expose']['operator'] = 'flagged_op';
+    $handler->display->display_options['filters']['flagged']['expose']['identifier'] = 'following';
+    $handler->display->display_options['filters']['flagged']['expose']['required'] = FALSE;
+  }
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_follow_form_alter(&$form, &$form_state, $form_id) {
+  if ($form_id != 'views_exposed_form' || strpos($form['#id'],'views-exposed-form-commons-bw') !== 0 || empty($form['following'])) {
+    return;
+  }
+
+  $form['#info']['filter-flagged']['label'] = t('Limited to');
+
+  $form['following']['#options'] = array(
+    'All' => t('All content'),
+    1 => t("Content you're following"),
+    0 => t("Content you're not following"),
+  );
+}
+
+/**
+ * Implements hook_flag_export_alter().
+ */
+function commons_follow_flag_export_alter(&$flag) {
+  // We export $flag->types as an array in code, then dynamically change
+  // the values in commons_follow_flag_alter(). Prevent that from being
+  // overwritten with the dynamic values.
+  if (in_array($flag['name'], array('commons_follow_node', 'email_node'))) {
+    $flag['types'] = array();
+  }
+}
+
+/**
+ * Implements hook_flag_alter().
+ */
+function commons_follow_flag_alter(&$flag) {
+  $commons_entity_integrations = commons_entity_integration_info();
+  // Find Commons node types that should have follow integration and alter
+  // the commons_follow_node flag to allow following these node types.
+  // This is currently hard-coded to node entities and the
+  // commons_follow_node flag, but could be expanded to add the ability
+  // to follow other entities.
+  // The Commons follow flags for user, term and group already have the
+  // appropriate content types in their flag exports, whereas
+  // $flag->types for commons_follow_node is more likely
+  // to change between sites.
+  if (in_array($flag->name, array('commons_follow_node', 'email_node'))) {
+    if (!empty($commons_entity_integrations['node'])) {
+      // Exclude bundles that users should not be able to follow:
+      foreach ($commons_entity_integrations['node'] as $bundle => $options) {
+        if (isset($options['exclude_commons_follow']) && $options['exclude_commons_follow'] == TRUE) {
+          unset($commons_entity_integrations['node'][$bundle]);
+        }
+      }
+      // Add the remaining bundles as flaggable options
+      if (!empty($commons_entity_integrations['node'])) {
+        $flag->types += array_keys($commons_entity_integrations['node']);
+      }
+    }
+  }
+}
+
+/**
+ * Get all node IDs relevant to what the user ordered.
+ *
+ * @param $account
+ *   The user being checked. Defaults to the current user.
+ * @param $options
+ *   Array. Includes options to alter the query. Options available are used
+ *   within the hook implementations.
+ *
+ * @return
+ *   Array of node IDs.
+ */
+function commons_follow_get_nids($account = NULL, $options = array()) {
+  if (empty($account)) {
+    global $user;
+    $account = clone $user;
+  }
+
+  $nids = array();
+  // We don't use module_invoke_all() is we want to retain the array keys,
+  // which are the user IDs.
+  foreach (module_implements('commons_follow_get_nids') as $module) {
+    $function = $module . '_commons_follow_get_nids';
+    $result = $function($account, $options);
+    if (empty($result)) {
+      continue;
+    }
+    foreach ($result as $nid) {
+      $nids[$nid] = $nid;
+    }
+  }
+  return $nids;
+}
+
+
+
+/**
+ * Get subscriptions flag IDs.
+ *
+ * @param $content_type
+ *   Optional. The type of content for which to load the flags. Usually 'node'.
+ * @param $content_subtype
+ *   Optional. The node type for which to load the flags.
+ * @param $account
+ *   Optional. The user accont to filter available flags. If not set, all
+ *   flags for will this node will be returned.
+ * @param $reset
+ *   Optional. Reset the internal query cache.
+ *
+ * @return $flags
+ *   An array of the structure [fid] = flag_object.
+ *
+ * @see flag_get_flags()
+ */
+function commons_follow_get_subscription_flags_ids($content_type = NULL, $content_subtype = NULL, $account = NULL, $reset = FALSE) {
+  if (!module_exists('message_subscribe')) {
+    // Requires message_subscribe module.
+    return;
+  }
+  $flags = message_subscribe_flag_get_flags($content_type, $content_subtype, $account, $reset);
+
+  $flag_ids = array();
+  foreach ($flags as $flag) {
+    $flag_ids[] = $flag->fid;
+  }
+  return $flag_ids;
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_follow_views_api() {
+  return array(
+    'api' => 3,
+    'path' => drupal_get_path('module', 'commons_follow') . '/includes/views',
+  );
+}
+
+/**
+* Returns a list of Commons Follow Flag objects.
+*/
+function commons_follow_get_flags() {
+  $flags = flag_get_flags();
+  foreach ($flags as $key => $flag) {
+    if (substr($key, 0, 14) != 'commons_follow') {
+      unset($flags[$key]);
+    }
+  }
+  return $flags;
+}
+
+/**
+* Returns an array of Commons Follow flags keyed on the numeric flag ID.
+*/
+function commons_follow_get_flag_ids() {
+  $flag_ids = array();
+  $flags = commons_follow_get_flags();
+  foreach ($flags as $key => $flag) {
+    $flag_ids[$flag->fid] = $key;
+  }
+  return $flag_ids;
+}
+
+/**
+* Returns a single flag ID based on a flag machine name.
+*/
+function commons_follow_get_flag_id($name) {
+  $flag = flag_get_flag($name);
+  $return = $flag->fid;
+  return $flag->fid;
+}
+/**
+ * Get a list of all content that a user is following.
+ * @return
+ *  An array keyed on the flag name with values corresponding to the IDs
+ *  of the flagged entities.
+ */
+function commons_follow_get_followed_content($account = array()) {
+  if (empty($account)) {
+    global $user;
+    $account = $user;
+  }
+  $results = array();
+  $flag_ids = commons_follow_get_flag_ids();
+  // Get a list of everything that the user is following.
+  $result = db_query("SELECT fid, content_id FROM {flag_content} WHERE fid IN (:fids) AND uid = :uid", array(':fids' => array_keys($flag_ids), ':uid' => $account->uid));
+  foreach ($result as $this_result) {
+    $results[$flag_ids[$this_result->fid]][] = $this_result->content_id;
+  }
+
+  return $results;
+}
+
+/**
+* Find a list of message IDs that correspond to events that the current user
+* is following.
+*/
+function commons_follow_get_followed_message_ids($account = NULL) {
+  $followed_mids = array();
+  // Allow the module with this flag namespace to return a list of
+  // followed MIDs.
+  $followed_content = commons_follow_get_followed_content($account);
+  $followed_mids = array();
+  foreach ($followed_content as $key => $content) {
+    $function = $key . '_commons_follow_get_message_ids';
+    if (function_exists($function)) {
+      $function($followed_mids, $followed_content);
+    }
+  }
+  return $followed_mids;
+}
+
+function commons_follow_views_data_alter(&$data) {
+  $data['flag_content']['ops']['field']['handler'] = 'commons_follow_handler_field_ops';
+}
+
+function commons_follow_views_query_alter(&$view, &$query) {
+  global $user;
+  $prefix = variable_get('message_subscribe_flag_prefix', 'subscribe') . '_';
+  if(strpos($view->name, $prefix) === 0 && isset($view->args[0]) && $user->uid != $view->args[0]) {
+    $flag_content_keys = array_keys($query->table_queue);
+    foreach($flag_content_keys AS $key) {
+      if(strpos($key, 'flag_content') === 0) {
+        //Convert the Send Email Query
+        $join = $query->table_queue[$key]['join'];
+        $join->extra[1] = array(
+          'field' => 'uid',
+          'value' => $view->args[0],
+          'numeric' => TRUE,
+        );
+        $query->table_queue[$key]['join'] = $join;
+      }
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow.strongarm.inc b/modules/commons/commons_follow/commons_follow.strongarm.inc
new file mode 100644
index 0000000..999ad58
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow.strongarm.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * commons_follow.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_follow_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'message_subscribe_flag_prefix';
+  $strongarm->value = 'commons_follow';
+  $export['message_subscribe_flag_prefix'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_follow/commons_follow_group/commons_follow_group.features.inc b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.features.inc
new file mode 100644
index 0000000..badb5fd
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.features.inc
@@ -0,0 +1,97 @@
+<?php
+/**
+ * @file
+ * commons_follow_group.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_follow_group_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_flag_default_flags().
+ */
+function commons_follow_group_flag_default_flags() {
+  $flags = array();
+  // Exported flag: "Groups".
+  $flags['commons_follow_group'] = array(
+    'content_type' => 'node',
+    'title' => 'Groups',
+    'global' => 0,
+    'types' => array(
+      0 => 'group',
+    ),
+    'flag_short' => 'Follow',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Following',
+    'unflag_long' => '',
+    'unflag_message' => 'Not following',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => 0,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_page' => 1,
+    'show_on_teaser' => 1,
+    'show_contextual_link' => FALSE,
+    'i18n' => 0,
+    'module' => 'commons_follow_group',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  // Exported flag: "Commons Follow (Groups - Email)".
+  $flags['email_group'] = array(
+    'content_type' => 'node',
+    'title' => 'Commons Follow (Groups - Email)',
+    'global' => 0,
+    'types' => array(
+      0 => 'group',
+    ),
+    'flag_short' => 'Receive email updates',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Don\'t receive email updates',
+    'unflag_long' => '',
+    'unflag_message' => '',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => -11,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_page' => 0,
+    'show_on_teaser' => 0,
+    'show_contextual_link' => FALSE,
+    'i18n' => 0,
+    'module' => 'commons_follow_group',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  return $flags;
+
+}
diff --git a/modules/commons/commons_follow/commons_follow_group/commons_follow_group.info b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.info
new file mode 100644
index 0000000..aacc282
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.info
@@ -0,0 +1,13 @@
+name = Commons Follow (Groups)
+description = Lets users follow individual organic groups.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = flag
+dependencies[] = og
+dependencies[] = strongarm
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[flag][] = commons_follow_group
+features[flag][] = email_group
+features[variable][] = message_subscribe_og
diff --git a/modules/commons/commons_follow/commons_follow_group/commons_follow_group.install b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.install
new file mode 100644
index 0000000..aaa0894
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.install
@@ -0,0 +1,9 @@
+<?php
+
+/**
+* Update Flag link text.
+*/
+function commons_follow_group_update_3101() {
+  features_revert(array('commons_follow_group' => array('flag')));
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow_group/commons_follow_group.module b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.module
new file mode 100644
index 0000000..f203a47
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.module
@@ -0,0 +1,153 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Follow (Groups) feature.
+ */
+
+include_once 'commons_follow_group.features.inc';
+
+/**
+ * Implements hook_commons_follow_get_nids().
+ */
+function commons_follow_group_commons_follow_get_nids($account, $options) {
+  // Get all group content from a followed group.
+  $gids = og_get_entity_groups('user', $account);
+  if (empty($gids['node'])) {
+    return;
+  }
+
+  // Get subscribe flag IDs.
+  $flag_ids = commons_follow_get_subscription_flags_ids('node');
+
+  $query = db_select('flag_content', 'f');
+  if (!empty($options['range'])) {
+    $query->range(0, $options['range']);
+  }
+
+  $result = $query
+    ->condition('fid', $flag_ids, 'IN')
+    ->condition('uid', $account->uid, '=')
+    ->condition('content_type', 'node', '=')
+    ->condition('content_id', $gids['node'], 'IN')
+    ->fields('f',array('content_id'))
+    ->execute()
+    ->fetchAll();
+
+  if (empty($result)) {
+    return array();
+  }
+
+  $nids = array();
+  foreach($result as $row) {
+    $nids[] = $row->content_id;
+  }
+
+  // Get the groups' content IDs.
+  $query = new EntityFieldQuery();
+  $result = $query
+    ->entityCondition('entity_type', 'og_membership')
+    ->propertyCondition('group_type', 'node')
+    ->propertyCondition('gid', $nids, 'IN')
+    ->propertyCondition('entity_type', 'node', '=')
+    ->execute();
+
+  if (empty($result['og_membership'])) {
+    return array();
+  }
+
+  // Keep array structure.
+  $nids = array();
+  $og_memberships = og_membership_load_multiple(array_keys($result['og_membership']));
+  foreach ($og_memberships as $og_membership) {
+    $nid = $og_membership->etid;
+    $nids[$nid] = $nid;
+  }
+
+  return $nids;
+}
+
+/**
+* Implements hook_node_view_alter().
+*/
+function commons_follow_group_node_view_alter(&$build) {
+  // Prevent users from following group nodes under the
+  // commons_follow_node flag.
+  // Instead, they should be followed using the commons_follow_group flag.
+  if (og_is_group_type('node', $build['#node']->type)) {
+    if (!empty($build['links']['flag']['#links']['flag-commons_follow_node'])) {
+      unset($build['links']['flag']['#links']['flag-commons_follow_node']);
+    }
+  }
+}
+
+/**
+* Implements hook_commons_follow_get_message_ids().
+*/
+function commons_follow_group_commons_follow_get_message_ids(&$followed_mids, $followed_content = array()) {
+  // Generate a list of message IDs where the target nodes are followed by
+  // the current user.
+  $result = db_query("SELECT m.mid AS mid FROM {message} m INNER JOIN {field_data_field_target_nodes} tn ON m.mid=tn.entity_id INNER JOIN {og_membership} om ON tn.field_target_nodes_target_id=om.etid WHERE om.entity_type = 'node' AND om.gid IN (:gids)", array(':gids' => array_values($followed_content['commons_follow_group'])));
+  foreach ($result as $this_result) {
+    $followed_mids[] = $this_result->mid;
+  }
+}
+
+/**
+ * Implements hook_node_insert().
+ */
+function commons_follow_group_node_insert($node) {
+  if ($node->type != 'group') {
+    return;
+  }
+  // The owner of the content automatically follows the content
+  $account = user_load($node->uid);
+  $flag = flag_get_flag('commons_follow_group');
+  $flag->flag('flag', $node->nid, $account);
+}
+
+
+/**
+ * Implements hook_og_membership_insert().
+ * Invoked from hook_entity_insert().
+ */
+function commons_follow_group_og_membership_insert(OgMembership $og_membership) {
+  commons_follow_group_sync_flag_to_group_membership($og_membership);
+}
+
+/**
+ * Implements hook_og_membership_update().
+ * Invoked from hook_entity_update().
+ */
+function commons_follow_group_og_membership_update(OgMembership $og_membership) {
+  commons_follow_group_sync_flag_to_group_membership($og_membership);
+}
+
+/**
+ * Implements hook_og_membership_delete().
+ * Invoked from hook_entity_delete().
+ */
+function commons_follow_group_og_membership_delete(OgMembership $og_membership) {
+  // The user should unfollow the group when her membership is deleted.
+  if ($og_membership->entity_type == 'user' && $og_membership->field_name == 'og_user_node') {
+    $account = user_load($og_membership->etid);
+    flag('unflag', 'commons_follow_group', $og_membership->gid, $account);    
+  }
+}
+
+// function flag($action, $flag_name, $content_id, $account = NULL) {
+
+function commons_follow_group_sync_flag_to_group_membership($og_membership) {
+  if ($og_membership->entity_type == 'user' && $og_membership->field_name == 'og_user_node') {
+    $account = user_load($og_membership->etid);
+    // The membership is approved. The user should follow the group.
+    if ($og_membership->state == 1) {
+      flag('flag', 'commons_follow_group', $og_membership->gid, $account);    
+    }
+    // The membership is not approved. The user should not follow the group.
+    else {
+      flag('unflag', 'commons_follow_group', $og_membership->gid, $account);    
+    }
+  }
+}
+  
+
diff --git a/modules/commons/commons_follow/commons_follow_group/commons_follow_group.strongarm.inc b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.strongarm.inc
new file mode 100644
index 0000000..bc60cbc
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_group/commons_follow_group.strongarm.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * commons_follow_group.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_follow_group_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'message_subscribe_og';
+  $strongarm->value = 'subscribe_node_email:default';
+  $export['message_subscribe_og'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_follow/commons_follow_node/commons_follow_node.features.inc b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.features.inc
new file mode 100644
index 0000000..1f8e294
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.features.inc
@@ -0,0 +1,91 @@
+<?php
+/**
+ * @file
+ * commons_follow_node.features.inc
+ */
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_follow_node_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_flag_default_flags().
+ */
+function commons_follow_node_flag_default_flags() {
+  $flags = array();
+  // Exported flag: "Other content you follow".
+  $flags['commons_follow_node'] = array(
+    'content_type' => 'node',
+    'title' => 'Other content',
+    'global' => 0,
+    'types' => array(),
+    'flag_short' => 'Follow',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Following',
+    'unflag_long' => '',
+    'unflag_message' => 'Not following',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => -10,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_page' => 1,
+    'show_on_teaser' => 1,
+    'show_contextual_link' => FALSE,
+    'i18n' => 0,
+    'module' => 'commons_follow_node',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  // Exported flag: "Email content".
+  $flags['email_node'] = array(
+    'content_type' => 'node',
+    'title' => 'Email content',
+    'global' => 0,
+    'types' => array(),
+    'flag_short' => 'Send Email',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Don\'t send Email',
+    'unflag_long' => '',
+    'unflag_message' => '',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => 0,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_page' => 0,
+    'show_on_teaser' => 0,
+    'show_contextual_link' => 0,
+    'i18n' => 0,
+    'module' => 'commons_follow_node',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  return $flags;
+
+}
diff --git a/modules/commons/commons_follow/commons_follow_node/commons_follow_node.info b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.info
new file mode 100644
index 0000000..91d481d
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.info
@@ -0,0 +1,13 @@
+name = Commons Follow (Individual nodes)
+description = Lets users follow individual nodes.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = flag
+dependencies[] = views_litepager
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[flag][] = commons_follow_node
+features[flag][] = email_node
+features[views_view][] = commons_follow_node
+features_exclude[dependencies][views] = views
diff --git a/modules/commons/commons_follow/commons_follow_node/commons_follow_node.install b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.install
new file mode 100644
index 0000000..6d08f0c
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.install
@@ -0,0 +1,21 @@
+<?php
+
+/**
+* Update Flag link text.
+*/
+function commons_follow_node_update_3101() {
+  features_revert(array('commons_follow_node' => array('flag')));
+  return array();
+}
+
+/**
+ * Update profile notification page to show an account's following views
+ * Not the current users following view.
+ */
+function commons_follow_node_update_3501() {
+  $revert = array(
+    'commons_follow_node' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow_node/commons_follow_node.module b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.module
new file mode 100644
index 0000000..463e4ea
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.module
@@ -0,0 +1,86 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Follow (Individual nodes) feature.
+ */
+
+include_once 'commons_follow_node.features.inc';
+
+/**
+ * Implements hook_commons_follow_get_nids().
+ */
+function commons_follow_node_commons_follow_get_nids($account, $options) {
+  // Get all flaggings from flags that belong to Message-subscribe, that
+  // reference the node entity-type.
+
+  // Get subscribe flag IDs.
+  $flag_ids = commons_follow_get_subscription_flags_ids('node');
+  if (empty($flag_ids)) {
+    return array();
+  }
+
+  $query = db_select('flag_content', 'f');
+
+  if (!empty($options['range'])) {
+    $query->range(0, $options['range']);
+  }
+
+  $result = $query
+    ->condition('fid', $flag_ids, 'IN')
+    ->condition('uid', $account->uid, '=')
+    ->condition('content_type', 'node', '=')
+    ->fields('f',array('content_id'))
+    ->execute()
+    ->fetchAll();
+  $nids = array();
+  foreach($result as $row) {
+    $nids[] = (integer) $row->content_id;
+  }
+
+  return $nids;
+}
+
+/**
+* Implements hook_commons_follow_get_message_ids().
+*/
+function commons_follow_node_commons_follow_get_message_ids(&$followed_mids, $followed_content = array()) {
+  // Generate a list of message IDs where the target nodes are followed by
+  // the current user.
+  $result = db_query("SELECT m.mid AS mid FROM {message} m INNER JOIN {field_data_field_target_nodes} tn ON m.mid=tn.entity_id WHERE tn.field_target_nodes_target_id IN (:nids)", array(':nids' => array_values($followed_content['commons_follow_node'])));
+  foreach ($result as $this_result) {
+    $followed_mids[] = $this_result->mid;
+  }
+}
+
+/**
+ * Implements hook_node_insert().
+ */
+function commons_follow_node_node_insert($node) {
+  // The owner of the content automatically follows the content
+  commons_follow_node_follow_node($node->nid, $node->type, $node->uid);
+}
+
+/**
+ * Implements hook_comment_insert().
+ */
+function commons_follow_node_comment_insert($comment) {
+  // The user who comment a node automatically follows that content
+  $content_type = str_replace('comment_node_', '', $comment->node_type);
+  commons_follow_node_follow_node($comment->nid, $content_type, $comment->uid);
+}
+
+/**
+ * Let a user to follow a node.
+ *
+ * @see commons_follow_node_comment_insert
+ * @see commons_follow_node_node_insert
+ */
+function commons_follow_node_follow_node($nid, $content_type, $user_id = NULL) {
+  $flag = flag_get_flag('commons_follow_node');
+
+  // Check if this content type use the "Individual nodes" flag
+  if (in_array($content_type, $flag->types)) {
+    $account = isset($user_id) ? user_load($user_id) : NULL;
+    $flag->flag('flag', $nid, $account);
+  }
+}
diff --git a/modules/commons/commons_follow/commons_follow_node/commons_follow_node.views_default.inc b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.views_default.inc
new file mode 100644
index 0000000..8db8038
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_node/commons_follow_node.views_default.inc
@@ -0,0 +1,167 @@
+<?php
+/**
+ * @file
+ * commons_follow_node.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_follow_node_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_follow_node';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Nodes a user follows';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['distinct'] = TRUE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '2';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'title' => 'title',
+    'ops_1' => 'ops_1',
+    'ops' => 'ops',
+  );
+  $handler->display->display_options['style_options']['default'] = '-1';
+  $handler->display->display_options['style_options']['info'] = array(
+    'title' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'ops_1' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'ops' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  $handler->display->display_options['style_options']['sticky'] = TRUE;
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'You\'re not following anything of this type.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Flags: commons_follow_node */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_node';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Relationship: Flags: email_node */
+  $handler->display->display_options['relationships']['flag_content_rel_1']['id'] = 'flag_content_rel_1';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['table'] = 'node';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['label'] = 'email_flag';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['required'] = 0;
+  $handler->display->display_options['relationships']['flag_content_rel_1']['flag'] = 'email_node';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['user_scope'] = 'any';
+  /* Relationship: Flags: User */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'flag_content';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['relationship'] = 'flag_content_rel';
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Flags: Flag link */
+  $handler->display->display_options['fields']['ops_1']['id'] = 'ops_1';
+  $handler->display->display_options['fields']['ops_1']['table'] = 'flag_content';
+  $handler->display->display_options['fields']['ops_1']['field'] = 'ops';
+  $handler->display->display_options['fields']['ops_1']['relationship'] = 'flag_content_rel_1';
+  $handler->display->display_options['fields']['ops_1']['label'] = 'Send email?';
+  $handler->display->display_options['fields']['ops_1']['element_label_colon'] = FALSE;
+  /* Field: Flags: Flag link */
+  $handler->display->display_options['fields']['ops']['id'] = 'ops';
+  $handler->display->display_options['fields']['ops']['table'] = 'flag_content';
+  $handler->display->display_options['fields']['ops']['field'] = 'ops';
+  $handler->display->display_options['fields']['ops']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['fields']['ops']['label'] = '';
+  $handler->display->display_options['fields']['ops']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['ops']['link_type'] = 'toggle';
+  /* Sort criterion: Flags: Flagged time */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'flag_content';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: User: Uid */
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'users';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['relationship'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'user';
+  $handler->display->display_options['arguments']['uid']['default_argument_options']['user'] = FALSE;
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['uid']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['uid']['validate']['type'] = 'user';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['operator'] = 'not empty';
+  $handler->display->display_options['filters']['type']['value'] = array();
+  $translatables['commons_follow_node'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('You\'re not following anything of this type.'),
+    t('flag'),
+    t('email_flag'),
+    t('Title'),
+    t('Send email?'),
+  );
+  $export['commons_follow_node'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_follow/commons_follow_term/commons_follow_term.features.inc b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.features.inc
new file mode 100644
index 0000000..4b10c15
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.features.inc
@@ -0,0 +1,89 @@
+<?php
+/**
+ * @file
+ * commons_follow_term.features.inc
+ */
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_follow_term_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_flag_default_flags().
+ */
+function commons_follow_term_flag_default_flags() {
+  $flags = array();
+  // Exported flag: "Topics you follow".
+  $flags['commons_follow_term'] = array(
+    'content_type' => 'taxonomy_term',
+    'title' => 'Topics',
+    'global' => 0,
+    'types' => array(
+      0 => 'topics',
+    ),
+    'flag_short' => 'Follow',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Following',
+    'unflag_long' => '',
+    'unflag_message' => 'Not following',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => -8,
+    'show_on_entity' => 1,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'module' => 'commons_follow_term',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  // Exported flag: "Email term".
+  $flags['email_term'] = array(
+    'content_type' => 'taxonomy_term',
+    'title' => 'Email term',
+    'global' => 0,
+    'types' => array(
+      0 => 'topics',
+    ),
+    'flag_short' => 'Send Email',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Don\'t send Email',
+    'unflag_long' => '',
+    'unflag_message' => '',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => 0,
+    'show_on_entity' => 1,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'module' => 'commons_follow_term',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  return $flags;
+
+}
diff --git a/modules/commons/commons_follow/commons_follow_term/commons_follow_term.info b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.info
new file mode 100644
index 0000000..cc99417
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.info
@@ -0,0 +1,13 @@
+name = Commons Follow (Taxonomy terms)
+description = Lets users follow individual taxonomy terms
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = flag
+dependencies[] = views
+dependencies[] = views_litepager
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[flag][] = commons_follow_term
+features[flag][] = email_term
+features[views_view][] = commons_follow_taxonomy_term
+features_exclude[dependencies][ctools] = ctools
diff --git a/modules/commons/commons_follow/commons_follow_term/commons_follow_term.install b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.install
new file mode 100644
index 0000000..77c4c76
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.install
@@ -0,0 +1,29 @@
+<?php
+
+/**
+* Update Flag link text.
+*/
+function commons_follow_term_update_3101() {
+  features_revert(array('commons_follow_term' => array('flag')));
+  return array();
+}
+
+/**
+ * Update email_term flag to allow terms in Topics vocabulary to be flagged.
+ */
+function commons_follow_term_update_3102() {
+  features_revert(array('commons_follow_term' => array('flag')));
+  return array();
+}
+
+/**
+ * Update profile notification page to show an account's following views
+ * Not the current users following view.
+ */
+function commons_follow_term_update_3501() {
+  $revert = array(
+    'commons_follow_term' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow_term/commons_follow_term.module b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.module
new file mode 100644
index 0000000..2eb4b56
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.module
@@ -0,0 +1,75 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Follow (Taxonomy terms) feature.
+ */
+
+include_once 'commons_follow_term.features.inc';
+
+/**
+ * Implements hook_commons_follow_get_nids().
+ */
+function commons_follow_term_commons_follow_get_nids($account, $options) {
+  // Get all flaggings from flags that belong to Message-subscribe, that
+  // reference the taxonomy-term entity-type.
+  $flag_ids = commons_follow_get_subscription_flags_ids('taxonomy_term');
+
+  if (empty($flag_ids)) {
+    return array();
+  }
+
+  // Get user's flagged terms.
+  $query = db_select('flag_content', 'f');
+  $result = $query
+    ->condition('fid', $flag_ids, 'IN')
+    ->condition('uid', $account->uid, '=')
+    ->condition('content_type', 'taxonomy_term', '=')
+    ->fields('f',array('content_id'))
+    ->execute()
+    ->fetchAll();
+
+  if (empty($result)) {
+    // No term flags.
+    return array();
+  }
+
+  $tids = array();
+  foreach($result as $row) {
+    $tids[] = (integer) $row->content_id;
+  }
+
+  // Get IDs of nodes tagged by the specified terms.
+  $query = db_select('taxonomy_index', 't');
+
+  if (!empty($options['range'])) {
+    $query->range(0, $options['range']);
+  }
+
+  $result = $query
+    ->addTag('node_access')
+    ->condition('tid', $tids, 'IN')
+    ->fields('t',array('nid'))
+    ->groupBy('nid')
+    ->execute()
+    ->fetchAll();
+
+  // Return the node IDs.
+  $nids = array();
+  foreach($result as $row) {
+    $nids[] = (integer) $row->nid;
+  }
+
+  return $nids;
+}
+
+/**
+* Implements hook_commons_follow_get_message_ids().
+*/
+function commons_follow_term_commons_follow_get_message_ids(&$followed_mids, $followed_content = array()) {
+  // Generate a list of message IDs where the target nodes are followed by
+  // the current user.
+  $result = db_query("SELECT m.mid AS mid FROM {message} m INNER JOIN {field_data_field_target_nodes} tn ON m.mid=tn.entity_id INNER JOIN {field_data_field_topics} ft ON ft.entity_id=tn.field_target_nodes_target_id WHERE ft.field_topics_tid IN (:tids) AND tn.entity_type = 'node'", array(':tids' => array_values($followed_content['commons_follow_term'])));
+  foreach ($result as $this_result) {
+    $followed_mids[] = $this_result->mid;
+  }
+}
diff --git a/modules/commons/commons_follow/commons_follow_term/commons_follow_term.views_default.inc b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.views_default.inc
new file mode 100644
index 0000000..21e785a
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_term/commons_follow_term.views_default.inc
@@ -0,0 +1,154 @@
+<?php
+/**
+ * @file
+ * commons_follow_term.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_follow_term_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_follow_taxonomy_term';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'taxonomy_term_data';
+  $view->human_name = 'Topics a user follows';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '6';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'name' => 'name',
+    'ops_1' => 'ops_1',
+    'ops' => 'ops',
+  );
+  $handler->display->display_options['style_options']['default'] = '-1';
+  $handler->display->display_options['style_options']['info'] = array(
+    'name' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'ops_1' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'ops' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  $handler->display->display_options['style_options']['sticky'] = TRUE;
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'You aren\'t following any topics.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Flags: commons_follow_term */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'taxonomy_term_data';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_term';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Relationship: Flags: email_term */
+  $handler->display->display_options['relationships']['flag_content_rel_1']['id'] = 'flag_content_rel_1';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['table'] = 'taxonomy_term_data';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['label'] = 'email_flag';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['required'] = 0;
+  $handler->display->display_options['relationships']['flag_content_rel_1']['flag'] = 'email_term';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['user_scope'] = 'any';
+  /* Relationship: Flags: User */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'flag_content';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['relationship'] = 'flag_content_rel';
+  /* Field: Taxonomy term: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'taxonomy_term_data';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['label'] = 'Topic';
+  $handler->display->display_options['fields']['name']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['name']['alter']['ellipsis'] = FALSE;
+  $handler->display->display_options['fields']['name']['link_to_taxonomy'] = TRUE;
+  /* Field: Flags: Flag link */
+  $handler->display->display_options['fields']['ops_1']['id'] = 'ops_1';
+  $handler->display->display_options['fields']['ops_1']['table'] = 'flag_content';
+  $handler->display->display_options['fields']['ops_1']['field'] = 'ops';
+  $handler->display->display_options['fields']['ops_1']['relationship'] = 'flag_content_rel_1';
+  $handler->display->display_options['fields']['ops_1']['label'] = 'Send email?';
+  /* Field: Flags: Flag link */
+  $handler->display->display_options['fields']['ops']['id'] = 'ops';
+  $handler->display->display_options['fields']['ops']['table'] = 'flag_content';
+  $handler->display->display_options['fields']['ops']['field'] = 'ops';
+  $handler->display->display_options['fields']['ops']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['fields']['ops']['label'] = '';
+  $handler->display->display_options['fields']['ops']['element_label_colon'] = FALSE;
+  /* Sort criterion: Flags: Flagged time */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'flag_content';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  $translatables['commons_follow_taxonomy_term'] = array(
+  /* Contextual filter: User: Uid */
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('You aren\'t following any topics.'),
+    t('flag'),
+    t('email_flag'),
+    t('Topic'),
+    t('Send email?'),
+  );
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'users';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['relationship'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'user';
+  $handler->display->display_options['arguments']['uid']['default_argument_options']['user'] = FALSE;
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['uid']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['uid']['validate']['type'] = 'user';
+  $handler->display->display_options['arguments']['uid']['validate_options']['type'] = 'either';
+  $export['commons_follow_taxonomy_term'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.commons_utility_links.inc b/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.commons_utility_links.inc
new file mode 100644
index 0000000..172c3cb
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.commons_utility_links.inc
@@ -0,0 +1,25 @@
+<?php
+
+/**
+ * @file
+ * Commons Utility Links hooks implemented by the Commons Follow UI module.
+ */
+
+/**
+ * Implements hook_commons_utility_links().
+ */
+function commons_follow_ui_commons_utility_links() {
+  $links = array();
+
+  if (user_is_logged_in()) {
+    global $user;
+    $account = $user;
+    $links['settings']= array(
+      'href' => 'user/' . $account->uid . '/notification-settings',
+      'title' => t('Settings'),
+      'weight' => 10,
+    );
+  }
+
+  return $links;
+}
diff --git a/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.info b/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.info
new file mode 100644
index 0000000..12d6a77
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.info
@@ -0,0 +1,7 @@
+name = "Commons Follow UI"
+description = "User interface for the Commons Follow functionality"
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_follow
+dependencies[] = message_subscribe_ui
+dependencies[] = quicktabs
diff --git a/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.module b/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.module
new file mode 100644
index 0000000..56973cb
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_ui/commons_follow_ui.module
@@ -0,0 +1,172 @@
+<?php
+
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_follow_ui_menu_alter(&$items) {
+  // Override the default Message Subscribe UI and replace it with a similar
+  // Quicktabs-based one.
+  $paths = array(
+    'user/%user/message-subscribe',
+    'user/%user/message-subscribe/commons_follow_user',
+    'user/%user/message-subscribe/commons_follow_group',
+    'user/%user/message-subscribe/commons_follow_node',
+    'user/%user/message-subscribe/commons_follow_term',
+  );
+  foreach ($paths as $path) {
+    if (isset($items[$path])) {
+      $items[$path]['access callback'] = FALSE;
+    }
+  }
+}
+
+/**
+ * Implements hook_menu().
+ */
+function commons_follow_ui_menu() {
+  $items = array();
+  $items['user/%user/notification-settings'] = array(
+    'title' => 'Notification settings',
+    'page callback' => 'drupal_get_form',
+    'page arguments' => array('commons_follow_ui_notification_settings_form', 1),
+    'access callback' => 'message_subscribe_ui_tab_access',
+    'access arguments' => array(1),
+    'type' => MENU_LOCAL_TASK,
+  );
+  return $items;
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_follow_ui_form_alter(&$form, &$form_state, $form_id) {
+  // We have a dedicated form for the "Send email by default" checkbox.
+  // Hide it from the user profile edit form.
+  if ($form_id == 'edit_profile_user_profile_form') {
+    $form['message_subscribe_email']['#access'] = FALSE;
+  }
+}
+
+function commons_follow_ui_notification_settings_form($form, &$form_state, $account) {
+  global $user;
+  if (empty($account)) {
+    $account = $user;
+  }
+  drupal_set_title(t('Notification settings'));
+  $form['#submit'][] = 'commons_follow_message_subscribe_email_setting_submit';
+  $form['uid'] = array(
+    '#type' => 'value',
+    '#value' => $account->uid,
+  );
+  $form['explanation'] = array(
+    '#markup' => t("Control how you are notified of new content and activity. When you follow a group, topic, user, or other content, you'll see updates in your content and activity streams, and you will automatically get email updates unlesss you disable emails or unfollow."),
+    '#weight' => 0,
+  );
+
+  $form['message_subscribe_email'] = array(
+    '#type' => 'checkbox',
+    '#title' => t('Send email notifications by default.'),
+    '#description' => t("If checked, you'll automatically sign up for email notifications when you follow something. Leave unchecked to default to signing up only for activity stream notifications"),
+    '#ajax' => array(
+      'callback' => 'commons_follow_message_subscribe_email_setting_submit',
+    ),
+    '#default_value' => isset($account->message_subscribe_email[LANGUAGE_NONE][0]['value']) ? $account->message_subscribe_email[LANGUAGE_NONE][0]['value'] : FALSE,
+    '#weight' => 1,
+  );
+  if ($account->uid != $user->uid) {
+    $form['message_subscribe_email']['#disabled'] = TRUE;
+  }
+
+  $form['submit'] = array(
+    '#type' => 'submit',
+    '#value' => t('Save email notification settings'),
+    '#attributes' => array(
+      'class' => array('js-hide'),
+    ),
+    '#weight' => 2,
+  );
+
+  $tabs = commons_follow_ui_generate_tabs($account);
+  $form['tabs'] = array(
+    '#markup' => drupal_render($tabs),
+    '#weight' => 3,
+  );
+
+  return $form;
+}
+
+function commons_follow_message_subscribe_email_setting_submit($form, &$form_state) {
+  // If the user has changed the value for this checkbox,
+  // save her account in order to save the change.
+  if ($form_state['values']['message_subscribe_email'] != $form['message_subscribe_email']['#default_value']) {
+    $account = user_load($form_state['values']['uid']);
+    $account->message_subscribe_email[LANGUAGE_NONE][0]['value'] = $form_state['values']['message_subscribe_email'];
+    user_save($account);
+  }
+}
+
+/**
+ * Generates the QuickTab title for the subscription UI.
+ * Replaces message_subscribe_tab_title().
+ */
+function commons_follow_ui_tab_title($account, $flag_name = NULL, $count = 0) {
+  global $user;
+
+  if (!$flag_name) {
+    // We are inside /message-subscribe so get the first flag.
+    $flag_name = key(message_subscribe_flag_get_flags(NULL, NULL, $account, FALSE));
+  }
+  $flag = flag_get_flag($flag_name);
+
+  $params = array(
+    '@flag' => $flag->get_title(),
+    '@count' => $count,
+    '@name' => format_username($account),
+  );
+  return $account->uid == $user->uid ? t('@flag you follow <span class="user-follow-count">@count</span>', $params) : t('@flag @name follows <span class="user-follow-count">@count</span>', $params);
+}
+
+/*
+ * Generates the Quicktab content for the subscription UI
+ */
+function commons_follow_ui_generate_tabs($account) {
+  $tabs = array();
+  foreach (array_keys(message_subscribe_flag_get_flags(NULL, NULL, $account, FALSE)) as $flag_name) {
+    if ($view = message_subscribe_ui_get_view($account, $flag_name)) {
+
+      // We have to do some 'verbose' view loading here, otherwise we will get a
+      // pager when looking at an empty view result.
+      $view->get_total_rows = TRUE;
+      $view->pre_execute();
+      $view->execute();
+      if ($view->total_rows == '0') {
+        unset($view->query->pager);
+      }
+      $preview = $view->preview();
+      $count = $view->total_rows;
+    }
+    else {
+      $count = 0;
+    }
+    $tabs[$flag_name] = array(
+      'title' => commons_follow_ui_tab_title($account, $flag_name, $count),
+      'contents' => array('#markup' => $preview),
+    );
+  }
+
+  if (!empty($tabs)) {
+    $settings = array(
+      'style' => 'Commons Tabs',
+      'ajax' => FALSE,
+      'html' => TRUE,
+      'title' => 'test',
+      'default_tab' => 'commons_follow_group',
+    );
+    $built_tabs = quicktabs_build_quicktabs('commons_follow_ui', $settings, $tabs);
+    return $built_tabs;
+  }
+  else {
+    return array();
+  }
+}
diff --git a/modules/commons/commons_follow/commons_follow_user/commons_follow_user.features.field_instance.inc b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.features.field_instance.inc
new file mode 100644
index 0000000..2861d26
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.features.field_instance.inc
@@ -0,0 +1,64 @@
+<?php
+/**
+ * @file
+ * commons_follow_user.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_follow_user_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_follow_user_user_followed-field_target_users'
+  $field_instances['message-commons_follow_user_user_followed-field_target_users'] = array(
+    'bundle' => 'commons_follow_user_user_followed',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_users',
+    'label' => 'Target users',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 1,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Target users');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_follow/commons_follow_user/commons_follow_user.features.inc b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.features.inc
new file mode 100644
index 0000000..6eb397f
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.features.inc
@@ -0,0 +1,128 @@
+<?php
+/**
+ * @file
+ * commons_follow_user.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_follow_user_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_follow_user_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_flag_default_flags().
+ */
+function commons_follow_user_flag_default_flags() {
+  $flags = array();
+  // Exported flag: "People".
+  $flags['commons_follow_user'] = array(
+    'content_type' => 'user',
+    'title' => 'People',
+    'global' => 0,
+    'types' => array(),
+    'flag_short' => 'Follow',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Following',
+    'unflag_long' => '',
+    'unflag_message' => 'Not following',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => -13,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_profile' => 1,
+    'access_uid' => 'others',
+    'module' => 'commons_follow_user',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  // Exported flag: "Email user".
+  $flags['email_user'] = array(
+    'content_type' => 'user',
+    'title' => 'Email user',
+    'global' => 0,
+    'types' => array(),
+    'flag_short' => 'Send Email',
+    'flag_long' => '',
+    'flag_message' => '',
+    'unflag_short' => 'Don\'t send Email',
+    'unflag_long' => '',
+    'unflag_message' => '',
+    'unflag_denied_text' => '',
+    'link_type' => 'toggle',
+    'roles' => array(
+      'flag' => array(
+        0 => 2,
+      ),
+      'unflag' => array(
+        0 => 2,
+      ),
+    ),
+    'weight' => 0,
+    'show_on_form' => 0,
+    'access_author' => '',
+    'show_on_profile' => 0,
+    'access_uid' => '',
+    'module' => 'commons_follow_user',
+    'locked' => array(
+      0 => 'name',
+    ),
+    'api_version' => 2,
+  );
+  return $flags;
+
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_follow_user_default_message_type() {
+  $items = array();
+  $items['commons_follow_user_user_followed'] = entity_import('message_type', '{
+    "name" : "commons_follow_user_user_followed",
+    "description" : "commons_follow_user_user_followed",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E is now following \\u003Ca href=\\u0022[message:field-target-users:0:url]\\u0022\\u003E[message:field-target-users:0:name]\\u003C\\/a\\u003E",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E is now following \\u003Ca href=\\u0022[message:field-target-users:0:url]\\u0022\\u003E[message:field-target-users:0:name]\\u003C\\/a\\u003E"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
diff --git a/modules/commons/commons_follow/commons_follow_user/commons_follow_user.info b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.info
new file mode 100644
index 0000000..947d59d
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.info
@@ -0,0 +1,21 @@
+name = Commons Follow (Users)
+description = Lets users follow other users.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_follow
+dependencies[] = entityreference
+dependencies[] = flag
+dependencies[] = message
+dependencies[] = views
+dependencies[] = views_content
+dependencies[] = views_litepager
+dependencies[] = views_load_more
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_instance][] = message-commons_follow_user_user_followed-field_target_users
+features[flag][] = commons_follow_user
+features[flag][] = email_user
+features[message_type][] = commons_follow_user_user_followed
+features[views_view][] = commons_follow_user
+features[views_view][] = commons_follow_user_followers
+features[views_view][] = commons_follow_user_following
diff --git a/modules/commons/commons_follow/commons_follow_user/commons_follow_user.install b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.install
new file mode 100644
index 0000000..e5e35a5
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.install
@@ -0,0 +1,29 @@
+<?php
+
+/**
+* Update Flag link text.
+*/
+function commons_follow_user_update_3101() {
+  features_revert(array('commons_follow_user' => array('flag')));
+  return array();
+}
+
+/**
+ * Correct a typo in the title of the follows view.
+ */
+function commons_follow_user_update_3102() {
+  features_revert(array('commons_follow_user' => array('views_view')));
+  return array();
+}
+
+/**
+ * Update profile notification page to show an account's following views
+ * Not the current users following view.
+ */
+function commons_follow_user_update_3501() {
+  $revert = array(
+    'commons_follow_user' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow_user/commons_follow_user.module b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.module
new file mode 100644
index 0000000..1f8222d
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.module
@@ -0,0 +1,138 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Follow (Users) feature.
+ */
+
+include_once 'commons_follow_user.features.inc';
+
+
+
+/**
+ * Implements hook_commons_follow_get_nids().
+ */
+function commons_follow_user_commons_follow_get_nids($account, $options) {
+  // Get all flaggings from flags that belong to Message-subscribe, that
+  // reference the node entity-type.
+
+  // Get subscribe flag IDs.
+  $flag_ids = commons_follow_get_subscription_flags_ids('user');
+
+  if (empty($flag_ids)) {
+    return array();
+  }
+
+  // Get flagged user IDs.
+  $query = db_select('flag_content', 'f');
+  $result = $query
+    ->condition('fid', $flag_ids, 'IN')
+    ->condition('uid', $account->uid, '=')
+    ->condition('content_type', 'user', '=')
+    ->fields('f',array('content_id'))
+    ->execute()
+    ->fetchAll();
+
+  if (empty($result)) {
+    // No user flags.
+    return array();
+  }
+
+  $uids = array();
+  foreach($result as $row) {
+    $uids[] = (integer) $row->content_id;
+  }
+
+  // Get the user's node IDs.
+  $query = new EntityFieldQuery();
+
+  if (!empty($options['range'])) {
+    $query->range(0, $options['range']);
+  }
+
+  $result = $query
+    ->entityCondition('entity_type', 'node')
+    ->propertyCondition('uid', $uids, 'IN')
+    ->execute();
+
+  $nids = array();
+  if (!empty($result['node'])) {
+    foreach ($result['node'] as $nid => $row) {
+      $nids[] = $nid;
+    }
+  }
+
+
+  return $nids;
+}
+
+/**
+* Implements hook_system_info_alter().
+*/
+function commons_follow_user_system_info_alter(&$info, $file, $type) {
+  // If Message.module is enabled, we'll define our "User follows another user"
+  // message type and will need to add to it an instance of field_target_users.
+  if ($file->name == 'commons_follow_user' && module_exists('message')) {
+    $info['features']['field_instance'][] = 'message-commons_follow_user_user_followed-field_target_users';
+    $info['features']['message_type'][] = 'commons_follow_user_user_followed';
+  }
+}
+
+/**
+ * Implements hook_flag().
+ */
+function commons_follow_user_flag($op, $flag, $content_id, $account, $fcid) {
+  // Display an activity stream message when a user follows another user.
+  if (module_exists('commons_activity_streams') && $flag->name == 'commons_follow_user' && $op == 'flag') {
+    $followed_user = user_load($content_id);
+    // Don't generate a message for flagging blocked users.
+    if (!$followed_user->status) {
+      return;
+    }
+    // Todo: Check module_exists() before creating the message.
+    if (commons_follow_user_existing_follow_message($account->uid, array($followed_user->uid))) {
+      // If this user previously followed the target user, don't generate a duplicate message.
+      return;
+    }
+    $message = message_create('commons_follow_user_user_followed', array(), $account);
+    $wrapper = entity_metadata_wrapper('message', $message);
+    $wrapper->field_target_users[] = $followed_user->uid;
+    $wrapper->save();
+  }
+}
+
+/**
+* Indicate whether there is an existing message about a given user following
+* a target user.
+*/
+function commons_follow_user_existing_follow_message($acting_uid, $target_uids) {
+  $query = new EntityFieldQuery();
+  $query->entityCondition('entity_type', 'message', '=')
+   ->propertyCondition('uid', $acting_uid)
+   ->propertyCondition('type', 'commons_follow_user_user_followed', '=')
+   ->fieldCondition('field_target_users', 'target_id', $target_uids, 'IN')
+   ->execute();
+
+   return !empty($query->ordered_results);
+}
+
+
+/**
+* Implements hook_commons_follow_get_message_ids().
+*/
+function commons_follow_user_commons_follow_get_message_ids(&$followed_mids, $followed_content = array()) {
+  // If the user isn't following any other users, we've nothing to do here.
+  if (empty($followed_content['commons_follow_user'])) {
+    return;
+  }
+  // Generate a list of message IDs where message.uid OR any of the referenced
+  // target users are ones that the current user is following.
+  $result = db_query("SELECT m.mid AS mid
+    FROM {message} m
+    LEFT JOIN {field_data_field_target_users} tu ON m.mid=tu.entity_id
+    WHERE tu.field_target_users_target_id IN(:uids)
+    OR m.uid IN (:uids)",
+    array(':uids' => array_values($followed_content['commons_follow_user'])));
+  foreach ($result as $this_result) {
+    $followed_mids[] = $this_result->mid;
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/commons_follow_user/commons_follow_user.views_default.inc b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.views_default.inc
new file mode 100644
index 0000000..fa18e54
--- /dev/null
+++ b/modules/commons/commons_follow/commons_follow_user/commons_follow_user.views_default.inc
@@ -0,0 +1,437 @@
+<?php
+/**
+ * @file
+ * commons_follow_user.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_follow_user_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_follow_user';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'users';
+  $view->human_name = 'Users that a user follows';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'access user profiles';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '4';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'name' => 'name',
+    'ops_1' => 'ops_1',
+    'ops' => 'ops',
+  );
+  $handler->display->display_options['style_options']['default'] = '-1';
+  $handler->display->display_options['style_options']['info'] = array(
+    'name' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'ops_1' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'ops' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  $handler->display->display_options['style_options']['sticky'] = TRUE;
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'You aren\'t following anyone.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Flags: commons_follow_user */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'users';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_user';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Relationship: Flags: email_user */
+  $handler->display->display_options['relationships']['flag_content_rel_1']['id'] = 'flag_content_rel_1';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['table'] = 'users';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['label'] = 'flag_user';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['required'] = 0;
+  $handler->display->display_options['relationships']['flag_content_rel_1']['flag'] = 'email_user';
+  $handler->display->display_options['relationships']['flag_content_rel_1']['user_scope'] = 'any';
+  /* Relationship: Flags: User */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'flag_content';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['relationship'] = 'flag_content_rel';
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['label'] = 'Person';
+  $handler->display->display_options['fields']['name']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['name']['alter']['ellipsis'] = FALSE;
+  /* Field: Flags: Flag link */
+  $handler->display->display_options['fields']['ops_1']['id'] = 'ops_1';
+  $handler->display->display_options['fields']['ops_1']['table'] = 'flag_content';
+  $handler->display->display_options['fields']['ops_1']['field'] = 'ops';
+  $handler->display->display_options['fields']['ops_1']['relationship'] = 'flag_content_rel_1';
+  $handler->display->display_options['fields']['ops_1']['label'] = 'Send email?';
+  /* Field: Flags: Flag link */
+  $handler->display->display_options['fields']['ops']['id'] = 'ops';
+  $handler->display->display_options['fields']['ops']['table'] = 'flag_content';
+  $handler->display->display_options['fields']['ops']['field'] = 'ops';
+  $handler->display->display_options['fields']['ops']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['fields']['ops']['label'] = '';
+  $handler->display->display_options['fields']['ops']['element_label_colon'] = FALSE;
+  /* Sort criterion: Flags: Flagged time */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'flag_content';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: User: Uid */
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'users';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['relationship'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'user';
+  $handler->display->display_options['arguments']['uid']['default_argument_options']['user'] = FALSE;
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['uid']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['uid']['validate']['type'] = 'user';
+  $handler->display->display_options['arguments']['uid']['validate_options']['type'] = 'either';
+  /* Filter criterion: User: Active */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'users';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  $translatables['commons_follow_user'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('You aren\'t following anyone.'),
+    t('flag'),
+    t('flag_user'),
+    t('Person'),
+    t('Send email?'),
+  );
+  $export['commons_follow_user'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_follow_user_followers';
+  $view->description = 'Display a list of users that are following a particular user.';
+  $view->tag = 'Commons';
+  $view->base_table = 'users';
+  $view->human_name = 'Commons Follow - User\'s followers';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Followers';
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['use_more_text'] = 'Show all followers';
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'access user profiles';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '16';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'This person has no followers.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: Flags: commons_follow_user */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'users';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['label'] = 'Commons Follow (Users)';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_user';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Relationship: Flags: User */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'flag_content';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['uid']['required'] = TRUE;
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = '';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50_avatar';
+  /* Sort criterion: Flags: Flagged time */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'flag_content';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: Flags: Content ID */
+  $handler->display->display_options['arguments']['content_id']['id'] = 'content_id';
+  $handler->display->display_options['arguments']['content_id']['table'] = 'flag_content';
+  $handler->display->display_options['arguments']['content_id']['field'] = 'content_id';
+  $handler->display->display_options['arguments']['content_id']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['arguments']['content_id']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['content_id']['default_argument_type'] = 'user';
+  $handler->display->display_options['arguments']['content_id']['default_argument_options']['user'] = FALSE;
+  $handler->display->display_options['arguments']['content_id']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['content_id']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['content_id']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['content_id']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['content_id']['validate']['type'] = 'flag_flaggable_user';
+  /* Filter criterion: User: Active */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'users';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'page_1');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'People who follow %1';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['use_more'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_text'] = FALSE;
+  $handler->display->display_options['use_more_text'] = 'Show all followers';
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '40';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['path'] = 'user/%/followers';
+  $translatables['commons_follow_user_followers'] = array(
+    t('Master'),
+    t('Followers'),
+    t('Show all followers'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('This person has no followers.'),
+    t('Commons Follow (Users)'),
+    t('Flag user'),
+    t('All'),
+    t('Content pane'),
+    t('more'),
+    t('Commons'),
+    t('Page'),
+    t('People who follow %1'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+  );
+  $export['commons_follow_user_followers'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_follow_user_following';
+  $view->description = 'A list of users followed by a particular user.';
+  $view->tag = 'Commons_follow';
+  $view->base_table = 'users';
+  $view->human_name = 'Commons Follow - Users that a particular user is following';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Following';
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['use_more_text'] = 'Show all following';
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'access user profiles';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '16';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['label'] = 'No results summary';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'This person isn\'t following anyone.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  $handler->display->display_options['empty']['area']['tokenize'] = TRUE;
+  /* Relationship: Flags: commons_follow_user */
+  $handler->display->display_options['relationships']['flag_content_rel']['id'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['table'] = 'users';
+  $handler->display->display_options['relationships']['flag_content_rel']['field'] = 'flag_content_rel';
+  $handler->display->display_options['relationships']['flag_content_rel']['label'] = 'Commons Follow (Users)';
+  $handler->display->display_options['relationships']['flag_content_rel']['flag'] = 'commons_follow_user';
+  $handler->display->display_options['relationships']['flag_content_rel']['user_scope'] = 'any';
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['label'] = '';
+  $handler->display->display_options['fields']['name']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['name']['alter']['ellipsis'] = FALSE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50_avatar';
+  /* Sort criterion: Flags: Flagged time */
+  $handler->display->display_options['sorts']['timestamp']['id'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['table'] = 'flag_content';
+  $handler->display->display_options['sorts']['timestamp']['field'] = 'timestamp';
+  $handler->display->display_options['sorts']['timestamp']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['sorts']['timestamp']['order'] = 'DESC';
+  /* Contextual filter: Flags: User uid */
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'flag_content';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['relationship'] = 'flag_content_rel';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'user';
+  $handler->display->display_options['arguments']['uid']['default_argument_options']['user'] = FALSE;
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['uid']['validate']['type'] = 'user';
+  /* Filter criterion: User: Active */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'users';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'page_1');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'People %1 follows';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['use_more'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_always'] = FALSE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['defaults']['use_more_text'] = FALSE;
+  $handler->display->display_options['use_more_text'] = 'Show all following';
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '40';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['path'] = 'user/%/following';
+  $translatables['commons_follow_user_following'] = array(
+    t('Master'),
+    t('Following'),
+    t('Show all following'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('No results summary'),
+    t('This person isn\'t following anyone.'),
+    t('Commons Follow (Users)'),
+    t('All'),
+    t('Content pane'),
+    t('more'),
+    t('Commons'),
+    t('Page'),
+    t('People %1 follows'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+  );
+  $export['commons_follow_user_following'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_follow/includes/views/commons_follow.views.inc b/modules/commons/commons_follow/includes/views/commons_follow.views.inc
new file mode 100644
index 0000000..0eaea15
--- /dev/null
+++ b/modules/commons/commons_follow/includes/views/commons_follow.views.inc
@@ -0,0 +1,52 @@
+<?php
+
+
+/**
+ * Implements hook_views_plugins().
+ */
+function commons_follow_views_plugins() {
+  // This handler requires message_subscribe module.
+  return array(
+    'argument default' => array(
+      'commons_follow_node' => array(
+        'title' => t('The node IDs the user is subscribed to'),
+        'handler' => 'commons_follow_plugin_argument_default_node',
+      ),
+      'commons_follow_message' => array(
+        'title' => t('The message IDs the user is subscribed to'),
+        'handler' => 'commons_follow_plugin_argument_default_message',
+      ),
+    ),
+  );
+}
+
+/**
+ * Implements hook_views_data().
+ */
+function commons_follow_views_data() {
+  $data['node']['cf_user_follow'] = array(
+    'title' => t('User Follow'), // The item it appears as on the UI,
+    'help' => t('Whether the user is following this content.'), // The help that appears on the UI,
+    'real field' => 'nid',
+     // Information for displaying a title as a field
+    'filter' => array(
+      'handler' => 'commons_follow_user_follow_filter',
+      'label' => t('Following'),
+      'type' => 'yes-no',
+    ),
+  );
+
+  $data['message']['cf_user_follow_message'] = array(
+    'title' => t('User Follow'), // The item it appears as on the UI,
+    'help' => t('Whether the user is following items related to this message.'), // The help that appears on the UI,
+    'real field' => 'mid',
+     // Information for displaying a title as a field
+    'filter' => array(
+      'handler' => 'commons_follow_user_follow_filter_message',
+      'label' => t('Following'),
+      'type' => 'yes-no',
+    ),
+  );
+
+  return $data;
+}
diff --git a/modules/commons/commons_follow/includes/views/handlers/commons_follow_handler_field_ops.inc b/modules/commons/commons_follow/includes/views/handlers/commons_follow_handler_field_ops.inc
new file mode 100644
index 0000000..3770782
--- /dev/null
+++ b/modules/commons/commons_follow/includes/views/handlers/commons_follow_handler_field_ops.inc
@@ -0,0 +1,62 @@
+<?php
+
+/**
+ * @file
+ * Contains the flag Ops field handler.
+ */
+
+/**
+ * Views field handler for the Flag operations links (flag/unflag).
+ *
+ * @ingroup views
+ */
+class commons_follow_handler_field_ops extends flag_handler_field_ops {
+
+  function render($values) {
+    global $user;
+    //If the passed in user doesn't match the current user
+    if(isset($this->view->args[0]) && $user->uid != $this->view->args[0]) {
+
+      if (!($flag = $this->get_flag())) {
+        // get_flag() itself will print a more detailed message.
+        return t('Missing flag');
+      }
+      $content_id = $values->{$this->aliases['content_id']};
+      $is_flagged = $values->{$this->aliases['is_flagged']};
+
+      if (empty($this->flag_applies[$content_id])) {
+        // Flag does not apply to this content.
+        return;
+      }
+
+      if (!empty($this->options['link_type'])) {
+        $flag->link_type = $this->options['link_type'];
+      }
+
+      $variables = array();
+      $action = $is_flagged ? 'unflag' : 'flag';
+      $variables['flag_css_name'] = str_replace('_', '-', $flag->name);
+
+      $flag_wrapper_classes_array = array();
+      $flag_wrapper_classes_array[] = 'flag-wrapper';
+      $flag_wrapper_classes_array[] = 'flag-' . $variables['flag_css_name'];
+      $flag_wrapper_classes_array[] = 'flag-' . $variables['flag_css_name'] . '-' . $content_id;
+      $variables['flag_wrapper_classes'] = implode(' ',$flag_wrapper_classes_array);
+
+      $flag_classes_array = array();
+      $flag_classes_array[] = 'flag';
+      $flag_classes_array[] = $action . '-action';
+      $flag_classes_array[] = 'flag-link-' . $flag->link_type;
+      $variables['flag_classes'] = implode(' ', $flag_classes_array);
+      $variables['is_flagged'] = $action;
+      $variables['link_text'] = $flag->get_label($action . '_short', $content_id);
+
+      return theme('commons_follow_otheruser_flag', $variables);
+    }
+    else {
+      return parent::render($values);
+    }
+
+//    return $flag->theme($is_flagged ? 'unflag' : 'flag', $content_id);
+  }
+}
diff --git a/modules/commons/commons_follow/includes/views/handlers/commons_follow_plugin_argument_default_message.inc b/modules/commons/commons_follow/includes/views/handlers/commons_follow_plugin_argument_default_message.inc
new file mode 100644
index 0000000..0cc1a2a
--- /dev/null
+++ b/modules/commons/commons_follow/includes/views/handlers/commons_follow_plugin_argument_default_message.inc
@@ -0,0 +1,21 @@
+<?php
+
+/**
+ * @file
+ * Holds the class defining the Views plugin that returns the message IDS that a
+ * user has subscribed to.
+ */
+
+class commons_follow_plugin_argument_default_message extends views_plugin_argument_default {
+
+  /**
+   * Get the default argument.
+   */
+  function get_argument() {
+    if (!$mids = commons_follow_get_followed_message_ids()) {
+      return FALSE;
+    }
+
+    return implode(',', $mids);
+  }
+}
diff --git a/modules/commons/commons_follow/includes/views/handlers/commons_follow_plugin_argument_default_node.inc b/modules/commons/commons_follow/includes/views/handlers/commons_follow_plugin_argument_default_node.inc
new file mode 100644
index 0000000..c82b724
--- /dev/null
+++ b/modules/commons/commons_follow/includes/views/handlers/commons_follow_plugin_argument_default_node.inc
@@ -0,0 +1,21 @@
+<?php
+
+/**
+ * @file
+ * Holds the class defining the Views plugin that returns the node IDS that a
+ * user has subscribed to.
+ */
+
+class commons_follow_plugin_argument_default_node extends views_plugin_argument_default {
+
+  /**
+   * Get the default argument.
+   */
+  function get_argument() {
+    if (!$nids = commons_follow_get_nids()) {
+      return FALSE;
+    }
+
+    return implode(',', $nids);
+  }
+}
diff --git a/modules/commons/commons_follow/includes/views/handlers/commons_follow_user_follow_filter.inc b/modules/commons/commons_follow/includes/views/handlers/commons_follow_user_follow_filter.inc
new file mode 100644
index 0000000..9f5cc3d
--- /dev/null
+++ b/modules/commons/commons_follow/includes/views/handlers/commons_follow_user_follow_filter.inc
@@ -0,0 +1,22 @@
+<?php
+
+/**
+ * @file
+ * Definition of views_handler_filter_boolean_operator_string.
+ */
+
+/**
+ * Views filter that toggles between flagged and unflagged content.
+ */
+class commons_follow_user_follow_filter extends views_handler_filter_boolean_operator {
+
+  function query() {
+    foreach ($this->view->argument as $argument_name => $argument) {
+      if ($argument->options['default_argument_type'] == 'commons_follow_node') {
+        // The argument that toggles 'following' or 'not following' display.
+        $this->view->argument[$argument_name]->options['not'] = !$this->value;
+        break;
+      }
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_follow/includes/views/handlers/commons_follow_user_follow_filter_message.inc b/modules/commons/commons_follow/includes/views/handlers/commons_follow_user_follow_filter_message.inc
new file mode 100644
index 0000000..eb63d2b
--- /dev/null
+++ b/modules/commons/commons_follow/includes/views/handlers/commons_follow_user_follow_filter_message.inc
@@ -0,0 +1,23 @@
+<?php
+
+/**
+ * @file
+ * Definition of views_handler_filter_boolean_operator_string.
+ */
+
+/**
+ * Views filter that toggles between flagged and unflagged content.
+ */
+class commons_follow_user_follow_filter_message extends views_handler_filter_boolean_operator {
+
+  function query() {
+    // The argument that toggles 'following' or 'not following' display.
+    if ($this->value == 0) {
+      foreach ($this->view->argument as $argument_name => $argument) {
+        if ($argument->options['default_argument_type'] == 'commons_follow_message') {
+          $this->view->argument[$argument_name]->options['not'] = !$this->value;
+        }
+      }
+    }
+  }
+}
diff --git a/modules/commons/commons_groups/commons_groups.features.field_base.inc b/modules/commons/commons_groups/commons_groups.features.field_base.inc
new file mode 100644
index 0000000..f60237e
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.features.field_base.inc
@@ -0,0 +1,287 @@
+<?php
+/**
+ * @file
+ * commons_groups.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_groups_field_default_field_bases() {
+  $field_bases = array();
+
+    // Exported field_base: 'group_access'
+    $field_bases['group_access'] = array(
+      'active' => '1',
+      'cardinality' => '1',
+      'deleted' => '0',
+      'entity_types' => array(),
+      'field_name' => 'group_access',
+      'foreign keys' => array(),
+      'indexes' => array(
+        'value' => array(
+          0 => 'value',
+        ),
+      ),
+      'locked' => '0',
+      'module' => 'list',
+      'no_ui' => TRUE,
+      'settings' => array(
+        'allowed_values' => array(
+          0 => 'Public - accessible to all site users',
+          1 => 'Private - accessible only to group members',
+        ),
+        'allowed_values_function' => '',
+      ),
+      'translatable' => '0',
+      'type' => 'list_boolean',
+    );
+
+    // Exported field_base: 'group_content_access'
+    $field_bases['group_content_access'] = array(
+      'active' => '1',
+      'cardinality' => '1',
+      'deleted' => '0',
+      'entity_types' => array(),
+      'field_name' => 'group_content_access',
+      'foreign keys' => array(),
+      'indexes' => array(
+        'value' => array(
+          0 => 'value',
+        ),
+      ),
+      'locked' => '0',
+      'module' => 'list',
+      'no_ui' => TRUE,
+      'settings' => array(
+        'allowed_values' => array(
+          0 => 'Use group defaults',
+          1 => 'Public - accessible to all site users',
+          2 => 'Private - accessible only to group members',
+        ),
+        'allowed_values_function' => '',
+      ),
+      'translatable' => '0',
+      'type' => 'list_integer',
+    );
+
+  // Exported field_base: 'field_og_access_default_value'
+  $field_bases['field_og_access_default_value'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_og_access_default_value',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => '',
+        1 => '',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => '0',
+    'type' => 'list_boolean',
+  );
+
+  // Exported field_base: 'field_og_subscribe_settings'
+  $field_bases['field_og_subscribe_settings'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_og_subscribe_settings',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        'anyone' => 'Any site member can contribute',
+        'approval' => 'Joining requires admin approval',
+        'invitation' => 'Joining requires an invitation',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => '0',
+    'type' => 'list_text',
+  );
+
+  // Alter the "approval" description when og_access is on.
+  if (module_exists('og_access')) {
+    $field_bases['field_og_subscribe_settings']['settings']['allowed_values']['invitation'] = 'Joining requires an invitation. The group and content is hidden from non-members.';
+  }
+
+  // Exported field_base: 'group_group'
+  $field_bases['group_group'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'group_group',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => 'Not a group',
+        1 => 'Group',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => '0',
+    'type' => 'list_boolean',
+  );
+
+// Exported field_base: 'og_group_ref'
+ $field_bases['og_group_ref'] = array(
+    'active' => '1',
+    'cardinality' => '-1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'description' => 'Separate group names with commas',
+    'field_name' => 'og_group_ref',
+    'foreign keys' => array(
+      'node' => array(
+        'columns' => array(
+          'target_id' => 'nid',
+        ),
+        'table' => 'node',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'og_commons',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'og_behavior' => array(
+            'status' => TRUE,
+          ),
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'membership_type' => 'og_membership_type_default',
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'handler_submit' => 'Change handler',
+      'target_type' => 'node',
+    ),
+    'target_type' => 'node',
+    'translatable' => '0',
+    'type' => 'entityreference',
+  );
+
+
+  // Exported field_base: 'og_membership_request'
+  $field_bases['og_membership_request'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(
+      0 => 'og_membership',
+    ),
+    'field_name' => 'og_membership_request',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'text',
+    'settings' => array(),
+    'translatable' => '0',
+    'type' => 'text_long',
+  );
+
+  // Exported field_base: 'field_group_logo'
+  $field_bases['field_group_logo'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_group_logo',
+    'foreign keys' => array(
+      'fid' => array(
+        'columns' => array(
+          'fid' => 'fid',
+        ),
+        'table' => 'file_managed',
+      ),
+    ),
+    'indexes' => array(
+      'fid' => array(
+        0 => 'fid',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'image',
+    'settings' => array(
+      'default_image' => 0,
+      'uri_scheme' => 'public',
+    ),
+    'translatable' => '0',
+    'type' => 'image',
+  );
+
+  // Exported field_base: 'og_roles_permissions'
+  $field_bases['og_roles_permissions'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'og_roles_permissions',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => 'Use default roles and permissions',
+        1 => 'Override default roles and permissions',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => '0',
+    'type' => 'list_boolean',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_groups/commons_groups.features.field_instance.inc b/modules/commons/commons_groups/commons_groups.features.field_instance.inc
new file mode 100644
index 0000000..0144c87
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.features.field_instance.inc
@@ -0,0 +1,536 @@
+<?php
+/**
+ * @file
+ * commons_groups.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_groups_field_default_field_instances() {
+  $field_instances = array();
+
+  $commons_groups_entity_types = commons_groups_get_group_content_entity_types();
+  if (!empty($commons_groups_entity_types)) {
+    foreach ($commons_groups_entity_types as $entity_type => $bundles) {
+      foreach(array_keys($bundles) as $bundle) {
+        commons_groups_field_definition($field_instances, $entity_type, $bundle);
+      }
+    }
+  }
+  $group_bundles = og_get_all_group_bundle();
+
+  if (empty($group_bundles['node'])) {
+    // Make sure group_bundles contains at least the group node bundle, in order
+    // to create the group audience field for it when installing the profile.
+    $group_bundles['node'] = array('group' => TRUE);
+  }
+  foreach(array_keys($group_bundles['node']) as $bundle) {
+    commons_groups_field_definition_group($field_instances, 'node', $bundle);
+  }
+
+  // Exported field_instance: 'og_membership-og_membership_type_default-og_membership_request'
+  $field_instances['og_membership-og_membership_type_default-og_membership_request'] = array(
+    'bundle' => 'og_membership_type_default',
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => 'This is the text a user may send to the group administrators.',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'og_membership',
+    'field_name' => 'og_membership_request',
+    'label' => 'Request message',
+    'required' => FALSE,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 5,
+      ),
+      'type' => 'text_textarea',
+      'weight' => 0,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Determine if this is an OG group.');
+  t('Group');
+  t('Group membership');
+  t('Group visibility');
+  t('Group content visibility');
+  t('Group roles and permissions');
+  t('Request message');
+  t('This is the text a user may send to the group administrators.');
+  t('Group Logo');
+  t('Hide contributed content from non-members');
+  t('Privacy settings');
+
+  return $field_instances;
+}
+
+function commons_groups_field_definition_group(&$field_instances, $entity_type, $bundle) {
+  // Exported field_instance: 'node-group-field_og_subscribe_settings'
+  $field_instances["$entity_type-$bundle-field_og_subscribe_settings"] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'value' => 'anyone',
+      ),
+    ),
+    'deleted' => '0',
+    'description' => t("These privacy settings will not change the visibility of content that has already posted into this group. It takes effect only for content created after the group is saved with new privacy settings."),
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'list',
+        'settings' => array(),
+        'type' => 'list_default',
+        'weight' => 4,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_og_subscribe_settings',
+    'label' => 'Privacy settings',
+    'required' => 1,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_buttons',
+      'weight' => '41',
+    ),
+  );
+
+  // Exported field_instance: 'node-group-field_og_access_default_value'
+  $field_instances["$entity_type-$bundle-field_og_access_default_value"] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'value' => 0,
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 5,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_og_access_default_value',
+    'label' => 'Hide contributed content from non-members',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(
+        'display_label' => 1,
+      ),
+      'type' => 'options_onoff',
+      'weight' => '42',
+    ),
+  );
+
+  // Exported field_instance: 'node-group-og_roles_permissions'
+  $field_instances["$entity_type-$bundle-og_roles_permissions"] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'value' => 1,
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'list',
+        'settings' => array(),
+        'type' => 'list_default',
+        'weight' => 1,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'og_roles_permissions',
+    'label' => 'Group roles and permissions',
+    'required' => TRUE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'custom settings' => FALSE,
+        'label' => 'Full',
+        'type' => 'list_default',
+      ),
+      'teaser' => array(
+        'custom settings' => FALSE,
+        'label' => 'Teaser',
+        'type' => 'list_default',
+      ),
+    ),
+    'widget' => array(
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_select',
+      'weight' => 1,
+    ),
+  );
+   // Exported field_instance: 'node-group-body'
+  $field_instances["$entity_type-$bundle-body"] = array(
+    'bundle' => $bundle,
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 1,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Description',
+    'required' => 0,
+    'settings' => array(
+      'display_summary' => 0,
+      'text_processing' => '1',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => '20',
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => '4',
+    ),
+  );
+
+  // Exported field_instance: 'node-group-group_group'
+  $field_instances["$entity_type-$bundle-" . OG_GROUP_FIELD] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'value' => 1,
+      ),
+    ),
+    'deleted' => '0',
+    'description' => 'Determine if this is an OG group.',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'commons_groups',
+        'settings' => array(
+          'field_name' => '0',
+        ),
+        'type' => 'commons_groups_group_subscribe',
+        'weight' => '0',
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'display_label' => 1,
+    'entity_type' => 'node',
+    'field_name' => OG_GROUP_FIELD,
+    'label' => 'Group',
+    'required' => FALSE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'custom settings' => FALSE,
+        'label' => 'Full',
+        'type' => 'og_group_subscribe',
+      ),
+      'teaser' => array(
+        'custom settings' => FALSE,
+        'label' => 'Teaser',
+        'type' => 'og_group_subscribe',
+      ),
+    ),
+    'widget' => array(
+      'module' => 'options',
+      'settings' => array(
+        'display_label' => 0,
+        'og_hide' => TRUE,
+      ),
+      'type' => 'options_onoff',
+      'weight' => 0,
+    ),
+  );
+
+  // Exported field_instance: 'node-group-group_access'
+  $field_instances["$entity_type-$bundle-group_access"] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'value' => 0,
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'group_access',
+    'label' => 'Group visibility',
+    'required' => TRUE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'label' => 'above',
+        'type' => 'options_onoff',
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'type' => 'options_onoff',
+      ),
+    ),
+    'widget' => array(
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_buttons',
+      'weight' => 41,
+    ),
+    'widget_type' => 'options_select',
+  );
+
+  // Exported field_instance: 'node-group-field_group_logo'
+  $field_instances["$entity_type-$bundle-field_group_logo"] = array(
+    'bundle' => $bundle,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'image',
+        'settings' => array(
+          'image_link' => '',
+          'image_style' => '50x50',
+        ),
+        'type' => 'image',
+        'weight' => '0',
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_group_logo',
+    'label' => 'Group Logo',
+    'required' => 0,
+    'settings' => array(
+      'alt_field' => 0,
+      'default_image' => 0,
+      'file_directory' => '',
+      'file_extensions' => 'png gif jpg jpeg',
+      'max_filesize' => '20mb',
+      'max_resolution' => '',
+      'min_resolution' => '30x30',
+      'title_field' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'image',
+      'settings' => array(
+        'preview_image_style' => 'thumbnail',
+        'progress_indicator' => 'throbber',
+      ),
+      'type' => 'image_image',
+      'weight' => '5',
+    ),
+  );
+}
+
+function commons_groups_field_definition(&$field_instances, $entity_type, $bundle) {
+  // Exported field_instance: 'node-post-og_group_ref'
+  $field_instances["$entity_type-$bundle-og_group_ref"] = array(
+    'bundle' => $bundle,
+    'default_value' => NULL,
+    'default_value_function' => 'commons_groups_entityreference_default_value',
+    'deleted' => '0',
+    'description' => 'Separate group names with commas',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'og_ui',
+        'settings' => array(),
+        'type' => 'og_list_default',
+        'weight' => 11,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => $entity_type,
+    'field_name' => 'og_group_ref',
+    'label' => 'Groups',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'og_widget' => array(
+          'admin' => array(
+            'widget_type' => 'entityreference_autocomplete_tags',
+          ),
+          'default' => array(
+            'widget_type' => 'entityreference_autocomplete_tags',
+          ),
+          'status' => TRUE,
+        ),
+        'prepopulate' => array(
+          'action' => 'none',
+          'fallback' => 'none',
+          'og_context' => 0,
+          'skip_perm' => '0',
+          'status' => 1,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'custom settings' => FALSE,
+        'label' => 'Full',
+        'type' => 'og_list_default',
+      ),
+      'teaser' => array(
+        'custom settings' => FALSE,
+        'label' => 'Teaser',
+        'type' => 'og_list_default',
+      ),
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'og',
+      'settings' => array(),
+      'type' => 'og_complex',
+      'weight' => 5,
+    ),
+  );
+
+  // Exported field_instance: '[entity]-[bundle]-group_content_access'
+  $field_instances["$entity_type-$bundle-group_content_access"] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'value' => 0,
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 5,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => $entity_type,
+    'field_name' => 'group_content_access',
+    'label' => 'Group content visibility',
+    'required' => TRUE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'label' => 'above',
+        'type' => 'list_default',
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'type' => 'list_default',
+      ),
+    ),
+    'widget' => array(
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_select',
+      'weight' => 16,
+    ),
+    'widget_type' => 'options_select',
+  );
+}
diff --git a/modules/commons/commons_groups/commons_groups.features.inc b/modules/commons/commons_groups/commons_groups.features.inc
new file mode 100644
index 0000000..b3aab7a
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.features.inc
@@ -0,0 +1,93 @@
+<?php
+/**
+ * @file
+ * commons_groups.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_groups_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_groups_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_image_default_styles().
+ */
+function commons_groups_image_default_styles() {
+  $styles = array();
+
+  // Exported image style: 35x35.
+  $styles['35x35'] = array(
+    'label' => '35x35',
+    'name' => '35x35',
+    'effects' => array(
+      1 => array(
+        'label' => 'Scale and crop',
+        'help' => 'Scale and crop will maintain the aspect-ratio of the original image, then crop the larger dimension. This is most useful for creating perfectly square thumbnails without stretching the image.',
+        'effect callback' => 'image_scale_and_crop_effect',
+        'dimensions callback' => 'image_resize_dimensions',
+        'form callback' => 'image_resize_form',
+        'summary theme' => 'image_resize_summary',
+        'module' => 'image',
+        'name' => 'image_scale_and_crop',
+        'data' => array(
+          'width' => 35,
+          'height' => 35,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: 50x50.
+  $styles['50x50'] = array(
+    'label' => '50x50',
+    'name' => '50x50',
+    'effects' => array(
+      2 => array(
+        'label' => 'Scale and crop',
+        'help' => 'Scale and crop will maintain the aspect-ratio of the original image, then crop the larger dimension. This is most useful for creating perfectly square thumbnails without stretching the image.',
+        'effect callback' => 'image_scale_and_crop_effect',
+        'dimensions callback' => 'image_resize_dimensions',
+        'form callback' => 'image_resize_form',
+        'summary theme' => 'image_resize_summary',
+        'module' => 'image',
+        'name' => 'image_scale_and_crop',
+        'data' => array(
+          'width' => 50,
+          'height' => 50,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  return $styles;
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_groups_node_info() {
+  $items = array(
+    'group' => array(
+      'name' => t('Group'),
+      'base' => 'node_content',
+      'description' => t('Use groups to contain people and content related by a shared interest or purpose.'),
+      'has_title' => '1',
+      'title_label' => t('Group name'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_groups/commons_groups.features.user_permission.inc b/modules/commons/commons_groups/commons_groups.features.user_permission.inc
new file mode 100644
index 0000000..ec080a3
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.features.user_permission.inc
@@ -0,0 +1,40 @@
+<?php
+/**
+ * @file
+ * commons_groups.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_groups_user_default_permissions() {
+  $permissions = array();
+
+  $groups = commons_groups_get_group_types();
+
+  if (isset($groups['node'])) {
+    foreach ($groups['node'] as $bundle => $group_info) {
+      // Exported permission: 'create group content'.
+      $permissions["create $bundle content"] = array(
+        'name' => "create $bundle content",
+        'roles' => array(
+          'administrator' => 'administrator',
+          'authenticated user' => 'authenticated user',
+        ),
+        'module' => 'node',
+      );
+
+      // Exported permission: 'edit own group content'.
+      $permissions["edit own $bundle content"] = array(
+        'name' => "edit own $bundle content",
+        'roles' => array(
+          'administrator' => 'administrator',
+          'authenticated user' => 'authenticated user',
+        ),
+        'module' => 'node',
+      );
+    }
+  }
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_groups/commons_groups.info b/modules/commons/commons_groups/commons_groups.info
new file mode 100644
index 0000000..59a4f2a
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.info
@@ -0,0 +1,74 @@
+name = Commons Groups
+description = Commons Organic Groups Functionality
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_body
+dependencies[] = commons_bw
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = date
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = entityreference_prepopulate
+dependencies[] = features
+dependencies[] = image
+dependencies[] = link
+dependencies[] = list
+dependencies[] = message
+dependencies[] = node
+dependencies[] = og
+dependencies[] = og_ui
+dependencies[] = options
+dependencies[] = radioactivity
+dependencies[] = strongarm
+dependencies[] = taxonomy
+dependencies[] = text
+dependencies[] = views
+dependencies[] = views_content
+dependencies[] = views_litepager
+dependencies[] = views_load_more
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_base][] = field_group_logo
+features[field_base][] = field_og_access_default_value
+features[field_base][] = field_og_subscribe_settings
+features[field_base][] = group_access
+features[field_base][] = group_content_access
+features[field_base][] = group_group
+features[field_base][] = og_group_ref
+features[field_base][] = og_membership_request
+features[field_base][] = og_roles_permissions
+features[field_instance][] = node-group-body
+features[field_instance][] = node-group-group_group
+features[field_instance][] = og_membership-og_membership_type_default-og_membership_request
+features[image][] = 35x35
+features[image][] = 50x50
+features[node][] = group
+features[user_permission][] = create group content
+features[user_permission][] = edit own group content
+features[variable][] = comment_anonymous_group
+features[variable][] = comment_default_mode_group
+features[variable][] = comment_default_per_page_group
+features[variable][] = comment_form_location_group
+features[variable][] = comment_group
+features[variable][] = comment_preview_group
+features[variable][] = comment_subject_field_group
+features[variable][] = field_bundle_settings_node__group
+features[variable][] = menu_options_group
+features[variable][] = menu_parent_group
+features[variable][] = node_options_group
+features[variable][] = node_preview_group
+features[variable][] = node_submitted_group
+features[variable][] = og_group_manager_default_rids_node_group
+features[variable][] = pathauto_node_group_pattern
+features[variable][] = pathauto_node_pattern
+features[views_view][] = commons_bw_all
+features[views_view][] = commons_contributors_group
+features[views_view][] = commons_group_moderation
+features[views_view][] = commons_groups_contributors
+features[views_view][] = commons_groups_directory
+features[views_view][] = commons_groups_recent_content
+features[views_view][] = commons_groups_user_groups
+features_exclude[field][node-group-group_group] = node-group-group_group
+features_exclude[field][node-group-group_access] = node-group-group_access
diff --git a/modules/commons/commons_groups/commons_groups.install b/modules/commons/commons_groups/commons_groups.install
new file mode 100644
index 0000000..f4ec12b
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.install
@@ -0,0 +1,190 @@
+<?php
+
+/**
+* Don't display group node author's avatar on the group node.
+*/
+function commons_groups_update_3100() {
+  features_revert(array('commons_groups' => array('variable')));
+  return array();
+}
+/**
+* Grant users the "group organizer" role after she's created a group.
+*/
+function commons_groups_update_3101() {
+  // We've updated the og_group_manager_default_rids_node_group variable.
+  features_revert(array('commons_groups' => array('variable')));
+  return array();
+}
+
+/**
+* Ensure that the anonymous users is not listed as a group member,
+* per http://drupal.org/node/1910874.
+*/
+function commons_groups_update_3102() {
+  $delete = db_delete('og_users_roles')
+    ->condition('uid', 0, '=')
+    ->execute();
+  return array();
+}
+
+/**
+* Grant authenticated users permission to create group nodes
+* per http://drupal.org/node/1936714.
+*/
+function commons_groups_update_3103() {
+  features_revert(array('commons_groups' => array('user_permission')));
+  return array();
+}
+
+/**
+* Grant authenticated users permission to create group nodes
+* per http://drupal.org/node/1936714.
+*/
+function commons_groups_update_3104() {
+  features_revert(array('commons_groups' => array('field_base', 'field_instance')));
+  return array();
+}
+
+/**
+ * Change the OG Organizer role back to Administrator member.
+ * See http://drupal.org/node/1940150 for more information.
+ */
+function commons_groups_update_3105() {
+  $result = db_update('og_role')
+    ->fields(array('name' => 'administrator member'))
+    ->condition('rid', 3, '=')
+    ->execute();
+  return array();
+}
+
+/**
+ * Update contributor view to show the titles per the interactive prototype.
+ * (http://drupal.org/node/1821808).
+ */
+function commons_groups_update_3106() {
+  $revert = array(
+      'commons_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Give group owners the organizer role for their own group
+ */
+function commons_groups_update_3107() {
+  // Ensure that the group creator is also listed as an organizer.
+  $group_nodes = db_select('node', 'n')
+    ->fields('n', array('nid', 'uid'))
+    ->condition('n.type', 'group','=')
+    ->execute()
+    ->fetchAll();
+  $organizer_role = db_select('og_role', 'o')
+    ->fields('o', array('rid'))
+    ->condition('o.group_bundle', 'group')
+    ->condition('o.name', 'administrator member')
+    ->execute()
+    ->fetchField();
+
+  foreach($group_nodes as $record) {
+    if (!empty($organizer_role)) {
+      og_role_grant('node', $record->nid, $record->uid, $organizer_role);
+    }
+  }
+  return array();
+}
+
+/**
+ * Update the og_group_ref and group privacy fields per
+ * http://drupal.org/node/1961296.
+ */
+function commons_groups_update_3108() {
+  $revert = array(
+    'commons_groups' => array('field_instance', 'views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Update the group_group field per http://drupal.org/node/1948224 and
+ * disable the deprecated Commons Group Privacy module
+ * per https://drupal.org/node/1961296.
+ */
+function commons_groups_update_3109() {
+  // Commons Group Privacy was deprecated in https://drupal.org/node/1961296.
+  module_disable('commons_group_privacy', TRUE);
+  $revert = array(
+    'commons_groups' => array('field_base', 'field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Update the og group filter inside views per
+ * http://drupal.org/node/2037417.
+ */
+function commons_groups_update_3110() {
+  $revert = array(
+    'commons_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Set commons_groups to display need update message for those upgrading from 3.2
+ * and revert the view to add the update display
+ * See https://drupal.org/node/2059857#comment-7733465
+ */
+function commons_groups_update_3111() {
+  variable_set('commons_groups_needs_update', TRUE);
+  $revert = array(
+    'commons_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  // Ensure that the menu callback from our new Views display is active.
+  menu_rebuild();
+  return array();
+}
+
+/**
+ * Update the og group filter inside views per
+ * http://drupal.org/node/2037417.
+ */
+function commons_groups_update_3112() {
+  $revert = array(
+    'commons_radioactivity' => array('views_view'),
+    'commons_activity_streams' => array('views_view'),
+    'commons_groups' => array('views_view'),
+    'commons_polls' => array('views_view'),
+    'commons_posts' => array('views_view'),
+    'commons_wikis' => array('views_view'),
+    'commons_q_a' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Standardize Browsing Widget views.
+ */
+function commons_groups_update_3113() {
+  $revert = array(
+    'commons_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Display sticky content at top of lists.
+ */
+function commons_groups_update_3114() {
+  $revert = array(
+    'commons_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_groups/commons_groups.module b/modules/commons/commons_groups/commons_groups.module
new file mode 100644
index 0000000..39e0290
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.module
@@ -0,0 +1,1151 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Groups feature.
+ */
+
+include_once 'commons_groups.features.inc';
+
+/**
+ * Implements hook_og_permission_alter().
+ */
+function commons_groups_og_permission_alter(&$perms) {
+  // We set these values programatically based
+  // on the value of field_og_subscribe_settings, so we disable them in the UI.
+  $perms['subscribe']['roles'] = array();
+  $perms['subscribe']['title'] = t('Contribute to the group');
+  $perms['subscribe']['description'] = t('This value is set automatically based on the "Group Privacy Settings" field.');
+  $perms['subscribe without approval']['roles'] = array();
+  $perms['subscribe without approval']['title'] = t('Contribute to the group without approval');
+  $perms['subscribe without approval']['description'] = t('This value is set automatically based on the "Group Privacy Settings" field.');
+}
+
+
+/**
+ * Implements hook_ctools_plugin_directory().
+ */
+function commons_groups_ctools_plugin_directory($module, $plugin) {
+  if ($module == 'entityreference') {
+    return "plugins/entityreference/$plugin";
+  }
+}
+
+/**
+ * Implements hook_modules_enabled().
+ *
+ * Make sure the og access fields exist when og_access is enabled.
+ */
+function commons_groups_modules_enabled($modules) {
+  if (in_array('og_access', $modules)) {
+    features_revert(array('commons_groups' => array('field_base')));
+    features_revert(array('commons_groups' => array('field_instance')));
+  }
+}
+
+/**
+ * Implements hook_help().
+ * Used for the 3.2 -> 3.3 migration to warn users who have out-of-date groups
+ * to make sure they update the group privacy settings.
+ * See https://drupal.org/node/2059857 for more information
+ */
+function commons_groups_help($path, $arg) {
+  if (variable_get('commons_groups_needs_update', FALSE)) {
+    $message =  '<p>' . t("Drupal Commons 3.3 added a new, required field to control group privacy. Please edit your group(s) select one of the privacy options. Once all groups are
+      set, an administrator can dismiss the update notice.") . '</p>';
+    if ($path == 'admin/content/groups/update') {
+      return $message;
+    }
+    elseif ($arg[0] == 'node' && $arg[2] == 'edit') {
+      $node = menu_get_object();
+      if($node->type == 'group' && empty($node->field_og_subscribe_settings)) {
+        return $message;
+      }
+    }
+    if (user_access('edit any group content')) {
+      $message = t("Group privacy settings !updated.", array('!updated' => l('need to be updated', 'admin/content/groups/update')));
+      drupal_set_message($message, 'warning', FALSE);
+    }
+  }
+}
+
+/**
+ * Implements hook_entity_view().
+ */
+function commons_groups_entity_view($entity, $type, $view_mode, $langcode) {
+  // Set a breadcrumb for nodes in groups. We currently assume that
+  // nodes are groups.
+  if ($view_mode == 'full' && !empty($entity->og_group_ref[LANGUAGE_NONE][0]['target_id']) && $type != 'user') {
+    $breadcrumb = array();
+    $breadcrumb[] = l(t('Home'), NULL);
+    $breadcrumb[] = l(t('Groups'), 'groups');
+    $group = node_load($entity->og_group_ref[LANGUAGE_NONE][0]['target_id']);
+    if (node_access('view', $group)) {
+      $breadcrumb[] = l($group->title, 'node/' . $group->nid);
+    }
+    drupal_set_breadcrumb($breadcrumb);
+  }
+}
+
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ *
+ * Alter the privacy settings fields.
+ */
+function commons_groups_form_node_form_alter(&$form, &$form_state) {
+  $groups = og_get_all_group_bundle();
+
+  if (isset($groups['node']) && in_array($form_state['node']->type, array_keys($groups['node']))) {
+    // The group privacy settings are not required.
+    $form['field_og_subscribe_settings'][LANGUAGE_NONE]['#required'] = FALSE;
+
+    if (module_exists('og_access')) {
+      // Display private content checkbox only when "Joining requires approval"
+      // is selected.
+      $form['field_og_access_default_value']['#states'] = array(
+        'visible' => array(
+          ':input[name="field_og_subscribe_settings[' . LANGUAGE_NONE . ']"]' => array('value' => 'approval'),
+        ),
+      );
+
+      $form['#after_build'] = array('commons_groups_form_group_node_after_build');
+    }
+
+    $form['#attached']['css'] = array(
+      drupal_get_path('module', 'commons_groups') . '/css/commons_groups.css',
+    );
+
+    // The group access is set on commons_groups_node_presave().
+    $form['group_access'][LANGUAGE_NONE]['#required'] = FALSE;
+    $form['group_access']['#access'] = FALSE;
+  }
+}
+
+/**
+ * After build callback for the group node form.
+ *
+ * Display the private content checkbox inside the privacy settings field.
+ */
+function commons_groups_form_group_node_after_build($form, $form_state) {
+  $form['field_og_subscribe_settings'][LANGUAGE_NONE]['approval']['#suffix'] = render($form['field_og_access_default_value']);
+
+  return $form;
+}
+
+/**
+ * Update the group permission field.
+ *
+ * @param $role
+ *   The OG role object of which the permissions are being changed.
+ * @param $permissions
+ *   The anonymous user permissions of the group.
+ */
+function _commons_groups_update_group_permissions($role, $permissions) {
+  $updated_roles = &drupal_static(__FUNCTION__);
+  if (!empty($updated_roles[$role->rid])) {
+    // Avoid updating a group subscription twice on the same request.
+    return;
+  }
+
+  if (!empty($permissions['subscribe without approval'])) {
+    $subscribe_type = 'anyone';
+  }
+  elseif (!empty($permissions['subscribe'])) {
+    $subscribe_type = 'approval';
+  }
+  else {
+    $subscribe_type = 'invitation';
+  }
+
+  $wrapper = entity_metadata_wrapper($role->group_type, $role->gid);
+  if ($wrapper->field_og_subscribe_settings->value() != $subscribe_type) {
+    // Mark that the group's permissions were already handled on this request,
+    // to avoid saving the group entity more than once.
+    $updated_roles[$role->rid] = TRUE;
+
+    $wrapper->field_og_subscribe_settings->set($subscribe_type);
+    $wrapper->save();
+  }
+}
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_groups_menu_alter(&$items) {
+  // Provide a more informative title.
+  if (isset($items['node/%/group'])) {
+    $items['node/%/group']['title'] = t('Administer group');
+  }
+}
+
+/*
+ * Implements hook_menu
+ * Used with commons_groups_help and the commons groups update view to turn off
+ * the warning message to update groups
+ */
+function commons_groups_menu() {
+  $items['admin/content/groups/update/toggle'] = array(
+    'title' => 'Toggle Groups Update',
+    'page callback' => 'commons_groups_update_toggle',
+    'access arguments' => array('edit any group content'),
+    'type' => MENU_CALLBACK,
+  );
+  return $items;
+}
+
+/*
+ * Ajax callback page to toggle the group update status to off
+ * See https://drupal.org/node/2059857 for more information
+ */
+function commons_groups_update_toggle() {
+  variable_set('commons_groups_needs_update', FALSE);
+  return TRUE;
+}
+
+/**
+ * Implements hook_block_info().
+ */
+function commons_groups_block_info() {
+  $blocks['commons_groups_create_group'] = array(
+    'info' => t('"Create a group" call to action'),
+    'cache' => DRUPAL_NO_CACHE,
+  );
+  return $blocks;
+}
+
+/**
+ * Implements hook_block_view().
+ */
+function commons_groups_block_view() {
+  $block['subject'] = '';
+  if (node_access('create', 'group')) {
+    $block['content'] = l(t('Create a group'), 'node/add/group');
+  }
+  else {
+    $block['content'] = '';
+  }
+  return $block;
+}
+
+/**
+ * Implements hook_features_pipe_alter().
+ */
+function commons_groups_features_pipe_alter(&$pipe, $data, $export) {
+  // Prevent Commons Groups related fields from being piped in features
+  // when a content type includes those fields.
+  if (!empty($pipe['field_instance'])) {
+    foreach ($pipe['field_instance'] as $delta => $value) {
+      $args = explode('-', $value);
+      $field_name = $args[2];
+      $excluded_fields = array('og_group_ref', 'field_og_access_default_value',
+        'field_og_subscribe_settings', 'og_roles_permissions', 'group_access', 'field_group_logo', 'group_group', 'body');
+      if (in_array($field_name, $excluded_fields)) {
+        unset($pipe['field_instance'][$delta]);
+      }
+    }
+  }
+  if (!empty($pipe['field_base'])) {
+    foreach ($pipe['field_base'] as $delta => $value) {
+      if ($delta == 'og_group_ref') {
+        unset($pipe['field_base'][$delta]);
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_groups_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'group' => array(
+        'is_group_content' => FALSE,
+        'is_group' => TRUE,
+        'exclude_commons_follow' => TRUE,
+      ),
+    ),
+  );
+}
+
+/**
+ * Implements hook_views_pre_view().
+ * By default, all views should have a group_type filter that looks at only nodes.
+ * This function allows those views to also show group content on the front page
+ * regardless of their entity type.
+ * See https://drupal.org/node/2037417 for more info.
+ */
+function commons_groups_views_pre_view(&$view, &$display_id, &$args) {
+  // We check to see if a group id argument is set in the view, and if no arguments
+  // are being passed to the view. If so, the group_type filter is irrelevant.
+  if (isset($view->display_handler->options['arguments']['gid']) && empty($args)) {
+    if (isset($view->display_handler->options['filters']['group_type'])) {
+      $filters = $view->display_handler->get_option('filters');
+      unset($filters['group_type']);
+      $view->display_handler->override_option('filters', $filters);
+    }
+  }
+}
+
+function commons_groups_group_contributors_count_topics($group) {
+  // Format the count of contributors.
+  $output = '';
+  $view = views_get_view('commons_contributors_group');
+  if (!empty($view)) {
+    $view->set_display('panel_pane_1');
+    $view->set_arguments(array($group->nid));
+    $view->get_total_rows = TRUE;
+    $view->execute();
+    // If there are no contributors with avatars, return an empty string
+    // rather than displaying '0 contributors'.
+    if (empty($view->total_rows)) {
+      return '';
+    }
+    $contributors_count = $view->total_rows;
+    $output .= l(format_plural($contributors_count, '1 contributor', '@count contributors'), 'node/' . $group->nid . '/contributors');
+  }
+  // Format the list of topics:
+  if (!empty($group->field_topics[LANGUAGE_NONE])) {
+    foreach ($group->field_topics[LANGUAGE_NONE] as $item) {
+      $tids[] = $item['tid'];
+    }
+    $topics = taxonomy_term_load_multiple($tids);
+    $topics_text = ' discussing the @topics ';
+    $t_args = array('@topics' => format_plural(count($topics), 'topic', 'topics'));
+    foreach ($topics as $topic) {
+      $topics_text .= '!topic-' . $topic->tid;
+      if ($topic == end($topics)) {
+        $topics_text .= '.';
+      }
+      else {
+        $topics_text .= ', ';
+      }
+      $t_args['!topic-' . $topic->tid] = l(t($topic->name), 'taxonomy/term/' . $topic->tid);
+    }
+    $output .= t($topics_text, $t_args);
+  }
+  return $output;
+}
+
+/* set commons_Groups form alter to happen after views bulk operations */
+function commons_groups_module_implements_alter(&$implementations, $hook) {
+  if ($hook == 'form_alter') {
+    $group = $implementations['commons_groups'];
+    unset($implementations['commons_groups']);
+    $implementations['commons_groups'] = $group;
+  }
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_groups_form_alter(&$form, &$form_state, $form_id) {
+  if ($form_id == 'views_exposed_form' && strstr($form['#id'], 'views-exposed-form-commons-groups-directory')) {
+    $form['groups-keys']['#attributes'] = array(
+      'placeholder' => t('Separate keywords with commas'),
+    );
+  }
+  if ((strstr($form_id, 'views_form_commons_group_moderation_page'))) {
+    $form['select']['action::views_bulk_operations_delete_item']['#weight'] = 9;
+  }
+  if ($form_id == 'group_node_form' && is_null($form['nid']['#value'])) {
+    $form['actions']['submit']['#submit'][] = 'commons_groups_group_submission_message';
+  }
+  // Redirect the user back to the group homepage after submitting
+  // a node within a group.
+  if (isset($form['#node']) && substr($form_id, -10) == '_node_form') {
+    // Hide the "Group content visibility" field to simplify the node form.
+    if (!empty($form['group_content_access']['#access'])) {
+      $form['group_content_access']['#access'] = FALSE;
+    }
+    // Set a human-friendly page title.
+    if (empty($form['#node']->nid)) {
+      $types = node_type_get_types();
+      $type = $form['#node']->type;
+      // Use 'a' or 'an' appropriately.
+      $vowels = array('a', 'e', 'i', 'o', 'u');
+      $verb = strtolower(in_array($type[0], $vowels)) ? 'Create an' : 'Create a';
+      drupal_set_title(t("$verb @name", array('@name' => $types[$type]->name)), PASS_THROUGH);
+    }
+    // Customizations to the node form for entitites that are group content.
+    $group_content_entity_types = commons_groups_get_group_content_entity_types();
+    if (isset($group_content_entity_types['node'][$form['#node']->type])) {
+      $form['actions']['submit']['#submit'][] = 'commons_groups_node_in_group_submit';
+    }
+  }
+  if (in_array($form_id, array('og_ui_admin_global_permissions', 'og_ui_admin_permissions'))) {
+    $group_content_entity_types = commons_groups_get_group_content_entity_types();
+    if (!empty($group_content_entity_types)) {
+      // @TODO: Improve this message to be more specific and/or
+      // reflect these changes in the checkboxes.
+      $message = 'In addition to the permissions listed here, the Commons Groups module grants non-group members the ability to post content into groups where content in the group is public.';
+      drupal_set_message(t($message), 'warning');
+    }
+  }
+  // Hide internal fields that the user should not be able to edit directly.
+  if ($form_id == 'edit_profile_user_profile_form' || substr($form_id, -10) === '_node_form') {
+    $internal_fields = array('field_unread_invitations', 'field_unread_messages', 'user_trusted_contacts', 'og_user_group_ref', 'group_access');
+    foreach ($internal_fields as $field_name) {
+      if(isset($form[$field_name])) {
+        $form[$field_name]['#access'] = FALSE;
+      }
+    }
+  }
+  // Disable Trusted Contacts field if commons_trusted_contacts is disabled.
+  $group_content_entity_types = commons_groups_get_group_content_entity_types();
+  if (isset($form['#node']->type) && isset($group_content_entity_types['node'][$form['#node']->type])) {
+    if (isset($form['og_user_group_ref']) && !module_exists('commons_trusted_contacts')) {
+      $form['og_user_group_ref']['#access'] = FALSE;
+    }
+  }
+}
+
+/**
+ * Submit handler called if the form is for a node enabled as group content.
+ */
+function commons_groups_node_in_group_submit(&$form, &$form_state) {
+  if (isset($form_state['values']['og_group_ref'][LANGUAGE_NONE][0])) {
+    $group = $form_state['values']['og_group_ref'][LANGUAGE_NONE][0]['target_id'];
+    $form_state['redirect'] = 'node/' . $group;
+  }
+}
+
+/**
+ * Implements hook_system_info_alter().
+ */
+function commons_groups_system_info_alter(&$info, $file, $type) {
+  // Commons Groups dynamically adds the og_group_ref field to
+  // content types that request it by altering the
+  // commons_groups_entity_types variable.
+  // We must add a corresponding line for each field instance
+  // to commons_groups.info so that Features is aware of the instance
+  // and can successfully revert the field_instance component back
+  // to its default state.
+  if ($file->name == 'commons_groups') {
+    $group_bundles = og_get_all_group_bundle();
+    if (!empty($group_bundles['node'])) {
+      foreach ($group_bundles['node'] as $bundle => $name) {
+        // These field instances should be added to groups regardless of
+        // whether og_access.module is enabled.
+        $info['features']['field_instance'][] = "node-$bundle-field_og_access_default_value";
+        $info['features']['field_instance'][] = "node-$bundle-field_og_subscribe_settings";
+        $info['features']['field_instance'][] = "node-$bundle-og_roles_permissions";
+        $info['features']['field_instance'][] = "node-$bundle-body";
+        $info['features']['field_instance'][] = "node-$bundle-group_group";
+
+        // These fields are only necessary when og_access.module is enabled.
+        $info['features']['field_instance'][] = "node-$bundle-group_access";
+        $info['features']['field_instance'][] = "node-$bundle-field_group_logo";
+
+        // Add default strongarm settings.
+        $info['features']['variable'][] = "comment_anonymous_$bundle";
+        $info['features']['variable'][] = "comment_default_mode_$bundle";
+        $info['features']['variable'][] = "comment_default_per_page_$bundle";
+        $info['features']['variable'][] = "comment_form_location_$bundle";
+        $info['features']['variable'][] = "comment_$bundle";
+        $info['features']['variable'][] = "comment_preview_$bundle";
+        $info['features']['variable'][] = "comment_subject_field_$bundle";
+        $info['features']['variable'][] = "field_bundle_settings_node__$bundle";
+      }
+    }
+    $group_content_entity_types = commons_groups_get_group_content_entity_types();
+    if (!empty($group_content_entity_types)) {
+      foreach ($group_content_entity_types as $entity_type => $bundles) {
+        foreach (array_keys($bundles) as $bundle) {
+          $info['features']['field_instance'][] = "$entity_type-$bundle-og_group_ref";
+          $info['features']['field_instance'][] = "$entity_type-$bundle-group_content_access";
+        }
+      }
+    }
+
+    // Commons specific group variables.
+    $commons_groups = commons_groups_get_group_types();
+    if (isset($commons_groups['node'])) {
+      foreach ($commons_groups['node'] as $bundle => $group_info) {
+        $info['features']['variable'][] = "node_options_$bundle";
+        $info['features']['variable'][] = "node_preview_$bundle";
+        $info['features']['variable'][] = "node_submitted_$bundle";
+        $info['features']['variable'][] = "og_group_manager_default_rids_node_$bundle";
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_default_message_type_alter().
+ */
+function commons_groups_default_message_type_alter(&$defaults) {
+  foreach (array('commons_activity_streams_comment_created', 'commons_activity_streams_node_created') as $name) {
+    if (!empty($defaults[$name])) {
+      $defaults[$name]->message_text[LANGUAGE_NONE][2] = commons_groups_message_partial_default();
+    }
+  }
+}
+
+
+/**
+ * Implements hook_og_user_access_alter().
+ *
+ * Deny create permissions from non-members on "non-public" groups (i.e. groups
+ * that don't allow joining without approval).
+ */
+function commons_groups_og_user_access_alter(&$perm, $context) {
+  $account = $context['account'];
+  $group_type = $context['group_type'];
+  $group = $context['group'];
+
+  if ($group_type != 'node') {
+    return;
+  }
+  // The purpose of this function is to grant permissions to create content
+  // in a group to non-members of the group, when the group's privacy settings
+  // (field_og_subscribe_settings) is set to "Anyone can contribute".
+  if (og_is_member($group_type, $group->nid, 'user', $account, array(OG_STATE_ACTIVE, OG_STATE_PENDING, OG_STATE_BLOCKED))) {
+    // The user is a group member, so comply to the OG permissions.
+    return;
+  }
+
+  $wrapper = entity_metadata_wrapper($group_type, $group);
+  $access_create = $account->uid && $wrapper->field_og_subscribe_settings->value() == 'anyone';
+
+  // Make sure user can view group (i.e. it's not private).
+  $commons_groups_entity_types = commons_groups_get_group_content_entity_types();
+  foreach (array_keys($commons_groups_entity_types['node']) as $type) {
+    $perm["create $type content"] = $access_create;
+  }
+}
+
+
+/**
+ * Implements of hook_token_info().
+ */
+function commons_groups_token_info() {
+  $types = array();
+  $tokens = array();
+
+  // Commons Groups tokens.
+  $types['commons-groups'] = array(
+    'name' => t('Commons Groups'),
+    'description' => t('Tokens related to the Groups functionality in Drupal Commons.'),
+    'needs-data' => 'node',
+  );
+  $tokens['commons-groups']['in-groups-text'] = array(
+    'name' => t('"In groups" text'),
+    'description' => t('The text (starting with "in the groups") indicating which groups a peice of content belongs to.'),
+  );
+  $tokens['node']['commons-groups-group-contributors-count-topics'] = array(
+    'name' => t('Commons Groups: Group contributor count and topics'),
+    'description' => t('Displays text showing the number of contributors and the topics associated with a group node.'),
+  );
+  return array(
+    'types' => $types,
+    'tokens' => $tokens,
+  );
+}
+
+
+/**
+ * Implements hook_tokens().
+ */
+function commons_groups_tokens($type, $tokens, $data = array(), $options = array()) {
+  $replacements = array();
+  if ($type == 'node' && !empty($data['node'])) {
+    $group = $data['node'];
+
+    foreach ($tokens as $name => $original) {
+      if ($name == 'commons-groups-group-contributors-count-topics') {
+        $replacements[$original] = commons_groups_group_contributors_count_topics($group);
+        return $replacements;
+      }
+    }
+  }
+  if ($type == 'commons-groups') {
+    if (!empty($tokens['in-groups-text'])) {
+      // Build a list of groups associated with this message.
+      $text = '';
+      $target_nids = array();
+      $related_groups = array();
+      $related_gids = array();
+
+      // First, build an array of target nodes associated with the message.
+      foreach ($data['message']->field_target_nodes[LANGUAGE_NONE] as $key => $value) {
+        $target_nids[] = $value['target_id'];
+      }
+      // If there are no target nodes, the in-groups-text token should be empty.
+      if (empty($target_nids)) {
+        $replacements['[commons-groups:in-groups-text]'] = $text;
+        return $replacements;
+      }
+      // Build a list of groups associated with the target nodes.
+      // For now, we assume that the group type is node.
+      foreach ($target_nids as $key => $nid) {
+        $og_memberships_this_target = og_get_entity_groups('node', $nid);
+        if (!empty($og_memberships_this_target['node'])) {
+          $og_memberships_this_target = $og_memberships_this_target['node'];
+          foreach ($og_memberships_this_target as $membership_id => $gid) {
+            $related_gids[] = $gid;
+          }
+        }
+      }
+      // If no groups are associated with any of the targett nodes,
+      // then we have no "in the groups" text.
+      if (empty($related_gids)) {
+        $replacements['[commons-groups:in-groups-text]'] = '';
+        return $replacements;
+      }
+
+      $related_groups = entity_load('node', $related_gids);
+      // Key the array of groups in a predictable way.
+      $related_groups = array_values($related_groups);
+      // Generate the appropriate text depending on the number of groups
+      // associated with the message:
+      $replacements['[commons-groups:in-groups-text]'] = commons_groups_related_groups_text($related_groups);
+      return $replacements;
+    }
+  }
+}
+
+function commons_groups_message_partial_default() {
+  $partial = array(
+    'value' => '[commons-groups:in-groups-text]',
+    'format' => 'full_html',
+    'safe_value' => '[commons-groups:in-groups-text]',
+  );
+  return $partial;
+}
+
+/**
+ * Build the related-groups text for nodes.
+ *
+ * @param $related_groups
+ *   Array of groups referenced by the node.
+ *
+ * @return
+ *   String containing the related groups.
+ */
+function commons_groups_related_groups_text($related_groups) {
+  // In 1 group: "in the x group"
+  if (count($related_groups) == 1) {
+    return ' ' . t('in the !group group', array('!group' => l($related_groups[0]->title, 'node/' . $related_groups[0]->nid)));
+  }
+
+  // In 2 groups: "in the x and y groups"
+  if (count($related_groups) == 2) {
+    return ' ' . t('in the !group-0 and !group-1 groups', array(
+      '!group-0' => l($related_groups[0]->title, 'node/' . $related_groups[0]->nid),
+      '!group-1' => l($related_groups[1]->title, 'node/' . $related_groups[1]->nid),
+    ));
+  }
+
+  // In more than 2 groups: "in the x, y and z groups"
+  if (count($related_groups) > 2) {
+    // Separate the last group.
+    $last_group = array_pop($related_groups);
+    $text = ' in the ';
+    // Prepare tokens for t() for each of the other groups.
+    foreach ($related_groups as $key => $this_group) {
+      $text .= "!group-$key, ";
+      $t_args["!group-$key"] = l($this_group->title, 'node/' . $this_group->nid);
+    }
+    // Prepare the last group token.
+    $text .= " and !group-$last_group->nid groups.";
+    $t_args["!group-$last_group->nid"] = l($last_group->title, 'node/' . $last_group->nid);
+    // Prepare the full text with all of the groups and their tokens:
+    return t($text, $t_args);
+  }
+}
+
+function commons_groups_group_submission_message($form, &$form_state) {
+  if ($form_state['values']['status'] !== 1) {
+    drupal_set_message(t('Thanks for your group submission! This group has entered the moderation queue and will be reviewed shortly.'));
+  }
+}
+
+/**
+ * Default value function for the og_group_ref reference field.
+ * This function is assigned to the field with the default_value_function
+ * property defined in our instances of the og_group_ref field,
+ * which takes place in commons_groups_field_definition().
+ */
+function commons_groups_entityreference_default_value($entity_type, $entity, $field, $instance, $langcode) {
+
+  $items = array();
+  $field_name = $field['field_name'];
+
+  if (empty($_GET[$field_name]) || !is_string($_GET[$field_name])) {
+    return $items;
+  }
+
+  if (empty($instance['settings']['behaviors']['prepopulate']['status'])) {
+    return $items;
+  }
+
+  $ids = explode(',', $_GET[$field_name]);
+  // Check access to the provided entities.
+  $target_type = $field['settings']['target_type'];
+  entity_load($target_type, $ids);
+  // Remove group nodes hidden by the node access system.
+  foreach ($ids as $target_id) {
+    $target = entity_load_single($target_type, $target_id);
+    if (entity_access('view', $target_type, $target)
+      && og_is_group_type($target_type, $target->type)
+      && (og_user_access($target_type, $target_id, "create $entity->type content") || og_user_access($target_type, $target_id, "update any $entity->type content"))
+    ) {
+      $items[] = array('target_id' => $target_id);
+    }
+  }
+  return $items;
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+function commons_groups_strongarm_alter(&$items) {
+  // Expose the Group content type for integration with Commons Radioactivity.
+  if (isset($items['commons_radioactivity_entity_types'])) {
+    $items['commons_radioactivity_entity_types']->value['node']['group'] = 1;
+  }
+}
+
+function commons_groups_default_rules_configuration_alter(&$configs) {
+  // Disable default OG new content notifications.
+  // The language doesn't correspond to Commons' open groups model and we use
+  // commons_follow and commons_follow_notify for new content notifications.
+  if (isset($configs['rules_og_member_active'])) {
+    $configs['rules_og_member_active']->active = FALSE;
+  }
+}
+
+/**
+ * Implements hook_node_presave().
+ *
+ * When the node's group is private, force the group content to be private.
+ */
+function commons_groups_node_presave($node) {
+  if (!module_exists('og_access')) {
+    return;
+  }
+
+  $wrapper = entity_metadata_wrapper('node', $node);
+
+  if (og_is_group('node', $node)) {
+    // Determine whether the group is private according to the subscription
+    // field.
+    $private = $wrapper->field_og_subscribe_settings->value() == 'invitation';
+    $wrapper->{OG_ACCESS_FIELD}->set((int)$private);
+    return;
+  }
+
+  if (!og_is_group_content_type('node', $node->type)) {
+    return;
+  }
+
+
+  // Check whether any of the groups are private.
+  $private = FALSE;
+  foreach (array_keys(og_get_group_audience_fields('node', $node->type)) as $field) {
+    if (empty($node->$field)) {
+      continue;
+    }
+
+    foreach ($wrapper->$field as $group_wrapper) {
+      if (empty($group_wrapper->field_og_access_default_value)) {
+        continue;
+      }
+
+      if ($group_wrapper->field_og_access_default_value->value() == TRUE) {
+        // Once a private group was found, there's no need to continue.
+        $private = TRUE;
+        break 2;
+      }
+    }
+  }
+
+  if ($private) {
+    $wrapper->{OG_CONTENT_ACCESS_FIELD}->set(OG_CONTENT_ACCESS_PRIVATE);
+  }
+}
+
+/**
+ * Implements hook_node_update().
+ */
+function commons_groups_node_update($node) {
+  $account = user_load($node->uid);
+  commons_groups_first_contribution($account, $node);
+
+  if (og_is_group('node', $node)) {
+    commons_groups_set_group_permissions($node);
+  }
+}
+
+/**
+ * Implements hook_node_insert().
+ */
+function commons_groups_node_insert($node) {
+  $account = user_load($node->uid);
+  commons_groups_first_contribution($account, $node);
+
+  if (og_is_group('node', $node)) {
+    // When creating a new group, this hook happens before OG creates the
+    // group specific roles. Therefore we create the roles here before altering
+    // them in commons_groups_set_group_permissions().
+    og_roles_override('node', $node->type, $node->nid);
+    commons_groups_set_group_permissions($node);
+  }
+}
+
+/**
+ * Set the group's permissions according to field_og_subscribe_settings.
+ *
+ * @param $node
+ *   A group node.
+ */
+function commons_groups_set_group_permissions($node) {
+  // Avoid updating a group subscription twice on the same request.
+  $updated_nodes = & drupal_static(__FUNCTION__);
+  if (!empty($updated_nodes[$node->nid])) {
+    return;
+  }
+  $updated_nodes[$node->nid] = TRUE;
+
+  $wrapper = entity_metadata_wrapper('node', $node);
+  $permission = $wrapper->field_og_subscribe_settings->value();
+  $og_roles = og_roles('node', $node->type, $node->nid);
+  $anon_rid = array_search(OG_ANONYMOUS_ROLE, $og_roles);
+
+  $permissions = array(
+    'subscribe' => $permission == 'approval',
+    'subscribe without approval' => $permission == 'anyone',
+  );
+
+  // Check if the permissions needs to be changed.
+  $changed = FALSE;
+  $old_permissions = og_role_permissions(array($anon_rid => OG_ANONYMOUS_ROLE));
+  foreach ($permissions as $permission => $value) {
+    if (empty($old_permissions[$anon_rid][$permission]) || $old_permissions[$anon_rid][$permission] != $value) {
+      $changed = TRUE;
+    }
+  }
+
+  // Only change the permissions when neccessary.
+  if ($changed) {
+    og_role_change_permissions($anon_rid, $permissions);
+  }
+}
+
+/**
+ * Returns an array of entity types that are enabled via Commons Groups.
+ */
+function commons_groups_get_group_content_entity_types() {
+  // Find all Commons Entity integrations.
+  $commons_entity_integrations = commons_entity_integration_info();
+  if (empty($commons_entity_integrations)) {
+    return array();
+  }
+
+  foreach ($commons_entity_integrations as $entity_type => $integration) {
+    foreach ($integration as $bundle => $options) {
+      if (isset($options['is_group_content']) && $options['is_group_content'] == FALSE) {
+        unset($commons_entity_integrations[$entity_type][$bundle]);
+      }
+    }
+    // If an entity type has no integrations, don't return it.
+    if (empty($commons_entity_integrations[$entity_type])) {
+      unset($commons_entity_integrations[$entity_type]);
+    }
+  }
+
+  return $commons_entity_integrations;
+}
+
+/**
+ * Returns an array of entity types that are defined as a group.
+ */
+function commons_groups_get_group_types() {
+  // Find all Commons Entity integrations.
+  $commons_groups = array();
+  $commons_entity_integrations = commons_entity_integration_info();
+  if (empty($commons_entity_integrations)) {
+    return array();
+  }
+
+  foreach ($commons_entity_integrations as $entity_type => $integration) {
+    foreach ($integration as $bundle => $options) {
+      if (isset($options['is_group']) && $options['is_group'] == TRUE) {
+        $commons_groups[$entity_type][$bundle] = $commons_entity_integrations[$entity_type][$bundle];
+      }
+    }
+  }
+
+  return $commons_groups;
+}
+
+/**
+ * When a user first creates content within a group,
+ * grant her the contributor role within that group.
+ */
+function commons_groups_first_contribution($account, $node) {
+  // Find the groups that this piece of content belongs to.
+  $groups = og_get_entity_groups('node', $node);
+  // @todo: Make it work also with user-groups.
+  if (!empty($groups['node'])) {
+    $node_groups = array_values($groups['node']);
+    // Find the groups that the node author belongs to.
+    $account_groups = og_get_groups_by_user($account, 'node');
+    if (!$account_groups) {
+      $account_groups = array();
+    }
+    // For groups where this user is not already a member, add her to the group.
+    // Anonymous users should never be added to a group automatically
+    if ($account->uid == 0) {
+      return;
+    }
+    $new_groups = array_diff($node_groups, $account_groups);
+    if (!empty($new_groups)) {
+      foreach ($new_groups as $new_group_nid) {
+        og_group('node', $new_group_nid, array('entity' => $account->uid));
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_commons_bw_group_widget().
+ */
+function commons_groups_commons_bw_group_widget() {
+  return array(
+    'commons_all' => array(
+      'title' => t('All'),
+      'type' => 'view',
+      'vid' => 'commons_bw_all',
+      'display' => 'default',
+      'weight' => -10,
+      'default' => 1,
+      'bundle' => 'post',
+    ),
+  );
+}
+
+/**
+ * Implements hook_preprocess_node().
+ */
+function commons_groups_preprocess_node(&$variables) {
+  $variables['user_picture'] = '';
+  if (variable_get('user_pictures', 0)) {
+    $node = $variables['node'];
+    $account = user_load($node->uid);
+
+    if (!empty($account->picture)) {
+      // @TODO: Ideally this function would only be passed file objects, but
+      // since there's a lot of legacy code that JOINs the {users} table to
+      // {node} or {comments} and passes the results into this function if we
+      // a numeric value in the picture field we'll assume it's a file id
+      // and load it for them. Once we've got user_load_multiple() and
+      // comment_load_multiple() functions the user module will be able to load
+      // the picture files in mass during the object's load process.
+      if (is_numeric($account->picture)) {
+        $account->picture = file_load($account->picture);
+      }
+      if (!empty($account->picture->uri)) {
+        $filepath = $account->picture->uri;
+      }
+    }
+    elseif (variable_get('user_picture_default', '')) {
+      $filepath = variable_get('user_picture_default', '');
+    }
+
+    if (isset($filepath)) {
+      if (module_exists('image') && file_valid_uri($filepath)) {
+        $alt = t("@user's picture", array('@user' => format_username($account)));
+
+        $render = array(
+          '#theme' => 'image_formatter',
+          '#image_style' => '50x50',
+          '#item' => array(
+            'uri' => $filepath,
+            'alt' => $alt,
+          ),
+          '#path' => array(
+            'path' => 'user/' . $account->uid,
+            'options' => array(
+              'attributes' => array(
+                'title' => t("View @user's profile.", array('@user' => format_username($account))),
+                'class' => array('user-picture'),
+              ),
+            ),
+          ),
+        );
+
+        // Use a unique image style for user pictures in post information.
+        $variables['user_picture'] = drupal_render($render);
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_preprocess_views_view_grid().
+ */
+function commons_groups_preprocess_views_view_grid(&$variables, $hook) {
+  // Change the displayed role name in the group contributors block to
+  // "Organizers".
+  if ($variables['view']->name == 'commons_contributors_group' && !empty($variables['title']) && $variables['title'] == 'administrator member') {
+    $variables['title'] = t('Organizers');
+  }
+}
+
+/**
+ * Implements hook_field_access().
+ */
+function commons_groups_field_access($op, $field, $entity_type, $entity, $account) {
+  $field_name = $field['field_name'];
+  switch ($field_name) {
+    case 'og_roles_permissions':
+      return FALSE;
+
+    case 'field_og_access_default_value':
+      return $op == 'edit' && module_exists('og_access');
+
+    case 'field_og_subscribe_settings':
+      return $op == 'edit';
+  }
+
+  if (module_exists('og_access') && in_array($field_name, array(OG_CONTENT_ACCESS_FIELD, OG_ACCESS_FIELD))) {
+    return FALSE;
+  }
+}
+
+/**
+ * Implements hook_field_formatter_info().
+ */
+function commons_groups_field_formatter_info() {
+  return array(
+    'commons_groups_group_subscribe' => array(
+      'label' => t('Commons groups subscribe link'),
+      'field types' => array('list_boolean'),
+      'settings' => array(
+        'field_name' => FALSE,
+      ),
+    ),
+  );
+}
+
+/**
+ * Implements hook_field_formatter_view().
+ */
+function commons_groups_field_formatter_view($entity_type, $entity, $field, $instance, $langcode, $items, $display) {
+  global $user;
+  $account = clone $user;
+
+  if ($display['type'] != 'commons_groups_group_subscribe') {
+    return;
+  }
+
+  if (!og_is_group($entity_type, $entity)) {
+    return;
+  }
+
+  if (!empty($entity->uid) && ($entity->uid == $account->uid)) {
+    // User is the group manager.
+    $element[0] = array('#markup' => t('You are the group manager'));
+    return $element;
+  }
+
+  list($id, , $bundle) = entity_extract_ids($entity_type, $entity);
+
+  // The user has a pending membership request. Let her know that
+  // her request is pending review.
+  if (og_is_member($entity_type, $id, 'user', $account, array(OG_STATE_PENDING))) {
+    $element[0] = array('#markup' => '<div class="subscription-type">' . t('Your membership request is pending review by a group organizer.') . '</div>');
+    return $element;
+  }
+  // If user is blocked, they should not be able to apply for membership.
+  if (og_is_member($entity_type, $id, 'user', $account, array(OG_STATE_BLOCKED))) {
+    return;
+  }
+  if (og_is_member($entity_type, $id, 'user', $account)) {
+    // The user has an active membership. She can leave the group.
+    // For groups where anyone can contribute without joining, don't display
+    // a "Leave" link since users never went through
+    // the separate step of joining.
+    if (og_is_member($entity_type, $id, 'user', $account, array(OG_STATE_ACTIVE)) && $entity->field_og_subscribe_settings[LANGUAGE_NONE][0]['value'] != 'anyone') {
+      $links['title'] = t('Leave group');
+      $links['href'] = "group/$entity_type/$id/unsubscribe";
+    }
+  }
+  else {
+    // Check if user can subscribe to the field.
+    if (empty($settings['field_name']) && $audience_field_name = og_get_best_group_audience_field('user', $account, $entity_type, $bundle)) {
+      $settings['field_name'] = $audience_field_name;
+    }
+    if (!$settings['field_name']) {
+      return;
+    }
+
+    $field_info = field_info_field($settings['field_name']);
+
+    // Check if entity is referencable.
+    if ($field_info['settings']['target_type'] != $entity_type) {
+      // Group type doesn't match.
+      return;
+    }
+    if (!empty($field_info['settings']['handler_settings']['target_bundles']) && !in_array($bundle, $field_info['settings']['handler_settings']['target_bundles'])) {
+      // Bundles don't match.
+      return;
+    }
+
+    if (!og_check_field_cardinality('user', $account, $settings['field_name'])) {
+      $element[0] = array('#markup' => format_plural($field_info['cardinality'], 'You are already registered to another group', 'You are already registered to @count groups'));
+      return $element;
+    }
+
+    $url = "group/$entity_type/$id/subscribe";
+    if ($settings['field_name']) {
+      $url .= '/' . $settings['field_name'];
+    }
+    // Set the needs update hook if we end up with a group call that is missing
+    // the subscribe settings. We also check the variable first, because we
+    // don't want to reset the variable cache if we don't have to.
+    // See https://drupal.org/node/2059857#comment-7733465 for more info.
+    if (empty($entity->field_og_subscribe_settings)) {
+      if (!variable_get('commons_groups_needs_update', FALSE)) {
+        variable_set('commons_groups_needs_update', TRUE);
+      }
+    }
+    // Don't display join link on public groups.
+    else {
+      if ($entity->field_og_subscribe_settings[LANGUAGE_NONE][0]['value'] != 'anyone') {
+        if ($entity->field_og_subscribe_settings[LANGUAGE_NONE][0]['value'] == 'approval') {
+          $subscription_type = t('Moderated group');
+          $links['title'] = t('Join group');
+          if ($account->uid) {
+            $links['href'] = $url;
+          }
+          else {
+            $links['href'] = 'user/login';
+            $links['options'] = array('query' => array('destination' => $url));
+          }
+        }
+        else {
+          $element[0] = array('#markup' => '<div class="subscription-type">' . t('Invite-only group') . '</div>');
+          return $element;
+        }
+      }
+    }
+  }
+  if (!empty($links['title'])) {
+    $links += array('options' => array());
+    $element[0] = array(
+      '#type' => 'link',
+      '#title' => $links['title'],
+      '#href' => $links['href'],
+      '#options' => $links['options'],
+    );
+
+    if (!empty($subscription_type)) {
+      $element[0]['#prefix'] = '<div class="subscription-type">' . $subscription_type . '</div>';
+    }
+
+    return $element;
+  }
+}
diff --git a/modules/commons/commons_groups/commons_groups.strongarm.inc b/modules/commons/commons_groups/commons_groups.strongarm.inc
new file mode 100644
index 0000000..42321f3
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.strongarm.inc
@@ -0,0 +1,179 @@
+<?php
+/**
+ * @file
+ * commons_groups.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_groups_strongarm() {
+  $export = array();
+  $commons_groups = commons_groups_get_group_types();
+  $group_bundles = og_get_all_group_bundle();
+
+  // These settings are automatic for all groups used within commons.
+  if (isset($group_bundles['node'])) {
+    foreach ($group_bundles['node'] as $bundle => $group_info) {
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_anonymous_$bundle";
+      $strongarm->value = 0;
+      $export["comment_anonymous_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_default_mode_$bundle";
+      $strongarm->value = 1;
+      $export["comment_default_mode_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_default_per_page_$bundle";
+      $strongarm->value = '50';
+      $export["comment_default_per_page_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_form_location_$bundle";
+      $strongarm->value = 1;
+      $export["comment_form_location_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_$bundle";
+      $strongarm->value = '0';
+      $export["comment_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_preview_$bundle";
+      $strongarm->value = '1';
+      $export["comment_preview_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "comment_subject_field_$bundle";
+      $strongarm->value = 1;
+      $export["comment_subject_field_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "field_bundle_settings_node__$bundle";
+      $strongarm->value = array(
+        'view_modes' => array(
+          'teaser' => array(
+            'custom_settings' => TRUE,
+          ),
+          'full' => array(
+            'custom_settings' => FALSE,
+          ),
+          'rss' => array(
+            'custom_settings' => FALSE,
+          ),
+          'search_index' => array(
+            'custom_settings' => FALSE,
+          ),
+          'search_result' => array(
+            'custom_settings' => FALSE,
+          ),
+          'diff_standard' => array(
+            'custom_settings' => FALSE,
+          ),
+          'token' => array(
+            'custom_settings' => FALSE,
+          ),
+        ),
+        'extra_fields' => array(
+          'form' => array(
+            'title' => array(
+              'weight' => '-5',
+            ),
+          ),
+          'display' => array(),
+        ),
+      );
+      $export["field_bundle_settings_node__$bundle"] = $strongarm;
+    }
+  }
+
+  // Add some additional default settings if the node implements the commons
+  // Specific entity integrations hook.
+  if (isset($commons_groups['node'])) {
+    foreach ($commons_groups['node'] as $bundle => $group_info) {
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "node_options_$bundle";
+      $strongarm->value = array(
+        0 => 'revision',
+      );
+      $export["node_options_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "node_preview_$bundle";
+      $strongarm->value = '1';
+      $export["node_preview_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "node_submitted_$bundle";
+      $strongarm->value = 0;
+      $export["node_submitted_$bundle"] = $strongarm;
+
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "og_group_manager_default_rids_node_$bundle";
+      $strongarm->value = array(
+        3 => '3',
+      );
+      $export["og_group_manager_default_rids_node_$bundle"] = $strongarm;
+    }
+  }
+
+  // These following settings are ONLY for the group content type.
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = "pathauto_node_group_pattern";
+  $strongarm->value = 'groups/[node:title]';
+  $export["pathauto_node_group_pattern"] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_group';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_group'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_group';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_group'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'pathauto_node_pattern';
+  $strongarm->value = 'groups/[node:og-group-ref:0:title]/[node:title]';
+  $export['pathauto_node_pattern'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_groups/commons_groups.views_default.inc b/modules/commons/commons_groups/commons_groups.views_default.inc
new file mode 100644
index 0000000..d7d4671
--- /dev/null
+++ b/modules/commons/commons_groups/commons_groups.views_default.inc
@@ -0,0 +1,1370 @@
+<?php
+/**
+ * @file
+ * commons_groups.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_groups_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_bw_all';
+  $view->description = 'Commons all content listing for the group browsing widget.';
+  $view->tag = 'Commons Browsing Widget';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Browsing Widget - All';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['query_comment'] = FALSE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '1';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* Header: Global: Node partial form */
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['id'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['table'] = 'views';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['field'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['bundle'] = 'post';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'Nobody has posted into this group yet.';
+  $handler->display->display_options['empty']['area']['format'] = 'plain_text';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Sticky */
+  $handler->display->display_options['sorts']['sticky']['id'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['table'] = 'node';
+  $handler->display->display_options['sorts']['sticky']['field'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['order'] = 'DESC';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'most recent';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['gid']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['gid']['validate']['type'] = 'og';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array();
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+  $translatables['commons_bw_all'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('Nobody has posted into this group yet.'),
+    t('OG membership from node'),
+    t('following'),
+    t('most recent'),
+    t('most active'),
+    t('All'),
+    t('Following'),
+  );
+  $export['commons_bw_all'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_contributors_group';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'users';
+  $view->human_name = 'Commons Contributors - Group';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Group contributors';
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'access user profiles';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['distinct'] = TRUE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '16';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['style_options']['columns'] = '7';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: OG membership: OG membership from User */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'users';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  /* Sort criterion: User: Created date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'users';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['gid']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['gid']['validate']['type'] = 'og';
+  /* Filter criterion: User: Active */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'users';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: OG membership: State */
+  $handler->display->display_options['filters']['state']['id'] = 'state';
+  $handler->display->display_options['filters']['state']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['state']['field'] = 'state';
+  $handler->display->display_options['filters']['state']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['state']['value'] = array(
+    1 => '1',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+
+  /* Display: group teaser */
+  $handler = $view->new_display('panel_pane', 'group teaser', 'panel_pane_1');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'Recent contributors';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['pager'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '14';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['label'] = '';
+  $handler->display->display_options['fields']['name']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['name']['link_to_user'] = FALSE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['picture']['alter']['text'] = '[picture]<span>[name]</span>';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['link_photo_to_profile'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '35x35';
+  /* Field: User: Uid */
+  $handler->display->display_options['fields']['uid']['id'] = 'uid';
+  $handler->display->display_options['fields']['uid']['table'] = 'users';
+  $handler->display->display_options['fields']['uid']['field'] = 'uid';
+  $handler->display->display_options['fields']['uid']['label'] = '';
+  $handler->display->display_options['fields']['uid']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['uid']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['uid']['link_to_user'] = FALSE;
+  /* Field: Global: Custom text */
+  $handler->display->display_options['fields']['nothing']['id'] = 'nothing';
+  $handler->display->display_options['fields']['nothing']['table'] = 'views';
+  $handler->display->display_options['fields']['nothing']['field'] = 'nothing';
+  $handler->display->display_options['fields']['nothing']['label'] = '';
+  $handler->display->display_options['fields']['nothing']['alter']['text'] = '[picture]<span>[name]</span>';
+  $handler->display->display_options['fields']['nothing']['alter']['make_link'] = TRUE;
+  $handler->display->display_options['fields']['nothing']['alter']['path'] = 'user/[uid]';
+  $handler->display->display_options['fields']['nothing']['alter']['absolute'] = TRUE;
+  $handler->display->display_options['fields']['nothing']['element_label_colon'] = FALSE;
+  $handler->display->display_options['argument_input'] = array(
+    'gid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'OG membership: Group ID',
+    ),
+  );
+
+  /* Display: group homepage */
+  $handler = $view->new_display('panel_pane', 'group homepage', 'panel_pane_2');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['style_plugin'] = FALSE;
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['style_options']['grouping'] = array(
+    0 => array(
+      'field' => 'og_roles',
+      'rendered' => 1,
+      'rendered_strip' => 0,
+    ),
+  );
+  $handler->display->display_options['defaults']['style_options'] = FALSE;
+  $handler->display->display_options['defaults']['row_plugin'] = FALSE;
+  $handler->display->display_options['row_plugin'] = 'fields';
+  $handler->display->display_options['defaults']['row_options'] = FALSE;
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50';
+  /* Field: OG membership: OG user roles in group */
+  $handler->display->display_options['fields']['og_roles']['id'] = 'og_roles';
+  $handler->display->display_options['fields']['og_roles']['table'] = 'og_membership';
+  $handler->display->display_options['fields']['og_roles']['field'] = 'og_roles';
+  $handler->display->display_options['fields']['og_roles']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['fields']['og_roles']['label'] = '';
+  $handler->display->display_options['fields']['og_roles']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['og_roles']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['og_roles']['empty'] = 'Contributors';
+  $handler->display->display_options['argument_input'] = array(
+    'gid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'OG membership: Group ID',
+    ),
+  );
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'page_1');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'Contributors to %1';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['path'] = 'node/%/contributors';
+  $translatables['commons_contributors_group'] = array(
+    t('Master'),
+    t('Group contributors'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('OG membership from user'),
+    t('All'),
+    t('group teaser'),
+    t('Recent contributors'),
+    t('[picture]<span>[name]</span>'),
+    t('View panes'),
+    t('group homepage'),
+    t('Contributors'),
+    t('Page'),
+    t('Contributors to %1'),
+  );
+  $export['commons_contributors_group'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_group_moderation';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Group Moderation';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Commons Group Moderation';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'edit any group content';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '25';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'views_bulk_operations' => 'views_bulk_operations',
+    'title' => 'title',
+    'name' => 'name',
+    'changed' => 'changed',
+    'edit_node' => 'edit_node',
+    'delete_node' => 'edit_node',
+  );
+  $handler->display->display_options['style_options']['default'] = 'changed';
+  $handler->display->display_options['style_options']['info'] = array(
+    'views_bulk_operations' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'title' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'name' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'changed' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'edit_node' => array(
+      'align' => '',
+      'separator' => '    ',
+      'empty_column' => 0,
+    ),
+    'delete_node' => array(
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  /* Relationship: Content: Author */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'node';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  /* Field: Bulk operations: Content */
+  $handler->display->display_options['fields']['views_bulk_operations']['id'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['table'] = 'node';
+  $handler->display->display_options['fields']['views_bulk_operations']['field'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['label'] = 'Update Actions';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['display_type'] = '1';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['enable_select_all_pages'] = 1;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['force_single'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['entity_load_capacity'] = '10';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_operations'] = array(
+    'action::node_assign_owner_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::commons_content_moderation_delete_node_block_user' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_delete_item' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Delete Item(s)',
+    ),
+    'action::views_bulk_operations_script_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::flag_node_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_make_sticky_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_make_unsticky_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_modify_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'show_all_tokens' => 1,
+        'display_values' => array(
+          '_all_' => '_all_',
+        ),
+      ),
+    ),
+    'action::views_bulk_operations_argument_selector_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'url' => '',
+      ),
+    ),
+    'action::node_promote_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_publish_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Publish',
+    ),
+    'action::node_unpromote_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_save_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::system_send_email_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::panelizer_set_status_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_unpublish_action' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Unpublish',
+    ),
+    'action::node_unpublish_by_keyword_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::pathauto_node_update_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 0,
+      'label' => '',
+    ),
+  );
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = 'User';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: Content: Updated date */
+  $handler->display->display_options['fields']['changed']['id'] = 'changed';
+  $handler->display->display_options['fields']['changed']['table'] = 'node';
+  $handler->display->display_options['fields']['changed']['field'] = 'changed';
+  $handler->display->display_options['fields']['changed']['label'] = 'Updated';
+  $handler->display->display_options['fields']['changed']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['changed']['date_format'] = 'short';
+  /* Field: Content: Edit link */
+  $handler->display->display_options['fields']['edit_node']['id'] = 'edit_node';
+  $handler->display->display_options['fields']['edit_node']['table'] = 'views_entity_node';
+  $handler->display->display_options['fields']['edit_node']['field'] = 'edit_node';
+  $handler->display->display_options['fields']['edit_node']['label'] = 'Operations';
+  $handler->display->display_options['fields']['edit_node']['element_label_colon'] = FALSE;
+  /* Field: Content: Delete link */
+  $handler->display->display_options['fields']['delete_node']['id'] = 'delete_node';
+  $handler->display->display_options['fields']['delete_node']['table'] = 'views_entity_node';
+  $handler->display->display_options['fields']['delete_node']['field'] = 'delete_node';
+  $handler->display->display_options['fields']['delete_node']['label'] = '';
+  $handler->display->display_options['fields']['delete_node']['element_label_colon'] = FALSE;
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator_id'] = '';
+  $handler->display->display_options['filters']['status']['expose']['label'] = 'Active';
+  $handler->display->display_options['filters']['status']['expose']['operator'] = 'status_op';
+  $handler->display->display_options['filters']['status']['expose']['identifier'] = 'status';
+  $handler->display->display_options['filters']['status']['expose']['required'] = TRUE;
+  $handler->display->display_options['filters']['status']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+    3 => 0,
+    4 => 0,
+  );
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'group' => 'group',
+  );
+
+  /* Display: Proposed */
+  $handler = $view->new_display('page', 'Proposed', 'page');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: Bulk operations: Content */
+  $handler->display->display_options['fields']['views_bulk_operations']['id'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['table'] = 'node';
+  $handler->display->display_options['fields']['views_bulk_operations']['field'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['label'] = 'Update Actions';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['display_type'] = '1';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['enable_select_all_pages'] = 1;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['force_single'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['entity_load_capacity'] = '10';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_operations'] = array(
+    'action::node_assign_owner_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::commons_content_moderation_delete_node_block_user' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_delete_item' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Delete Item(s)',
+    ),
+    'action::views_bulk_operations_script_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::flag_node_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_make_sticky_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_make_unsticky_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_modify_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'show_all_tokens' => 1,
+        'display_values' => array(
+          '_all_' => '_all_',
+        ),
+      ),
+    ),
+    'action::views_bulk_operations_argument_selector_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'url' => '',
+      ),
+    ),
+    'action::node_promote_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_publish_action' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Publish',
+    ),
+    'action::node_unpromote_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_save_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::system_send_email_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::panelizer_set_status_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::node_unpublish_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Unpublish',
+    ),
+    'action::node_unpublish_by_keyword_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::pathauto_node_update_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 0,
+      'label' => '',
+    ),
+  );
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = 'User';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: Content: Updated date */
+  $handler->display->display_options['fields']['changed']['id'] = 'changed';
+  $handler->display->display_options['fields']['changed']['table'] = 'node';
+  $handler->display->display_options['fields']['changed']['field'] = 'changed';
+  $handler->display->display_options['fields']['changed']['label'] = 'Updated';
+  $handler->display->display_options['fields']['changed']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['changed']['date_format'] = 'short';
+  /* Field: Content: Edit link */
+  $handler->display->display_options['fields']['edit_node']['id'] = 'edit_node';
+  $handler->display->display_options['fields']['edit_node']['table'] = 'views_entity_node';
+  $handler->display->display_options['fields']['edit_node']['field'] = 'edit_node';
+  $handler->display->display_options['fields']['edit_node']['label'] = 'Operations';
+  $handler->display->display_options['fields']['edit_node']['element_label_colon'] = FALSE;
+  /* Field: Content: Delete link */
+  $handler->display->display_options['fields']['delete_node']['id'] = 'delete_node';
+  $handler->display->display_options['fields']['delete_node']['table'] = 'views_entity_node';
+  $handler->display->display_options['fields']['delete_node']['field'] = 'delete_node';
+  $handler->display->display_options['fields']['delete_node']['label'] = '';
+  $handler->display->display_options['fields']['delete_node']['element_label_colon'] = FALSE;
+  $handler->display->display_options['defaults']['filter_groups'] = FALSE;
+  $handler->display->display_options['defaults']['filters'] = FALSE;
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '0';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator_id'] = '';
+  $handler->display->display_options['filters']['status']['expose']['label'] = 'Active';
+  $handler->display->display_options['filters']['status']['expose']['operator'] = 'status_op';
+  $handler->display->display_options['filters']['status']['expose']['identifier'] = 'status';
+  $handler->display->display_options['filters']['status']['expose']['required'] = TRUE;
+  $handler->display->display_options['filters']['status']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+    3 => 0,
+    4 => 0,
+  );
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'group' => 'group',
+  );
+  $handler->display->display_options['path'] = 'admin/content/groups/proposed';
+  $handler->display->display_options['menu']['type'] = 'default tab';
+  $handler->display->display_options['menu']['title'] = 'Proposed Groups';
+  $handler->display->display_options['menu']['description'] = 'Proposed Group Moderation';
+  $handler->display->display_options['menu']['weight'] = '0';
+  $handler->display->display_options['menu']['context'] = 0;
+  $handler->display->display_options['tab_options']['type'] = 'tab';
+  $handler->display->display_options['tab_options']['title'] = 'Groups';
+  $handler->display->display_options['tab_options']['description'] = 'Groups Moderation';
+  $handler->display->display_options['tab_options']['weight'] = '0';
+
+  /* Display: Published Groups */
+  $handler = $view->new_display('page', 'Published Groups', 'page_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['defaults']['filter_groups'] = FALSE;
+  $handler->display->display_options['defaults']['filters'] = FALSE;
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator_id'] = '';
+  $handler->display->display_options['filters']['status']['expose']['label'] = 'Active';
+  $handler->display->display_options['filters']['status']['expose']['operator'] = 'status_op';
+  $handler->display->display_options['filters']['status']['expose']['identifier'] = 'status';
+  $handler->display->display_options['filters']['status']['expose']['required'] = TRUE;
+  $handler->display->display_options['filters']['status']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+    3 => 0,
+    4 => 0,
+  );
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'group' => 'group',
+  );
+  $handler->display->display_options['path'] = 'admin/content/groups/published';
+  $handler->display->display_options['menu']['type'] = 'tab';
+  $handler->display->display_options['menu']['title'] = 'Published';
+  $handler->display->display_options['menu']['description'] = 'Manage Published Groups';
+  $handler->display->display_options['menu']['weight'] = '0';
+  $handler->display->display_options['menu']['context'] = 0;
+
+  /* Display: Group Update */
+  $handler = $view->new_display('page', 'Group Update', 'page_2');
+  $handler->display->display_options['defaults']['use_ajax'] = FALSE;
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['defaults']['empty'] = FALSE;
+  /* No results behavior: Global: Unfiltered text */
+  $handler->display->display_options['empty']['area_text_custom']['id'] = 'area_text_custom';
+  $handler->display->display_options['empty']['area_text_custom']['table'] = 'views';
+  $handler->display->display_options['empty']['area_text_custom']['field'] = 'area_text_custom';
+  $handler->display->display_options['empty']['area_text_custom']['label'] = 'No Results Toggle';
+  $handler->display->display_options['empty']['area_text_custom']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area_text_custom']['content'] = 'All groups are updated. <a class="use-ajax" href="update/toggle">Remove group update message</a>';
+  $handler->display->display_options['defaults']['fields'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = 'User';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: Content: Updated date */
+  $handler->display->display_options['fields']['changed']['id'] = 'changed';
+  $handler->display->display_options['fields']['changed']['table'] = 'node';
+  $handler->display->display_options['fields']['changed']['field'] = 'changed';
+  $handler->display->display_options['fields']['changed']['label'] = 'Updated';
+  $handler->display->display_options['fields']['changed']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['changed']['date_format'] = 'short';
+  /* Field: Content: Edit link */
+  $handler->display->display_options['fields']['edit_node']['id'] = 'edit_node';
+  $handler->display->display_options['fields']['edit_node']['table'] = 'views_entity_node';
+  $handler->display->display_options['fields']['edit_node']['field'] = 'edit_node';
+  $handler->display->display_options['fields']['edit_node']['label'] = 'Operations';
+  $handler->display->display_options['fields']['edit_node']['element_label_colon'] = FALSE;
+  /* Field: Content: Delete link */
+  $handler->display->display_options['fields']['delete_node']['id'] = 'delete_node';
+  $handler->display->display_options['fields']['delete_node']['table'] = 'views_entity_node';
+  $handler->display->display_options['fields']['delete_node']['field'] = 'delete_node';
+  $handler->display->display_options['fields']['delete_node']['label'] = '';
+  $handler->display->display_options['fields']['delete_node']['element_label_colon'] = FALSE;
+  $handler->display->display_options['defaults']['filter_groups'] = FALSE;
+  $handler->display->display_options['defaults']['filters'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'group' => 'group',
+  );
+  /* Filter criterion: Content: Privacy settings (field_og_subscribe_settings) */
+  $handler->display->display_options['filters']['field_og_subscribe_settings_value']['id'] = 'field_og_subscribe_settings_value';
+  $handler->display->display_options['filters']['field_og_subscribe_settings_value']['table'] = 'field_data_field_og_subscribe_settings';
+  $handler->display->display_options['filters']['field_og_subscribe_settings_value']['field'] = 'field_og_subscribe_settings_value';
+  $handler->display->display_options['filters']['field_og_subscribe_settings_value']['operator'] = 'empty';
+  $handler->display->display_options['path'] = 'admin/content/groups/update';
+  $handler->display->display_options['menu']['title'] = 'Needs Update';
+  $handler->display->display_options['menu']['weight'] = '10';
+  $handler->display->display_options['menu']['context'] = 0;
+  $handler->display->display_options['menu']['context_only_inline'] = 0;
+  $translatables['commons_group_moderation'] = array(
+    t('Master'),
+    t('Commons Group Moderation'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('author'),
+    t('Update Actions'),
+    t('Title'),
+    t('User'),
+    t('Updated'),
+    t('Operations'),
+    t('Active'),
+    t('Proposed'),
+    t('Published Groups'),
+  );
+  $export['commons_group_moderation'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_groups_contributors';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'users';
+  $view->human_name = 'Commons Contributors - Sitewide';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Contributors';
+  $handler->display->display_options['use_more'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'access user profiles';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['distinct'] = TRUE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '16';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'grid';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: OG membership: OG membership from User */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'users';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50';
+  /* Sort criterion: User: Created date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'users';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Filter criterion: User: Active */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'users';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: OG membership: State */
+  $handler->display->display_options['filters']['state']['id'] = 'state';
+  $handler->display->display_options['filters']['state']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['state']['field'] = 'state';
+  $handler->display->display_options['filters']['state']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['state']['value'] = array(
+    1 => '1',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_title'] = 'Contributors (Site-wide)';
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $translatables['commons_groups_contributors'] = array(
+    t('Master'),
+    t('Contributors'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('OG membership from user'),
+    t('Content pane'),
+    t('Contributors (Site-wide)'),
+    t('Commons'),
+  );
+  $export['commons_groups_contributors'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_groups_directory';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'commons_groups_directory';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Groups';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  $handler->display->display_options['row_options']['links'] = FALSE;
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No groups matched the text you entered.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Field: Group (group_group) */
+  $handler->display->display_options['filters']['group_group_value']['id'] = 'group_group_value';
+  $handler->display->display_options['filters']['group_group_value']['table'] = 'field_data_group_group';
+  $handler->display->display_options['filters']['group_group_value']['field'] = 'group_group_value';
+  $handler->display->display_options['filters']['group_group_value']['value'] = array(
+    1 => '1',
+  );
+  /* Filter criterion: Search: Search Terms */
+  $handler->display->display_options['filters']['keys']['id'] = 'keys';
+  $handler->display->display_options['filters']['keys']['table'] = 'search_index';
+  $handler->display->display_options['filters']['keys']['field'] = 'keys';
+  $handler->display->display_options['filters']['keys']['exposed'] = TRUE;
+  $handler->display->display_options['filters']['keys']['expose']['operator_id'] = 'keys_op';
+  $handler->display->display_options['filters']['keys']['expose']['label'] = 'Limit to';
+  $handler->display->display_options['filters']['keys']['expose']['operator'] = 'keys_op';
+  $handler->display->display_options['filters']['keys']['expose']['identifier'] = 'groups-keys';
+  $handler->display->display_options['filters']['keys']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+  );
+
+  /* Display: Feed */
+  $handler = $view->new_display('feed', 'Feed', 'feed');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['style_plugin'] = 'rss';
+  $handler->display->display_options['row_plugin'] = 'node_rss';
+  $handler->display->display_options['path'] = 'commons-groups-directory.xml';
+  $handler->display->display_options['displays'] = array(
+    'default' => 'default',
+    'page' => 'page',
+  );
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['inherit_panels_path'] = '1';
+  $translatables['commons_groups_directory'] = array(
+    t('Master'),
+    t('Groups'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No groups matched the text you entered.'),
+    t('Limit to'),
+    t('Feed'),
+    t('Content pane'),
+    t('Commons'),
+  );
+  $export['commons_groups_directory'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_groups_recent_content';
+  $view->description = 'Shows titles of the 5 most recent pieces of content in a group.';
+  $view->tag = 'Commons';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Groups: Recent group content';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Commons Groups: Recent content';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '5';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Type */
+  $handler->display->display_options['fields']['type']['id'] = 'type';
+  $handler->display->display_options['fields']['type']['table'] = 'node';
+  $handler->display->display_options['fields']['type']['field'] = 'type';
+  $handler->display->display_options['fields']['type']['label'] = '';
+  $handler->display->display_options['fields']['type']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['type']['element_label_colon'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  $handler->display->display_options['fields']['title']['element_class'] = 'type-[type]';
+  $handler->display->display_options['fields']['title']['element_label_colon'] = FALSE;
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_action'] = 'not found';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+
+  /* Display: Block */
+  $handler = $view->new_display('block', 'Block', 'block');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $translatables['commons_groups_recent_content'] = array(
+    t('Master'),
+    t('Commons Groups: Recent content'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('OG membership from node'),
+    t('All'),
+    t('Block'),
+  );
+  $export['commons_groups_recent_content'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_groups_user_groups';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'og_membership';
+  $view->human_name = 'Commons Groups: Groups that a user contributes to';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '3';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: OG membership: Group Node from OG membership */
+  $handler->display->display_options['relationships']['og_membership_related_node_group']['id'] = 'og_membership_related_node_group';
+  $handler->display->display_options['relationships']['og_membership_related_node_group']['table'] = 'og_membership';
+  $handler->display->display_options['relationships']['og_membership_related_node_group']['field'] = 'og_membership_related_node_group';
+  $handler->display->display_options['relationships']['og_membership_related_node_group']['required'] = TRUE;
+  /* Field: Content: Group Logo */
+  $handler->display->display_options['fields']['field_group_logo']['id'] = 'field_group_logo';
+  $handler->display->display_options['fields']['field_group_logo']['table'] = 'field_data_field_group_logo';
+  $handler->display->display_options['fields']['field_group_logo']['field'] = 'field_group_logo';
+  $handler->display->display_options['fields']['field_group_logo']['relationship'] = 'og_membership_related_node_group';
+  $handler->display->display_options['fields']['field_group_logo']['label'] = '';
+  $handler->display->display_options['fields']['field_group_logo']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_group_logo']['click_sort_column'] = 'fid';
+  $handler->display->display_options['fields']['field_group_logo']['settings'] = array(
+    'image_style' => 'thumbnail',
+    'image_link' => 'content',
+  );
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['relationship'] = 'og_membership_related_node_group';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['element_label_colon'] = FALSE;
+  /* Field: Field: Group */
+  $handler->display->display_options['fields']['group_group']['id'] = 'group_group';
+  $handler->display->display_options['fields']['group_group']['table'] = 'field_data_group_group';
+  $handler->display->display_options['fields']['group_group']['field'] = 'group_group';
+  $handler->display->display_options['fields']['group_group']['relationship'] = 'og_membership_related_node_group';
+  $handler->display->display_options['fields']['group_group']['label'] = '';
+  $handler->display->display_options['fields']['group_group']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['group_group']['type'] = 'commons_groups_group_subscribe';
+  $handler->display->display_options['fields']['group_group']['settings'] = array(
+    'field_name' => '0',
+  );
+  /* Contextual filter: OG membership: Entity id */
+  $handler->display->display_options['arguments']['etid']['id'] = 'etid';
+  $handler->display->display_options['arguments']['etid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['etid']['field'] = 'etid';
+  $handler->display->display_options['arguments']['etid']['default_action'] = 'not found';
+  $handler->display->display_options['arguments']['etid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['etid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['etid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['etid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: OG membership: Entity_type */
+  $handler->display->display_options['filters']['entity_type']['id'] = 'entity_type';
+  $handler->display->display_options['filters']['entity_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['entity_type']['field'] = 'entity_type';
+  $handler->display->display_options['filters']['entity_type']['value'] = 'user';
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['argument_input'] = array(
+    'etid' => array(
+      'type' => 'context',
+      'context' => 'user_edit_form.uid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'OG membership: Entity id',
+    ),
+  );
+  $translatables['commons_groups_user_groups'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('Group node from OG membership'),
+    t('All'),
+    t('Content pane'),
+    t('View panes'),
+  );
+  $export['commons_groups_user_groups'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_groups/css/commons_groups.css b/modules/commons/commons_groups/css/commons_groups.css
new file mode 100644
index 0000000..db04154
--- /dev/null
+++ b/modules/commons/commons_groups/css/commons_groups.css
@@ -0,0 +1 @@
+#edit-field-og-access-default-value { margin-left: 20px; }
diff --git a/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.features.inc b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.features.inc
new file mode 100644
index 0000000..41a3f22
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.features.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * commons_groups_directory.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_groups_directory_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_groups_directory_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.info b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.info
new file mode 100644
index 0000000..5bb77a3
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.info
@@ -0,0 +1,13 @@
+name = Commons Groups Directory
+description = The site-wide directory of groups
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_activity_streams_groups
+dependencies[] = commons_radioactivity_groups
+dependencies[] = ctools
+dependencies[] = page_manager
+dependencies[] = views_content
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[page_manager_pages][] = groups_directory
diff --git a/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.module b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.module
new file mode 100644
index 0000000..4b691f5
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.module
@@ -0,0 +1,8 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Group Directory feature.
+ */
+
+include_once 'commons_groups_directory.features.inc';
+
diff --git a/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.pages_default.inc b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.pages_default.inc
new file mode 100644
index 0000000..549e242
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_directory/commons_groups_directory.pages_default.inc
@@ -0,0 +1,148 @@
+<?php
+/**
+ * @file
+ * commons_groups_directory.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_pages().
+ */
+function commons_groups_directory_default_page_manager_pages() {
+  $page = new stdClass();
+  $page->disabled = FALSE; /* Edit this to true to make a default page disabled initially */
+  $page->api_version = 1;
+  $page->name = 'groups_directory';
+  $page->task = 'page';
+  $page->admin_title = 'Groups Directory';
+  $page->admin_description = 'A directory of groups.';
+  $page->path = 'groups';
+  $page->access = array(
+    'type' => 'none',
+    'settings' => NULL,
+  );
+  $page->menu = array(
+    'type' => 'normal',
+    'title' => 'Groups',
+    'name' => 'main-menu',
+    'weight' => '-1',
+    'parent' => array(
+      'type' => 'none',
+      'title' => '',
+      'name' => 'navigation',
+      'weight' => '-1',
+    ),
+  );
+  $page->arguments = array();
+  $page->conf = array(
+    'admin_paths' => FALSE,
+  );
+  $page->default_handlers = array();
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'page_groups_directory_panel_context';
+  $handler->task = 'page';
+  $handler->subtask = 'groups_directory';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'Panel',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'top' => NULL,
+      'left' => NULL,
+      'right' => NULL,
+      'bottom' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = 'Groups';
+  $display->uuid = 'b342a293-2541-cc64-1577-839054c92368';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-bf6c6f1b-08a6-3874-7186-c955c763c092';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_groups_directory-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'bf6c6f1b-08a6-3874-7186-c955c763c092';
+    $display->content['new-bf6c6f1b-08a6-3874-7186-c955c763c092'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-bf6c6f1b-08a6-3874-7186-c955c763c092';
+    $pane = new stdClass();
+    $pane->pid = 'new-ab237aa5-5ae7-8fb4-e1ce-20c776a6950b';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_radioactivity_groups_most_active-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'ab237aa5-5ae7-8fb4-e1ce-20c776a6950b';
+    $display->content['new-ab237aa5-5ae7-8fb4-e1ce-20c776a6950b'] = $pane;
+    $display->panels['two_66_33_second'][0] = 'new-ab237aa5-5ae7-8fb4-e1ce-20c776a6950b';
+    $pane = new stdClass();
+    $pane->pid = 'new-3db36521-fb53-58a4-c9e2-137a2dacee07';
+    $pane->panel = 'two_66_33_top';
+    $pane->type = 'block';
+    $pane->subtype = 'commons_groups-commons_groups_create_group';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '3db36521-fb53-58a4-c9e2-137a2dacee07';
+    $display->content['new-3db36521-fb53-58a4-c9e2-137a2dacee07'] = $pane;
+    $display->panels['two_66_33_top'][0] = 'new-3db36521-fb53-58a4-c9e2-137a2dacee07';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = 'new-bf6c6f1b-08a6-3874-7186-c955c763c092';
+  $handler->conf['display'] = $display;
+  $page->default_handlers[$handler->name] = $handler;
+  $pages['groups_directory'] = $page;
+
+  return $pages;
+
+}
diff --git a/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.features.inc b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.features.inc
new file mode 100644
index 0000000..4d103b2
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.features.inc
@@ -0,0 +1,17 @@
+<?php
+/**
+ * @file
+ * commons_groups_pages.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_groups_pages_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "panelizer" && $api == "panelizer") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.info b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.info
new file mode 100644
index 0000000..fdcc25f
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.info
@@ -0,0 +1,17 @@
+name = Commons Group Homepages
+description = Provides a default home page for groups
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_activity_streams
+dependencies[] = commons_bw
+dependencies[] = commons_follow_group
+dependencies[] = commons_radioactivity_groups
+dependencies[] = ctools
+dependencies[] = panelizer
+dependencies[] = strongarm
+features[ctools][] = panelizer:panelizer:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[panelizer_defaults][] = node:group:default
+features[panelizer_defaults][] = node:group:default:teaser
+features[variable][] = panelizer_defaults_node_group
diff --git a/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.install b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.install
new file mode 100644
index 0000000..73dd290
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.install
@@ -0,0 +1,22 @@
+<?php
+
+/**
+* Implements hook_enable().
+*/
+function commons_groups_pages_enable() {
+  // We need Page Manager to respond to the node view menu callback.
+  // Since all Panelized moduels need this variable set, we use variable_set
+  // rather than exporting via Strongarm in order to avoid Features conflicts.
+  variable_set('page_manager_node_view_disabled', FALSE);
+}
+
+/**
+ * Updating one_main panel per http://drupal.org/node/1948224.
+ */
+function commons_groups_pages_update_3101() {
+  $revert = array(
+    'commons_groups' => array('panelizer_defaults'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.module b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.module
new file mode 100644
index 0000000..defdc24
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.module
@@ -0,0 +1,56 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Group Homepages feature.
+ */
+
+include_once 'commons_groups_pages.features.inc';
+
+/**
+ * Implements hook_system_info_alter().
+ */
+function commons_groups_pages_system_info_alter(&$info, $file, $type) {
+  // Commons Groups dynamically adds the og_group_ref field to
+  // content types that request it by altering the
+  // commons_groups_entity_types variable.
+  // We must add a corresponding line for each field instance
+  // to commons_groups.info so that Features is aware of the instance
+  // and can successfully revert the field_instance component back
+  // to its default state.
+  if ($file->name == 'commons_groups_pages') {
+    $group_bundles = og_get_all_group_bundle();
+    if (!empty($group_bundles['node'])) {
+      foreach ($group_bundles['node'] as $bundle => $name) {
+        // These field instances should be added to groups regardless of
+        // whether og_access.module is enabled.
+        $info['features']['panelizer_defaults'][] = "node:$bundle:default";
+        $info['features']['panelizer_defaults'][] = "node:$bundle:default:teaser";
+        $info['features']['variable'][] = "panelizer_defaults_node_$bundle";
+      }
+    }
+  }
+}
+
+/*
+ * Implements hook_features_pipe_alter().
+ */
+function commons_groups_pages_features_pipe_alter(&$pipe, $data, $export) {
+  // Prevent Commons Groups related fields from being piped in features
+  // when a content type includes those fields.
+  if (!empty($pipe['panelizer_defaults'])) {
+
+    foreach ($pipe['panelizer_defaults'] as $delta => $value) {
+      $args = explode(':', $value);
+      $group_name = $args[1];
+
+      $group_bundles = og_get_all_group_bundle();
+      if (isset($group_bundles['node']) && isset($group_bundles['node']['group'])) {
+        unset($group_bundles['node']['group']);
+      }
+      $excluded_groups = array_keys($group_bundles);
+      if (in_array($group_name, $excluded_groups)) {
+        unset($pipe['field_instance'][$delta]);
+      }
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.panelizer.inc b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.panelizer.inc
new file mode 100644
index 0000000..0431bfb
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.panelizer.inc
@@ -0,0 +1,456 @@
+<?php
+/**
+ * @file
+ * commons_groups_pages.panelizer.inc
+ */
+
+/**
+ * Implements hook_panelizer_defaults().
+ */
+function commons_groups_pages_panelizer_defaults() {
+  $export = array();
+
+  $group_bundles = og_get_all_group_bundle();
+  if (!empty($group_bundles['node'])) {
+    foreach ($group_bundles['node'] as $bundle => $name) {
+      $panelizer = new stdClass();
+      $panelizer->disabled = FALSE; /* Edit this to true to make a default panelizer disabled initially */
+      $panelizer->api_version = 1;
+      $panelizer->name = "node:$bundle:default";
+      $panelizer->title = 'Default';
+      $panelizer->panelizer_type = 'node';
+      $panelizer->panelizer_key = $bundle;
+      $panelizer->no_blocks = FALSE;
+      $panelizer->css_id = '';
+      $panelizer->css = '';
+      $panelizer->pipeline = 'ipe';
+      $panelizer->contexts = array();
+      $panelizer->relationships = array();
+      $panelizer->access = array();
+      $panelizer->view_mode = 'page_manager';
+      $panelizer->css_class = '';
+      $panelizer->title_element = 'H2';
+      $panelizer->link_to_entity = TRUE;
+      $panelizer->extra = '';
+      $display = new panels_display();
+      $display->layout = 'two_66_33';
+      $display->layout_settings = array();
+      $display->panel_settings = array(
+        'style_settings' => array(
+          'default' => NULL,
+          'top' => NULL,
+          'left' => NULL,
+          'right' => NULL,
+          'bottom' => NULL,
+          'two_66_33_top' => NULL,
+          'two_66_33_first' => NULL,
+          'two_66_33_second' => NULL,
+          'two_66_33_bottom' => NULL,
+        ),
+      );
+      $display->cache = array();
+      $display->title = '%node:title';
+      $display->uuid = '819deb2a-c56c-2214-558d-c52460a89778';
+      $display->content = array();
+      $display->panels = array();
+      $pane = new stdClass();
+      $pane->pid = 'new-10f12c5b-679e-d294-b1bd-9aac845800f5';
+      $pane->panel = 'two_66_33_first';
+      $pane->type = 'node_content';
+      $pane->subtype = 'node_content';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'links' => 1,
+        'no_extras' => 0,
+        'override_title' => 1,
+        'override_title_text' => '',
+        'identifier' => '',
+        'link' => 0,
+        'leave_node_title' => 0,
+        'build_mode' => 'full',
+        'context' => 'panelizer',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 0;
+      $pane->locks = array();
+      $pane->uuid = '10f12c5b-679e-d294-b1bd-9aac845800f5';
+      $display->content['new-10f12c5b-679e-d294-b1bd-9aac845800f5'] = $pane;
+      $display->panels['two_66_33_first'][0] = 'new-10f12c5b-679e-d294-b1bd-9aac845800f5';
+      $pane = new stdClass();
+      $pane->pid = 'new-80b62348-7cee-e304-5d65-0ce1b6bbb216';
+      $pane->panel = 'two_66_33_first';
+      $pane->type = 'commons_bw_group';
+      $pane->subtype = 'commons_bw_group';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'override_title' => 0,
+        'override_title_text' => '',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 1;
+      $pane->locks = array();
+      $pane->uuid = '80b62348-7cee-e304-5d65-0ce1b6bbb216';
+      $display->content['new-80b62348-7cee-e304-5d65-0ce1b6bbb216'] = $pane;
+      $display->panels['two_66_33_first'][1] = 'new-80b62348-7cee-e304-5d65-0ce1b6bbb216';
+      $pane = new stdClass();
+      $pane->pid = 'new-13120946-03a1-bfc4-2d74-f39dd758ebce';
+      $pane->panel = 'two_66_33_second';
+      $pane->type = 'views_panes';
+      $pane->subtype = 'commons_events_upcoming-panel_pane_1';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'context' => array(
+          0 => 'panelizer',
+        ),
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 0;
+      $pane->locks = array();
+      $pane->uuid = '13120946-03a1-bfc4-2d74-f39dd758ebce';
+      $display->content['new-13120946-03a1-bfc4-2d74-f39dd758ebce'] = $pane;
+      $display->panels['two_66_33_second'][0] = 'new-13120946-03a1-bfc4-2d74-f39dd758ebce';
+      $pane = new stdClass();
+      $pane->pid = 'new-a7009535-0e2a-2c94-edd2-4ecc953c4ca2';
+      $pane->panel = 'two_66_33_second';
+      $pane->type = 'views_panes';
+      $pane->subtype = 'activity_group-panel_pane_1';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'items_per_page' => '4',
+        'arguments' => array(
+          'gid' => '%node:nid',
+        ),
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 1;
+      $pane->locks = array();
+      $pane->uuid = 'a7009535-0e2a-2c94-edd2-4ecc953c4ca2';
+      $display->content['new-a7009535-0e2a-2c94-edd2-4ecc953c4ca2'] = $pane;
+      $display->panels['two_66_33_second'][1] = 'new-a7009535-0e2a-2c94-edd2-4ecc953c4ca2';
+      $pane = new stdClass();
+      $pane->pid = 'new-ba735f2b-4734-7724-098d-1925c6a4bb47';
+      $pane->panel = 'two_66_33_second';
+      $pane->type = 'views_panes';
+      $pane->subtype = 'commons_radioactivity_groups_active_in_group-panel_pane_1';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'arguments' => array(
+          'gid' => '%node:nid',
+        ),
+        'context' => array(
+          0 => 'panelizer',
+        ),
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 2;
+      $pane->locks = array();
+      $pane->uuid = 'ba735f2b-4734-7724-098d-1925c6a4bb47';
+      $display->content['new-ba735f2b-4734-7724-098d-1925c6a4bb47'] = $pane;
+      $display->panels['two_66_33_second'][2] = 'new-ba735f2b-4734-7724-098d-1925c6a4bb47';
+      $pane = new stdClass();
+      $pane->pid = 'new-52796f83-93dd-2cf4-41aa-33520dc31e5f';
+      $pane->panel = 'two_66_33_second';
+      $pane->type = 'views_panes';
+      $pane->subtype = 'commons_contributors_group-panel_pane_2';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'context' => array(
+          0 => 'panelizer',
+        ),
+      );
+      $pane->cache = array(
+        'method' => 'simple',
+        'settings' => array(
+          'lifetime' => '15',
+          'granularity' => 'context',
+        ),
+      );
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 3;
+      $pane->locks = array();
+      $pane->uuid = '52796f83-93dd-2cf4-41aa-33520dc31e5f';
+      $display->content['new-52796f83-93dd-2cf4-41aa-33520dc31e5f'] = $pane;
+      $display->panels['two_66_33_second'][3] = 'new-52796f83-93dd-2cf4-41aa-33520dc31e5f';
+      $display->hide_title = PANELS_TITLE_FIXED;
+      $display->title_pane = '0';
+      $panelizer->display = $display;
+      $export["node:$bundle:default"] = $panelizer;
+
+      $panelizer = new stdClass();
+      $panelizer->disabled = FALSE; /* Edit this to true to make a default panelizer disabled initially */
+      $panelizer->api_version = 1;
+      $panelizer->name = "node:$bundle:default:teaser";
+      $panelizer->title = 'Default';
+      $panelizer->panelizer_type = 'node';
+      $panelizer->panelizer_key = "$bundle";
+      $panelizer->no_blocks = FALSE;
+      $panelizer->css_id = '';
+      $panelizer->css = '';
+      $panelizer->pipeline = 'standard';
+      $panelizer->contexts = array();
+      $panelizer->relationships = array();
+      $panelizer->access = array();
+      $panelizer->view_mode = 'teaser';
+      $panelizer->css_class = '';
+      $panelizer->title_element = 'H2';
+      $panelizer->link_to_entity = TRUE;
+      $panelizer->extra = array();
+      $display = new panels_display();
+      $display->layout = 'one';
+      $display->layout_settings = array();
+      $display->panel_settings = array(
+        'style_settings' => array(
+          'default' => NULL,
+          'one_main' => NULL,
+        ),
+      );
+      $display->cache = array();
+      $display->title = '%node:title';
+      $display->uuid = '2880dc3a-9be6-dc34-a563-b9748d152f92';
+      $display->content = array();
+      $display->panels = array();
+      $pane = new stdClass();
+      $pane->pid = 'new-026f9d2d-fd0e-d794-1971-47eb628a7f6e';
+      $pane->panel = 'one_main';
+      $pane->type = 'entity_field';
+      $pane->subtype = 'node:group_group';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'label' => 'hidden',
+        'formatter' => 'commons_groups_group_subscribe',
+        'delta_limit' => 0,
+        'delta_offset' => '0',
+        'delta_reversed' => FALSE,
+        'formatter_settings' => array(),
+        'context' => 'panelizer',
+        'override_title' => 0,
+        'override_title_text' => '',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 0;
+      $pane->locks = array();
+      $pane->uuid = '026f9d2d-fd0e-d794-1971-47eb628a7f6e';
+      $display->content['new-026f9d2d-fd0e-d794-1971-47eb628a7f6e'] = $pane;
+      $display->panels['one_main'][0] = 'new-026f9d2d-fd0e-d794-1971-47eb628a7f6e';
+      $pane = new stdClass();
+      $pane->pid = 'new-13859111-e3fa-5e54-a93c-57f09d719e38';
+      $pane->panel = 'one_main';
+      $pane->type = 'token';
+      $pane->subtype = 'node:commons-groups-group-contributors-count-topics';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'sanitize' => 0,
+        'context' => 'panelizer',
+        'override_title' => 0,
+        'override_title_text' => '',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 1;
+      $pane->locks = array();
+      $pane->uuid = '13859111-e3fa-5e54-a93c-57f09d719e38';
+      $display->content['new-13859111-e3fa-5e54-a93c-57f09d719e38'] = $pane;
+      $display->panels['one_main'][1] = 'new-13859111-e3fa-5e54-a93c-57f09d719e38';
+      $pane = new stdClass();
+      $pane->pid = 'new-f7a3719c-d7be-f024-ed91-c8c0df943df4';
+      $pane->panel = 'one_main';
+      $pane->type = 'token';
+      $pane->subtype = 'node:flag-commons-follow-group-link';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'sanitize' => 0,
+        'context' => 'panelizer',
+        'override_title' => 1,
+        'override_title_text' => '',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 2;
+      $pane->locks = array();
+      $pane->uuid = 'f7a3719c-d7be-f024-ed91-c8c0df943df4';
+      $display->content['new-f7a3719c-d7be-f024-ed91-c8c0df943df4'] = $pane;
+      $display->panels['one_main'][2] = 'new-f7a3719c-d7be-f024-ed91-c8c0df943df4';
+      $pane = new stdClass();
+      $pane->pid = 'new-926a99b3-8e75-aa14-2542-16f2ab9e70b3';
+      $pane->panel = 'one_main';
+      $pane->type = 'entity_field';
+      $pane->subtype = 'node:field_group_logo';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'label' => 'hidden',
+        'formatter' => 'image',
+        'delta_limit' => 0,
+        'delta_offset' => '0',
+        'delta_reversed' => FALSE,
+        'formatter_settings' => array(
+          'image_style' => '50x50',
+          'image_link' => 'content',
+        ),
+        'context' => 'panelizer',
+        'override_title' => 0,
+        'override_title_text' => '',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 3;
+      $pane->locks = array();
+      $pane->uuid = '926a99b3-8e75-aa14-2542-16f2ab9e70b3';
+      $display->content['new-926a99b3-8e75-aa14-2542-16f2ab9e70b3'] = $pane;
+      $display->panels['one_main'][3] = 'new-926a99b3-8e75-aa14-2542-16f2ab9e70b3';
+      $pane = new stdClass();
+      $pane->pid = 'new-c22911c5-3c21-75b4-c5f3-80efb733956b';
+      $pane->panel = 'one_main';
+      $pane->type = 'entity_field';
+      $pane->subtype = 'node:body';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'label' => 'hidden',
+        'formatter' => 'text_summary_or_trimmed',
+        'delta_limit' => 0,
+        'delta_offset' => '0',
+        'delta_reversed' => FALSE,
+        'formatter_settings' => array(
+          'trim_length' => '600',
+        ),
+        'context' => 'panelizer',
+        'override_title' => 0,
+        'override_title_text' => 'Por que no se ve?',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 4;
+      $pane->locks = array();
+      $pane->uuid = 'c22911c5-3c21-75b4-c5f3-80efb733956b';
+      $display->content['new-c22911c5-3c21-75b4-c5f3-80efb733956b'] = $pane;
+      $display->panels['one_main'][4] = 'new-c22911c5-3c21-75b4-c5f3-80efb733956b';
+      $pane = new stdClass();
+      $pane->pid = 'new-cb706c02-36e8-a414-c9f5-c34bf15861ca';
+      $pane->panel = 'one_main';
+      $pane->type = 'views';
+      $pane->subtype = 'commons_groups_recent_content';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'override_pager_settings' => 0,
+        'use_pager' => 0,
+        'nodes_per_page' => '5',
+        'pager_id' => '0',
+        'offset' => '0',
+        'more_link' => 0,
+        'feed_icons' => 0,
+        'panel_args' => 0,
+        'link_to_view' => 0,
+        'args' => '',
+        'url' => '',
+        'display' => 'block',
+        'context' => array(
+          0 => 'panelizer.nid',
+        ),
+        'override_title' => 1,
+        'override_title_text' => 'Recent content',
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 5;
+      $pane->locks = array();
+      $pane->uuid = 'cb706c02-36e8-a414-c9f5-c34bf15861ca';
+      $display->content['new-cb706c02-36e8-a414-c9f5-c34bf15861ca'] = $pane;
+      $display->panels['one_main'][5] = 'new-cb706c02-36e8-a414-c9f5-c34bf15861ca';
+      $pane = new stdClass();
+      $pane->pid = 'new-6c3207ac-19f3-8184-11ba-e3aee789a9c8';
+      $pane->panel = 'one_main';
+      $pane->type = 'views_panes';
+      $pane->subtype = 'commons_contributors_group-panel_pane_1';
+      $pane->shown = TRUE;
+      $pane->access = array();
+      $pane->configuration = array(
+        'context' => array(
+          0 => 'panelizer',
+        ),
+      );
+      $pane->cache = array();
+      $pane->style = array(
+        'settings' => NULL,
+      );
+      $pane->css = array();
+      $pane->extras = array();
+      $pane->position = 6;
+      $pane->locks = array();
+      $pane->uuid = '6c3207ac-19f3-8184-11ba-e3aee789a9c8';
+      $display->content['new-6c3207ac-19f3-8184-11ba-e3aee789a9c8'] = $pane;
+      $display->panels['one_main'][6] = 'new-6c3207ac-19f3-8184-11ba-e3aee789a9c8';
+      $display->hide_title = PANELS_TITLE_FIXED;
+      $display->title_pane = '0';
+      $panelizer->display = $display;
+      $export["node:$bundle:default:teaser"] = $panelizer;
+    }
+  }
+
+
+  return $export;
+}
diff --git a/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.strongarm.inc b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.strongarm.inc
new file mode 100644
index 0000000..8de19ca
--- /dev/null
+++ b/modules/commons/commons_groups/modules/commons_groups_pages/commons_groups_pages.strongarm.inc
@@ -0,0 +1,46 @@
+<?php
+/**
+ * @file
+ * commons_groups_pages.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_groups_pages_strongarm() {
+  $export = array();
+
+  $group_bundles = og_get_all_group_bundle();
+  if (!empty($group_bundles['node'])) {
+    // Don't alter the group panel.
+    foreach ($group_bundles['node'] as $bundle => $name) {
+      $strongarm = new stdClass();
+      $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+      $strongarm->api_version = 1;
+      $strongarm->name = "panelizer_defaults_node_$bundle";
+      $strongarm->value = array(
+        'status' => 1,
+        'view modes' => array(
+          'page_manager' => array(
+            'status' => 1,
+            'default' => 1,
+            'choice' => 0,
+          ),
+          'default' => array(
+            'status' => 0,
+            'default' => 0,
+            'choice' => 0,
+          ),
+          'teaser' => array(
+            'status' => 1,
+            'default' => 1,
+            'choice' => 0,
+          ),
+        ),
+      );
+      $export["panelizer_defaults_node_$bundle"] = $strongarm;
+    }
+  }
+
+  return $export;
+}
diff --git a/modules/commons/commons_groups/plugins/entityreference/selection/OgCommonsSelectionHandler.class.php b/modules/commons/commons_groups/plugins/entityreference/selection/OgCommonsSelectionHandler.class.php
new file mode 100644
index 0000000..05dfcf4
--- /dev/null
+++ b/modules/commons/commons_groups/plugins/entityreference/selection/OgCommonsSelectionHandler.class.php
@@ -0,0 +1,83 @@
+<?php
+
+/**
+ * @file
+ * OG Commons groups selection handler.
+ */
+
+class OgCommonsSelectionHandler extends OgSelectionHandler {
+
+  public static function getInstance($field, $instance = NULL, $entity_type = NULL, $entity = NULL) {
+    return new self($field, $instance, $entity_type, $entity);
+  }
+
+  /**
+   * Overrides OgSelectionHandler::buildEntityFieldQuery().
+   */
+  public function buildEntityFieldQuery($match = NULL, $match_operator = 'CONTAINS') {
+    $group_type = $this->field['settings']['target_type'];
+
+    if (empty($this->instance['field_mode']) || $group_type != 'node' || user_is_anonymous()) {
+      return parent::buildEntityFieldQuery($match, $match_operator);
+    }
+
+    $handler = EntityReference_SelectionHandler_Generic::getInstance($this->field, $this->instance, $this->entity_type, $this->entity);
+    $query = $handler->buildEntityFieldQuery($match, $match_operator);
+
+    // Show only the entities that are active groups.
+    $query->fieldCondition(OG_GROUP_FIELD, 'value', 1);
+    $query->fieldCondition('field_og_subscribe_settings', 'value', 'anyone');
+
+    // Add this property to make sure we will have the {node} table later on in
+    // OgCommonsSelectionHandler::entityFieldQueryAlter().
+    $query->propertyCondition('nid', 0, '>');
+
+    $query->addMetaData('entityreference_selection_handler', $this);
+
+    // FIXME: http://drupal.org/node/1325628
+    unset($query->tags['node_access']);
+
+    $query->addTag('entity_field_access');
+    $query->addTag('og');
+
+    return $query;
+  }
+
+  /**
+   * Overrides OgSelectionHandler::entityFieldQueryAlter().
+   *
+   * Add the user's groups along with the rest of the "public" groups.
+   */
+  public function entityFieldQueryAlter(SelectQueryInterface $query) {
+    $gids = og_get_entity_groups();
+    if (empty($gids['node'])) {
+      return;
+    }
+
+    $conditions = &$query->conditions();
+    // Find the condition for the "field_data_field_privacy_settings" query, and
+    // the one for the "node.nid", so we can later db_or() them.
+    $public_condition = array();
+    foreach ($conditions as $key => $condition) {
+      if ($key !== '#conjunction' && is_string($condition['field'])) {
+        if (strpos($condition['field'], 'field_data_field_og_subscribe_settings') === 0) {
+          $public_condition = $condition;
+          unset($conditions[$key]);
+        }
+
+        if ($condition['field'] === 'node.nid') {
+          unset($conditions[$key]);
+        }
+      }
+    }
+
+    if (!$public_condition) {
+      return;
+    }
+
+    $or = db_or();
+    $or->condition($public_condition['field'], $public_condition['value'], $public_condition['operator']);
+    $or->condition('node.nid', $gids['node'], 'IN');
+    $query->condition($or);
+  }
+}
diff --git a/modules/commons/commons_groups/plugins/entityreference/selection/og_commons.inc b/modules/commons/commons_groups/plugins/entityreference/selection/og_commons.inc
new file mode 100644
index 0000000..55fc029
--- /dev/null
+++ b/modules/commons/commons_groups/plugins/entityreference/selection/og_commons.inc
@@ -0,0 +1,6 @@
+<?php
+
+$plugin = array(
+  'title' => t('Commons OG'),
+  'class' => 'OgCommonsSelectionHandler',
+);
diff --git a/modules/commons/commons_images/commons_images.default_breakpoint_group.inc b/modules/commons/commons_images/commons_images.default_breakpoint_group.inc
new file mode 100644
index 0000000..a5492eb
--- /dev/null
+++ b/modules/commons/commons_images/commons_images.default_breakpoint_group.inc
@@ -0,0 +1,90 @@
+<?php
+/**
+ * @file
+ * commons_images.default_breakpoint_group.inc
+ */
+
+/**
+ * Implements hook_default_breakpoint_group().
+ */
+function commons_images_default_breakpoint_group() {
+  $export = array();
+
+  // Breakpoints.
+  $breakpoints = array();
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons large';
+
+  // Breakpoint group.
+  $breakpoint_group = new stdClass();
+  $breakpoint_group->disabled = FALSE; /* Edit this to true to make a default breakpoint_group disabled initially */
+  $breakpoint_group->api_version = 1;
+  $breakpoint_group->machine_name = 'commons_default';
+  $breakpoint_group->name = 'Commons default';
+  $breakpoint_group->breakpoints = $breakpoints;
+  $breakpoint_group->type = 'module';
+  $breakpoint_group->overridden = 0;
+  $export['commons_default'] = $breakpoint_group;
+
+  // Breakpoints.
+  $breakpoints = array();
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons large';
+
+  // Breakpoint group.
+  $breakpoint_group = new stdClass();
+  $breakpoint_group->disabled = FALSE; /* Edit this to true to make a default breakpoint_group disabled initially */
+  $breakpoint_group->api_version = 1;
+  $breakpoint_group->machine_name = 'commons_full';
+  $breakpoint_group->name = 'Commons full';
+  $breakpoint_group->breakpoints = $breakpoints;
+  $breakpoint_group->type = 'module';
+  $breakpoint_group->overridden = 0;
+  $export['commons_full'] = $breakpoint_group;
+
+  // Breakpoints.
+  $breakpoints = array();
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons large';
+
+  // Breakpoint group.
+  $breakpoint_group = new stdClass();
+  $breakpoint_group->disabled = FALSE; /* Edit this to true to make a default breakpoint_group disabled initially */
+  $breakpoint_group->api_version = 1;
+  $breakpoint_group->machine_name = 'commons_origins';
+  $breakpoint_group->name = 'Commons Origins';
+  $breakpoint_group->breakpoints = $breakpoints;
+  $breakpoint_group->type = 'theme';
+  $breakpoint_group->overridden = 0;
+  $export['commons_origins'] = $breakpoint_group;
+
+  // Breakpoints.
+  $breakpoints = array();
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons small landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium portrait';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons medium landscape';
+  $breakpoints[] = 'breakpoints.theme.commons_origins.commons large';
+
+  // Breakpoint group.
+  $breakpoint_group = new stdClass();
+  $breakpoint_group->disabled = FALSE; /* Edit this to true to make a default breakpoint_group disabled initially */
+  $breakpoint_group->api_version = 1;
+  $breakpoint_group->machine_name = 'commons_teaser';
+  $breakpoint_group->name = 'Commons teaser';
+  $breakpoint_group->breakpoints = $breakpoints;
+  $breakpoint_group->type = 'module';
+  $breakpoint_group->overridden = 0;
+  $export['commons_teaser'] = $breakpoint_group;
+
+  return $export;
+}
diff --git a/modules/commons/commons_images/commons_images.default_breakpoints.inc b/modules/commons/commons_images/commons_images.default_breakpoints.inc
new file mode 100644
index 0000000..fbda730
--- /dev/null
+++ b/modules/commons/commons_images/commons_images.default_breakpoints.inc
@@ -0,0 +1,89 @@
+<?php
+/**
+ * @file
+ * commons_images.default_breakpoints.inc
+ */
+
+/**
+ * Implements hook_default_breakpoints().
+ */
+function commons_images_default_breakpoints() {
+  $export = array();
+
+  $breakpoint = new stdClass();
+  $breakpoint->disabled = FALSE; /* Edit this to true to make a default breakpoint disabled initially */
+  $breakpoint->api_version = 1;
+  $breakpoint->machine_name = 'breakpoints.theme.commons_origins.commons large';
+  $breakpoint->name = 'Commons large';
+  $breakpoint->breakpoint = 'only screen and (min-width:935px)';
+  $breakpoint->source = 'commons_origins';
+  $breakpoint->source_type = 'theme';
+  $breakpoint->status = 1;
+  $breakpoint->weight = 4;
+  $breakpoint->multipliers = array(
+    '1x' => '1x',
+  );
+  $export['breakpoints.theme.commons_origins.commons large'] = $breakpoint;
+
+  $breakpoint = new stdClass();
+  $breakpoint->disabled = FALSE; /* Edit this to true to make a default breakpoint disabled initially */
+  $breakpoint->api_version = 1;
+  $breakpoint->machine_name = 'breakpoints.theme.commons_origins.commons medium landscape';
+  $breakpoint->name = 'Commons medium landscape';
+  $breakpoint->breakpoint = 'only screen and (min-width:769px) and (max-width:934px';
+  $breakpoint->source = 'commons_origins';
+  $breakpoint->source_type = 'theme';
+  $breakpoint->status = 1;
+  $breakpoint->weight = 3;
+  $breakpoint->multipliers = array(
+    '1x' => '1x',
+  );
+  $export['breakpoints.theme.commons_origins.commons medium landscape'] = $breakpoint;
+
+  $breakpoint = new stdClass();
+  $breakpoint->disabled = FALSE; /* Edit this to true to make a default breakpoint disabled initially */
+  $breakpoint->api_version = 1;
+  $breakpoint->machine_name = 'breakpoints.theme.commons_origins.commons medium portrait';
+  $breakpoint->name = 'Commons medium portrait';
+  $breakpoint->breakpoint = 'only screen and (min-width:481px) and (max-width:768px)';
+  $breakpoint->source = 'commons_origins';
+  $breakpoint->source_type = 'theme';
+  $breakpoint->status = 1;
+  $breakpoint->weight = 2;
+  $breakpoint->multipliers = array(
+    '1x' => '1x',
+  );
+  $export['breakpoints.theme.commons_origins.commons medium portrait'] = $breakpoint;
+
+  $breakpoint = new stdClass();
+  $breakpoint->disabled = FALSE; /* Edit this to true to make a default breakpoint disabled initially */
+  $breakpoint->api_version = 1;
+  $breakpoint->machine_name = 'breakpoints.theme.commons_origins.commons small landscape';
+  $breakpoint->name = 'Commons small landscape';
+  $breakpoint->breakpoint = 'only screen and (min-width:321px) and (max-width:480px)';
+  $breakpoint->source = 'commons_origins';
+  $breakpoint->source_type = 'theme';
+  $breakpoint->status = 1;
+  $breakpoint->weight = 1;
+  $breakpoint->multipliers = array(
+    '1x' => '1x',
+  );
+  $export['breakpoints.theme.commons_origins.commons small landscape'] = $breakpoint;
+
+  $breakpoint = new stdClass();
+  $breakpoint->disabled = FALSE; /* Edit this to true to make a default breakpoint disabled initially */
+  $breakpoint->api_version = 1;
+  $breakpoint->machine_name = 'breakpoints.theme.commons_origins.commons small portrait';
+  $breakpoint->name = 'Commons small portrait';
+  $breakpoint->breakpoint = 'only screen and (max-width:320px)';
+  $breakpoint->source = 'commons_origins';
+  $breakpoint->source_type = 'theme';
+  $breakpoint->status = 1;
+  $breakpoint->weight = 0;
+  $breakpoint->multipliers = array(
+    '1x' => '1x',
+  );
+  $export['breakpoints.theme.commons_origins.commons small portrait'] = $breakpoint;
+
+  return $export;
+}
diff --git a/modules/commons/commons_images/commons_images.default_picture_mapping.inc b/modules/commons/commons_images/commons_images.default_picture_mapping.inc
new file mode 100644
index 0000000..e91e30f
--- /dev/null
+++ b/modules/commons/commons_images/commons_images.default_picture_mapping.inc
@@ -0,0 +1,101 @@
+<?php
+/**
+ * @file
+ * commons_images.default_picture_mapping.inc
+ */
+
+/**
+ * Implements hook_default_picture_mapping().
+ */
+function commons_images_default_picture_mapping() {
+  $export = array();
+
+  $picture_mapping = new stdClass();
+  $picture_mapping->disabled = FALSE; /* Edit this to true to make a default picture_mapping disabled initially */
+  $picture_mapping->api_version = 1;
+  $picture_mapping->machine_name = 'commons_default';
+  $picture_mapping->breakpoint_group = 'commons_default';
+  $picture_mapping->mapping = array(
+    'breakpoints.theme.commons_origins.commons small portrait' => array(
+      '1x' => 'commons-default-small',
+      '1.5x' => 'commons-default-small-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons small landscape' => array(
+      '1x' => 'commons-default-small',
+      '1.5x' => 'commons-default-small-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons medium portrait' => array(
+      '1x' => 'commons-default-medium',
+      '1.5x' => 'commons-default-medium-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons medium landscape' => array(
+      '1x' => 'commons-default-medium',
+      '1.5x' => 'commons-default-medium-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons large' => array(
+      '1x' => 'commons-default-large',
+      '1.5x' => 'commons-default-large-1_5x',
+    ),
+  );
+  $export['commons_default'] = $picture_mapping;
+
+  $picture_mapping = new stdClass();
+  $picture_mapping->disabled = FALSE; /* Edit this to true to make a default picture_mapping disabled initially */
+  $picture_mapping->api_version = 1;
+  $picture_mapping->machine_name = 'commons_full';
+  $picture_mapping->breakpoint_group = 'commons_full';
+  $picture_mapping->mapping = array(
+    'breakpoints.theme.commons_origins.commons small portrait' => array(
+      '1x' => 'commons-full-small',
+      '1.5x' => 'commons-full-small-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons small landscape' => array(
+      '1x' => 'commons-full-small',
+      '1.5x' => 'commons-full-small-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons medium portrait' => array(
+      '1x' => 'commons-full-medium',
+      '1.5x' => 'commons-full-medium-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons medium landscape' => array(
+      '1x' => 'commons-full-medium',
+      '1.5x' => 'commons-full-medium-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons large' => array(
+      '1x' => 'commons-full-large',
+      '1.5x' => 'commons-full-large-1_5x',
+    ),
+  );
+  $export['commons_full'] = $picture_mapping;
+
+  $picture_mapping = new stdClass();
+  $picture_mapping->disabled = FALSE; /* Edit this to true to make a default picture_mapping disabled initially */
+  $picture_mapping->api_version = 1;
+  $picture_mapping->machine_name = 'commons_teaser';
+  $picture_mapping->breakpoint_group = 'commons_teaser';
+  $picture_mapping->mapping = array(
+    'breakpoints.theme.commons_origins.commons small portrait' => array(
+      '1x' => 'commons-teaser-small',
+      '1.5x' => 'commons-teaser-small-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons small landscape' => array(
+      '1x' => 'commons-teaser-small',
+      '1.5x' => 'commons-teaser-small-1_5x',
+    ),
+    'breakpoints.theme.commons_origins.commons medium portrait' => array(
+      '1x' => 'commons-teaser-medium',
+      '1.5x' => 'commons-teaser-medium-1_5',
+    ),
+    'breakpoints.theme.commons_origins.commons medium landscape' => array(
+      '1x' => 'commons-teaser-medium',
+      '1.5x' => 'commons-teaser-medium-1_5',
+    ),
+    'breakpoints.theme.commons_origins.commons large' => array(
+      '1x' => 'commons-teaser-large',
+      '1.5x' => 'commons-teaser-large-1_5x',
+    ),
+  );
+  $export['commons_teaser'] = $picture_mapping;
+
+  return $export;
+}
diff --git a/modules/commons/commons_images/commons_images.features.inc b/modules/commons/commons_images/commons_images.features.inc
new file mode 100644
index 0000000..48d70d2
--- /dev/null
+++ b/modules/commons/commons_images/commons_images.features.inc
@@ -0,0 +1,455 @@
+<?php
+/**
+ * @file
+ * commons_images.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_images_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "breakpoints" && $api == "default_breakpoint_group") {
+    return array("version" => "1");
+  }
+  if ($module == "breakpoints" && $api == "default_breakpoints") {
+    return array("version" => "1");
+  }
+  if ($module == "picture" && $api == "default_picture_mapping") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_image_default_styles().
+ */
+function commons_images_image_default_styles() {
+  $styles = array();
+
+  // Exported image style: commons-default-large.
+  $styles['commons-default-large'] = array(
+    'name' => 'commons-default-large',
+    'label' => 'Commons default large',
+    'effects' => array(
+      18 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 536,
+          'height' => 600,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-default-large-1_5x.
+  $styles['commons-default-large-1_5x'] = array(
+    'name' => 'commons-default-large-1_5x',
+    'label' => 'Commons default large 1.5x',
+    'effects' => array(
+      19 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 804,
+          'height' => 900,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-default-medium.
+  $styles['commons-default-medium'] = array(
+    'name' => 'commons-default-medium',
+    'label' => 'Commons default medium',
+    'effects' => array(
+      18 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 536,
+          'height' => 600,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-default-medium-1_5x.
+  $styles['commons-default-medium-1_5x'] = array(
+    'name' => 'commons-default-medium-1_5x',
+    'label' => 'Commons default medium 1.5x',
+    'effects' => array(
+      19 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 804,
+          'height' => 900,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-default-small.
+  $styles['commons-default-small'] = array(
+    'name' => 'commons-default-small',
+    'label' => 'Commons default small',
+    'effects' => array(
+      20 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 456,
+          'height' => 500,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-default-small-1_5x.
+  $styles['commons-default-small-1_5x'] = array(
+    'name' => 'commons-default-small-1_5x',
+    'label' => 'Commons default small 1.5x',
+    'effects' => array(
+      21 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 684,
+          'height' => 750,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-full-large.
+  $styles['commons-full-large'] = array(
+    'name' => 'commons-full-large',
+    'label' => 'Commons full large',
+    'effects' => array(
+      22 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 916,
+          'height' => '',
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-full-large-1_5x.
+  $styles['commons-full-large-1_5x'] = array(
+    'name' => 'commons-full-large-1_5x',
+    'label' => 'Commons full large 1.5x',
+    'effects' => array(
+      23 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 1374,
+          'height' => '',
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-full-medium.
+  $styles['commons-full-medium'] = array(
+    'name' => 'commons-full-medium',
+    'label' => 'Commons full medium',
+    'effects' => array(
+      24 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 768,
+          'height' => '',
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-full-medium-1_5.
+  $styles['commons-full-medium-1_5'] = array(
+    'name' => 'commons-full-medium-1_5',
+    'label' => 'Commons full medium 1.5',
+    'effects' => array(
+      25 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 1152,
+          'height' => '',
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-full-small.
+  $styles['commons-full-small'] = array(
+    'name' => 'commons-full-small',
+    'label' => 'Commons full small',
+    'effects' => array(
+      20 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 456,
+          'height' => 500,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-full-small-1_5x.
+  $styles['commons-full-small-1_5x'] = array(
+    'name' => 'commons-full-small-1_5x',
+    'label' => 'Commons full small 1.5x',
+    'effects' => array(
+      21 => array(
+        'label' => 'Scale',
+        'help' => 'Scaling will maintain the aspect-ratio of the original image. If only a single dimension is specified, the other dimension will be calculated.',
+        'effect callback' => 'image_scale_effect',
+        'dimensions callback' => 'image_scale_dimensions',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'image',
+        'name' => 'image_scale',
+        'data' => array(
+          'width' => 684,
+          'height' => 750,
+          'upscale' => 0,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-teaser-large.
+  $styles['commons-teaser-large'] = array(
+    'name' => 'commons-teaser-large',
+    'label' => 'Commons teaser large',
+    'effects' => array(
+      16 => array(
+        'label' => 'Scale and Smart Crop',
+        'help' => 'Similar to "Scale And Crop", but preserves the portion of the image with the most entropy.',
+        'effect callback' => 'smartcrop_scale_effect',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'smartcrop',
+        'name' => 'smartcrop_scale_and_crop',
+        'data' => array(
+          'width' => 124,
+          'height' => 124,
+          'upscale' => 1,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-teaser-large-1_5x.
+  $styles['commons-teaser-large-1_5x'] = array(
+    'name' => 'commons-teaser-large-1_5x',
+    'label' => 'Commons teaser large 1.5x',
+    'effects' => array(
+      17 => array(
+        'label' => 'Scale and Smart Crop',
+        'help' => 'Similar to "Scale And Crop", but preserves the portion of the image with the most entropy.',
+        'effect callback' => 'smartcrop_scale_effect',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'smartcrop',
+        'name' => 'smartcrop_scale_and_crop',
+        'data' => array(
+          'width' => 186,
+          'height' => 186,
+          'upscale' => 1,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-teaser-medium.
+  $styles['commons-teaser-medium'] = array(
+    'name' => 'commons-teaser-medium',
+    'label' => 'Commons teaser medium',
+    'effects' => array(
+      14 => array(
+        'label' => 'Scale and Smart Crop',
+        'help' => 'Similar to "Scale And Crop", but preserves the portion of the image with the most entropy.',
+        'effect callback' => 'smartcrop_scale_effect',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'smartcrop',
+        'name' => 'smartcrop_scale_and_crop',
+        'data' => array(
+          'width' => 72,
+          'height' => 72,
+          'upscale' => 1,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-teaser-medium-1_5x.
+  $styles['commons-teaser-medium-1_5x'] = array(
+    'name' => 'commons-teaser-medium-1_5x',
+    'label' => 'Commons teaser medium 1.5x',
+    'effects' => array(
+      15 => array(
+        'label' => 'Scale and Smart Crop',
+        'help' => 'Similar to "Scale And Crop", but preserves the portion of the image with the most entropy.',
+        'effect callback' => 'smartcrop_scale_effect',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'smartcrop',
+        'name' => 'smartcrop_scale_and_crop',
+        'data' => array(
+          'width' => 108,
+          'height' => 108,
+          'upscale' => 1,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-teaser-small.
+  $styles['commons-teaser-small'] = array(
+    'name' => 'commons-teaser-small',
+    'label' => 'Commons teaser small',
+    'effects' => array(
+      12 => array(
+        'label' => 'Scale and Smart Crop',
+        'help' => 'Similar to "Scale And Crop", but preserves the portion of the image with the most entropy.',
+        'effect callback' => 'smartcrop_scale_effect',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'smartcrop',
+        'name' => 'smartcrop_scale_and_crop',
+        'data' => array(
+          'width' => 54,
+          'height' => 54,
+          'upscale' => 1,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  // Exported image style: commons-teaser-small-1_5x.
+  $styles['commons-teaser-small-1_5x'] = array(
+    'name' => 'commons-teaser-small-1_5x',
+    'label' => 'Commons teaser small 1.5x',
+    'effects' => array(
+      13 => array(
+        'label' => 'Scale and Smart Crop',
+        'help' => 'Similar to "Scale And Crop", but preserves the portion of the image with the most entropy.',
+        'effect callback' => 'smartcrop_scale_effect',
+        'form callback' => 'image_scale_form',
+        'summary theme' => 'image_scale_summary',
+        'module' => 'smartcrop',
+        'name' => 'smartcrop_scale_and_crop',
+        'data' => array(
+          'width' => 81,
+          'height' => 81,
+          'upscale' => 1,
+        ),
+        'weight' => 1,
+      ),
+    ),
+  );
+
+  return $styles;
+}
diff --git a/modules/commons/commons_images/commons_images.info b/modules/commons/commons_images/commons_images.info
new file mode 100644
index 0000000..6afb9f2
--- /dev/null
+++ b/modules/commons/commons_images/commons_images.info
@@ -0,0 +1,45 @@
+name = Commons Images
+description = Image styles used in the Commons distribution
+core = 7.x
+package = Commons - Building blocks
+project = commons_images
+dependencies[] = breakpoints
+dependencies[] = ctools
+dependencies[] = file_entity
+dependencies[] = image
+dependencies[] = picture
+dependencies[] = smartcrop
+features[breakpoint_group][] = commons_default
+features[breakpoint_group][] = commons_full
+features[breakpoint_group][] = commons_origins
+features[breakpoint_group][] = commons_teaser
+features[breakpoints][] = breakpoints.theme.commons_origins.commons large
+features[breakpoints][] = breakpoints.theme.commons_origins.commons medium landscape
+features[breakpoints][] = breakpoints.theme.commons_origins.commons medium portrait
+features[breakpoints][] = breakpoints.theme.commons_origins.commons small landscape
+features[breakpoints][] = breakpoints.theme.commons_origins.commons small portrait
+features[ctools][] = breakpoints:default_breakpoint_group:1
+features[ctools][] = breakpoints:default_breakpoints:1
+features[ctools][] = picture:default_picture_mapping:1
+features[features_api][] = api:2
+features[image][] = commons-default-large
+features[image][] = commons-default-large-1_5x
+features[image][] = commons-default-medium
+features[image][] = commons-default-medium-1_5x
+features[image][] = commons-default-small
+features[image][] = commons-default-small-1_5x
+features[image][] = commons-full-large
+features[image][] = commons-full-large-1_5x
+features[image][] = commons-full-medium
+features[image][] = commons-full-medium-1_5
+features[image][] = commons-full-small
+features[image][] = commons-full-small-1_5x
+features[image][] = commons-teaser-large
+features[image][] = commons-teaser-large-1_5x
+features[image][] = commons-teaser-medium
+features[image][] = commons-teaser-medium-1_5x
+features[image][] = commons-teaser-small
+features[image][] = commons-teaser-small-1_5x
+features[picture_mapping][] = commons_default
+features[picture_mapping][] = commons_full
+features[picture_mapping][] = commons_teaser
diff --git a/modules/commons/commons_images/commons_images.module b/modules/commons/commons_images/commons_images.module
new file mode 100644
index 0000000..f3ec52e
--- /dev/null
+++ b/modules/commons/commons_images/commons_images.module
@@ -0,0 +1,76 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Images feature.
+ */
+
+include_once 'commons_images.features.inc';
+
+/**
+ * Implements hook_file_default_displays_alter().
+ */
+function commons_images_file_default_displays_alter(&$file_displays) {
+  // Copy all default image formatters to full image formatters.
+  foreach ($file_displays as $file_display) {
+    if (strpos($file_display->name, 'image__default__') !== false) {
+      $display = clone $file_display;
+      $name = str_replace('image__default__', 'image__full__', $display->name);
+      $display->name = $name;
+      $file_displays[$name] = $display;
+    }
+  }
+
+  // Default images should be displayed using the 'default' picture group.
+  if (isset($file_displays['image__default__file_field_image'])) {
+    $file_displays['image__default__file_field_image']->status = FALSE;
+  }
+
+  $file_display = new stdClass();
+  $file_display->api_version = 1;
+  $file_display->name = 'image__default__file_field_picture';
+  $file_display->weight = 1;
+  $file_display->status = TRUE;
+  $file_display->settings = array(
+    'picture_group' => 'commons_default',
+    'fallback_image_style' => 'commons-default-small',
+    'image_link' => 'content',
+    'colorbox' => 'commons_default',
+  );
+  $file_displays['image__default__file_field_picture'] = $file_display;
+
+  // Full images should be displayed using the 'full' picture group.
+  if (isset($file_displays['image__full__file_field_image'])) {
+    $file_displays['image__full__file_field_image']->status = FALSE;
+  }
+
+  $file_display = new stdClass();
+  $file_display->api_version = 1;
+  $file_display->name = 'image__full__file_field_picture';
+  $file_display->weight = 1;
+  $file_display->status = TRUE;
+  $file_display->settings = array(
+    'picture_group' => 'commons_full',
+    'fallback_image_style' => 'commons-full-small',
+    'image_link' => '',
+    'colorbox' => 'commons_full',
+  );
+  $file_displays['image__full__file_field_picture'] = $file_display;
+
+  // Teaser images should be displayed using the 'teaser' picture group.
+  if (isset($file_displays['image__teaser__file_field_image'])) {
+    $file_displays['image__teaser__file_field_image']->status = FALSE;
+  }
+
+  $file_display = new stdClass();
+  $file_display->api_version = 1;
+  $file_display->name = 'image__teaser__file_field_picture';
+  $file_display->weight = -1;
+  $file_display->status = TRUE;
+  $file_display->settings = array(
+    'picture_group' => 'commons_teaser',
+    'fallback_image_style' => 'commons-teaser-small',
+    'image_link' => '',
+    'colorbox' => 'commons_teaser',
+  );
+  $file_displays['image__teaser__file_field_picture'] = $file_display;
+}
diff --git a/modules/commons/commons_kissmetrics/commons_kissmetrics.info b/modules/commons/commons_kissmetrics/commons_kissmetrics.info
new file mode 100644
index 0000000..db4f71f
--- /dev/null
+++ b/modules/commons/commons_kissmetrics/commons_kissmetrics.info
@@ -0,0 +1,31 @@
+name = Commons KISSmetrics
+description = Integrates with KISSmetrics to tracks Commons-specific user metrics and actions.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = comment
+dependencies[] = entity
+dependencies[] = flag
+dependencies[] = kissmetrics
+dependencies[] = og
+dependencies[] = privatemsg_rules
+dependencies[] = rules
+dependencies[] = voting_rules
+features[features_api][] = api:2
+features[rules_config][] = rules_commons_kissmetrics_collect_referenced_groups
+features[rules_config][] = rules_commons_kissmetrics_user_adds_a_trusted_contact
+features[rules_config][] = rules_commons_kissmetrics_user_approves_a_trusted_contact
+features[rules_config][] = rules_commons_kissmetrics_user_creates_content
+features[rules_config][] = rules_commons_kissmetrics_user_edits_profile
+features[rules_config][] = rules_commons_kissmetrics_user_edits_wiki
+features[rules_config][] = rules_commons_kissmetrics_user_flags_content_as_inappropriate
+features[rules_config][] = rules_commons_kissmetrics_user_follows_content
+features[rules_config][] = rules_commons_kissmetrics_user_follows_group
+features[rules_config][] = rules_commons_kissmetrics_user_follows_topic
+features[rules_config][] = rules_commons_kissmetrics_user_follows_user
+features[rules_config][] = rules_commons_kissmetrics_user_likes_content
+features[rules_config][] = rules_commons_kissmetrics_user_logs_in
+features[rules_config][] = rules_commons_kissmetrics_user_logs_out
+features[rules_config][] = rules_commons_kissmetrics_user_posts_comment
+features[rules_config][] = rules_commons_kissmetrics_user_registers
+features[rules_config][] = rules_commons_kissmetrics_user_replies_to_private_message_thread
+features[rules_config][] = rules_commons_kissmetrics_user_starts_new_private_message_thread
diff --git a/modules/commons/commons_kissmetrics/commons_kissmetrics.module b/modules/commons/commons_kissmetrics/commons_kissmetrics.module
new file mode 100644
index 0000000..44788b0
--- /dev/null
+++ b/modules/commons/commons_kissmetrics/commons_kissmetrics.module
@@ -0,0 +1,5 @@
+<?php
+/**
+ * @file
+ * Drupal needs this blank file.
+ */
diff --git a/modules/commons/commons_kissmetrics/commons_kissmetrics.rules_defaults.inc b/modules/commons/commons_kissmetrics/commons_kissmetrics.rules_defaults.inc
new file mode 100644
index 0000000..7d64ab8
--- /dev/null
+++ b/modules/commons/commons_kissmetrics/commons_kissmetrics.rules_defaults.inc
@@ -0,0 +1,328 @@
+<?php
+/**
+ * @file
+ * commons_kissmetrics.rules_defaults.inc
+ */
+
+/**
+ * Implements hook_default_rules_configuration().
+ */
+function commons_kissmetrics_default_rules_configuration() {
+  $items = array();
+  $items['rules_commons_kissmetrics_collect_referenced_groups'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_collect_referenced_groups" : {
+      "LABEL" : "Commons KISSmetrics: Collect Referenced Groups",
+      "PLUGIN" : "rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules" ],
+      "USES VARIABLES" : {
+        "commons_kissmetrics_referenced_groups" : { "label" : "Referenced Groups", "type" : "node" },
+        "commons_kissmetrics_collected_groups" : { "label" : "Collected Groups", "type" : "text", "parameter" : false }
+      },
+      "IF" : [
+        { "entity_has_field" : {
+            "entity" : [ "commons-kissmetrics-referenced-groups" ],
+            "field" : "og_group_ref"
+          }
+        }
+      ],
+      "DO" : [
+        { "LOOP" : {
+            "USING" : { "list" : [ "commons-kissmetrics-referenced-groups:og-group-ref" ] },
+            "ITEM" : { "referenced_group" : "Referenced Group" },
+            "DO" : [
+              { "data_set" : {
+                  "data" : [ "commons-kissmetrics-collected-groups" ],
+                  "value" : "Group|[referenced-group:title]\\r\\n[commons-kissmetrics-collected-groups:value]"
+                }
+              }
+            ]
+          }
+        }
+      ],
+      "PROVIDES VARIABLES" : [ "commons_kissmetrics_collected_groups" ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_adds_a_trusted_contact'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_adds_a_trusted_contact" : {
+      "LABEL" : "Commons KISSmetrics: User Adds A Trusted Contact",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "og" ],
+      "ON" : { "og_user_insert" : [] },
+      "IF" : [ { "data_is" : { "data" : [ "og-membership:state" ], "value" : "2" } } ],
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Added A Trusted Contact",
+            "properties" : "User|[account:name]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_approves_a_trusted_contact'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_approves_a_trusted_contact" : {
+      "LABEL" : "Commons KISSmetrics: User Approves A Trusted Contact",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "og" ],
+      "ON" : { "og_user_approved" : [] },
+      "IF" : [ { "data_is" : { "data" : [ "og-membership:state" ], "value" : "1" } } ],
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Approved A Trusted Contact",
+            "properties" : "User|[account:name]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_creates_content'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_creates_content" : {
+      "LABEL" : "Commons KISSmetrics: User Creates Content",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics" ],
+      "ON" : { "node_insert" : [] },
+      "DO" : [
+        { "component_rules_commons_kissmetrics_collect_referenced_groups" : {
+            "USING" : { "commons_kissmetrics_referenced_groups" : [ "node" ] },
+            "PROVIDE" : { "commons_kissmetrics_collected_groups" : { "commons_kissmetrics_collected_groups" : "Collected Groups" } }
+          }
+        },
+        { "kissmetrics_record_event" : {
+            "name" : "User Created Content",
+            "properties" : "Title|[node:title]\\r\\nType|[node:content-type:name]\\r\\n[commons-kissmetrics-collected-groups:value]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_edits_profile'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_edits_profile" : {
+      "LABEL" : "Commons KISSmetrics: User Edits Profile",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics" ],
+      "ON" : { "user_update" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : { "name" : "User Edited Profile", "properties" : "User|[account:name]" } }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_edits_wiki'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_edits_wiki" : {
+      "LABEL" : "Commons KISSmetrics: User Edits Wiki",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics" ],
+      "ON" : { "node_update" : [] },
+      "IF" : [
+        { "node_is_of_type" : { "node" : [ "node" ], "type" : { "value" : { "wiki" : "wiki" } } } }
+      ],
+      "DO" : [
+        { "component_rules_commons_kissmetrics_collect_referenced_groups" : {
+            "USING" : { "commons_kissmetrics_referenced_groups" : [ "node" ] },
+            "PROVIDE" : { "commons_kissmetrics_collected_groups" : { "commons_kissmetrics_collected_groups" : "Collected Groups" } }
+          }
+        },
+        { "kissmetrics_record_event" : {
+            "name" : "User Edited Wiki",
+            "properties" : "Title|[node:title]\\r\\n[commons-kissmetrics-collected-groups:value]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_flags_content_as_inappropriate'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_flags_content_as_inappropriate" : {
+      "LABEL" : "Commons KISSmetrics: User Flags Content As Inappropriate",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "flag" ],
+      "ON" : { "flag_flagged_inappropriate_node" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Flagged Content As Inappropriate",
+            "properties" : "Title|[flagged-node:title]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_follows_content'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_follows_content" : {
+      "LABEL" : "Commons KISSmetrics: User Follows Content",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "flag" ],
+      "ON" : { "flag_flagged_commons_follow_node" : [] },
+      "DO" : [
+        { "component_rules_commons_kissmetrics_collect_referenced_groups" : {
+            "USING" : { "commons_kissmetrics_referenced_groups" : [ "flagged-node" ] },
+            "PROVIDE" : { "commons_kissmetrics_collected_groups" : { "commons_kissmetrics_collected_groups" : "Collected Groups" } }
+          }
+        },
+        { "kissmetrics_record_event" : {
+            "name" : "User Followed Content",
+            "properties" : "Title|[flagged-node:title]\\r\\n[commons-kissmetrics-collected-groups:value]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_follows_group'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_follows_group" : {
+      "LABEL" : "Commons KISSmetrics: User Follows Group",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "flag" ],
+      "ON" : { "flag_flagged_commons_follow_group" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Followed Group",
+            "properties" : "Title|[flagged-node:title]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_follows_topic'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_follows_topic" : {
+      "LABEL" : "Commons KISSmetrics: User Follows Topic",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "flag" ],
+      "ON" : { "flag_flagged_commons_follow_term" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Followed Topic",
+            "properties" : "Name|[flagged-taxonomy-term:name]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_follows_user'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_follows_user" : {
+      "LABEL" : "Commons KISSmetrics: User Follows User",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "flag" ],
+      "ON" : { "flag_flagged_commons_follow_user" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Followed User",
+            "properties" : "User|[flagged-user:name]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_likes_content'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_likes_content" : {
+      "LABEL" : "Commons KISSmetrics: User Likes Content",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "voting_rules" ],
+      "ON" : { "voting_rules_insert_node" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : { "name" : "User Liked Content", "properties" : "Title|[node:title]" } }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_logs_in'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_logs_in" : {
+      "LABEL" : "Commons KISSmetrics: User Logs In",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics" ],
+      "ON" : { "user_login" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : { "name" : "User Logged In", "properties" : "User|[account:name]" } }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_logs_out'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_logs_out" : {
+      "LABEL" : "Commons KISSmetrics: User Logs Out",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics" ],
+      "ON" : { "user_logout" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : { "name" : "User Logged Out", "properties" : "User|[[account:name]]" } }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_posts_comment'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_posts_comment" : {
+      "LABEL" : "Commons KISSmetrics: User Posts Comment",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "comment" ],
+      "ON" : { "comment_insert" : [] },
+      "DO" : [
+        { "component_rules_commons_kissmetrics_collect_referenced_groups" : {
+            "USING" : { "commons_kissmetrics_referenced_groups" : [ "comment:node" ] },
+            "PROVIDE" : { "commons_kissmetrics_collected_groups" : { "commons_kissmetrics_collected_groups" : "Collected Groups" } }
+          }
+        },
+        { "kissmetrics_record_event" : {
+            "name" : "User Posted Comment",
+            "properties" : "Title|[comment:title]\\r\\nAssociated Content|[comment:node:title]\\r\\n[commons-kissmetrics-collected-groups:value]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_registers'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_registers" : {
+      "LABEL" : "Commons KISSmetrics: User Registers",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics" ],
+      "ON" : { "user_insert" : [] },
+      "DO" : [
+        { "kissmetrics_record_event" : { "name" : "User Registered", "properties" : "User|[[account:name]]" } }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_replies_to_private_message_thread'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_replies_to_private_message_thread" : {
+      "LABEL" : "Commons KISSmetrics: User Replies To Private Message Thread",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "privatemsg_rules" ],
+      "ON" : { "privatemsg_insert" : [] },
+      "IF" : [
+        { "NOT data_is_empty" : { "data" : [ "privatemsg-message:thread-id" ] } }
+      ],
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Replied To Private Message Thread",
+            "properties" : "Author|[privatemsg-message:author]\\r\\nRecipient|[recipient:name]"
+          }
+        }
+      ]
+    }
+  }');
+  $items['rules_commons_kissmetrics_user_starts_new_private_message_thread'] = entity_import('rules_config', '{ "rules_commons_kissmetrics_user_starts_new_private_message_thread" : {
+      "LABEL" : "Commons KISSmetrics: User Starts New Private Message Thread",
+      "PLUGIN" : "reaction rule",
+      "OWNER" : "rules",
+      "TAGS" : [ "Commons KISSmetrics" ],
+      "REQUIRES" : [ "rules", "kissmetrics", "privatemsg_rules" ],
+      "ON" : { "privatemsg_insert" : [] },
+      "IF" : [ { "data_is_empty" : { "data" : [ "privatemsg-message:thread-id" ] } } ],
+      "DO" : [
+        { "kissmetrics_record_event" : {
+            "name" : "User Started New Private Message Thread",
+            "properties" : "Author|[privatemsg-message:author]\\r\\nRecipient|[recipient:name]"
+          }
+        }
+      ]
+    }
+  }');
+  return $items;
+}
diff --git a/modules/commons/commons_like/.gitignore b/modules/commons/commons_like/.gitignore
new file mode 100644
index 0000000..b4b2957
--- /dev/null
+++ b/modules/commons/commons_like/.gitignore
@@ -0,0 +1 @@
+/.sass-cache/
\ No newline at end of file
diff --git a/modules/commons/commons_like/commons-like.css b/modules/commons/commons_like/commons-like.css
new file mode 100644
index 0000000..3629201
--- /dev/null
+++ b/modules/commons/commons_like/commons-like.css
@@ -0,0 +1,90 @@
+.rate-widget-commons_like {
+  padding: 0 10px;
+  background-color: #fefefe;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FFFEFEFE', endColorstr='#FFE8E8E8');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #fefefe), color-stop(100%, #e8e8e8));
+  background-image: -webkit-linear-gradient(top, #fefefe 0%, #e8e8e8 100%);
+  background-image: -moz-linear-gradient(top, #fefefe 0%, #e8e8e8 100%);
+  background-image: -o-linear-gradient(top, #fefefe 0%, #e8e8e8 100%);
+  background-image: linear-gradient(top, #fefefe 0%, #e8e8e8 100%);
+  border: 1px solid #cccccc;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  color: #333333;
+  text-align: center;
+  display: inline-block;
+}
+.rate-widget-commons_like:hover {
+  text-decoration: none;
+}
+
+.rate-widget-commons_like {
+  position: relative;
+  width: 62px;
+  height: 20px;
+  padding: 0;
+}
+.rate-widget-commons_like .rate-commons-like-btn {
+  display: block;
+  font-size: 0;
+  width: 62px;
+  height: 20px;
+  position: absolute;
+  left: 0;
+  top: 0;
+  z-index: 2;
+}
+.rate-widget-commons_like .rate-commons-like-btn:before {
+  content: '';
+  background: url("images/like.png") no-repeat;
+  width: 10px;
+  height: 14px;
+  display: inline-block;
+  margin-right: 3px;
+  position: absolute;
+  left: 17px;
+  top: 3px;
+}
+.rate-widget-commons_like .rate-commons-like-count {
+  position: absolute;
+  top: -1px;
+  right: -1px;
+  z-index: 1;
+  background: #D9D9D9;
+  border: 1px solid #b5b5b5;
+  height: 20px;
+  line-height: 20px;
+  padding: 0 5px;
+  -webkit-border-radius: 0 3px 3px 0px;
+  -moz-border-radius: 0 3px 3px 0px;
+  -ms-border-radius: 0 3px 3px 0px;
+  -o-border-radius: 0 3px 3px 0px;
+  border-radius: 0 3px 3px 0px;
+}
+.rate-widget-commons_like .rate-commons-like-count:after, .rate-widget-commons_like .rate-commons-like-count:before {
+  right: 100%;
+  border: solid transparent;
+  content: " ";
+  height: 0;
+  width: 0;
+  position: absolute;
+  pointer-events: none;
+}
+.rate-widget-commons_like .rate-commons-like-count:after {
+  border-color: rgba(217, 217, 217, 0);
+  border-right-color: #D9D9D9;
+  border-width: 4px;
+  top: 50%;
+  margin-top: -4px;
+}
+.rate-widget-commons_like .rate-commons-like-count:before {
+  border-color: rgba(181, 181, 181, 0);
+  border-right-color: #B5B5B5;
+  border-width: 5px;
+  top: 50%;
+  margin-top: -5px;
+}
diff --git a/modules/commons/commons_like/commons-like.scss b/modules/commons/commons_like/commons-like.scss
new file mode 100644
index 0000000..799579d
--- /dev/null
+++ b/modules/commons/commons_like/commons-like.scss
@@ -0,0 +1,92 @@
+@import 'compass';
+
+$dark_gray: rgb(51,51,51);
+
+%btn-gray {
+  // box-shadow: 1px 1px 1px #ABE0A2 inset, 0 3px 3px rgba(#000, 0.09);
+  padding: 0 10px;
+  // needs latest Compass, add '@import "compass"' to your scss
+  background-color: #fefefe; // Old browsers
+  @include filter-gradient(#fefefe, #e8e8e8, vertical); // IE6-9
+  @include background-image(linear-gradient(top,  #fefefe 0%,#e8e8e8 100%));
+  border: 1px solid #cccccc;
+  @include border-radius(3px);
+  color: $dark_gray;
+  text-align: center;
+  display: inline-block;
+  // text-shadow: 1px 1px rgba(#000, 0.49);
+
+  &:hover {
+    text-decoration: none;
+  }
+}
+
+.rate-widget-commons_like {
+  position: relative;
+  @extend %btn-gray;
+  width: 62px;
+  height: 20px;
+  padding: 0;
+
+  .rate-commons-like-btn {
+    display: block;
+    font-size: 0;
+    width: 62px;
+    height: 20px;
+    position: absolute;
+    left: 0;
+    top: 0;
+    z-index: 2;
+
+    &:before {
+      content: '';
+      background: url('images/like.png') no-repeat;
+      width: 10px;
+      height: 14px;
+      display: inline-block;
+      margin-right: 3px;
+      position: absolute;
+      left: 17px;
+      top: 3px;
+    }
+  }
+
+  .rate-commons-like-count {
+    position: absolute;
+    top: -1px;
+    right: -1px;
+    z-index: 1;
+    background: #D9D9D9;
+    border: 1px solid #B5B5B5;
+    height: 20px;
+    line-height: 20px;
+    padding: 0 5px;
+    @include border-radius(0 3px 3px 0px);
+
+    &:after, &:before {
+      right: 100%;
+      border: solid transparent;
+      content: " ";
+      height: 0;
+      width: 0;
+      position: absolute;
+      pointer-events: none;
+    }
+
+    &:after {
+      border-color: rgba(217, 217, 217, 0);
+      border-right-color: #D9D9D9;
+      border-width: 4px;
+      top: 50%;
+      margin-top: -4px;
+    }
+
+    &:before {
+      border-color: rgba(181, 181, 181, 0);
+      border-right-color: #B5B5B5;
+      border-width: 5px;
+      top: 50%;
+      margin-top: -5px;
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_like/commons-like.tpl.php b/modules/commons/commons_like/commons-like.tpl.php
new file mode 100644
index 0000000..ab83a4a
--- /dev/null
+++ b/modules/commons/commons_like/commons-like.tpl.php
@@ -0,0 +1,42 @@
+<?php
+/**
+ * @file
+ * Rate widget theme
+ *
+ * This is the default template for rate widgets. See section 3 of the README
+ * file for information on theming widgets.
+ *
+ * Available variables:
+ * - $links: Array with vote links
+ *     array(
+ *       array(
+ *         'text' => 'Button label',
+ *         'href' => 'Link href',
+ *         'value' => 20,
+ *         'votes' => 6,
+ *       ),
+ *     )
+ * - $results: Array with voting results
+ *     array(
+ *       'rating' => 12, // Average rating
+ *       'options' => array( // Votes per option. Only available when value_type == 'options'
+ *         1 => 234,
+ *         2 => 34,
+ *       ),
+ *       'count' => 23, // Number of votes
+ *       'up' => 2, // Number of up votes. Only available for thumbs up / down.
+ *       'down' => 3, // Number of down votes. Only available for thumbs up / down.
+ *       'up_percent' => 40, // Percentage of up votes. Only available for thumbs up / down.
+ *       'down_percent' => 60, // Percentage of down votes. Only available for thumbs up / down.
+ *       'user_vote' => 80, // Value for user vote. Only available when user has voted.
+ *     )
+ * - $mode: Display mode.
+ * - $just_voted: Indicator whether the user has just voted (boolean).
+ * - $content_type: "node" or "comment".
+ * - $content_id: Node or comment id.
+ * - $buttons: Array with themed buttons (built in preprocess function).
+ * - $info: String with user readable information (built in preprocess function).
+ */
+?>
+
+<?php print $like_button . ' <div class="rate-commons-like-count">' . $results['count'] . '</div>'; ?>
diff --git a/modules/commons/commons_like/commons_like.features.field_instance.inc b/modules/commons/commons_like/commons_like.features.field_instance.inc
new file mode 100644
index 0000000..1ff8c39
--- /dev/null
+++ b/modules/commons/commons_like/commons_like.features.field_instance.inc
@@ -0,0 +1,63 @@
+<?php
+/**
+ * @file
+ * commons_like.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_like_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_like_user_likes_node-field_target_nodes'
+  $field_instances['message-commons_like_user_likes_node-field_target_nodes'] = array(
+    'bundle' => 'commons_like_user_likes_node',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => FALSE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Target nodes');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_like/commons_like.features.inc b/modules/commons/commons_like/commons_like.features.inc
new file mode 100644
index 0000000..16f1761
--- /dev/null
+++ b/modules/commons/commons_like/commons_like.features.inc
@@ -0,0 +1,46 @@
+<?php
+/**
+ * @file
+ * commons_like.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_like_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_like_default_message_type() {
+  $items = array();
+  $items['commons_like_user_likes_node'] = entity_import('message_type', '{
+    "name" : "commons_like_user_likes_node",
+    "description" : "Commons like: User likes a node",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture]",
+          "format" : "full_html",
+          "safe_value" : "[message:user:picture]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E liked the [message:field-target-nodes:0:type] \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E liked the [message:field-target-nodes:0:type] \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
diff --git a/modules/commons/commons_like/commons_like.info b/modules/commons/commons_like/commons_like.info
new file mode 100644
index 0000000..a40f432
--- /dev/null
+++ b/modules/commons/commons_like/commons_like.info
@@ -0,0 +1,15 @@
+name = Commons Like
+description = Community members can indicate that they like content and comments.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = message
+dependencies[] = rate
+dependencies[] = strongarm
+dependencies[] = votingapi
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[field_instance][] = message-commons_like_user_likes_node-field_target_nodes
+features[message_type][] = commons_like_user_likes_node
+features[variable][] = rate_widgets
\ No newline at end of file
diff --git a/modules/commons/commons_like/commons_like.install b/modules/commons/commons_like/commons_like.install
new file mode 100644
index 0000000..2bf9f50
--- /dev/null
+++ b/modules/commons/commons_like/commons_like.install
@@ -0,0 +1,12 @@
+<?php
+
+/**
+ * Set the node display setting to a valid option.
+ */
+function commons_like_update_3000() {
+    $revert = array(
+      'commons_like' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_like/commons_like.module b/modules/commons/commons_like/commons_like.module
new file mode 100644
index 0000000..49f6f2e
--- /dev/null
+++ b/modules/commons/commons_like/commons_like.module
@@ -0,0 +1,134 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Like feature.
+ */
+
+include_once 'commons_like.features.inc';
+
+/**
+ * Implements hook_features_export_alter().
+ */
+function commons_like_features_export_alter(&$export, $module_name) {
+  /* don't export strongarm anymore */
+  if($module_name == 'commons_like' && isset($export['features']['variable'])) {
+    unset($export['features']['variable']);
+  }
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+ function commons_like_strongarm_alter(&$items) {
+  // Expose the Post content type for 'liking' via the Commons_like module
+  // by altering the configuration for the Rate.module widget that it provides.
+  if (!empty($items['rate_widgets']->value)) {
+    foreach($items['rate_widgets']->value as $key => $widget) {
+      if ($widget->name == 'commons_like') {
+        $commons_entity_integrations = commons_entity_integration_info();
+        if (!empty($commons_entity_integrations['node'])) {
+          foreach ($commons_entity_integrations['node'] as $bundle => $options) {
+            if (!isset($options['exclude_rate']) || $options['exclude_rate'] != TRUE) {
+              $items['rate_widgets']->value[$key]->node_types[] = $bundle;
+            }
+            if (!isset($options['exclude_rate_comments']) || $options['exclude_rate_comments'] != TRUE) {
+              $items['rate_widgets']->value[$key]->comment_types[] = $bundle;
+            }
+          }
+        }
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_votingapi_insert().
+ *   Create a message when a user likes a node.
+ */
+function commons_like_votingapi_insert($votes) {
+  foreach ($votes as $vote) {
+    if ($vote['tag'] == 'commons_like' && $vote['entity_type'] == 'node') {
+      $node = node_load($vote['entity_id']);
+      $message = message_create('commons_like_user_likes_node', array('uid' => $vote['uid'], 'timestamp' => $vote['timestamp']));
+      $wrapper = entity_metadata_wrapper('message', $message);
+      $wrapper->field_target_nodes[] = $node;
+      $wrapper->save();
+    }
+  }
+}
+
+/**
+ * Implements hook_votingapi_delete().
+ *   Delete a message when a user unlikes a node.
+ */
+function commons_like_votingapi_delete($votes) {
+  foreach ($votes as $vote) {
+    if (isset($vote['tag']) && $vote['tag'] == 'commons_like' && $vote['entity_type'] == 'node') {
+      if (module_exists('commons_activity_streams') && $mids = commons_like_existing_node_like_messages($vote['uid'], array($vote['entity_id']))) {
+        message_delete_multiple($mids);
+      }
+    }
+  }
+}
+
+/**
+ * Indicate whether there is an existing message about a given user
+ * liking a specific node.
+ */
+function commons_like_existing_node_like_messages($acting_uid, $target_nids) {
+  $query = new EntityFieldQuery();
+  $query->entityCondition('entity_type', 'message', '=')
+   ->propertyCondition('uid', $acting_uid)
+   ->propertyCondition('type', 'commons_like_user_likes_node', '=')
+   ->fieldCondition('field_target_nodes', 'target_id', $target_nids, 'IN')
+   ->execute();
+
+  if (!empty($query->ordered_results)) {
+    $mids = array();
+    foreach($query->ordered_results as $result) {
+      $mids[] = $result->entity_id;
+    }
+    return $mids;
+  }
+  return FALSE;
+}
+
+/**
+ * Implements hook_theme().
+ */
+function commons_like_theme() {
+  return array(
+    'rate_template_commons_like' => array(
+      'variables' => array('links' => NULL, 'results' => NULL, 'mode' => NULL, 'just_voted' => FALSE, 'content_type' => NULL, 'content_id' => NULL, 'display_options' => NULL),
+      'template' => 'commons-like',
+    ),
+  );
+}
+
+/**
+ * Implements hook_rate_templates().
+ */
+function commons_like_rate_templates() {
+  $templates = array();
+
+  $templates['commons_like'] = new stdClass();
+  $templates['commons_like']->value_type = 'points';
+  $templates['commons_like']->options = array(
+    array(1, 'like'),
+  );
+  $templates['commons_like']->theme = 'rate_template_commons_like';
+  $templates['commons_like']->css = drupal_get_path('module', 'commons_like') . '/commons-like.css';
+  $templates['commons_like']->customizable = FALSE;
+  $templates['commons_like']->translate = TRUE;
+  $templates['commons_like']->use_source_translation = TRUE;
+  $templates['commons_like']->template_title = t('Commons like');
+
+  return $templates;
+}
+
+/**
+ * Preprocess function for the commons_like template.
+ */
+function commons_like_preprocess_rate_template_commons_like(&$variables) {
+  $variables['like_button'] = theme('rate_button', array('text' => $variables['links'][0]['text'], 'href' => $variables['links'][0]['href'], 'class' => 'rate-commons-like-btn'));
+}
diff --git a/modules/commons/commons_like/commons_like.strongarm.inc b/modules/commons/commons_like/commons_like.strongarm.inc
new file mode 100644
index 0000000..7a98e8b
--- /dev/null
+++ b/modules/commons/commons_like/commons_like.strongarm.inc
@@ -0,0 +1,60 @@
+<?php
+/**
+ * @file
+ * commons_like.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_like_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'rate_widgets';
+  $strongarm->value = array(
+    1 => (object) array(
+      'name' => 'commons_like',
+      'tag' => 'commons_like',
+      'title' => 'Like',
+      'node_types' => array(
+      ),
+      'comment_types' => array(
+      ),
+      'options' => array(
+        0 => array(
+          0 => 1,
+          1 => 'like',
+        ),
+      ),
+      'template' => 'commons_like',
+      'node_display' => '2',
+      'teaser_display' => FALSE,
+      'comment_display' => '2',
+      'node_display_mode' => '1',
+      'teaser_display_mode' => '1',
+      'comment_display_mode' => '1',
+      'roles' => array(
+        2 => '2',
+        1 => 0,
+      ),
+      'allow_voting_by_author' => 0,
+      'noperm_behaviour' => '3',
+      'displayed' => '2',
+      'displayed_just_voted' => '1',
+      'description' => '',
+      'description_in_compact' => TRUE,
+      'delete_vote_on_second_click' => '1',
+      'value_type' => 'points',
+      'theme' => 'rate_template_commons_like',
+      'css' => 'profiles/commons/modules/contrib/commons_like/commons-like.css',
+      'translate' => TRUE,
+      'use_source_translation' => TRUE,
+    ),
+  );
+  $export['rate_widgets'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_like/config.rb b/modules/commons/commons_like/config.rb
new file mode 100644
index 0000000..1983ae6
--- /dev/null
+++ b/modules/commons/commons_like/config.rb
@@ -0,0 +1,25 @@
+# Require any additional compass plugins here.
+
+# Set this to the root of your project when deployed:
+http_path = "/"
+css_dir = "/"
+sass_dir = "/"
+images_dir = "images"
+
+
+output_style = :expanded
+environment = :production
+
+# To enable relative paths to assets via compass helper functions. Uncomment:
+relative_assets = true
+
+# To disable debugging comments that display the original location of your selectors. Uncomment:
+# line_comments = false
+color_output = false
+
+
+# If you prefer the indented syntax, you might want to regenerate this
+# project again passing --syntax sass, or you can uncomment this:
+# preferred_syntax = :sass
+# and then run:
+# sass-convert -R --from scss --to sass sass scss && rm -rf sass && mv scss sass
diff --git a/modules/commons/commons_like/images/like.png b/modules/commons/commons_like/images/like.png
new file mode 100644
index 0000000..4204463
Binary files /dev/null and b/modules/commons/commons_like/images/like.png differ
diff --git a/modules/commons/commons_location/commons_location.features.field_base.inc b/modules/commons/commons_location/commons_location.features.field_base.inc
new file mode 100644
index 0000000..565a109
--- /dev/null
+++ b/modules/commons/commons_location/commons_location.features.field_base.inc
@@ -0,0 +1,30 @@
+<?php
+/**
+ * @file
+ * commons_location.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_location_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_address'
+  $field_bases['field_address'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_address',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => 0,
+    'module' => 'addressfield',
+    'settings' => array(),
+    'translatable' => 0,
+    'type' => 'addressfield',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_location/commons_location.info b/modules/commons/commons_location/commons_location.info
new file mode 100644
index 0000000..c9a9974
--- /dev/null
+++ b/modules/commons/commons_location/commons_location.info
@@ -0,0 +1,9 @@
+name = Commons Location
+description = Provide a field definition for locations.
+core = 7.x
+package = Commons - Building Blocks
+dependencies[] = addressfield
+dependencies[] = features
+dependencies[] = field_sql_storage
+features[features_api][] = api:2
+features[field_base][] = field_address
diff --git a/modules/commons/commons_location/commons_location.module b/modules/commons/commons_location/commons_location.module
new file mode 100644
index 0000000..5476b39
--- /dev/null
+++ b/modules/commons/commons_location/commons_location.module
@@ -0,0 +1,5 @@
+<?php
+/**
+ * @file
+ * commons_location.module
+ */
diff --git a/modules/commons/commons_media/commons_media.css b/modules/commons/commons_media/commons_media.css
new file mode 100644
index 0000000..66d560a
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.css
@@ -0,0 +1,28 @@
+iframe,
+object,
+embed {
+  max-width: 100%;
+}
+
+video {
+  height: auto;
+  max-width: 100%;
+}
+
+.oembed {
+  height: 0;
+  overflow: hidden;
+  padding-bottom: 56.25%;
+  padding-top: 30px;
+  position: relative;
+}
+
+.oembed iframe,
+.oembed object,
+.oembed embed {
+  height: 100%;
+  left: 0;
+  position: absolute;
+  top: 0;
+  width: 100%;
+}
diff --git a/modules/commons/commons_media/commons_media.features.field_base.inc b/modules/commons/commons_media/commons_media.features.field_base.inc
new file mode 100644
index 0000000..3a93532
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.features.field_base.inc
@@ -0,0 +1,45 @@
+<?php
+/**
+ * @file
+ * commons_media.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_media_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_media'
+  $field_bases['field_media'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_media',
+    'foreign keys' => array(
+      'fid' => array(
+        'columns' => array(
+          'fid' => 'fid',
+        ),
+        'table' => 'file_managed',
+      ),
+    ),
+    'indexes' => array(
+      'fid' => array(
+        0 => 'fid',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'file',
+    'settings' => array(
+      'display_default' => 0,
+      'display_field' => 0,
+      'uri_scheme' => 'public',
+    ),
+    'translatable' => 0,
+    'type' => 'file',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_media/commons_media.features.field_instance.inc b/modules/commons/commons_media/commons_media.features.field_instance.inc
new file mode 100644
index 0000000..91e86d0
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.features.field_instance.inc
@@ -0,0 +1,98 @@
+<?php
+/**
+ * @file
+ * commons_media.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_media_field_default_field_instances() {
+  $field_instances = array();
+
+  $commons_groups_entity_types = commons_groups_get_group_content_entity_types();
+  if (!empty($commons_groups_entity_types)) {
+    foreach ($commons_groups_entity_types as $entity_type => $bundles) {
+      foreach ($bundles as $bundle => $integrations) {
+        if (!empty($integrations['media'])) {
+          commons_media_field_definition($field_instances, $entity_type, $bundle);
+        }
+      }
+    }
+  }
+
+  return $field_instances;
+}
+
+function commons_media_field_definition(&$field_instances, $entity_type, $bundle) {
+  // Exported field_instance: 'entity-bundle-field_media'
+  $field_instances["$entity_type-$bundle-field_media"] = array(
+    'bundle' => $bundle,
+    'deleted' => 0,
+    'description' => 'Attach an image or video.',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'file_entity',
+        'settings' => array(
+          'file_view_mode' => 'default',
+        ),
+        'type' => 'file_rendered',
+        'weight' => 0,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'file_entity',
+        'settings' => array(
+          'file_view_mode' => 'teaser',
+        ),
+        'type' => 'file_rendered',
+        'weight' => 0,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'field_media',
+    'label' => 'Media',
+    'required' => 0,
+    'settings' => array(
+      'description_field' => 0,
+      'file_directory' => 'media',
+      'file_extensions' => 'jpg jpeg gif png oembed mov mp4 m4v mpeg avi ogv webp webm',
+      'max_filesize' => '',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'media',
+      'settings' => array(
+        'allowed_schemes' => array(
+          'oembed' => 'oembed',
+          'public' => 'public',
+        ),
+        'allowed_types' => array(
+          'audio' => 0,
+          'document' => 0,
+          'image' => 'image',
+          'video' => 'video',
+        ),
+        'browser_plugins' => array(
+          'media_default--media_browser_1' => 0,
+          'media_default--media_browser_my_files' => 0,
+          'media_internet' => 'media_internet',
+          'upload' => 'upload',
+        ),
+        'progress_indicator' => 'throbber',
+      ),
+      'type' => 'media_generic',
+      'weight' => 2,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Attach an image or video.');
+  t('Media');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_media/commons_media.features.inc b/modules/commons/commons_media/commons_media.features.inc
new file mode 100644
index 0000000..b77b46f
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.features.inc
@@ -0,0 +1,14 @@
+<?php
+/**
+ * @file
+ * commons_media.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_media_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_media/commons_media.features.user_permission.inc b/modules/commons/commons_media/commons_media.features.user_permission.inc
new file mode 100644
index 0000000..e7a5c77
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.features.user_permission.inc
@@ -0,0 +1,64 @@
+<?php
+/**
+ * @file
+ * commons_media.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_media_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'access media browser'.
+  $permissions['access media browser'] = array(
+    'name' => 'access media browser',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'media',
+  );
+
+  // Exported permission: 'add media from remote sources'.
+  $permissions['add media from remote sources'] = array(
+    'name' => 'add media from remote sources',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'media_internet',
+  );
+
+  // Exported permission: 'create files'.
+  $permissions['create files'] = array(
+    'name' => 'create files',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'file_entity',
+  );
+
+  // Exported permission: 'delete own image files'.
+  $permissions['delete own image files'] = array(
+    'name' => 'delete own image files',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'file_entity',
+  );
+
+  // Exported permission: 'delete own video files'.
+  $permissions['delete own video files'] = array(
+    'name' => 'delete own video files',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'file_entity',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_media/commons_media.info b/modules/commons/commons_media/commons_media.info
new file mode 100644
index 0000000..276462e
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.info
@@ -0,0 +1,24 @@
+name = Commons Media
+description = Provides media handling capabilities.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = file
+dependencies[] = file_entity
+dependencies[] = media
+dependencies[] = media_internet
+dependencies[] = media_oembed
+dependencies[] = strongarm
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[field_base][] = field_media
+features[user_permission][] = access media browser
+features[user_permission][] = add media from remote sources
+features[user_permission][] = create files
+features[user_permission][] = delete own image files
+features[user_permission][] = delete own video files
+features[variable][] = file_entity_file_upload_wizard_skip_fields
+features[variable][] = file_entity_file_upload_wizard_skip_file_type
+features[variable][] = file_entity_file_upload_wizard_skip_scheme
+features[variable][] = media_dialog_theme
diff --git a/modules/commons/commons_media/commons_media.install b/modules/commons/commons_media/commons_media.install
new file mode 100644
index 0000000..e813ba7
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.install
@@ -0,0 +1,28 @@
+<?php
+
+/**
+ * @file
+ * Install, update and uninstall functions for the Commons Media module.
+ */
+
+/**
+ * Accommodate the latest changes to the Media module.
+ */
+function commons_media_update_7300() {
+  $revert = array(
+    'commons_media' => array('user_permission', 'variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Configure File Entity upload wizard settings.
+ */
+function commons_media_update_7301() {
+  $revert = array(
+    'commons_media' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_media/commons_media.module b/modules/commons/commons_media/commons_media.module
new file mode 100644
index 0000000..6a06b1f
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.module
@@ -0,0 +1,293 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Media feature.
+ */
+
+include_once 'commons_media.features.inc';
+
+// Functions to ensure that the private file system is used when embedding files in private group content.
+include_once 'commons_media.private_files.inc';
+
+/**
+ * Implements hook_system_info_alter().
+ */
+function commons_media_system_info_alter(&$info, $file, $type) {
+  if ($file->name == 'commons_media') {
+    $entity_integrations = commons_entity_integration_info();
+
+    if (!empty($entity_integrations)) {
+      foreach ($entity_integrations as $entity_type => $bundles) {
+        foreach ($bundles as $bundle => $integrations) {
+          if (!empty($integrations['media'])) {
+            $info['features']['field_instance'][] = "$entity_type-$bundle-field_media";
+          }
+        }
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_media_menu_alter(&$items) {
+  // Use a tweaked AJAX page callback for managed_file and media elements in
+  // order to bypass a core issue that occurs when more than one browsing widget
+  // tab contains a managed_file or media file field widget.
+  if (isset($items['file/ajax'])) {
+    $items['file/ajax']['page callback'] = 'commons_ajax_upload';
+  }
+  if (isset($items['media/ajax'])) {
+    $items['media/ajax']['page callback'] = 'commons_ajax_upload';
+  }
+}
+
+/**
+ * Menu callback; Shared Ajax callback for managed_file and media elements.
+ *
+ * Identical to the Ajax callback used by file.module and media.module except
+ * with the $form_build_id != $_POST['form_build_id'] check removed in order to
+ * prevent errors when more than one browsing widget tab contains a managed_file
+ * or media file field widget.
+ *
+ * @see file_ajax_upload()
+ * @see media_ajax_upload()
+ */
+function commons_ajax_upload() {
+  $form_parents = func_get_args();
+  $form_build_id = (string) array_pop($form_parents);
+
+  if (empty($_POST['form_build_id'])) {
+    // Invalid request.
+    drupal_set_message(t('An unrecoverable error occurred. The uploaded file likely exceeded the maximum file size (@size) that this server supports.', array('@size' => format_size(file_upload_max_size()))), 'error');
+    $commands = array();
+    $commands[] = ajax_command_replace(NULL, theme('status_messages'));
+    return array('#type' => 'ajax', '#commands' => $commands);
+  }
+
+  list($form, $form_state, $form_id, $form_build_id, $commands) = ajax_get_form();
+
+  if (!$form) {
+    // Invalid form_build_id.
+    drupal_set_message(t('An unrecoverable error occurred. Use of this form has expired. Try reloading the page and submitting again.'), 'error');
+    $commands = array();
+    $commands[] = ajax_command_replace(NULL, theme('status_messages'));
+    return array('#type' => 'ajax', '#commands' => $commands);
+  }
+
+  // Get the current element and count the number of files.
+  $current_element = $form;
+  foreach ($form_parents as $parent) {
+    $current_element = $current_element[$parent];
+  }
+  $current_file_count = isset($current_element['#file_upload_delta']) ? $current_element['#file_upload_delta'] : 0;
+
+  // Process user input. $form and $form_state are modified in the process.
+  drupal_process_form($form['#form_id'], $form, $form_state);
+
+  // Retrieve the element to be rendered.
+  foreach ($form_parents as $parent) {
+    $form = $form[$parent];
+  }
+
+  // Add the special Ajax class if a new file was added.
+  if (isset($form['#file_upload_delta']) && $current_file_count < $form['#file_upload_delta']) {
+    $form[$current_file_count]['#attributes']['class'][] = 'ajax-new-content';
+  }
+  // Otherwise just add the new content class on a placeholder.
+  else {
+    $form['#suffix'] .= '<span class="ajax-new-content"></span>';
+  }
+
+  $output = theme('status_messages') . drupal_render($form);
+  $js = drupal_add_js();
+  $settings = call_user_func_array('array_merge_recursive', $js['settings']['data']);
+
+  $commands[] = ajax_command_replace(NULL, $output, $settings);
+  return array('#type' => 'ajax', '#commands' => $commands);
+}
+
+/**
+ * Implements hook_element_info_alter().
+ */
+function commons_media_element_info_alter(&$type) {
+  $type['media']['#process'][] = 'commons_media_simplify_media_buttons';
+}
+
+/**
+ * Extra #process callback which simplifies the media element buttons.
+ */
+function commons_media_simplify_media_buttons($element, $edit, &$form_state) {
+  // Remove extraneous elements.
+  $element['#title_display'] = 'invisible';
+
+  return $element;
+}
+
+/**
+ * Implements hook_page_build().
+ */
+function commons_media_page_build(&$page) {
+  $page['page_bottom']['commons_media']['#attached']['css'] = array(
+    drupal_get_path('module', 'commons_media') . '/commons_media.css' => array(
+      'every_page' => TRUE,
+    ),
+  );
+}
+
+/**
+ * Implements hook_filter_default_formats_alter().
+ */
+function commons_media_filter_default_formats_alter(&$formats) {
+  if (module_exists('media_wysiwyg')) {
+    // Allow markup from remote media.
+    $formats['filtered_html']['filters']['filter_html']['settings']['allowed_html'] = '<a> <em> <strong> <u> <cite> <blockquote> <code> <ul> <ol> <li> <dl> <dt> <dd> <h4> <h5> <h6>  <p> <br> <img> <strike> <iframe></iframe>';
+
+    // Enable the media filter.
+    $formats['filtered_html']['filters'] += array(
+      'media_filter' => array(
+        'status' => 1,
+        'weight' => 2,
+      ),
+    );
+  }
+}
+
+/**
+ * Implements hook_ckeditor_profile_defaults().
+ */
+function commons_media_ckeditor_profile_defaults_alter(&$profiles) {
+  if (module_exists('media_wysiwyg')) {
+    // Disable the advanced content filter.
+    $profiles['Advanced']['settings']['allowed_content'] = 'f';
+
+    // Add the media button.
+    $profiles['Advanced']['settings']['toolbar'] = '[
+    [\'Format\'],
+    [\'Bold\',\'Italic\',\'Strike\'],
+    [\'NumberedList\',\'BulletedList\',\'Indent\',\'Outdent\',\'Blockquote\'],
+    [\'Link\',\'Unlink\',\'Media\']
+    ]';
+
+    // Load the media plugin.
+    $profiles['Advanced']['settings']['loadPlugins'] += array(
+      'media' => array(
+        'default' => 'f',
+        'desc' => 'Plugin for inserting images from Drupal media module',
+        'name' => 'media',
+        'path' => '%plugin_dir%media/',
+      ),
+    );
+  }
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ */
+function commons_media_form_file_entity_add_upload_alter(&$form, &$form_state, $form_id) {
+  // Automatically upload selected files.
+  if ($form['#step'] == 1) {
+    $form['#attached']['js'][] = drupal_get_path('module', 'commons_media') . '/commons_media_autoupload.js';
+  }
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ */
+function commons_media_form_media_internet_add_alter(&$form, &$form_state, $form_id) {
+  if (isset($form['embed_code'])) {
+    $form['embed_code']['#description'] = t('Enter a URL or link to the media you would like to embed, such as a video or image. You can upload video from a range of providers, such as YouTube, Flickr or Vimeo.');
+  }
+}
+
+/**
+ * Implements hook_media_format_form_prepare_alter().
+ */
+function commons_media_media_wysiwyg_format_form_prepare_alter(&$form, &$form_state, $media) {
+  // Remove the ability to override field values through WYSIWYG.
+  $form['options']['fields']['#access'] = FALSE;
+
+  // Attach JavaScript to automatically embed files.
+  $form['#attached']['js'][] = drupal_get_path('module', 'commons_media') . '/commons_media_autoembed.js';
+}
+
+/**
+ * Implements hook_entity_presave().
+ */
+function commons_media_entity_presave($entity, $type) {
+  // Only proceed if the private file system has been configured.
+  if (!variable_get('file_private_path', FALSE)) {
+    return;
+  }
+
+  list($entity_id, $entity_vid, $entity_bundle) = entity_extract_ids($type, $entity);
+
+  // Only proceed if the entity has been configured as group content.
+  if (!og_is_group_content_type($type, $entity_bundle)) {
+    return;
+  }
+
+  // Loop over all the file and image fields attached to this entity.
+  foreach (_commons_media_get_file_and_image_fields($entity, $type) as $field_name) {
+    // Iterate over the items arrays for each language.
+    foreach (array_keys($entity->{$field_name}) as $langcode) {
+      $items = isset($entity->{$field_name}[$langcode]) ? $entity->{$field_name}[$langcode] : array();
+
+      // Ensure that the private file system is used when attaching files to
+      // private group content.
+      foreach ($items as $delta => $item) {
+        // Move files to the private file system if the content is private.
+        if ($entity->group_content_access[LANGUAGE_NONE][0]['value'] == 2) {
+          $source_file = file_load($item['fid']);
+
+          // Only move public files.
+          if (file_uri_scheme($source_file->uri) == 'public') {
+            $usage = file_usage_list($source_file);
+
+            // Only move files that aren't currently in use.
+            if (empty($usage)) {
+              $scheme = 'private://';
+              $uri = file_stream_wrapper_uri_normalize($scheme . $source_file->filename);
+              file_move($source_file, $uri, FILE_EXISTS_RENAME);
+            }
+          }
+        }
+      }
+    }
+  }
+}
+
+/**
+ * Returns an array of image field names from a specific entity.
+ *
+ * @param $entity
+ *   The entity variable passed through hook_entity_presave().
+ * @param $type
+ *   The entity type variable passed through hook_entity_presave().
+ *
+ * @return array
+ *   An array of file and image field names or an empty array if none are found.
+ */
+function _commons_media_get_file_and_image_fields($entity, $type) {
+  $collected_fields = array();
+
+  // Determine the list of instances to iterate on.
+  list(, , $bundle) = entity_extract_ids($type, $entity);
+  $instances = field_info_instances($type, $bundle);
+  $fields = field_info_fields();
+
+  // Iterate through the instances and collect results.
+  foreach ($instances as $instance) {
+    $field_name = $instance['field_name'];
+
+    // Only collect file and image fields.
+    if ($fields[$field_name]['type'] == 'file' || $fields[$field_name]['type'] == 'image') {
+      if (isset($entity->{$field_name})) {
+        $collected_fields[] = $field_name;
+      }
+    }
+  }
+
+  return $collected_fields;
+}
diff --git a/modules/commons/commons_media/commons_media.private_files.inc b/modules/commons/commons_media/commons_media.private_files.inc
new file mode 100644
index 0000000..0721b78
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.private_files.inc
@@ -0,0 +1,126 @@
+<?php
+
+/**
+ * @file
+ * Functions related to ensuring that the private file system is used when embedding files in private group content.
+ */
+
+/**
+ * Implements hook_field_attach_insert().
+ */
+function commons_media_field_attach_insert($entity_type, $entity) {
+  _commons_media_filter_add_file_usage_from_fields($entity_type, $entity);
+}
+
+/**
+ * Implements hook_field_attach_update().
+ */
+function commons_media_field_attach_update($entity_type, $entity) {
+  _commons_media_filter_add_file_usage_from_fields($entity_type, $entity);
+}
+
+/**
+ * Ensure that the private file system is used when embedding files in private group content.
+ */
+function _commons_media_filter_add_file_usage_from_fields($entity_type, $entity) {
+  // Only proceed if the Media: WYSIWYG module is enabled.
+  if (!module_exists('media_wysiwyg')) {
+    return;
+  }
+
+  // Only proceed if the private file system has been configured.
+  if (!variable_get('file_private_path', FALSE)) {
+    return;
+  }
+
+  // Track the total usage for files from all fields combined.
+  $entity_files = commons_media_entity_field_count_files($entity_type, $entity);
+
+  list($entity_id, $entity_vid, $entity_bundle) = entity_extract_ids($entity_type, $entity);
+
+  // Only proceed if the entity has been configured as group content.
+  if (!og_is_group_content_type($entity_type, $entity_bundle)) {
+    return;
+  }
+
+  // Ensure that the private file system is used when attaching files to private
+  // group content.
+  foreach ($entity_files as $fid => $entity_count) {
+    // Move files to the private file system if the content is private.
+    if ($entity->group_content_access[LANGUAGE_NONE][0]['value'] == 2) {
+      if ($source_file = file_load($fid)) {
+
+        // Only move public files.
+        if (file_uri_scheme($source_file->uri) == 'public') {
+          $usage = file_usage_list($source_file);
+
+          // Only move files that aren't currently in use.
+          if (empty($usage)) {
+            $scheme = 'private://';
+            $uri = file_stream_wrapper_uri_normalize($scheme . $source_file->filename);
+            file_move($source_file, $uri, FILE_EXISTS_RENAME);
+          }
+        }
+      }
+    }
+  }
+}
+
+/**
+ * Utility function to get the file count in this entity
+ *
+ * @param type $entity
+ * @param type $entity_type
+ * @return int
+ */
+function commons_media_entity_field_count_files($entity_type, $entity) {
+  $entity_files = array();
+
+  foreach (commons_media_filter_parse_from_fields($entity_type, $entity) as $file_reference) {
+    if (empty($entity_files[$file_reference['fid']])) {
+      $entity_files[$file_reference['fid']] = 1;
+    }
+    else {
+      $entity_files[$file_reference['fid']]++;
+    }
+  }
+
+  return $entity_files;
+}
+
+/**
+ * Parse file references from an entity's text fields and return them as an array.
+ */
+function commons_media_filter_parse_from_fields($entity_type, $entity) {
+  $file_references = array();
+
+  foreach (media_wysiwyg_filter_fields_with_text_filtering($entity_type, $entity) as $field_name) {
+    if ($field_items = field_get_items($entity_type, $entity, $field_name)) {
+      foreach ($field_items as $field_item) {
+        preg_match_all(MEDIA_WYSIWYG_TOKEN_REGEX, $field_item['value'], $matches);
+
+        foreach ($matches[0] as $tag) {
+          $tag = str_replace(array('[[', ']]'), '', $tag);
+          $tag_info = drupal_json_decode($tag);
+
+          if (isset($tag_info['fid']) && $tag_info['type'] == 'media') {
+            $file_references[] = $tag_info;
+          }
+        }
+
+        preg_match_all(MEDIA_WYSIWYG_TOKEN_REGEX, $field_item['value'], $matches_alt);
+
+        foreach ($matches_alt[0] as $tag) {
+          $tag = urldecode($tag);
+          $tag_info = drupal_json_decode($tag);
+
+          if (isset($tag_info['fid']) && $tag_info['type'] == 'media') {
+            $file_references[] = $tag_info;
+          }
+        }
+      }
+    }
+  }
+
+  return $file_references;
+}
diff --git a/modules/commons/commons_media/commons_media.strongarm.inc b/modules/commons/commons_media/commons_media.strongarm.inc
new file mode 100644
index 0000000..50fa0a5
--- /dev/null
+++ b/modules/commons/commons_media/commons_media.strongarm.inc
@@ -0,0 +1,42 @@
+<?php
+/**
+ * @file
+ * commons_media.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_media_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'file_entity_file_upload_wizard_skip_fields';
+  $strongarm->value = 0;
+  $export['file_entity_file_upload_wizard_skip_fields'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'file_entity_file_upload_wizard_skip_file_type';
+  $strongarm->value = 1;
+  $export['file_entity_file_upload_wizard_skip_file_type'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'file_entity_file_upload_wizard_skip_scheme';
+  $strongarm->value = 1;
+  $export['file_entity_file_upload_wizard_skip_scheme'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'media_dialog_theme';
+  $strongarm->value = 'ember';
+  $export['media_dialog_theme'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_media/commons_media_autoembed.js b/modules/commons/commons_media/commons_media_autoembed.js
new file mode 100644
index 0000000..bd64f21
--- /dev/null
+++ b/modules/commons/commons_media/commons_media_autoembed.js
@@ -0,0 +1,10 @@
+(function ($) {
+
+Drupal.behaviors.autoEmbed = {
+  attach: function (context, settings) {
+    // Automatically click the submit button to embed the file.
+    $('.button.fake-ok').click();
+  }
+};
+
+})(jQuery);
diff --git a/modules/commons/commons_media/commons_media_autoupload.js b/modules/commons/commons_media/commons_media_autoupload.js
new file mode 100644
index 0000000..31a32d6
--- /dev/null
+++ b/modules/commons/commons_media/commons_media_autoupload.js
@@ -0,0 +1,20 @@
+(function ($) {
+
+Drupal.behaviors.autoUpload = {
+  attach: function (context, settings) {
+    // Loop through all of the managed file form elements on the page.
+    $('.form-managed-file').each(function(index, element) {
+      // Hide/show the file upload/remove button if a file is not present.
+      if ($(this).children('span.file').length == 0 ) {
+        $(this).children('input.form-submit').hide();
+      };
+
+      // Automatically upload the file if a file is selected.
+      $(this).delegate('input.form-file', 'change', function() {
+        $(this).siblings('input.form-submit').mousedown();
+      });
+    });
+  }
+};
+
+})(jQuery);
diff --git a/modules/commons/commons_misc/commons_misc.features.inc b/modules/commons/commons_misc/commons_misc.features.inc
new file mode 100644
index 0000000..f2ea822
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.features.inc
@@ -0,0 +1,17 @@
+<?php
+/**
+ * @file
+ * commons_misc.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_misc_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_misc/commons_misc.features.user_permission.inc b/modules/commons/commons_misc/commons_misc.features.user_permission.inc
new file mode 100644
index 0000000..1376ff2
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.features.user_permission.inc
@@ -0,0 +1,77 @@
+<?php
+/**
+ * @file
+ * commons_misc.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_misc_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'access comments'.
+  $permissions['access comments'] = array(
+    'name' => 'access comments',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'comment',
+  );
+
+  // Exported permission: 'access content'.
+  $permissions['access content'] = array(
+    'name' => 'access content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'access user profiles'.
+  $permissions['access user profiles'] = array(
+    'name' => 'access user profiles',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'user',
+  );
+
+  // Exported permission: 'post comments'.
+  $permissions['post comments'] = array(
+    'name' => 'post comments',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'comment',
+  );
+
+  // Exported permission: 'skip comment approval'.
+  $permissions['skip comment approval'] = array(
+    'name' => 'skip comment approval',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'comment',
+  );
+
+  // Exported permission: 'view own unpublished content'.
+  $permissions['view own unpublished content'] = array(
+    'name' => 'view own unpublished content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_misc/commons_misc.features.user_role.inc b/modules/commons/commons_misc/commons_misc.features.user_role.inc
new file mode 100644
index 0000000..354ec88
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.features.user_role.inc
@@ -0,0 +1,20 @@
+<?php
+/**
+ * @file
+ * commons_misc.features.user_role.inc
+ */
+
+/**
+ * Implements hook_user_default_roles().
+ */
+function commons_misc_user_default_roles() {
+  $roles = array();
+
+  // Exported role: administrator.
+  $roles['administrator'] = array(
+    'name' => 'administrator',
+    'weight' => 10,
+  );
+
+  return $roles;
+}
diff --git a/modules/commons/commons_misc/commons_misc.info b/modules/commons/commons_misc/commons_misc.info
new file mode 100644
index 0000000..c6d9557
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.info
@@ -0,0 +1,26 @@
+name = Commons Miscellaneous Configuration
+description = Various suggested bits of configuration for Commons sites.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = comment
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = node
+dependencies[] = strongarm
+dependencies[] = user
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[page_manager_handlers][] = node_view_panel_context
+features[user_permission][] = access comments
+features[user_permission][] = access content
+features[user_permission][] = access user profiles
+features[user_permission][] = post comments
+features[user_permission][] = skip comment approval
+features[user_permission][] = view own unpublished content
+features[user_role][] = administrator
+features[variable][] = navbar_libraries_variants
+features[variable][] = theme_adaptivetheme_settings
+features[variable][] = theme_commons_origins_settings
+features[variable][] = user_register
+features_exclude[dependencies][page_manager] = page_manager
diff --git a/modules/commons/commons_misc/commons_misc.install b/modules/commons/commons_misc/commons_misc.install
new file mode 100644
index 0000000..b8ab941
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.install
@@ -0,0 +1,67 @@
+<?php
+/**
+ * @file
+ * Update hooks for commons_misc related functions.
+ */
+
+/**
+ * Implements hook_install().
+ */
+function commons_misc_install() {
+  // While the administrator role will be created by Features, it will not be
+  // available yet when hook_install() is run, so we need to test for and create
+  // it here.
+  if (!$role = user_role_load_by_name('administrator')) {
+    $role = new stdClass();
+    $role->name = 'administrator';
+    $role->weight = 10;
+    user_role_save($role);
+  }
+
+  // Grant user 1 the 'administrator' role.
+  user_multiple_role_edit(array(1), 'add_role', $role->rid);
+
+  // Set the 'administrator' role as the 'administrator role'.
+  variable_set('user_admin_role', $role->rid);
+}
+
+/**
+ * Enable legacy IE settings for Commons Origins.
+ */
+function commons_misc_update_7000() {
+  // Pull the existing settings for Commons Origins so that any changes by the
+  // user are preserved.
+  $settings = variable_get('theme_commons_origins_settings', array());
+
+  // Prevent IE from falling into compatibility mode.
+  $settings['chrome_edge'] = 1;
+
+  // Enable cleartype in IE.
+  $settings['clear_type'] = 1;
+
+  // Save the new Commons Origins settings.
+  variable_set('theme_commons_origins_settings', $settings);
+}
+
+/**
+ * Assign the administrator role a larger weight.
+ */
+function commons_misc_update_7001() {
+  $revert = array(
+    'commons_misc' => array('user_role'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Configure navbar to use the source version of Modernizr since it isn't
+ * currently possible to include a minified version of the library.
+ */
+function commons_misc_update_7002() {
+  $revert = array(
+    'commons_misc' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_misc/commons_misc.module b/modules/commons/commons_misc/commons_misc.module
new file mode 100644
index 0000000..c2df42c
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.module
@@ -0,0 +1,74 @@
+<?php
+/**
+ * @file
+ * Misc Commons functionality.
+ */
+
+include_once 'commons_misc.features.inc';
+
+/**
+ * Implements hook_mail_alter();
+ */
+function commons_misc_mail_alter(&$message) {
+  if (strstr($message['to'], '@') == '@example.com') {
+    $message['send'] = FALSE;
+  }
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter();
+ */
+function commons_misc_form_post_node_form_alter(&$form, &$form_state, $form_id) {
+  // Hide revision information when creating a node.
+  if (!isset($form_state['node']->nid)) {
+    $form['revision_information']['#access'] = FALSE;
+  }
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ */
+function commons_misc_form_system_theme_settings_alter(&$form, &$form_state, $form_id) {
+  $themes_list = list_themes(TRUE);
+
+  // Filter down to just the commons_origins theme:
+  // If commons_origins theme exists
+  // If commons_origins is enabled
+  // If we're not on the general settings tab -- because args aren't set yet
+  // And we're on the commons_origin settings page, then show the color palette
+  if (isset($themes_list['commons_origins'])
+    && $themes_list['commons_origins']->status == 1
+    && !empty($form_state['build_info']['args'])
+    && $form_state['build_info']['args'][0] == 'commons_origins') {
+    // Add the color palette selection form to the apperance settings form.
+    require_once(drupal_get_path('theme', 'commons_origins') . '/commons_origins.palettes.inc');
+    commons_origins_palettes_form($form);
+  }
+}
+
+/**
+ * Implements hook_navbar().
+ */
+function commons_misc_navbar() {
+  $items = array();
+
+  // Add a link to the official commons documentation.
+  $items['documentation'] = array(
+    '#type' => 'navbar_item',
+    'tab' => array(
+      '#type' => 'link',
+      '#title' => t('Documentation'),
+      '#href' => 'https://docs.acquia.com/commons',
+      '#options' => array(
+        'attributes' => array(
+          'title' => t('Commons Documentation'),
+          'class' => array('icon', 'icon-help'),
+          'target' => '_blank',
+        ),
+      ),
+    ),
+    '#weight' => 20,
+  );
+
+  return $items;
+}
diff --git a/modules/commons/commons_misc/commons_misc.pages_default.inc b/modules/commons/commons_misc/commons_misc.pages_default.inc
new file mode 100644
index 0000000..6ebca4b
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.pages_default.inc
@@ -0,0 +1,84 @@
+<?php
+/**
+ * @file
+ * commons_misc.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_handlers().
+ */
+function commons_misc_default_page_manager_handlers() {
+  $export = array();
+
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'node_view_panel_context';
+  $handler->task = 'node_view';
+  $handler->subtask = '';
+  $handler->handler = 'panel_context';
+  $handler->weight = -98;
+  $handler->conf = array(
+    'title' => 'Fallback panel',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = 'da99dbdb-5ba9-9ab4-7944-b91485cd4086';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-deed05d0-e6bb-9b94-9d09-499090d1e5d3';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'node_content';
+    $pane->subtype = 'node_content';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'links' => 1,
+      'no_extras' => 0,
+      'override_title' => 1,
+      'override_title_text' => '',
+      'identifier' => 'fallback',
+      'link' => 0,
+      'leave_node_title' => 1,
+      'build_mode' => 'full',
+      'context' => 'argument_entity_id:node_1',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'deed05d0-e6bb-9b94-9d09-499090d1e5d3';
+    $display->content['new-deed05d0-e6bb-9b94-9d09-499090d1e5d3'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-deed05d0-e6bb-9b94-9d09-499090d1e5d3';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = 'new-deed05d0-e6bb-9b94-9d09-499090d1e5d3';
+  $handler->conf['display'] = $display;
+  $export['node_view_panel_context'] = $handler;
+
+  return $export;
+}
diff --git a/modules/commons/commons_misc/commons_misc.strongarm.inc b/modules/commons/commons_misc/commons_misc.strongarm.inc
new file mode 100644
index 0000000..53ef917
--- /dev/null
+++ b/modules/commons/commons_misc/commons_misc.strongarm.inc
@@ -0,0 +1,324 @@
+<?php
+/**
+ * @file
+ * commons_misc.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_misc_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'theme_adaptivetheme_settings';
+  $strongarm->value = array(
+    'toggle_logo' => 1,
+    'toggle_name' => 1,
+    'toggle_slogan' => 1,
+    'toggle_node_user_picture' => 1,
+    'toggle_comment_user_picture' => 1,
+    'toggle_comment_user_verification' => 1,
+    'toggle_favicon' => 1,
+    'toggle_main_menu' => 1,
+    'toggle_secondary_menu' => 1,
+    'default_logo' => 1,
+    'logo_path' => '',
+    'logo_upload' => '',
+    'default_favicon' => 1,
+    'favicon_path' => '',
+    'favicon_upload' => '',
+    'bigscreen_layout' => 'three_col_grail',
+    'bigscreen_sidebar_unit' => '%',
+    'bigscreen_sidebar_first' => '25',
+    'bigscreen_sidebar_second' => '25',
+    'bigscreen_page_unit' => '%',
+    'bigscreen_page_width' => '100',
+    'bigscreen_set_max_width' => '1',
+    'bigscreen_max_width_unit' => 'px',
+    'bigscreen_max_width' => '1140',
+    'bigscreen_media_query' => 'only screen and (min-width:1025px)',
+    'tablet_landscape_layout' => 'three_col_grail',
+    'tablet_landscape_sidebar_unit' => '%',
+    'tablet_landscape_sidebar_first' => '20',
+    'tablet_landscape_sidebar_second' => '20',
+    'tablet_landscape_page_unit' => '%',
+    'tablet_landscape_page_width' => '100',
+    'tablet_landscape_media_query' => 'only screen and (min-width:769px) and (max-width:1024px)',
+    'tablet_portrait_layout' => 'one_col_vert',
+    'tablet_portrait_sidebar_unit' => '%',
+    'tablet_portrait_sidebar_first' => '50',
+    'tablet_portrait_sidebar_second' => '50',
+    'tablet_portrait_page_unit' => '%',
+    'tablet_portrait_page_width' => '100',
+    'tablet_portrait_media_query' => 'only screen and (min-width:481px) and (max-width:768px)',
+    'smartphone_landscape_layout' => 'one_col_vert',
+    'smartphone_landscape_sidebar_unit' => '%',
+    'smartphone_landscape_sidebar_first' => '50',
+    'smartphone_landscape_sidebar_second' => '50',
+    'smartphone_landscape_media_query' => 'only screen and (min-width:321px) and (max-width:480px)',
+    'smartphone_landscape_page_width' => '100',
+    'smartphone_landscape_page_unit' => '%',
+    'smartphone_portrait_media_query' => 'only screen and (max-width:320px)',
+    'smartphone_portrait_page_width' => '',
+    'smartphone_portrait_page_unit' => '',
+    'smartphone_portrait_sidebar_first' => '',
+    'smartphone_portrait_sidebar_second' => '',
+    'smartphone_portrait_sidebar_unit' => '',
+    'smartphone_portrait_layout' => '',
+    'bigscreen_two_brick' => 'two-brick',
+    'bigscreen_two_66_33' => 'two-66-33',
+    'bigscreen_two_50' => 'two-50',
+    'bigscreen_two_33_66' => 'two-33-66',
+    'bigscreen_three_50_25_25' => 'three-50-25-25',
+    'bigscreen_three_3x33' => 'three-3x33',
+    'bigscreen_three_25_50_25' => 'three-25-50-25',
+    'bigscreen_three_25_25_50' => 'three-25-25-50',
+    'bigscreen_four_4x25' => 'four-4x25',
+    'bigscreen_five_5x20' => 'five-5x20-2x3-grid',
+    'bigscreen_six_6x16' => 'six-6x16-3x2-grid',
+    'bigscreen_three_inset_right' => 'three-inset-right',
+    'bigscreen_three_inset_left' => 'three-inset-left',
+    'tablet_landscape_two_brick' => 'two-brick',
+    'tablet_landscape_two_66_33' => 'two-66-33',
+    'tablet_landscape_two_50' => 'two-50',
+    'tablet_landscape_two_33_66' => 'two-33-66',
+    'tablet_landscape_three_50_25_25' => 'three-50-25-25',
+    'tablet_landscape_three_3x33' => 'three-3x33',
+    'tablet_landscape_three_25_50_25' => 'three-25-50-25',
+    'tablet_landscape_three_25_25_50' => 'three-25-25-50',
+    'tablet_landscape_four_4x25' => 'four-4x25',
+    'tablet_landscape_five_5x20' => 'five-5x20-2x3-grid',
+    'tablet_landscape_six_6x16' => 'six-6x16-3x2-grid',
+    'tablet_landscape_three_inset_right' => 'three-inset-right',
+    'tablet_landscape_three_inset_left' => 'three-inset-left',
+    'tablet_portrait_two_brick' => 'two-brick',
+    'tablet_portrait_two_66_33' => 'two-66-33',
+    'tablet_portrait_two_50' => 'two-50',
+    'tablet_portrait_two_33_66' => 'two-33-66',
+    'tablet_portrait_three_50_25_25' => 'three-50-25-25-stack-top',
+    'tablet_portrait_three_3x33' => 'three-3x33-stack-top',
+    'tablet_portrait_three_25_50_25' => 'three-25-50-25-stack-top',
+    'tablet_portrait_three_25_25_50' => 'three-25-25-50-stack-top',
+    'tablet_portrait_four_4x25' => 'four-4x25-2x2-grid',
+    'tablet_portrait_five_5x20' => 'five-5x20-1x2x2-grid',
+    'tablet_portrait_six_6x16' => 'six-6x16-2x3-grid',
+    'tablet_portrait_three_inset_right' => 'three-inset-right-wrap',
+    'tablet_portrait_three_inset_left' => 'three-inset-left-wrap',
+    'smartphone_landscape_two_brick' => 'two-brick-stack',
+    'smartphone_landscape_two_66_33' => 'two-66-33-stack',
+    'smartphone_landscape_two_50' => 'two-50-stack',
+    'smartphone_landscape_two_33_66' => 'two-33-66-stack',
+    'smartphone_landscape_three_50_25_25' => 'three-50-25-25-stack',
+    'smartphone_landscape_three_3x33' => 'three-3x33-stack',
+    'smartphone_landscape_three_25_50_25' => 'three-25-50-25-stack',
+    'smartphone_landscape_three_25_25_50' => 'three-25-25-50-stack',
+    'smartphone_landscape_four_4x25' => 'four-4x25-stack',
+    'smartphone_landscape_five_5x20' => 'five-5x20-stack',
+    'smartphone_landscape_six_6x16' => 'six-6x16-stack',
+    'smartphone_landscape_three_inset_right' => 'three-inset-right-stack',
+    'smartphone_landscape_three_inset_left' => 'three-inset-left-stack',
+    'enable_custom_media_queries' => '1',
+    'global_default_layout_toggle' => '0',
+    'global_default_layout' => 'smartphone-portrait',
+    'global_files_path' => 'public_files',
+    'custom_files_path' => '',
+    'disable_responsive_styles' => '0',
+    'load_html5js' => '1',
+    'load_onmediaqueryjs' => '0',
+    'load_ltie8css' => '0',
+    'load_respondjs' => '0',
+    'load_scalefixjs' => '0',
+    'adaptivetheme_meta_viewport' => 'width=device-width, initial-scale=1',
+    'adaptivetheme_meta_mobileoptimized' => 'width',
+    'adaptivetheme_meta_handheldfriendly' => 'true',
+    'adaptivetheme_meta_apple_mobile_web_app_capable' => 'yes',
+    'chrome_edge' => '0',
+    'clear_type' => '0',
+    'expose_regions' => '0',
+    'show_window_size' => '0',
+    'atcore_version_test' => 0,
+    'load_all_panels' => '0',
+    'load_all_panels_no_sidebars' => '0',
+    'enable_extensions' => '0',
+    'enable_font_settings' => '0',
+    'enable_heading_settings' => '0',
+    'enable_image_settings' => '0',
+    'enable_apple_touch_icons' => '0',
+    'enable_exclude_css' => '0',
+    'enable_custom_css' => '0',
+    'enable_context_regions' => '0',
+    'enable_float_region_blocks' => '0',
+    'enable_markup_overides' => '0',
+    'at-settings__active_tab' => '',
+    'at_core' => '7.x-3.x',
+  );
+  $export['theme_adaptivetheme_settings'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'theme_commons_origins_settings';
+  $strongarm->value = array(
+    'toggle_logo' => 1,
+    'toggle_name' => 1,
+    'toggle_slogan' => 1,
+    'toggle_node_user_picture' => 1,
+    'toggle_comment_user_picture' => 1,
+    'toggle_comment_user_verification' => 1,
+    'toggle_favicon' => 1,
+    'toggle_main_menu' => 1,
+    'toggle_secondary_menu' => 1,
+    'default_logo' => 1,
+    'logo_path' => '',
+    'logo_upload' => '',
+    'default_favicon' => 1,
+    'favicon_path' => '',
+    'favicon_upload' => '',
+    'bigscreen_layout' => 'three_col_grail',
+    'bigscreen_sidebar_unit' => 'px',
+    'bigscreen_sidebar_first' => '285',
+    'bigscreen_sidebar_second' => '285',
+    'bigscreen_page_unit' => 'px',
+    'bigscreen_page_width' => '935',
+    'bigscreen_set_max_width' => 1,
+    'bigscreen_max_width_unit' => 'px',
+    'bigscreen_max_width' => '935',
+    'bigscreen_media_query' => 'only screen and (min-width:935px)',
+    'tablet_landscape_layout' => 'three_col_grail',
+    'tablet_landscape_sidebar_unit' => '%',
+    'tablet_landscape_sidebar_first' => '20',
+    'tablet_landscape_sidebar_second' => '20',
+    'tablet_landscape_page_unit' => '%',
+    'tablet_landscape_page_width' => '100',
+    'tablet_landscape_media_query' => 'only screen and (min-width:769px) and (max-width:934px)',
+    'tablet_portrait_layout' => 'one_col_vert',
+    'tablet_portrait_sidebar_unit' => '%',
+    'tablet_portrait_sidebar_first' => '50',
+    'tablet_portrait_sidebar_second' => '50',
+    'tablet_portrait_page_unit' => '%',
+    'tablet_portrait_page_width' => '100',
+    'tablet_portrait_media_query' => 'only screen and (min-width:481px) and (max-width:768px)',
+    'smartphone_landscape_layout' => 'one_col_vert',
+    'smartphone_landscape_sidebar_unit' => '%',
+    'smartphone_landscape_sidebar_first' => '50',
+    'smartphone_landscape_sidebar_second' => '50',
+    'smartphone_landscape_media_query' => 'only screen and (min-width:321px) and (max-width:480px)',
+    'smartphone_landscape_page_width' => '100',
+    'smartphone_landscape_page_unit' => '%',
+    'smartphone_portrait_media_query' => 'only screen and (max-width:320px)',
+    'smartphone_portrait_page_width' => '100',
+    'smartphone_portrait_page_unit' => '%',
+    'smartphone_portrait_sidebar_first' => '100',
+    'smartphone_portrait_sidebar_second' => '100',
+    'smartphone_portrait_sidebar_unit' => '%',
+    'smartphone_portrait_layout' => 'one_col_stack',
+    'bigscreen_two_brick' => 'two-brick',
+    'bigscreen_two_66_33' => 'two-66-33',
+    'bigscreen_two_50' => 'two-50',
+    'bigscreen_two_33_66' => 'two-33-66',
+    'bigscreen_three_50_25_25' => 'three-50-25-25',
+    'bigscreen_three_3x33' => 'three-3x33',
+    'bigscreen_three_25_50_25' => 'three-25-50-25',
+    'bigscreen_three_25_25_50' => 'three-25-25-50',
+    'bigscreen_four_4x25' => 'four-4x25',
+    'bigscreen_five_5x20' => 'five-5x20-2x3-grid',
+    'bigscreen_six_6x16' => 'six-6x16-3x2-grid',
+    'bigscreen_three_inset_right' => 'three-inset-right',
+    'bigscreen_three_inset_left' => 'three-inset-left',
+    'tablet_landscape_two_brick' => 'two-brick',
+    'tablet_landscape_two_66_33' => 'two-66-33',
+    'tablet_landscape_two_50' => 'two-50',
+    'tablet_landscape_two_33_66' => 'two-33-66',
+    'tablet_landscape_three_50_25_25' => 'three-50-25-25',
+    'tablet_landscape_three_3x33' => 'three-3x33',
+    'tablet_landscape_three_25_50_25' => 'three-25-50-25',
+    'tablet_landscape_three_25_25_50' => 'three-25-25-50',
+    'tablet_landscape_four_4x25' => 'four-4x25',
+    'tablet_landscape_five_5x20' => 'five-5x20-2x3-grid',
+    'tablet_landscape_six_6x16' => 'six-6x16-3x2-grid',
+    'tablet_landscape_three_inset_right' => 'three-inset-right',
+    'tablet_landscape_three_inset_left' => 'three-inset-left',
+    'tablet_portrait_two_brick' => 'two-brick',
+    'tablet_portrait_two_66_33' => 'two-66-33',
+    'tablet_portrait_two_50' => 'two-50',
+    'tablet_portrait_two_33_66' => 'two-33-66',
+    'tablet_portrait_three_50_25_25' => 'three-50-25-25-stack-top',
+    'tablet_portrait_three_3x33' => 'three-3x33-stack-top',
+    'tablet_portrait_three_25_50_25' => 'three-25-50-25-stack-top',
+    'tablet_portrait_three_25_25_50' => 'three-25-25-50-stack-top',
+    'tablet_portrait_four_4x25' => 'four-4x25-2x2-grid',
+    'tablet_portrait_five_5x20' => 'five-5x20-1x2x2-grid',
+    'tablet_portrait_six_6x16' => 'six-6x16-2x3-grid',
+    'tablet_portrait_three_inset_right' => 'three-inset-right-wrap',
+    'tablet_portrait_three_inset_left' => 'three-inset-left-wrap',
+    'smartphone_landscape_two_brick' => 'two-brick-stack',
+    'smartphone_landscape_two_66_33' => 'two-66-33-stack',
+    'smartphone_landscape_two_50' => 'two-50-stack',
+    'smartphone_landscape_two_33_66' => 'two-33-66-stack',
+    'smartphone_landscape_three_50_25_25' => 'three-50-25-25-stack',
+    'smartphone_landscape_three_3x33' => 'three-3x33-stack',
+    'smartphone_landscape_three_25_50_25' => 'three-25-50-25-stack',
+    'smartphone_landscape_three_25_25_50' => 'three-25-25-50-stack',
+    'smartphone_landscape_four_4x25' => 'four-4x25-stack',
+    'smartphone_landscape_five_5x20' => 'five-5x20-stack',
+    'smartphone_landscape_six_6x16' => 'six-6x16-stack',
+    'smartphone_landscape_three_inset_right' => 'three-inset-right-stack',
+    'smartphone_landscape_three_inset_left' => 'three-inset-left-stack',
+    'enable_custom_media_queries' => 1,
+    'global_default_layout_toggle' => 0,
+    'global_default_layout' => 'smartphone-portrait',
+    'global_files_path' => 'public_files',
+    'custom_files_path' => '',
+    'disable_responsive_styles' => 0,
+    'load_html5js' => 1,
+    'load_onmediaqueryjs' => 0,
+    'load_ltie8css' => 0,
+    'load_respondjs' => 0,
+    'load_scalefixjs' => 0,
+    'adaptivetheme_meta_viewport' => 'width=device-width, initial-scale=1',
+    'adaptivetheme_meta_mobileoptimized' => 'width',
+    'adaptivetheme_meta_handheldfriendly' => 'true',
+    'adaptivetheme_meta_apple_mobile_web_app_capable' => 'yes',
+    'chrome_edge' => 1,
+    'clear_type' => 1,
+    'expose_regions' => 0,
+    'show_window_size' => 0,
+    'atcore_version_test' => 0,
+    'load_all_panels' => 0,
+    'load_all_panels_no_sidebars' => 0,
+    'enable_extensions' => 0,
+    'enable_font_settings' => 0,
+    'enable_heading_settings' => 0,
+    'enable_image_settings' => 0,
+    'enable_apple_touch_icons' => 0,
+    'enable_exclude_css' => 0,
+    'enable_custom_css' => 0,
+    'enable_context_regions' => 0,
+    'enable_float_region_blocks' => 0,
+    'enable_markup_overides' => 0,
+    'at-settings__active_tab' => 'edit-bigscreen',
+    'at_core' => '7.x-3.x',
+  );
+  $export['theme_commons_origins_settings'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'navbar_libraries_variants';
+  $strongarm->value = array(
+    'modernizr' => 'source',
+  );
+  $export['navbar_libraries_variants'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_register';
+  $strongarm->value = '1';
+  $export['user_register'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_notices/commons_notices.features.field_instance.inc b/modules/commons/commons_notices/commons_notices.features.field_instance.inc
new file mode 100644
index 0000000..99a6cc3
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.features.field_instance.inc
@@ -0,0 +1,62 @@
+<?php
+/**
+ * @file
+ * commons_notices.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_notices_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'node-notice-body'
+  $field_instances['node-notice-body'] = array(
+    'bundle' => 'notice',
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 0,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => FALSE,
+    'settings' => array(
+      'display_summary' => FALSE,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => -4,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_notices/commons_notices.features.inc b/modules/commons/commons_notices/commons_notices.features.inc
new file mode 100644
index 0000000..bc5e24e
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.features.inc
@@ -0,0 +1,39 @@
+<?php
+/**
+ * @file
+ * commons_notices.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_notices_ctools_plugin_api() {
+  list($module, $api) = func_get_args();
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_notices_views_api() {
+  return array("version" => "3.0");
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_notices_node_info() {
+  $items = array(
+    'notice' => array(
+      'name' => t('Notice'),
+      'base' => 'node_content',
+      'description' => 'Display an administrative alert for your website users, such as planned system maintenance.',
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_notices/commons_notices.info b/modules/commons/commons_notices/commons_notices.info
new file mode 100644
index 0000000..db2c418
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.info
@@ -0,0 +1,29 @@
+name = Commons Notices
+core = 7.x
+package = Commons - Content types
+php = 5.2.4
+dependencies[] = commons_body
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = node
+dependencies[] = strongarm
+dependencies[] = text
+dependencies[] = views
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:1
+features[field_instance][] = node-notice-body
+features[node][] = notice
+features[variable][] = comment_anonymous_notice
+features[variable][] = comment_default_mode_notice
+features[variable][] = comment_default_per_page_notice
+features[variable][] = comment_form_location_notice
+features[variable][] = comment_notice
+features[variable][] = comment_preview_notice
+features[variable][] = comment_subject_field_notice
+features[variable][] = menu_options_notice
+features[variable][] = menu_parent_notice
+features[variable][] = node_options_notice
+features[variable][] = node_preview_notice
+features[variable][] = node_submitted_notice
+features[views_view][] = commons_notices_latest_notices
diff --git a/modules/commons/commons_notices/commons_notices.install b/modules/commons/commons_notices/commons_notices.install
new file mode 100644
index 0000000..69ea93e
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.install
@@ -0,0 +1,12 @@
+<?php
+
+/**
+ * Disable summary on Notice nodes.
+ */
+function commons_notices_update_7000() {
+    $revert = array(
+      'commons_notices' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_notices/commons_notices.module b/modules/commons/commons_notices/commons_notices.module
new file mode 100644
index 0000000..f19998c
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Notices feature.
+ */
+
+include_once 'commons_notices.features.inc';
diff --git a/modules/commons/commons_notices/commons_notices.strongarm.inc b/modules/commons/commons_notices/commons_notices.strongarm.inc
new file mode 100644
index 0000000..6c5b955
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.strongarm.inc
@@ -0,0 +1,103 @@
+<?php
+/**
+ * @file
+ * commons_notices.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_notices_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_notice';
+  $strongarm->value = 0;
+  $export['comment_anonymous_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_notice';
+  $strongarm->value = 1;
+  $export['comment_default_mode_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_notice';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_notice';
+  $strongarm->value = 1;
+  $export['comment_form_location_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_notice';
+  $strongarm->value = '0';
+  $export['comment_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_notice';
+  $strongarm->value = '1';
+  $export['comment_preview_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_notice';
+  $strongarm->value = 1;
+  $export['comment_subject_field_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_notice';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_notice';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_notice';
+  $strongarm->value = array(
+    0 => 'status',
+    1 => 'promote',
+  );
+  $export['node_options_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_notice';
+  $strongarm->value = '1';
+  $export['node_preview_notice'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_notice';
+  $strongarm->value = 0;
+  $export['node_submitted_notice'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_notices/commons_notices.views_default.inc b/modules/commons/commons_notices/commons_notices.views_default.inc
new file mode 100644
index 0000000..9f90785
--- /dev/null
+++ b/modules/commons/commons_notices/commons_notices.views_default.inc
@@ -0,0 +1,118 @@
+<?php
+/**
+ * @file
+ * commons_notices.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_notices_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_notices_latest_notices';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Notices - Latest Notices';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Community Notices';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['query_comment'] = FALSE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  $handler->display->display_options['row_options']['links'] = FALSE;
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['content'] = 'There are no results.';
+  $handler->display->display_options['empty']['area']['format'] = 'plain_text';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'Post date';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type_1']['id'] = 'type_1';
+  $handler->display->display_options['filters']['type_1']['table'] = 'node';
+  $handler->display->display_options['filters']['type_1']['field'] = 'type';
+  $handler->display->display_options['filters']['type_1']['value'] = array(
+    'notice' => 'notice',
+  );
+  $handler->display->display_options['filters']['type_1']['group'] = 1;
+
+  /* Display: Latest Notices Block */
+  $handler = $view->new_display('block', 'Latest Notices Block', 'block_2');
+  $handler->display->display_options['defaults']['title'] = FALSE;
+  $handler->display->display_options['title'] = 'Latest Notices';
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $translatables['commons_notices_latest_notices'] = array(
+    t('Master'),
+    t('Community Notices'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('There are no results.'),
+    t('OG membership from node'),
+    t('Post date'),
+    t('All'),
+    t('Latest Notices Block'),
+    t('Latest Notices'),
+  );
+  $export['commons_notices_latest_notices'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_notify/commons_notify.features.field_base.inc b/modules/commons/commons_notify/commons_notify.features.field_base.inc
new file mode 100644
index 0000000..0e8596e
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.features.field_base.inc
@@ -0,0 +1,98 @@
+<?php
+/**
+ * @file
+ * commons_notify.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_notify_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_message_rendered_body'
+  $field_bases['field_message_rendered_body'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_message_rendered_body',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'text',
+    'settings' => array(),
+    'translatable' => 0,
+    'type' => 'text_long',
+  );
+
+  // Exported field_base: 'field_message_rendered_subject'
+  $field_bases['field_message_rendered_subject'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_message_rendered_subject',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'text',
+    'settings' => array(
+      'max_length' => 255,
+    ),
+    'translatable' => 0,
+    'type' => 'text',
+  );
+
+  // Exported field_base: 'message_subscribe_email'
+  $field_bases['message_subscribe_email'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(
+      0 => 'user',
+    ),
+    'field_name' => 'message_subscribe_email',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => 'Don\'t email',
+        1 => 'Email',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => 0,
+    'type' => 'list_boolean',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_notify/commons_notify.features.field_instance.inc b/modules/commons/commons_notify/commons_notify.features.field_instance.inc
new file mode 100644
index 0000000..d03df1f
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.features.field_instance.inc
@@ -0,0 +1,786 @@
+<?php
+/**
+ * @file
+ * commons_notify.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_notify_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_notify_comment_created-field_message_rendered_body'
+  $field_instances['message-commons_notify_comment_created-field_message_rendered_body'] = array(
+    'bundle' => 'commons_notify_comment_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_body',
+    'label' => 'Body',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 5,
+      ),
+      'type' => 'text_textarea',
+      'weight' => 6,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_comment_created-field_message_rendered_subject'
+  $field_instances['message-commons_notify_comment_created-field_message_rendered_subject'] = array(
+    'bundle' => 'commons_notify_comment_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 3,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_subject',
+    'label' => 'Subject',
+    'required' => FALSE,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'size' => 60,
+      ),
+      'type' => 'text_textfield',
+      'weight' => 8,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_comment_created-field_target_comments'
+  $field_instances['message-commons_notify_comment_created-field_target_comments'] = array(
+    'bundle' => 'commons_notify_comment_created',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 1,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 5,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 5,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_comments',
+    'label' => 'Target comment',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 4,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_comment_created-field_target_nodes'
+  $field_instances['message-commons_notify_comment_created-field_target_nodes'] = array(
+    'bundle' => 'commons_notify_comment_created',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 6,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 6,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_comment_created_no_groups-field_message_rendered_body'
+  $field_instances['message-commons_notify_comment_created_no_groups-field_message_rendered_body'] = array(
+    'bundle' => 'commons_notify_comment_created_no_groups',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_body',
+    'label' => 'Body',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 5,
+      ),
+      'type' => 'text_textarea',
+      'weight' => 6,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_comment_created_no_groups-field_message_rendered_subject'
+  $field_instances['message-commons_notify_comment_created_no_groups-field_message_rendered_subject'] = array(
+    'bundle' => 'commons_notify_comment_created_no_groups',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 3,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_subject',
+    'label' => 'Subject',
+    'required' => FALSE,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'size' => 60,
+      ),
+      'type' => 'text_textfield',
+      'weight' => 8,
+    ),
+  );
+
+
+  // Exported field_instance: 'message-commons_notify_comment_created_no_groups-field_target_comments'
+  $field_instances['message-commons_notify_comment_created_no_groups-field_target_comments'] = array(
+    'bundle' => 'commons_notify_comment_created_no_groups',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 1,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 5,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 5,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_comments',
+    'label' => 'Target comment',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 4,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_comment_created_no_groups-field_target_nodes'
+  $field_instances['message-commons_notify_comment_created_no_groups-field_target_nodes'] = array(
+    'bundle' => 'commons_notify_comment_created_no_groups',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 6,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 6,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_node_created-field_message_rendered_body'
+  $field_instances['message-commons_notify_node_created-field_message_rendered_body'] = array(
+    'bundle' => 'commons_notify_node_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 1,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_body',
+    'label' => 'Body',
+    'required' => FALSE,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 5,
+      ),
+      'type' => 'text_textarea',
+      'weight' => 4,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_node_created-field_message_rendered_subject'
+  $field_instances['message-commons_notify_node_created-field_message_rendered_subject'] = array(
+    'bundle' => 'commons_notify_node_created',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 2,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 1,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_subject',
+    'label' => 'Subject',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => 255,
+      ),
+      'type' => 'text_textfield',
+      'weight' => 3,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_node_created-field_target_nodes'
+  $field_instances['message-commons_notify_node_created-field_target_nodes'] = array(
+    'bundle' => 'commons_notify_node_created',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_node_created_no_groups-field_message_rendered_body'
+  $field_instances['message-commons_notify_node_created_no_groups-field_message_rendered_body'] = array(
+    'bundle' => 'commons_notify_node_created_no_groups',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 1,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_body',
+    'label' => 'Body',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 5,
+      ),
+      'type' => 'text_textarea',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_node_created_no_groups-field_message_rendered_subject'
+  $field_instances['message-commons_notify_node_created_no_groups-field_message_rendered_subject'] = array(
+    'bundle' => 'commons_notify_node_created_no_groups',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_message_rendered_subject',
+    'label' => 'Subject',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => 60,
+      ),
+      'type' => 'text_textfield',
+      'weight' => 3,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_notify_node_created_no_groups-field_target_nodes'
+  $field_instances['message-commons_notify_node_created_no_groups-field_target_nodes'] = array(
+    'bundle' => 'commons_notify_node_created_no_groups',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 0,
+    ),
+  );
+
+  // Exported field_instance: 'message_type-commons_notify-message_text'
+  $field_instances['message_type-commons_notify-message_text'] = array(
+    'bundle' => 'commons_notify',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => 'This is the text of all messages of this type.',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message_type',
+    'field_name' => 'message_text',
+    'label' => 'Message text',
+    'required' => TRUE,
+    'settings' => array(
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 5,
+      ),
+      'type' => 'text_textarea',
+      'weight' => 0,
+    ),
+  );
+
+  // Exported field_instance: 'user-user-message_subscribe_email'
+  $field_instances['user-user-message_subscribe_email'] = array(
+    'bundle' => 'user',
+    'default_value' => array(
+      0 => array(
+        'value' => 1,
+      ),
+    ),
+    'deleted' => 0,
+    'description' => 'Email option will be checked automatically when subscribing to something.',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'list',
+        'settings' => array(),
+        'type' => 'list_default',
+        'weight' => 9,
+      ),
+    ),
+    'display_label' => 1,
+    'entity_type' => 'user',
+    'field_name' => 'message_subscribe_email',
+    'label' => 'Email subscriptions',
+    'required' => FALSE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'options',
+      'settings' => array(
+        'display_label' => 0,
+      ),
+      'type' => 'options_onoff',
+      'weight' => 0,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+  t('Email option will be checked automatically when subscribing to something.');
+  t('Email subscriptions');
+  t('Message text');
+  t('Subject');
+  t('Target comment');
+  t('Target nodes');
+  t('This is the text of all messages of this type.');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_notify/commons_notify.features.inc b/modules/commons/commons_notify/commons_notify.features.inc
new file mode 100644
index 0000000..529cbef
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.features.inc
@@ -0,0 +1,135 @@
+<?php
+/**
+ * @file
+ * commons_notify.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_notify_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_notify_default_message_type() {
+  $items = array();
+  $items['commons_notify_comment_created'] = entity_import('message_type', '{
+    "name" : "commons_notify_comment_created",
+    "description" : "Commons Notify: Comment created",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "commons_notify",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "New comment on [message:field-target-nodes:0:title_field] in [message:field-target-nodes:0:og-group-ref:0:title]: [message:field-target-nodes:0:title_field]",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003ENew comment on [message:field-target-nodes:0:title_field] in [message:field-target-nodes:0:og-group-ref:0:title]: [message:field-target-nodes:0:title_field]\\u003C\\/p\\u003E\\n"
+        },
+        {
+          "value" : "Hi [message:user:name],\\r\\n\\r\\n[message:field-target-comments:0:author] commented on [message:field-target-nodes:0:title_field] [commons-groups:in-groups-text]:\\r\\n\\r\\n[message:field-target-comments:0:body]\\r\\n\\r\\nRead \\u0026 respond: [message:field-target-comments:0:url]\\r\\nUpdate your notification settings: [site:url]\\/user\\/[message:user:uid]\\/notification-settings",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003EHi [message:user:name],\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-comments:0:author] commented on [message:field-target-nodes:0:title_field] [commons-groups:in-groups-text]:\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-comments:0:body]\\u003C\\/p\\u003E\\n\\u003Cp\\u003ERead \\u0026amp; respond: [message:field-target-comments:0:url]\\u003Cbr \\/\\u003E\\nUpdate your notification settings: [site:url]\\/user\\/[message:user:uid]\\/notification-settings\\u003C\\/p\\u003E\\n"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['commons_notify_comment_created_no_groups'] = entity_import('message_type', '{
+    "name" : "commons_notify_comment_created_no_groups",
+    "description" : "Commons Notify: Comment created no groups",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "commons_notify",
+    "data" : {
+      "token options" : { "clear" : 0 },
+      "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" }
+    },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "New comment on [message:field-target-nodes:0:title_field] ",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003ENew comment on [message:field-target-nodes:0:title_field]\\u003C\\/p\\u003E\\n"
+        },
+        {
+          "value" : "Hi [message:user:name],\\r\\n\\r\\n[message:field-target-comments:0:author] commented on [message:field-target-nodes:0:title_field]:\\r\\n\\r\\n[message:field-target-comments:0:body]\\r\\n\\r\\nRead \\u0026 respond: [message:field-target-comments:0:url]\\r\\nUpdate your notification settings: [site:url]\\/notification-settings",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003EHi [message:user:name],\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-comments:0:author] commented on [message:field-target-nodes:0:title_field]:\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-comments:0:body]\\u003C\\/p\\u003E\\n\\u003Cp\\u003ERead \\u0026amp; respond: [message:field-target-comments:0:url]\\u003Cbr \\/\\u003E\\nUpdate your notification settings: [site:url]\\/notification-settings\\u003C\\/p\\u003E\\n"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['commons_notify_node_created'] = entity_import('message_type', '{
+    "name" : "commons_notify_node_created",
+    "description" : "The notification sent when a user creates a node.",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "commons_notify",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "New [message:field-target-nodes:0:content-type] in [message:field-target-nodes:0:og-group-ref:0:title]: [message:field-target-nodes:0:title_field]",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003ENew [message:field-target-nodes:0:content-type] in [message:field-target-nodes:0:og-group-ref:0:title]: [message:field-target-nodes:0:title_field]\\u003C\\/p\\u003E\\n"
+        },
+        {
+          "value" : "Hi [message:user:name],\\r\\n\\r\\n[message:field-target-nodes:0:author] created the [message:field-target-nodes:0:content-type] \\u201c[message:field-target-nodes:0:title_field]\\u201d on [site:name] [commons-groups:in-groups-text] on [message:field-target-nodes:0:created]:\\r\\n\\r\\n[message:field-target-nodes:0:body]\\r\\n\\r\\n\\r\\nPermalink: [message:field-target-nodes:0:url]\\r\\nAdd a comment at [message:field-target-nodes:0:url]#comment-form\\r\\n\\r\\nChange email notifications at [site:url]user\\/[message:user:uid]\\/notification-settings",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003EHi [message:user:name],\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-nodes:0:author] created the [message:field-target-nodes:0:content-type] \\u201c[message:field-target-nodes:0:title_field]\\u201d on [site:name] [commons-groups:in-groups-text] on [message:field-target-nodes:0:created]:\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-nodes:0:body]\\u003C\\/p\\u003E\\n\\u003Cp\\u003EPermalink: [message:field-target-nodes:0:url]\\u003Cbr \\/\\u003E\\nAdd a comment at [message:field-target-nodes:0:url]#comment-form\\u003C\\/p\\u003E\\n\\u003Cp\\u003EChange email notifications at [site:url]user\\/[message:user:uid]\\/notification-settings\\u003C\\/p\\u003E\\n"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['commons_notify_node_created_no_groups'] = entity_import('message_type', '{
+    "name" : "commons_notify_node_created_no_groups",
+    "description" : "The notification sent when a user creates a node that is not in any groups",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "commons_notify",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "New [message:field-target-nodes:0:content-type] on [site:name]: [message:field-target-nodes:0:title_field]",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003ENew [message:field-target-nodes:0:content-type] on [site:name]: [message:field-target-nodes:0:title_field]\\u003C\\/p\\u003E\\n"
+        },
+        {
+          "value" : "Hi [message:user:name],\\r\\n\\r\\n[message:field-target-nodes:0:author] created the [message:field-target-nodes:0:content-type] \\u201c[message:field-target-nodes:0:title_field]\\u201d on [site:name] [commons-groups:in-groups-text] on [message:field-target-nodes:0:created]:\\r\\n\\r\\n[message:field-target-nodes:0:body]\\r\\n\\r\\n\\r\\nPermalink: [message:field-target-nodes:0:url]\\r\\nAdd a comment at [message:field-target-nodes:0:url]#comment-form\\r\\n\\r\\nChange email notifications at [site:url]user\\/[message:user:uid]\\/notification-settings",
+          "format" : "plain_text",
+          "safe_value" : "\\u003Cp\\u003EHi [message:user:name],\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-nodes:0:author] created the [message:field-target-nodes:0:content-type] \\u201c[message:field-target-nodes:0:title_field]\\u201d on [site:name] [commons-groups:in-groups-text] on [message:field-target-nodes:0:created]:\\u003C\\/p\\u003E\\n\\u003Cp\\u003E[message:field-target-nodes:0:body]\\u003C\\/p\\u003E\\n\\u003Cp\\u003EPermalink: [message:field-target-nodes:0:url]\\u003Cbr \\/\\u003E\\nAdd a comment at [message:field-target-nodes:0:url]#comment-form\\u003C\\/p\\u003E\\n\\u003Cp\\u003EChange email notifications at [site:url]user\\/[message:user:uid]\\/notification-settings\\u003C\\/p\\u003E\\n"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
+
+/**
+ * Implements hook_default_message_type_category().
+ */
+function commons_notify_default_message_type_category() {
+  $items = array();
+  $items['commons_notify'] = entity_import('message_type_category', '{
+    "category" : "commons_notify",
+    "description" : "Commons Notify",
+    "language" : "und",
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
diff --git a/modules/commons/commons_notify/commons_notify.info b/modules/commons/commons_notify/commons_notify.info
new file mode 100644
index 0000000..1e5688a
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.info
@@ -0,0 +1,50 @@
+name = Commons Notify
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_follow
+dependencies[] = ctools
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = list
+dependencies[] = message
+dependencies[] = message_subscribe
+dependencies[] = message_subscribe_email
+dependencies[] = number
+dependencies[] = options
+dependencies[] = strongarm
+dependencies[] = text
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[field_base][] = field_message_rendered_body
+features[field_base][] = field_message_rendered_subject
+features[field_base][] = message_subscribe_email
+features[field_instance][] = message-commons_notify_comment_created-field_message_rendered_body
+features[field_instance][] = message-commons_notify_comment_created-field_message_rendered_subject
+features[field_instance][] = message-commons_notify_comment_created-field_target_comments
+features[field_instance][] = message-commons_notify_comment_created-field_target_nodes
+features[field_instance][] = message-commons_notify_comment_created_no_groups-field_message_rendered_body
+features[field_instance][] = message-commons_notify_comment_created_no_groups-field_message_rendered_subject
+features[field_instance][] = message-commons_notify_comment_created_no_groups-field_target_comments
+features[field_instance][] = message-commons_notify_comment_created_no_groups-field_target_nodes
+features[field_instance][] = message-commons_notify_node_created-field_message_rendered_body
+features[field_instance][] = message-commons_notify_node_created-field_message_rendered_subject
+features[field_instance][] = message-commons_notify_node_created-field_target_nodes
+features[field_instance][] = message-commons_notify_node_created_no_groups-field_message_rendered_body
+features[field_instance][] = message-commons_notify_node_created_no_groups-field_message_rendered_subject
+features[field_instance][] = message-commons_notify_node_created_no_groups-field_target_nodes
+features[field_instance][] = message_type-commons_notify-message_text
+features[field_instance][] = user-user-message_subscribe_email
+features[message_type][] = commons_notify_comment_created
+features[message_type][] = commons_notify_comment_created_no_groups
+features[message_type][] = commons_notify_node_created
+features[message_type][] = commons_notify_node_created_no_groups
+features[message_type_category][] = commons_notify
+features[variable][] = field_bundle_settings_message__commons_notify_comment_created
+features[variable][] = field_bundle_settings_message__commons_notify_comment_created_no_groups
+features[variable][] = field_bundle_settings_message__commons_notify_node_created
+features[variable][] = field_bundle_settings_message__commons_notify_node_created_no_groups
+features[variable][] = message_subscribe_default_notifiers
+features_exclude[field_base][message_text] = message_text
+features_exclude[field_base][field_target_nodes] = field_target_nodes
+features_exclude[field_base][field_target_comments] = field_target_comments
diff --git a/modules/commons/commons_notify/commons_notify.install b/modules/commons/commons_notify/commons_notify.install
new file mode 100644
index 0000000..ba5b31a
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.install
@@ -0,0 +1,33 @@
+<?php
+
+/**
+ * Ensure that the new notifications fields are reverted.
+ */
+function commons_notify_update_7301() {
+  features_revert(array('commons_notify' => array('field_base', 'field_instance')));
+  return array();
+}
+
+/**
+ * Ensure that users' email subscription preferences are honored.
+ */
+function commons_notify_update_7302() {
+  features_revert(array('commons_notify' => array('variable')));
+  return array();
+}
+
+/**
+ * Correct the user notification settings URL.
+ */
+function commons_notify_update_7303() {
+  features_revert(array('commons_notify' => array('message_type')));
+  return array();
+}
+
+/**
+ * Add message notify for comments that have no group.
+ */
+function commons_notify_update_7304() {
+  features_revert(array('commons_notify' => array('message_type')));
+  return array();
+}
diff --git a/modules/commons/commons_notify/commons_notify.module b/modules/commons/commons_notify/commons_notify.module
new file mode 100644
index 0000000..2cfcc7d
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.module
@@ -0,0 +1,103 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Notify feature.
+ */
+
+include_once 'commons_notify.features.inc';
+
+/**
+ * Implements hook_node_insert().
+ * In order to respect node access restrictions, we register
+ * a shutdown function, because node access grants haven not been written
+ * by the time hook_node_insert() is invoked. For more background,
+ * see https://drupal.org/node/1918666.
+ *
+ */
+function commons_notify_node_insert($node) {
+  drupal_register_shutdown_function('commons_notify_send_message_on_shutdown', $node);
+}
+
+/**
+ * Send a notification for newly created nodes.
+ * This function is registered as a shutdown function
+ * in commons_notify_node_insert.
+ * Note that shutdown functions run after drupal_set_message() messages are
+ * displayed, so you'll need to use another method such as watchdog() logging
+ * if you wish to add debugging messages to this function.
+ */
+function commons_notify_send_message_on_shutdown($node) {
+  // Create a message when a user creates a new node.
+  // Borrowed from message_example.module:
+  // Save the message and assign it to the user realm. Since another user,
+  // usually an admin might create the node, but populate the author field
+  // with another user, we make sure the user realm is populated with the
+  // node's author, instead of the acting user (although in most cases it
+  // would be the same user).
+  // The following example demonstrates that we don't need to explicitly set
+  // the realm to the user, since if no realms are provided then the message
+  // is automatically assigned to the user passed in the function, or if no
+  // user object is provided, then to the acting user.
+  $message_type = 'commons_notify_node_created';
+  // We need to clear the static loading cache so that the node body will be
+  // ready in time for token replacement for the  message.
+  entity_get_controller('node')->resetCache(array($node->nid));
+  if (!isset($node->og_group_ref[LANGUAGE_NONE][0]['target_id'])) {
+    $message_type = 'commons_notify_node_created_no_groups';
+  }
+  // Allow other modules to specify an alternative messagge type to use.
+  $hook = 'node_insert';
+  drupal_alter('commons_notify_message_selection', $message_type, $hook, $node);
+  $account = user_load($node->uid);
+  $message = message_create($message_type, array('uid' => $account->uid, 'timestamp' => $node->created));
+  // Save reference to the node in the node reference field.
+  $wrapper = entity_metadata_wrapper('message', $message);
+  // We use a multiple value field in case we wish to use the same
+  // field for grouping messages in the future
+  // (eg http://drupal.org/node/1757060).
+  $wrapper->field_target_nodes[] = $node;
+  $wrapper->save();
+  $options = array(
+    'rendered fields' => array(
+      'message_notify_email_subject' => 'field_message_rendered_subject',
+      'message_notify_email_body' => 'field_message_rendered_body',
+    ),
+  );
+  message_subscribe_send_message('node', $node, $message, array('email' => $options));
+}
+
+/**
+ * Implements hook_comment_insert().
+ */
+function commons_notify_comment_insert($comment) {
+  $account = user_load($comment->uid);
+  $node = node_load($comment->nid);
+  $message_type = 'commons_notify_comment_created';
+  $hook = 'comment_insert';
+  if (!isset($node->og_group_ref[LANGUAGE_NONE][0]['target_id'])) {
+    $message_type = 'commons_notify_comment_created_no_groups';
+  }
+  drupal_alter('commons_notify_message_selection', $message_type, $hook, $comment);
+  $message = message_create($message_type, array('uid' => $account->uid, 'timestamp' => $comment->created));
+  // Save reference to the node in the node reference field, and the
+  // "publish" state (i.e. if the node is published or unpublished).
+  $wrapper = entity_metadata_wrapper('message', $message);
+  $wrapper->field_target_nodes[] = $node;
+  $wrapper->field_target_comments[] = $comment;
+
+  // The message should be published only if the node and the comment are
+  // both published.
+  // @todo: Deal with message publishing/unpublishing.
+  /*
+  $published = $node->status && $comment->status;
+  $wrapper->field_published->set($published);
+  */
+  $wrapper->save();
+  $options = array(
+    'rendered fields' => array(
+      'message_notify_email_subject' => 'field_message_rendered_subject',
+      'message_notify_email_body' => 'field_message_rendered_body',
+    ),
+  );
+  message_subscribe_send_message('comment', $comment, $message, array('email' => $options));
+}
diff --git a/modules/commons/commons_notify/commons_notify.strongarm.inc b/modules/commons/commons_notify/commons_notify.strongarm.inc
new file mode 100644
index 0000000..7908a70
--- /dev/null
+++ b/modules/commons/commons_notify/commons_notify.strongarm.inc
@@ -0,0 +1,157 @@
+<?php
+/**
+ * @file
+ * commons_notify.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_notify_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_notify_comment_created';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_notify_comment_created'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_notify_comment_created_no_groups';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_notify_comment_created_no_groups'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_notify_node_created';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_notify_node_created'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_notify_node_created_no_groups';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_notify_node_created_no_groups'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'message_subscribe_default_notifiers';
+  $strongarm->value = array();
+  $export['message_subscribe_default_notifiers'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_pages/commons_pages.features.field_instance.inc b/modules/commons/commons_pages/commons_pages.features.field_instance.inc
new file mode 100644
index 0000000..2caa003
--- /dev/null
+++ b/modules/commons/commons_pages/commons_pages.features.field_instance.inc
@@ -0,0 +1,62 @@
+<?php
+/**
+ * @file
+ * commons_pages.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_pages_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'node-page-body'
+  $field_instances['node-page-body'] = array(
+    'bundle' => 'page',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 0,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => FALSE,
+    'settings' => array(
+      'display_summary' => FALSE,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => -4,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_pages/commons_pages.features.inc b/modules/commons/commons_pages/commons_pages.features.inc
new file mode 100644
index 0000000..a5472aa
--- /dev/null
+++ b/modules/commons/commons_pages/commons_pages.features.inc
@@ -0,0 +1,31 @@
+<?php
+/**
+ * @file
+ * commons_pages.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_pages_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_pages_node_info() {
+  $items = array(
+    'page' => array(
+      'name' => t('Page'),
+      'base' => 'node_content',
+      'description' => t('Use <em>basic pages</em> for your static content, such as an \'About us\' page.'),
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_pages/commons_pages.info b/modules/commons/commons_pages/commons_pages.info
new file mode 100644
index 0000000..432107d
--- /dev/null
+++ b/modules/commons/commons_pages/commons_pages.info
@@ -0,0 +1,27 @@
+name = Commons Pages
+core = 7.x
+package = Commons - Content types
+dependencies[] = commons_body
+dependencies[] = commons_bw
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = node
+dependencies[] = strongarm
+dependencies[] = text
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[field_instance][] = node-page-body
+features[node][] = page
+features[variable][] = comment_anonymous_page
+features[variable][] = comment_default_mode_page
+features[variable][] = comment_default_per_page_page
+features[variable][] = comment_form_location_page
+features[variable][] = comment_page
+features[variable][] = comment_preview_page
+features[variable][] = comment_subject_field_page
+features[variable][] = menu_options_page
+features[variable][] = menu_parent_page
+features[variable][] = node_options_page
+features[variable][] = node_preview_page
+features[variable][] = node_submitted_page
+features[variable][] = pathauto_node_page_pattern
diff --git a/modules/commons/commons_pages/commons_pages.install b/modules/commons/commons_pages/commons_pages.install
new file mode 100644
index 0000000..2a9a148
--- /dev/null
+++ b/modules/commons/commons_pages/commons_pages.install
@@ -0,0 +1,12 @@
+<?php
+
+/**
+ * Disable summary on Page nodes.
+ */
+function commons_pages_update_7000() {
+    $revert = array(
+      'commons_pages' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_pages/commons_pages.module b/modules/commons/commons_pages/commons_pages.module
new file mode 100644
index 0000000..f3d530b
--- /dev/null
+++ b/modules/commons/commons_pages/commons_pages.module
@@ -0,0 +1,31 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Pages feature.
+ */
+
+include_once 'commons_pages.features.inc';
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+function commons_pages_strongarm_alter(&$items) {
+  // Expose the Page content type for 'liking' via the Commons_like module
+  // by altering the configuration for the Rate.module widget that it provides.
+  if (!empty($items['rate_widgets']->value)) {
+    foreach($items['rate_widgets']->value as $key => $widget) {
+      if ($widget->name == 'commons_like') {
+        if (!in_array('document', $items['rate_widgets']->value[$key]->node_types)) {
+          $items['rate_widgets']->value[$key]->node_types[] = 'page';  
+        }       
+        if (!in_array('document', $items['rate_widgets']->value[$key]->comment_types)) {
+          $items['rate_widgets']->value[$key]->comment_types[] = 'page';  
+        }
+      }
+    }
+  }
+  // Expose the Page content type for integration with Commons Groups.
+  if (isset($items['commons_groups_entity_types'])) {
+    $items['commons_groups_entity_types']->value['node']['page'] = 1;
+  }
+}
diff --git a/modules/commons/commons_pages/commons_pages.strongarm.inc b/modules/commons/commons_pages/commons_pages.strongarm.inc
new file mode 100644
index 0000000..5a33e76
--- /dev/null
+++ b/modules/commons/commons_pages/commons_pages.strongarm.inc
@@ -0,0 +1,109 @@
+<?php
+/**
+ * @file
+ * commons_pages.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_pages_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_page';
+  $strongarm->value = 0;
+  $export['comment_anonymous_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_page';
+  $strongarm->value = 1;
+  $export['comment_default_mode_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_page';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_page';
+  $strongarm->value = 1;
+  $export['comment_form_location_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_page';
+  $strongarm->value = '0';
+  $export['comment_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_page';
+  $strongarm->value = '1';
+  $export['comment_preview_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_page';
+  $strongarm->value = 1;
+  $export['comment_subject_field_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_page';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_page';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_page';
+  $strongarm->value = array(
+    0 => 'status',
+  );
+  $export['node_options_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_page';
+  $strongarm->value = '1';
+  $export['node_preview_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_page';
+  $strongarm->value = 0;
+  $export['node_submitted_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'pathauto_node_page_pattern';
+  $strongarm->value = 'content/[node:title]';
+  $export['pathauto_node_page_pattern'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_polls/commons_polls.features.field_instance.inc b/modules/commons/commons_polls/commons_polls.features.field_instance.inc
new file mode 100644
index 0000000..9ba1622
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.features.field_instance.inc
@@ -0,0 +1,64 @@
+<?php
+/**
+ * @file
+ * commons_polls.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_polls_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'node-poll-body'
+  $field_instances['node-poll-body'] = array(
+    'bundle' => 'poll',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 1,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => 0,
+    'settings' => array(
+      'display_summary' => 0,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => 2,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_polls/commons_polls.features.inc b/modules/commons/commons_polls/commons_polls.features.inc
new file mode 100644
index 0000000..a8ce91e
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.features.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * commons_polls.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_polls_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_polls_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_polls/commons_polls.features.og_features_permission.inc b/modules/commons/commons_polls/commons_polls.features.og_features_permission.inc
new file mode 100644
index 0000000..e10f92a
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.features.og_features_permission.inc
@@ -0,0 +1,52 @@
+<?php
+/**
+ * @file
+ * commons_polls.features.og_features_permission.inc
+ */
+
+/**
+ * Implements hook_og_features_default_permissions().
+ */
+function commons_polls_og_features_default_permissions() {
+  $permissions = array();
+
+  // Exported og permission: 'node:group:create poll content'
+  $permissions['node:group:create poll content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any poll content'
+  $permissions['node:group:delete any poll content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own poll content'
+  $permissions['node:group:delete own poll content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any poll content'
+  $permissions['node:group:update any poll content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own poll content'
+  $permissions['node:group:update own poll content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_polls/commons_polls.features.user_permission.inc b/modules/commons/commons_polls/commons_polls.features.user_permission.inc
new file mode 100644
index 0000000..aa3ee3d
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.features.user_permission.inc
@@ -0,0 +1,82 @@
+<?php
+/**
+ * @file
+ * commons_polls.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_polls_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'cancel own vote'.
+  $permissions['cancel own vote'] = array(
+    'name' => 'cancel own vote',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'poll',
+  );
+
+  // Exported permission: 'create poll content'.
+  $permissions['create poll content'] = array(
+    'name' => 'create poll content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete any poll content'.
+  $permissions['delete any poll content'] = array(
+    'name' => 'delete any poll content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own poll content'.
+  $permissions['delete own poll content'] = array(
+    'name' => 'delete own poll content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit any poll content'.
+  $permissions['edit any poll content'] = array(
+    'name' => 'edit any poll content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit own poll content'.
+  $permissions['edit own poll content'] = array(
+    'name' => 'edit own poll content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'vote on polls'.
+  $permissions['vote on polls'] = array(
+    'name' => 'vote on polls',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'poll',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_polls/commons_polls.info b/modules/commons/commons_polls/commons_polls.info
new file mode 100644
index 0000000..c049736
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.info
@@ -0,0 +1,46 @@
+name = Commons Polls
+description = Commons poll content type
+core = 7.x
+package = Commons - Content types
+dependencies[] = commons_body
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = og
+dependencies[] = og_ui
+dependencies[] = poll
+dependencies[] = radioactivity
+dependencies[] = strongarm
+dependencies[] = views
+dependencies[] = views_litepager
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_instance][] = node-poll-body
+features[og_features_permission][] = node:group:create poll content
+features[og_features_permission][] = node:group:delete any poll content
+features[og_features_permission][] = node:group:delete own poll content
+features[og_features_permission][] = node:group:update any poll content
+features[og_features_permission][] = node:group:update own poll content
+features[user_permission][] = cancel own vote
+features[user_permission][] = create poll content
+features[user_permission][] = delete any poll content
+features[user_permission][] = delete own poll content
+features[user_permission][] = edit any poll content
+features[user_permission][] = edit own poll content
+features[user_permission][] = vote on polls
+features[variable][] = comment_anonymous_poll
+features[variable][] = comment_default_mode_poll
+features[variable][] = comment_default_per_page_poll
+features[variable][] = comment_form_location_poll
+features[variable][] = comment_poll
+features[variable][] = comment_preview_poll
+features[variable][] = comment_subject_field_poll
+features[variable][] = field_bundle_settings_node__poll
+features[variable][] = menu_options_poll
+features[variable][] = menu_parent_poll
+features[variable][] = node_options_poll
+features[variable][] = node_preview_poll
+features[variable][] = node_submitted_poll
+features[views_view][] = commons_bw_polls
diff --git a/modules/commons/commons_polls/commons_polls.install b/modules/commons/commons_polls/commons_polls.install
new file mode 100644
index 0000000..e196d60
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.install
@@ -0,0 +1,56 @@
+<?php
+
+/**
+ * Disable summary on Poll nodes.
+ */
+function commons_polls_update_7000() {
+    $revert = array(
+      'commons_polls' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Grant users the ability to vote on polls.
+ */
+function commons_polls_update_7001() {
+    $revert = array(
+      'commons_polls' => array('user_permission'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Standardize Browsing Widget views.
+ */
+function commons_polls_update_7002() {
+  $revert = array(
+    'commons_polls' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Display sticky content at top of lists.
+ */
+function commons_polls_update_7003() {
+  $revert = array(
+    'commons_polls' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Add links to node teasers in the browsing widget.
+ */
+function commons_polls_update_7004() {
+  $revert = array(
+    'commons_polls' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_polls/commons_polls.module b/modules/commons/commons_polls/commons_polls.module
new file mode 100644
index 0000000..7e1ec8d
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.module
@@ -0,0 +1,159 @@
+<?php
+/**
+ * @file
+ * Code for the Commons polls feature.
+ */
+
+include_once 'commons_polls.features.inc';
+
+/**
+* Implements hook_commons_bw_group_widget().
+*/
+function commons_polls_commons_bw_group_widget() {
+  return array(
+    'commons_polls' => array(
+      'title' => t('Polls'),
+      'type' => 'view',
+      'vid' => 'commons_bw_polls',
+      'display' => 'default',
+      'weight' => 10,
+      'bundle' => 'poll',
+    ),
+  );
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_polls_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'poll' => array(
+        'media' => TRUE,
+        'is_group_content' => TRUE,
+      ),
+    ),
+  );
+}
+
+/**
+* Implements hook_strongarm_alter().
+*/
+ function commons_polls_strongarm_alter(&$items) {
+  // Expose the poll content type for 'liking' via the Commons_like module
+  // by altering the configuration for the Rate.module widget that it provides.
+  if (!empty($items['rate_widgets']->value)) {
+    foreach($items['rate_widgets']->value as $key => $widget) {
+      if ($widget->name == 'commons_like') {
+        if (!in_array('poll', $items['rate_widgets']->value[$key]->node_types)) {
+          $items['rate_widgets']->value[$key]->node_types[] = 'poll';
+        }
+        if (!in_array('poll', $items['rate_widgets']->value[$key]->comment_types)) {
+          $items['rate_widgets']->value[$key]->comment_types[] = 'poll';
+        }
+      }
+    }
+  }
+  // Expose the poll content type for integration with Commons Radioactivity
+  // and Commons Groups.
+  foreach (array('commons_radioactivity_entity_types', 'commons_groups_entity_types') as $key) {
+    if (isset($items[$key])) {
+      $items[$key]->value['node']['poll'] = 1;
+    }
+  }
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ *
+ * Display polls on the browsing widget main view.
+ */
+function commons_polls_views_default_views_alter(&$views) {
+  if (!empty($views['commons_bw_all'])) {
+    $views['commons_bw_all']->display['default']->display_options['filters']['type']['value']['poll'] = 'poll';
+  }
+}
+
+/**
+ * Implements hook_form_FROM_ID_alter().
+ */
+function commons_polls_form_commons_bw_partial_node_form_alter(&$form, &$form_state) {
+  if (empty($form['#entity']) || $form['#entity']->type != 'poll') {
+    return;
+  }
+
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#title_display'] = 'invisible';
+  $form['body'][$language][0]['#required'] = TRUE;
+  $form['body'][$language][0]['#placeholder'] = t('Enter a question, e.g. "What is your favorite color?"');
+  $form['body'][$language][0]['#resizable'] = FALSE;
+  $form['body']['#weight'] = -10;
+
+  // Prepare the form for collapsing.
+  $form['body']['#attributes']['class'][] = 'trigger-field';
+  foreach (array('field_media', 'field_image', 'og_group_ref', 'choice_wrapper', 'actions') as $field) {
+    if (isset($form[$field])) {
+      $form[$field]['#attributes']['class'][] = 'hideable-field';
+    }
+  }
+
+  // Add the poll choices widget.
+  $form['choice_wrapper'] = array(
+    '#tree' => FALSE,
+    '#weight' => -4,
+    '#prefix' => '<div class="hideable-field clearfix" id="poll-choice-wrapper">',
+    '#suffix' => '</div>',
+  );
+
+  // Container for just the poll choices.
+  $form['choice_wrapper']['choice'] = array(
+    '#prefix' => '<div id="poll-choices">',
+    '#suffix' => '</div>',
+    '#theme' => 'poll_choices',
+  );
+
+  for ($delta = 0; $delta < 10; $delta++) {
+    $form['choice_wrapper']['choice'][$delta] = _poll_choice_form($delta, NULL, '', 0, $delta);
+
+    if ($delta >= 2) {
+      $form['choice_wrapper']['choice'][$delta]['#attributes'] = array('class' => array('hidden'));
+    }
+  }
+
+  $form['choice_wrapper']['add_choice'] = array(
+    '#markup' => '<a href="#" id="add-choice">' . t('Add more choices') . '</a>',
+  );
+
+  $form['#attached']['js'] = array(drupal_get_path('module', 'commons_polls') . '/js/commons_polls_partial_form.js');
+
+  $form['actions']['submit']['#value'] = t('Create');
+
+  $form['#pre_render'][] = 'commons_polls_form_commons_bw_partial_node_form_after_build';
+
+  // Submit handler to process the choices.
+  array_unshift($form['#submit'], 'commons_polls_form_commons_bw_partial_node_form_submit');
+}
+
+/**
+ * Submit handler.
+ * Set poll settings on the node.
+ */
+function commons_polls_form_commons_bw_partial_node_form_submit(&$form, &$form_state) {
+  $node = $form['#entity'];
+  $node->choice = $form_state['values']['choice'];
+  $node->runtime = 0;
+  $node->active = TRUE;
+}
+
+/**
+ * After-build call-back.
+ * See commons_polls_form_commons_bw_partial_node_form_alter().
+ */
+function commons_polls_form_commons_bw_partial_node_form_after_build($form) {
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#pre_render'] = array();
+  $form['body'][$language][0]['format']['#access'] = FALSE;
+  $form['body'][$language][0]['value']['#rows'] = 3;
+
+  return $form;
+}
diff --git a/modules/commons/commons_polls/commons_polls.strongarm.inc b/modules/commons/commons_polls/commons_polls.strongarm.inc
new file mode 100644
index 0000000..37d558f
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.strongarm.inc
@@ -0,0 +1,120 @@
+<?php
+/**
+ * @file
+ * commons_polls.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_polls_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_poll';
+  $strongarm->value = 0;
+  $export['comment_anonymous_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_poll';
+  $strongarm->value = 1;
+  $export['comment_default_mode_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_poll';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_poll';
+  $strongarm->value = 1;
+  $export['comment_form_location_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_poll';
+  $strongarm->value = '2';
+  $export['comment_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_poll';
+  $strongarm->value = '1';
+  $export['comment_preview_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_poll';
+  $strongarm->value = 1;
+  $export['comment_subject_field_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__poll';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '-5',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_poll';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_poll';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_poll';
+  $strongarm->value = array(
+    0 => 'status',
+    1 => 'revision',
+  );
+  $export['node_options_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_poll';
+  $strongarm->value = '1';
+  $export['node_preview_poll'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_poll';
+  $strongarm->value = 1;
+  $export['node_submitted_poll'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_polls/commons_polls.views_default.inc b/modules/commons/commons_polls/commons_polls.views_default.inc
new file mode 100644
index 0000000..ff5609c
--- /dev/null
+++ b/modules/commons/commons_polls/commons_polls.views_default.inc
@@ -0,0 +1,132 @@
+<?php
+/**
+ * @file
+ * commons_polls.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_polls_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_bw_polls';
+  $view->description = 'Commons Polls listing for the group browsing widget.';
+  $view->tag = 'Commons Polls, Commons Browsing Widget';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Browsing Widget - Polls';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['query_comment'] = FALSE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '6';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* Header: Global: Node partial form */
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['id'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['table'] = 'views';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['field'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['bundle'] = 'poll';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['content'] = 'No polls have been added to this group.';
+  $handler->display->display_options['empty']['area']['format'] = 'plain_text';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Sticky */
+  $handler->display->display_options['sorts']['sticky']['id'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['table'] = 'node';
+  $handler->display->display_options['sorts']['sticky']['field'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['order'] = 'DESC';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'most recent';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'poll' => 'poll',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+  $translatables['commons_bw_polls'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No polls have been added to this group.'),
+    t('OG membership from node'),
+    t('following'),
+    t('most recent'),
+    t('most active'),
+    t('All'),
+    t('Following'),
+  );
+
+  $export['commons_bw_polls'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_polls/js/commons_polls_partial_form.js b/modules/commons/commons_polls/js/commons_polls_partial_form.js
new file mode 100644
index 0000000..968225c
--- /dev/null
+++ b/modules/commons/commons_polls/js/commons_polls_partial_form.js
@@ -0,0 +1,19 @@
+(function ($) {
+
+  // Handle the "Add more choices" link on the partial poll node form.
+  Drupal.behaviors.commons_polls_partial_form = {
+    attach: function(context) {
+      $('#add-choice').click(function(event) {
+        event.preventDefault();
+        var $hiddenRows = $('#poll-choice-table tr.hidden', context);
+        // Remove the add choices link when revealing the last available row.
+        if ($hiddenRows.length == 1) {
+          this.remove();
+        }
+        // Reveal the first hidden choice.
+        $hiddenRows.first().show('fast').removeClass('hidden');
+      });
+    }
+  }
+
+})(jQuery);
diff --git a/modules/commons/commons_posts/commons_posts.features.field_instance.inc b/modules/commons/commons_posts/commons_posts.features.field_instance.inc
new file mode 100644
index 0000000..66591ac
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.features.field_instance.inc
@@ -0,0 +1,117 @@
+<?php
+/**
+ * @file
+ * commons_posts.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_posts_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_posts_post_created-field_target_nodes'
+  $field_instances['message-commons_posts_post_created-field_target_nodes'] = array(
+    'bundle' => 'commons_posts_post_created',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'node-post-body'
+  $field_instances['node-post-body'] = array(
+    'bundle' => 'post',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 1,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => 0,
+    'settings' => array(
+      'display_summary' => 0,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => 2,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+  t('Target nodes');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_posts/commons_posts.features.inc b/modules/commons/commons_posts/commons_posts.features.inc
new file mode 100644
index 0000000..46180d3
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.features.inc
@@ -0,0 +1,75 @@
+<?php
+/**
+ * @file
+ * commons_posts.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_posts_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_posts_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_posts_default_message_type() {
+  $items = array();
+  $items['commons_posts_post_created'] = entity_import('message_type', '{
+    "name" : "commons_posts_post_created",
+    "description" : "Commons Posts - Post Created",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E posted \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E posted \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E"
+        },
+        {
+          "value" : "[commons-groups:in-groups-text]",
+          "format" : "filtered_html",
+          "safe_value" : "[commons-groups:in-groups-text]"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_posts_node_info() {
+  $items = array(
+    'post' => array(
+      'name' => t('Post'),
+      'base' => 'node_content',
+      'description' => t('Start a conversation or share some information.'),
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_posts/commons_posts.features.og_features_permission.inc b/modules/commons/commons_posts/commons_posts.features.og_features_permission.inc
new file mode 100644
index 0000000..932956b
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.features.og_features_permission.inc
@@ -0,0 +1,52 @@
+<?php
+/**
+ * @file
+ * commons_posts.features.og_features_permission.inc
+ */
+
+/**
+ * Implements hook_og_features_default_permissions().
+ */
+function commons_posts_og_features_default_permissions() {
+  $permissions = array();
+
+  // Exported og permission: 'node:group:create post content'
+  $permissions['node:group:create post content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any post content'
+  $permissions['node:group:delete any post content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own post content'
+  $permissions['node:group:delete own post content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any post content'
+  $permissions['node:group:update any post content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own post content'
+  $permissions['node:group:update own post content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_posts/commons_posts.features.user_permission.inc b/modules/commons/commons_posts/commons_posts.features.user_permission.inc
new file mode 100644
index 0000000..f3eccb2
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.features.user_permission.inc
@@ -0,0 +1,62 @@
+<?php
+/**
+ * @file
+ * commons_posts.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_posts_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'create post content'.
+  $permissions['create post content'] = array(
+    'name' => 'create post content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete any post content'.
+  $permissions['delete any post content'] = array(
+    'name' => 'delete any post content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own post content'.
+  $permissions['delete own post content'] = array(
+    'name' => 'delete own post content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit any post content'.
+  $permissions['edit any post content'] = array(
+    'name' => 'edit any post content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit own post content'.
+  $permissions['edit own post content'] = array(
+    'name' => 'edit own post content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_posts/commons_posts.info b/modules/commons/commons_posts/commons_posts.info
new file mode 100644
index 0000000..2b84e7c
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.info
@@ -0,0 +1,52 @@
+name = Commons Posts
+description = Commons Post content type
+core = 7.x
+package = Commons - Content types
+dependencies[] = commons_body
+dependencies[] = commons_bw
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = node
+dependencies[] = og
+dependencies[] = og_ui
+dependencies[] = radioactivity
+dependencies[] = strongarm
+dependencies[] = taxonomy
+dependencies[] = text
+dependencies[] = views
+dependencies[] = views_litepager
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_instance][] = message-commons_posts_post_created-field_target_nodes
+features[field_instance][] = node-post-body
+features[message_type][] = commons_posts_post_created
+features[node][] = post
+features[og_features_permission][] = node:group:create post content
+features[og_features_permission][] = node:group:delete any post content
+features[og_features_permission][] = node:group:delete own post content
+features[og_features_permission][] = node:group:update any post content
+features[og_features_permission][] = node:group:update own post content
+features[user_permission][] = create post content
+features[user_permission][] = delete any post content
+features[user_permission][] = delete own post content
+features[user_permission][] = edit any post content
+features[user_permission][] = edit own post content
+features[variable][] = comment_anonymous_post
+features[variable][] = comment_default_mode_post
+features[variable][] = comment_default_per_page_post
+features[variable][] = comment_form_location_post
+features[variable][] = comment_post
+features[variable][] = comment_preview_post
+features[variable][] = comment_subject_field_post
+features[variable][] = field_bundle_settings_message__commons_posts_post_created
+features[variable][] = field_bundle_settings_node__post
+features[variable][] = menu_options_post
+features[variable][] = menu_parent_post
+features[variable][] = node_options_post
+features[variable][] = node_preview_post
+features[variable][] = node_submitted_post
+features[views_view][] = commons_bw_posts
diff --git a/modules/commons/commons_posts/commons_posts.install b/modules/commons/commons_posts/commons_posts.install
new file mode 100644
index 0000000..688c79f
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.install
@@ -0,0 +1,67 @@
+<?php
+
+/**
+ * Disable summary on Posts nodes.
+ */
+function commons_posts_update_7000() {
+    $revert = array(
+      'commons_posts' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Provide a new "User posted [title]" message type for posts.
+ */
+function commons_posts_update_7001() {
+    $revert = array(
+      'commons_posts' => array('message_type', 'field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Remove extra markup from message type for posts.
+ */
+function commons_posts_update_7002() {
+    $revert = array(
+      'commons_posts' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Standardize Browsing Widget views.
+ */
+function commons_posts_update_7003() {
+  $revert = array(
+    'commons_posts' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Display sticky content at top of lists.
+ */
+function commons_posts_update_7004() {
+  $revert = array(
+    'commons_posts' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Add links to node teasers in the browsing widget.
+ */
+function commons_posts_update_7005() {
+  $revert = array(
+    'commons_posts' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_posts/commons_posts.module b/modules/commons/commons_posts/commons_posts.module
new file mode 100644
index 0000000..8c3b11d
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.module
@@ -0,0 +1,144 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Posts feature.
+ */
+
+include_once 'commons_posts.features.inc';
+
+/**
+* Implements hook_commons_bw_group_widget().
+*/
+function commons_posts_commons_bw_group_widget() {
+  return array(
+    'commons_posts' => array(
+      'title' => t('Posts'),
+      'type' => 'view',
+      'vid' => 'commons_bw_posts',
+      'display' => 'default',
+      'weight' => -1,
+      'bundle' => 'post',
+    ),
+  );
+}
+
+/**
+ * Implements hook_commons_bw_create_all_widget().
+ */
+function commons_posts_commons_bw_create_all_widget($group) {
+  if (og_user_access('node', $group->nid, 'create post content')) {
+    $link = l(t('Create a post'),'node/add/post',
+    array('attributes' => array('class' => 'commons-posts-create'), 'query' => array('og_group_ref' => $group->nid))
+    );
+    return array(
+      'commons_posts' => array(
+        'default' => TRUE,
+        'link' => $link,
+        'text' =>  t('Foster a topic through commenting'),
+        '#weight' => -1,
+      ),
+    );
+  }
+}
+
+/**
+ * Implements hook_form_FROM_ID_alter().
+ */
+function commons_posts_form_commons_bw_partial_node_form_alter(&$form, &$form_state) {
+  if (empty($form['#entity']) || $form['#entity']->type != 'post') {
+    return;
+  }
+
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#title_display'] = 'invisible';
+  $form['body'][$language][0]['#required'] = TRUE;
+  $form['body'][$language][0]['#placeholder'] = t("What's on your mind?");
+  $form['body'][$language][0]['#resizable'] = FALSE;
+
+  // Set fields as hideable so the forms can be compacted.
+  $form['body']['#attributes']['class'][] = 'trigger-field';
+  foreach (array('field_media', 'field_image', 'og_group_ref', 'choice_wrapper', 'actions') as $field) {
+    if (isset($form[$field])) {
+      $form[$field]['#attributes']['class'][] = 'hideable-field';
+    }
+  }
+
+  $form['actions']['submit']['#value'] = t('Post');
+  $form['#pre_render'][] = 'commons_posts_form_commons_bw_partial_node_form_after_build';
+}
+
+/**
+ * After-build call-back.
+ * See commons_posts_form_commons_bw_partial_node_form_alter().
+ */
+function commons_posts_form_commons_bw_partial_node_form_after_build($form) {
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#pre_render'] = array();
+  $form['body'][$language][0]['format']['#access'] = FALSE;
+  $form['body'][$language][0]['value']['#rows'] = 3;
+
+  return $form;
+}
+
+
+/**
+ * Implements commons_activity_streams_message_selection_alter().
+ */
+function commons_posts_commons_activity_streams_message_selection_alter(&$message_type, $hook, $node) {
+  // Use a "User posted [title]" format activity stream message.
+  if ($hook == 'node_insert' && $node->type == 'post') {
+    $message_type = 'commons_posts_post_created';
+  }
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_posts_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'post' => array(
+        'media' => TRUE,
+        'is_group_content' => TRUE,
+      ),
+    ),
+  );
+}
+
+/**
+* Implements hook_strongarm_alter().
+*/
+ function commons_posts_strongarm_alter(&$items) {
+  // Expose the Post content type for 'liking' via the Commons_like module
+  // by altering the configuration for the Rate.module widget that it provides.
+  if (!empty($items['rate_widgets']->value)) {
+    foreach($items['rate_widgets']->value as $key => $widget) {
+      if ($widget->name == 'commons_like') {
+        if (!in_array('post', $items['rate_widgets']->value[$key]->node_types)) {
+          $items['rate_widgets']->value[$key]->node_types[] = 'post';
+        }
+        if (!in_array('post', $items['rate_widgets']->value[$key]->comment_types)) {
+          $items['rate_widgets']->value[$key]->comment_types[] = 'post';
+        }
+      }
+    }
+  }
+  // Expose the post content type for integration with Commons Radioactivity
+  // and Commons Groups.
+  foreach (array('commons_radioactivity_entity_types', 'commons_groups_entity_types') as $key) {
+    if (isset($items[$key])) {
+      $items[$key]->value['node']['post'] = 1;
+    }
+  }
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ *
+ * Display posts on the browsing widget main view.
+ */
+function commons_posts_views_default_views_alter(&$views) {
+  if (!empty($views['commons_bw_all'])) {
+    $views['commons_bw_all']->display['default']->display_options['filters']['type']['value']['post'] = 'post';
+  }
+}
diff --git a/modules/commons/commons_posts/commons_posts.strongarm.inc b/modules/commons/commons_posts/commons_posts.strongarm.inc
new file mode 100644
index 0000000..e178963
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.strongarm.inc
@@ -0,0 +1,184 @@
+<?php
+/**
+ * @file
+ * commons_posts.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_posts_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_post';
+  $strongarm->value = 0;
+  $export['comment_anonymous_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_post';
+  $strongarm->value = 1;
+  $export['comment_default_mode_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_post';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_post';
+  $strongarm->value = 1;
+  $export['comment_form_location_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_post';
+  $strongarm->value = '2';
+  $export['comment_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_post';
+  $strongarm->value = '1';
+  $export['comment_preview_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_post';
+  $strongarm->value = 1;
+  $export['comment_subject_field_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_posts_post_created';
+  $strongarm->value = array(
+    'view_modes' => array(
+      'message_notify_email_subject' => array(
+        'custom_settings' => TRUE,
+      ),
+      'message_notify_email_body' => array(
+        'custom_settings' => TRUE,
+      ),
+      'full' => array(
+        'custom_settings' => FALSE,
+      ),
+      'diff_standard' => array(
+        'custom_settings' => FALSE,
+      ),
+      'token' => array(
+        'custom_settings' => FALSE,
+      ),
+    ),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'default' => array(
+            'weight' => '0',
+            'visible' => TRUE,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'default' => array(
+            'weight' => '1',
+            'visible' => TRUE,
+          ),
+        ),
+        'message__message_text__2' => array(
+          'default' => array(
+            'weight' => '2',
+            'visible' => TRUE,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_posts_post_created'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__post';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '-5',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_post';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_post';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_post';
+  $strongarm->value = array(
+    0 => 'status',
+    1 => 'revision',
+  );
+  $export['node_options_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_post';
+  $strongarm->value = '1';
+  $export['node_preview_post'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_post';
+  $strongarm->value = 1;
+  $export['node_submitted_post'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_posts/commons_posts.views_default.inc b/modules/commons/commons_posts/commons_posts.views_default.inc
new file mode 100644
index 0000000..fb7c0ea
--- /dev/null
+++ b/modules/commons/commons_posts/commons_posts.views_default.inc
@@ -0,0 +1,132 @@
+<?php
+/**
+ * @file
+ * commons_posts.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_posts_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_bw_posts';
+  $view->description = 'Commons Posts listing for the group browsing widget.';
+  $view->tag = 'Commons Posts, Commons Browsing Widget';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Browsing Widget - Posts';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['query_comment'] = FALSE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '2';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* Header: Global: Node partial form */
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['id'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['table'] = 'views';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['field'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['bundle'] = 'post';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No posts have been added to this group.';
+  $handler->display->display_options['empty']['area']['format'] = 'plain_text';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Sticky */
+  $handler->display->display_options['sorts']['sticky']['id'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['table'] = 'node';
+  $handler->display->display_options['sorts']['sticky']['field'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['order'] = 'DESC';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'most recent';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'post' => 'post',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+  $translatables['commons_bw_posts'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No posts have been added to this group.'),
+    t('OG membership from node'),
+    t('following'),
+    t('most recent'),
+    t('most active'),
+    t('All'),
+    t('Following'),
+  );
+  $export['commons_bw_posts'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_profile_base/commons_profile_base.features.field_base.inc b/modules/commons/commons_profile_base/commons_profile_base.features.field_base.inc
new file mode 100644
index 0000000..340ffe8
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.features.field_base.inc
@@ -0,0 +1,99 @@
+<?php
+/**
+ * @file
+ * commons_profile_base.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_profile_base_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_bio'
+  $field_bases['field_bio'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_bio',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'text',
+    'settings' => array(),
+    'translatable' => '0',
+    'type' => 'text_long',
+  );
+
+  // Exported field_base: 'field_name_first'
+  $field_bases['field_name_first'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_name_first',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'text',
+    'settings' => array(
+      'max_length' => '40',
+    ),
+    'translatable' => '0',
+    'type' => 'text',
+  );
+
+  // Exported field_base: 'field_name_last'
+  $field_bases['field_name_last'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_name_last',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => '0',
+    'module' => 'text',
+    'settings' => array(
+      'max_length' => '80',
+    ),
+    'translatable' => '0',
+    'type' => 'text',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_profile_base/commons_profile_base.features.field_instance.inc b/modules/commons/commons_profile_base/commons_profile_base.features.field_instance.inc
new file mode 100644
index 0000000..864cfb3
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.features.field_instance.inc
@@ -0,0 +1,122 @@
+<?php
+/**
+ * @file
+ * commons_profile_base.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_profile_base_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'user-user-field_bio'
+  $field_instances['user-user-field_bio'] = array(
+    'bundle' => 'user',
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 8,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'field_bio',
+    'label' => 'Bio',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => '0',
+      'user_register_form' => 0,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => '5',
+      ),
+      'type' => 'text_textarea',
+      'weight' => '5',
+    ),
+  );
+
+  // Exported field_instance: 'user-user-field_name_first'
+  $field_instances['user-user-field_name_first'] = array(
+    'bundle' => 'user',
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'field_name_first',
+    'label' => 'First Name',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => '0',
+      'user_register_form' => 1,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => '60',
+      ),
+      'type' => 'text_textfield',
+      'weight' => '3',
+    ),
+  );
+
+  // Exported field_instance: 'user-user-field_name_last'
+  $field_instances['user-user-field_name_last'] = array(
+    'bundle' => 'user',
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 3,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'field_name_last',
+    'label' => 'Last Name',
+    'required' => 0,
+    'settings' => array(
+      'text_processing' => '0',
+      'user_register_form' => 1,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => '60',
+      ),
+      'type' => 'text_textfield',
+      'weight' => '4',
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Bio');
+  t('First Name');
+  t('Last Name');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_profile_base/commons_profile_base.features.inc b/modules/commons/commons_profile_base/commons_profile_base.features.inc
new file mode 100644
index 0000000..94b5c81
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.features.inc
@@ -0,0 +1,15 @@
+<?php
+/**
+ * @file
+ * commons_profile_base.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_profile_base_ctools_plugin_api() {
+  list($module, $api) = func_get_args();
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_profile_base/commons_profile_base.info b/modules/commons/commons_profile_base/commons_profile_base.info
new file mode 100644
index 0000000..3ae9767
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.info
@@ -0,0 +1,24 @@
+name = Commons Profile Base
+description = Provides a base set of profile fields for user profiles.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = strongarm
+dependencies[] = text
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[field_base][] = field_bio
+features[field_base][] = field_name_first
+features[field_base][] = field_name_last
+features[field_instance][] = user-user-field_bio
+features[field_instance][] = user-user-field_name_first
+features[field_instance][] = user-user-field_name_last
+features[variable][] = realname_pattern
+features[variable][] = user_mail_register_admin_created_body
+features[variable][] = user_mail_register_no_approval_required_body
+features[variable][] = user_mail_status_activated_body
+features[variable][] = user_picture_dimensions
+features[variable][] = user_picture_file_size
+features[variable][] = user_picture_style
+features[variable][] = user_pictures
diff --git a/modules/commons/commons_profile_base/commons_profile_base.install b/modules/commons/commons_profile_base/commons_profile_base.install
new file mode 100644
index 0000000..c8541cc
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.install
@@ -0,0 +1,23 @@
+<?php
+
+/**
+ * Revert strongarm varibles related to realname recursion error.
+ */
+function commons_profile_base_update_7000() {
+    $revert = array(
+      'commons_profile_base' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Replace tokens with their raw equivalents in user registration emails.
+ */
+function commons_profile_base_update_7001() {
+  $revert = array(
+    'commons_profile_base' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_profile_base/commons_profile_base.module b/modules/commons/commons_profile_base/commons_profile_base.module
new file mode 100644
index 0000000..8e68057
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.module
@@ -0,0 +1,119 @@
+<?php
+/**
+ * @file
+ * Drupal needs this blank file.
+ */
+
+include_once 'commons_profile_base.features.inc';
+
+/**
+* Implements hook_form_FORM_ID_alter().
+*/
+function commons_profile_base_form_user_login_alter(&$form, &$form_state, $form_id) {
+  drupal_set_title(t('Log in'));
+}
+
+/**
+* Implements hook_form_FORM_ID_alter().
+*/
+function commons_profile_base_form_user_register_form_alter(&$form, &$form_state, $form_id) {
+  // Tweak the user registration form to match the Commons designs.
+  drupal_set_title(t('Sign up'));
+  $form['field_name_first']['#weight'] = -100;
+  $form['field_name_last']['#weight'] = -99;
+  if (empty($form['administer_users']['#value'])) {
+    $form['actions']['submit']['#value'] = t('Sign up');
+  }
+}
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_profile_base_menu_alter(&$items) {
+  $items['user/register']['title'] = 'Sign up';
+}
+
+/**
+ * Implements hook_modules_enabled().
+ *
+ * Replace tokens with their raw equivalents in user registration emails.
+ */
+function commons_profile_base_modules_enabled($modules) {
+  if (in_array('realname', $modules)) {
+    features_revert(array('commons_profile_base' => array('variable')));
+  }
+}
+
+/**
+ * Implements hook_modules_disabled().
+ *
+ * Restore default user registration emails.
+ */
+function commons_profile_base_modules_disabled($modules) {
+  if (in_array('realname', $modules)) {
+    features_revert(array('commons_profile_base' => array('variable')));
+  }
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+function commons_profile_base_strongarm_alter(&$items) {
+  // The default user registration emails include tokens which display user
+  // names as realnames. Realnames cannot be used for logging in or resetting
+  // passwords which leads to confusion.
+  // Replace the tokens with their raw equivalents so user emails display
+  // usernames instead of realnames.
+  if (module_exists('realname')) {
+    if (isset($items['user_mail_register_admin_created_body'])) {
+      $items['user_mail_register_admin_created_body']->value = '[user:name-raw],
+
+A site administrator at [site:name] has created an account for you. You may now log in by clicking this link or copying and pasting it to your browser:
+
+[user:one-time-login-url]
+
+This link can only be used once to log in and will lead you to a page where you can set your password.
+
+After setting your password, you will be able to log in at [site:login-url] in the future using:
+
+username: [user:name-raw]
+password: Your password
+
+--  [site:name] team';
+    }
+    if (isset($items['user_mail_register_no_approval_required_body'])) {
+      $items['user_mail_register_no_approval_required_body']->value = '[user:name-raw],
+
+Thank you for registering at [site:name]. You may now log in by clicking this link or copying and pasting it to your browser:
+
+[user:one-time-login-url]
+
+This link can only be used once to log in and will lead you to a page where you can set your password.
+
+After setting your password, you will be able to log in at [site:login-url] in the future using:
+
+username: [user:name-raw]
+password: Your password
+
+--  [site:name] team';
+    }
+    if (isset($items['user_mail_status_activated_body'])) {
+      $items['user_mail_status_activated_body']->value = '[user:name],
+
+Your account at [site:name] has been activated.
+
+You may now log in by clicking this link or copying and pasting it into your browser:
+
+[user:one-time-login-url]
+
+This link can only be used once to log in and will lead you to a page where you can set your password.
+
+After setting your password, you will be able to log in at [site:login-url] in the future using:
+
+username: [user:name-raw]
+password: Your password
+
+--  [site:name] team';
+    }
+  }
+}
diff --git a/modules/commons/commons_profile_base/commons_profile_base.strongarm.inc b/modules/commons/commons_profile_base/commons_profile_base.strongarm.inc
new file mode 100644
index 0000000..dd25435
--- /dev/null
+++ b/modules/commons/commons_profile_base/commons_profile_base.strongarm.inc
@@ -0,0 +1,111 @@
+<?php
+/**
+ * @file
+ * commons_profile_base.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_profile_base_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'realname_pattern';
+  $strongarm->value = '[user:field-name-first] [user:field-name-last]';
+  $export['realname_pattern'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_mail_register_admin_created_body';
+  $strongarm->value = '[user:name],
+
+A site administrator at [site:name] has created an account for you. You may now log in by clicking this link or copying and pasting it to your browser:
+
+[user:one-time-login-url]
+
+This link can only be used once to log in and will lead you to a page where you can set your password.
+
+After setting your password, you will be able to log in at [site:login-url] in the future using:
+
+username: [user:name]
+password: Your password
+
+--  [site:name] team';
+  $export['user_mail_register_admin_created_body'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_mail_register_no_approval_required_body';
+  $strongarm->value = '[user:name],
+
+Thank you for registering at [site:name]. You may now log in by clicking this link or copying and pasting it to your browser:
+
+[user:one-time-login-url]
+
+This link can only be used once to log in and will lead you to a page where you can set your password.
+
+After setting your password, you will be able to log in at [site:login-url] in the future using:
+
+username: [user:name]
+password: Your password
+
+--  [site:name] team';
+  $export['user_mail_register_no_approval_required_body'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_mail_status_activated_body';
+  $strongarm->value = '[user:name],
+
+Your account at [site:name] has been activated.
+
+You may now log in by clicking this link or copying and pasting it into your browser:
+
+[user:one-time-login-url]
+
+This link can only be used once to log in and will lead you to a page where you can set your password.
+
+After setting your password, you will be able to log in at [site:login-url] in the future using:
+
+username: [user:name]
+password: Your password
+
+--  [site:name] team';
+  $export['user_mail_status_activated_body'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_pictures';
+  $strongarm->value = '1';
+  $export['user_pictures'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_picture_dimensions';
+  $strongarm->value = '1024x1024';
+  $export['user_picture_dimensions'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_picture_file_size';
+  $strongarm->value = '800';
+  $export['user_picture_file_size'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'user_picture_style';
+  $strongarm->value = 'thumbnail';
+  $export['user_picture_style'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_profile_social/commons_profile_social.features.field_base.inc b/modules/commons/commons_profile_social/commons_profile_social.features.field_base.inc
new file mode 100644
index 0000000..953e171
--- /dev/null
+++ b/modules/commons/commons_profile_social/commons_profile_social.features.field_base.inc
@@ -0,0 +1,104 @@
+<?php
+/**
+ * @file
+ * commons_profile_social.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_profile_social_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_facebook_url'
+  $field_bases['field_facebook_url'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_facebook_url',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => '0',
+    'module' => 'link',
+    'settings' => array(
+      'attributes' => array(
+        'class' => '',
+        'rel' => '',
+        'target' => 'default',
+      ),
+      'display' => array(
+        'url_cutoff' => 80,
+      ),
+      'enable_tokens' => 1,
+      'title' => 'optional',
+      'title_maxlength' => 128,
+      'title_value' => '',
+      'url' => 0,
+    ),
+    'translatable' => '0',
+    'type' => 'link_field',
+  );
+
+  // Exported field_base: 'field_linkedin_url'
+  $field_bases['field_linkedin_url'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_linkedin_url',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => '0',
+    'module' => 'link',
+    'settings' => array(
+      'attributes' => array(
+        'class' => '',
+        'rel' => '',
+        'target' => 'default',
+      ),
+      'display' => array(
+        'url_cutoff' => 80,
+      ),
+      'enable_tokens' => 1,
+      'title' => 'optional',
+      'title_maxlength' => 128,
+      'title_value' => '',
+      'url' => 0,
+    ),
+    'translatable' => '0',
+    'type' => 'link_field',
+  );
+
+  // Exported field_base: 'field_twitter_url'
+  $field_bases['field_twitter_url'] = array(
+    'active' => '1',
+    'cardinality' => '1',
+    'deleted' => '0',
+    'entity_types' => array(),
+    'field_name' => 'field_twitter_url',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => '0',
+    'module' => 'link',
+    'settings' => array(
+      'attributes' => array(
+        'class' => '',
+        'rel' => '',
+        'target' => 'default',
+      ),
+      'display' => array(
+        'url_cutoff' => 80,
+      ),
+      'enable_tokens' => 1,
+      'title' => 'optional',
+      'title_maxlength' => 128,
+      'title_value' => '',
+      'url' => 0,
+    ),
+    'translatable' => '0',
+    'type' => 'link_field',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_profile_social/commons_profile_social.features.field_instance.inc b/modules/commons/commons_profile_social/commons_profile_social.features.field_instance.inc
new file mode 100644
index 0000000..a43f441
--- /dev/null
+++ b/modules/commons/commons_profile_social/commons_profile_social.features.field_instance.inc
@@ -0,0 +1,175 @@
+<?php
+/**
+ * @file
+ * commons_profile_social.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_profile_social_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'user-user-field_facebook_url'
+  $field_instances['user-user-field_facebook_url'] = array(
+    'bundle' => 'user',
+    'default_value' => array(
+      0 => array(
+        'title' => '',
+        'url' => '',
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'link',
+        'settings' => array(),
+        'type' => 'link_default',
+        'weight' => 6,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'field_facebook_url',
+    'label' => 'Facebook URL',
+    'required' => 0,
+    'settings' => array(
+      'attributes' => array(
+        'class' => 'facebook-url',
+        'configurable_title' => 0,
+        'rel' => 'nofollow',
+        'target' => 'default',
+        'title' => '',
+      ),
+      'display' => array(
+        'url_cutoff' => '80',
+      ),
+      'enable_tokens' => 0,
+      'title' => 'none',
+      'title_maxlength' => '128',
+      'title_value' => '',
+      'url' => 0,
+      'user_register_form' => 0,
+      'validate_url' => 1,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'link',
+      'settings' => array(),
+      'type' => 'link_field',
+      'weight' => '6',
+    ),
+  );
+
+  // Exported field_instance: 'user-user-field_linkedin_url'
+  $field_instances['user-user-field_linkedin_url'] = array(
+    'bundle' => 'user',
+    'default_value' => array(
+      0 => array(
+        'url' => '',
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'link',
+        'settings' => array(),
+        'type' => 'link_default',
+        'weight' => 5,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'field_linkedin_url',
+    'label' => 'LinkedIn URL',
+    'required' => 0,
+    'settings' => array(
+      'attributes' => array(
+        'class' => 'linkedin-url',
+        'configurable_title' => 0,
+        'rel' => 'nofollow',
+        'target' => 'default',
+        'title' => '',
+      ),
+      'display' => array(
+        'url_cutoff' => '80',
+      ),
+      'enable_tokens' => 0,
+      'title' => 'none',
+      'title_maxlength' => '128',
+      'title_value' => '',
+      'url' => 0,
+      'user_register_form' => 0,
+      'validate_url' => 1,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'link',
+      'settings' => array(),
+      'type' => 'link_field',
+      'weight' => '7',
+    ),
+  );
+
+  // Exported field_instance: 'user-user-field_twitter_url'
+  $field_instances['user-user-field_twitter_url'] = array(
+    'bundle' => 'user',
+    'default_value' => array(
+      0 => array(
+        'title' => '',
+        'url' => '',
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'link',
+        'settings' => array(),
+        'type' => 'link_default',
+        'weight' => 7,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'field_twitter_url',
+    'label' => 'Twitter URL',
+    'required' => 0,
+    'settings' => array(
+      'attributes' => array(
+        'class' => 'twitter-url',
+        'configurable_title' => 0,
+        'rel' => 'nofollow',
+        'target' => 'default',
+        'title' => '',
+      ),
+      'display' => array(
+        'url_cutoff' => '80',
+      ),
+      'enable_tokens' => 1,
+      'title' => 'none',
+      'title_maxlength' => '128',
+      'title_value' => '',
+      'url' => 0,
+      'user_register_form' => 0,
+      'validate_url' => 1,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'link',
+      'settings' => array(),
+      'type' => 'link_field',
+      'weight' => '8',
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Facebook URL');
+  t('LinkedIn URL');
+  t('Twitter URL');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_profile_social/commons_profile_social.info b/modules/commons/commons_profile_social/commons_profile_social.info
new file mode 100644
index 0000000..484a492
--- /dev/null
+++ b/modules/commons/commons_profile_social/commons_profile_social.info
@@ -0,0 +1,14 @@
+name = Commons Profile (Social fields)
+description = Provides a set of link fields to the user's profile for the user's Facebook, Linkedin and Twitter accounts.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = features
+dependencies[] = field_sql_storage
+dependencies[] = link
+features[features_api][] = api:1
+features[field_base][] = field_facebook_url
+features[field_base][] = field_linkedin_url
+features[field_base][] = field_twitter_url
+features[field_instance][] = user-user-field_facebook_url
+features[field_instance][] = user-user-field_linkedin_url
+features[field_instance][] = user-user-field_twitter_url
\ No newline at end of file
diff --git a/modules/commons/commons_profile_social/commons_profile_social.install b/modules/commons/commons_profile_social/commons_profile_social.install
new file mode 100644
index 0000000..f0d48fd
--- /dev/null
+++ b/modules/commons/commons_profile_social/commons_profile_social.install
@@ -0,0 +1,10 @@
+<?php
+/* update script to make sure the feature gets reverted so social links get removed from default display */
+function commons_profile_social_update_7001() {
+
+  // Revert Features components to ensure that they are in their default states.
+  $revert = array(
+    'commons_profile_social' => array('field_instance'),
+  );
+  features_revert($revert);
+}
\ No newline at end of file
diff --git a/modules/commons/commons_profile_social/commons_profile_social.module b/modules/commons/commons_profile_social/commons_profile_social.module
new file mode 100644
index 0000000..44788b0
--- /dev/null
+++ b/modules/commons/commons_profile_social/commons_profile_social.module
@@ -0,0 +1,5 @@
+<?php
+/**
+ * @file
+ * Drupal needs this blank file.
+ */
diff --git a/modules/commons/commons_q_a/commons-thumbs-up-down.css b/modules/commons/commons_q_a/commons-thumbs-up-down.css
new file mode 100644
index 0000000..e16520b
--- /dev/null
+++ b/modules/commons/commons_q_a/commons-thumbs-up-down.css
@@ -0,0 +1,131 @@
+.rate-widget-commons_thumbs_up_down {
+  width: 4.5em;
+  margin: 1.7em 0;
+}
+
+.rate-info {
+  position: relative;
+  width: 100%;
+  height: 3.5em;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  margin-bottom: .4em;
+  padding: .1em .4em;
+  border: 1px solid #ccc;
+  -webkit-border-radius: 0.3em;
+  -moz-border-radius: 0.3em;
+  -ms-border-radius: 0.3em;
+  -o-border-radius: 0.3em;
+  border-radius: 0.3em;
+  font-size: .8em;
+  line-height: 1.2em;
+  text-align: center;
+  background: #fff;
+  color: #333;
+  z-index: 0;
+}
+.rate-info:before, .rate-info:after {
+  content: "";
+  display: block;
+  width: 0;
+  height: 0;
+  overflow: hidden;
+  position: absolute;
+  bottom: -0.85em;
+  left: 50%;
+  margin-left: -0.5em;
+  border: 0.5em solid transparent;
+}
+.rate-info:before {
+  border-top-color: #ccc;
+  margin-bottom: -1px;
+}
+.rate-info:after {
+  border-top-color: #fff;
+}
+
+.rate-info-value {
+  display: block;
+  font-size: 1.8em;
+  font-weight: bold;
+  line-height: 1em;
+}
+
+.rate-info-label {
+  line-height: 1em;
+  color: #888;
+}
+
+.commons-q-a-rate-buttons {
+  margin: 0;
+  line-height: 100%;
+}
+
+.commons-q-a-rate-trigger {
+  margin: 0;
+  width: 50%;
+  height: 2em;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  line-height: 2em;
+}
+.commons-q-a-rate-trigger .rate-button {
+  display: block;
+  height: 100%;
+  overflow: hidden;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  border: 1px solid #ccc;
+  -webkit-border-radius: 0.3em;
+  -moz-border-radius: 0.3em;
+  -ms-border-radius: 0.3em;
+  -o-border-radius: 0.3em;
+  border-radius: 0.3em;
+  color: transparent;
+  background: #fefefe;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #fefefe), color-stop(100%, #e8e8e8));
+  background: -webkit-linear-gradient(top, #fefefe, #e8e8e8);
+  background: -moz-linear-gradient(top, #fefefe, #e8e8e8);
+  background: -o-linear-gradient(top, #fefefe, #e8e8e8);
+  background: linear-gradient(top, #fefefe, #e8e8e8);
+}
+.commons-q-a-rate-trigger .rate-button:before {
+  display: block;
+  margin: 0 auto;
+  text-align: center;
+  font-size: 2.4em;
+  color: #333;
+  font-weight: bold;
+  font-family: monospace;
+}
+.commons-q-a-rate-trigger .rate-button:hover {
+  text-decoration: none;
+}
+.commons-q-a-rate-trigger .rate-voted {
+  background: #f3f3f3;
+  border-color: #f3f3f3;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.1em rgba(0, 0, 0, 0.4);
+  -moz-box-shadow: inset 0.1em 0.1em 0.1em rgba(0, 0, 0, 0.4);
+  box-shadow: inset 0.1em 0.1em 0.1em rgba(0, 0, 0, 0.4);
+}
+
+.commons-q-a-rate-up {
+  float: left;
+  padding-right: .2em;
+}
+
+.commons-q-a-rate-down {
+  float: right;
+  padding-left: .2em;
+}
+
+.rate-number-up-down-btn-up:before {
+  content: "+";
+}
+
+.rate-number-up-down-btn-down:before {
+  content: "-";
+}
diff --git a/modules/commons/commons_q_a/commons-thumbs-up-down.scss b/modules/commons/commons_q_a/commons-thumbs-up-down.scss
new file mode 100644
index 0000000..723c676
--- /dev/null
+++ b/modules/commons/commons_q_a/commons-thumbs-up-down.scss
@@ -0,0 +1,127 @@
+@import "compass";
+
+$arrow-width: 1em;
+
+.rate-widget-commons_thumbs_up_down {
+  width: 4.5em;
+  margin: 1.7em 0;
+}
+
+.rate-info {
+  position: relative;
+  width: 100%;
+  height: 3.5em;
+  @include box-sizing(border-box);
+  margin-bottom: .4em;
+  padding: .1em .4em;
+  border: 1px solid #ccc;
+  @include border-radius(.3em);
+  font-size: .8em;
+  line-height: 1.2em;
+  text-align: center;
+  background: #fff;
+  color: #333;
+  z-index: 0;
+
+  &:before,
+  &:after {
+    content: "";
+    display: block;
+    width: 0;
+    height: 0;
+    overflow: hidden;
+    position: absolute;
+    bottom: -($arrow-width - .15);
+    left: 50%;
+    margin-left: -($arrow-width / 2);
+    border: ($arrow-width / 2) solid transparent;
+  }
+
+  &:before {
+    border-top-color: #ccc;
+    margin-bottom: -1px;
+  }
+
+  &:after {
+    border-top-color: #fff;
+  }
+}
+
+.rate-info-value {
+  display: block;
+  font-size: 1.8em;
+  font-weight: bold;
+  line-height: 1em;
+}
+
+.rate-info-label {
+  line-height: 1em;
+  color: #888;
+}
+
+.commons-q-a-rate-buttons {
+  margin: 0;
+  line-height: 100%;
+}
+
+.commons-q-a-rate-trigger {
+  margin: 0;
+  width: 50%;
+  height: 2em;
+  @include box-sizing(border-box);
+  line-height: 2em;
+
+  .rate-button {
+    display: block;
+    height: 100%;
+    overflow: hidden;
+    @include box-sizing(border-box);
+    border: 1px solid #ccc;
+    @include border-radius(.3em);
+    color: transparent;
+    background: #fefefe;
+    @include background(linear-gradient(top, #fefefe, #e8e8e8));
+
+    &:before {
+      display: block;
+      margin: 0 auto;
+      text-align: center;
+      font-size: 2.4em;
+      color: #333;
+      font-weight: bold;
+      font-family: monospace;
+    }
+
+    &:hover {
+      text-decoration: none;
+    }
+  }
+
+  .rate-voted {
+    background: #f3f3f3;
+    border-color: #f3f3f3;
+    @include box-shadow(inset .1em .1em .1em rgba(0, 0, 0, .4));
+  }
+}
+
+.commons-q-a-rate-up {
+  float: left;
+  padding-right: .2em;
+}
+
+.commons-q-a-rate-down {
+  float: right;
+  padding-left: .2em;
+}
+
+.rate-number-up-down-btn-up {
+  &:before {
+    content: "+";
+  }
+}
+
+.rate-number-up-down-btn-down {
+  &:before {
+    content: "-";
+  }
+}
diff --git a/modules/commons/commons_q_a/commons-thumbs-up-down.tpl.php b/modules/commons/commons_q_a/commons-thumbs-up-down.tpl.php
new file mode 100644
index 0000000..17cdfa1
--- /dev/null
+++ b/modules/commons/commons_q_a/commons-thumbs-up-down.tpl.php
@@ -0,0 +1,25 @@
+<?php
+/**
+ * @file
+ * Rate widget theme
+ */
+?>
+
+<div class="commons-q-a-rate-up-down clearfix">
+  <?php
+  print '<div class="rate-info"><span class="rate-info-value">' . $results['rating'] . '</span> <span class="rate-info-label">' . format_plural($results['rating'], 'point', 'points') . '</span></div>';
+
+  if ($display_options['description']) {
+    print '<div class="rate-description">' . $display_options['description'] . '</div>';
+  }
+  ?>
+
+  <div class="commons-q-a-rate-buttons">
+    <div class="commons-q-a-rate-trigger commons-q-a-rate-up">
+      <?php print $up_button; ?>
+    </div>
+    <div class="commons-q-a-rate-trigger commons-q-a-rate-down">
+      <?php print $down_button; ?>
+    </div>
+  </div>
+</div>
diff --git a/modules/commons/commons_q_a/commons_q_a.features.field_base.inc b/modules/commons/commons_q_a/commons_q_a.features.field_base.inc
new file mode 100644
index 0000000..c8e30b8
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.features.field_base.inc
@@ -0,0 +1,57 @@
+<?php
+/**
+ * @file
+ * commons_q_a.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_q_a_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_related_question'
+  $field_bases['field_related_question'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_related_question',
+    'foreign keys' => array(
+      'node' => array(
+        'columns' => array(
+          'target_id' => 'nid',
+        ),
+        'table' => 'node',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(
+          'question' => 'question',
+        ),
+      ),
+      'target_type' => 'node',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.features.field_instance.inc b/modules/commons/commons_q_a/commons_q_a.features.field_instance.inc
new file mode 100644
index 0000000..adacf7b
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.features.field_instance.inc
@@ -0,0 +1,267 @@
+<?php
+/**
+ * @file
+ * commons_q_a.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_q_a_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_q_a_question_answered-field_target_nodes'
+  $field_instances['message-commons_q_a_question_answered-field_target_nodes'] = array(
+    'bundle' => 'commons_q_a_question_answered',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'message-commons_q_a_question_asked-field_target_nodes'
+  $field_instances['message-commons_q_a_question_asked-field_target_nodes'] = array(
+    'bundle' => 'commons_q_a_question_asked',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'node-answer-body'
+  $field_instances['node-answer-body'] = array(
+    'bundle' => 'answer',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 0,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => FALSE,
+    'settings' => array(
+      'display_summary' => FALSE,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => -4,
+    ),
+  );
+
+  // Exported field_instance: 'node-answer-field_related_question'
+  $field_instances['node-answer-field_related_question'] = array(
+    'bundle' => 'answer',
+    'default_value' => NULL,
+    'default_value_function' => 'entityreference_prepopulate_field_default_value',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 12,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'node',
+    'field_name' => 'field_related_question',
+    'label' => 'Related question',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'action' => 'disable',
+          'fallback' => 'form_error',
+          'og_context' => 0,
+          'skip_perm' => 0,
+          'status' => 1,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 4,
+    ),
+  );
+
+  // Exported field_instance: 'node-question-body'
+  $field_instances['node-question-body'] = array(
+    'bundle' => 'question',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 2,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 1,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => 0,
+    'settings' => array(
+      'display_summary' => 0,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => 1,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+  t('Related question');
+  t('Target nodes');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.features.inc b/modules/commons/commons_q_a/commons_q_a.features.inc
new file mode 100644
index 0000000..f230f42
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.features.inc
@@ -0,0 +1,115 @@
+<?php
+/**
+ * @file
+ * commons_q_a.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_q_a_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "panelizer" && $api == "panelizer") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_q_a_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_q_a_default_message_type() {
+  $items = array();
+  $items['commons_q_a_question_answered'] = entity_import('message_type', '{
+    "name" : "commons_q_a_question_answered",
+    "description" : "Commons Q\\u0026A: Question Answered",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E answered the question \\u003Cem\\u003E[message:field-target-nodes:0:field-related-question:title]\\u003C\\/em\\u003E with \\u0022\\u003Ca href=\\u0022[message:field-target-nodes:0:field-related-question:url]#node-[message:field-target-nodes:0:nid]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E\\u0022",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E answered the question \\u003Cem\\u003E[message:field-target-nodes:0:field-related-question:title]\\u003C\\/em\\u003E with \\u0022\\u003Ca href=\\u0022[message:field-target-nodes:0:field-related-question:url]#node-[message:field-target-nodes:0:nid]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E\\u0022"
+        },
+        {
+          "value" : "[commons-groups:in-groups-text]",
+          "format" : "full_html",
+          "safe_value" : "[commons-groups:in-groups-text]"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['commons_q_a_question_asked'] = entity_import('message_type', '{
+    "name" : "commons_q_a_question_asked",
+    "description" : "Commons Q\\u0026A: Question Asked",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "filtered_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E asked the question \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E asked the question \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E"
+        },
+        {
+          "value" : "[commons-groups:in-groups-text]",
+          "format" : "full_html",
+          "safe_value" : "[commons-groups:in-groups-text]"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_q_a_node_info() {
+  $items = array(
+    'answer' => array(
+      'name' => t('Answer'),
+      'base' => 'node_content',
+      'description' => t('Use answers for responses to Question content, which can be rated by user votes.'),
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+    'question' => array(
+      'name' => t('Question'),
+      'base' => 'node_content',
+      'description' => t('Ask a question to receive answers from other community members'),
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.features.og_features_permission.inc b/modules/commons/commons_q_a/commons_q_a.features.og_features_permission.inc
new file mode 100644
index 0000000..a21c58e
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.features.og_features_permission.inc
@@ -0,0 +1,90 @@
+<?php
+/**
+ * @file
+ * commons_q_a.features.og_features_permission.inc
+ */
+
+/**
+ * Implements hook_og_features_default_permissions().
+ */
+function commons_q_a_og_features_default_permissions() {
+  $permissions = array();
+
+  // Exported og permission: 'node:group:create answer content'
+  $permissions['node:group:create answer content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:create question content'
+  $permissions['node:group:create question content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any answer content'
+  $permissions['node:group:delete any answer content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any question content'
+  $permissions['node:group:delete any question content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own answer content'
+  $permissions['node:group:delete own answer content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own question content'
+  $permissions['node:group:delete own question content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any answer content'
+  $permissions['node:group:update any answer content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any question content'
+  $permissions['node:group:update any question content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own answer content'
+  $permissions['node:group:update own answer content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own question content'
+  $permissions['node:group:update own question content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.features.user_permission.inc b/modules/commons/commons_q_a/commons_q_a.features.user_permission.inc
new file mode 100644
index 0000000..758a4bb
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.features.user_permission.inc
@@ -0,0 +1,110 @@
+<?php
+/**
+ * @file
+ * commons_q_a.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_q_a_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'create answer content'.
+  $permissions['create answer content'] = array(
+    'name' => 'create answer content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'create question content'.
+  $permissions['create question content'] = array(
+    'name' => 'create question content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete any answer content'.
+  $permissions['delete any answer content'] = array(
+    'name' => 'delete any answer content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete any question content'.
+  $permissions['delete any question content'] = array(
+    'name' => 'delete any question content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own answer content'.
+  $permissions['delete own answer content'] = array(
+    'name' => 'delete own answer content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own question content'.
+  $permissions['delete own question content'] = array(
+    'name' => 'delete own question content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit any answer content'.
+  $permissions['edit any answer content'] = array(
+    'name' => 'edit any answer content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit any question content'.
+  $permissions['edit any question content'] = array(
+    'name' => 'edit any question content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit own answer content'.
+  $permissions['edit own answer content'] = array(
+    'name' => 'edit own answer content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit own question content'.
+  $permissions['edit own question content'] = array(
+    'name' => 'edit own question content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.info b/modules/commons/commons_q_a/commons_q_a.info
new file mode 100644
index 0000000..6ffb85c
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.info
@@ -0,0 +1,95 @@
+name = Commons Q&A
+description = Allows community members to ask questions and vote for the best answers
+core = 7.x
+package = Commons - Content types
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = field_sql_storage
+dependencies[] = og_ui
+dependencies[] = options
+dependencies[] = strongarm
+dependencies[] = text
+dependencies[] = views
+dependencies[] = views_content
+dependencies[] = views_litepager
+features[ctools][] = panelizer:panelizer:1
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_base][] = field_related_question
+features[field_instance][] = message-commons_q_a_question_answered-field_target_nodes
+features[field_instance][] = message-commons_q_a_question_asked-field_target_nodes
+features[field_instance][] = node-answer-body
+features[field_instance][] = node-answer-field_related_question
+features[field_instance][] = node-question-body
+features[message_type][] = commons_q_a_question_answered
+features[message_type][] = commons_q_a_question_asked
+features[node][] = answer
+features[node][] = question
+features[og_features_permission][] = node:group:create answer content
+features[og_features_permission][] = node:group:create question content
+features[og_features_permission][] = node:group:delete any answer content
+features[og_features_permission][] = node:group:delete any question content
+features[og_features_permission][] = node:group:delete own answer content
+features[og_features_permission][] = node:group:delete own question content
+features[og_features_permission][] = node:group:update any answer content
+features[og_features_permission][] = node:group:update any question content
+features[og_features_permission][] = node:group:update own answer content
+features[og_features_permission][] = node:group:update own question content
+features[user_permission][] = create answer content
+features[user_permission][] = create question content
+features[user_permission][] = delete any answer content
+features[user_permission][] = delete any question content
+features[user_permission][] = delete own answer content
+features[user_permission][] = delete own question content
+features[user_permission][] = edit any answer content
+features[user_permission][] = edit any question content
+features[user_permission][] = edit own answer content
+features[user_permission][] = edit own question content
+features[variable][] = comment_anonymous_answer
+features[variable][] = comment_anonymous_question
+features[variable][] = comment_answer
+features[variable][] = comment_default_mode_answer
+features[variable][] = comment_default_mode_question
+features[variable][] = comment_default_per_page_answer
+features[variable][] = comment_default_per_page_question
+features[variable][] = comment_form_location_answer
+features[variable][] = comment_form_location_question
+features[variable][] = comment_preview_answer
+features[variable][] = comment_preview_question
+features[variable][] = comment_question
+features[variable][] = comment_subject_field_answer
+features[variable][] = comment_subject_field_question
+features[variable][] = field_bundle_settings_message__commons_q_a_question_answered
+features[variable][] = field_bundle_settings_message__commons_q_a_question_asked
+features[variable][] = field_bundle_settings_node__answer
+features[variable][] = field_bundle_settings_node__question
+features[variable][] = menu_options_answer
+features[variable][] = menu_options_question
+features[variable][] = menu_parent_answer
+features[variable][] = menu_parent_question
+features[variable][] = node_options_answer
+features[variable][] = node_options_question
+features[variable][] = node_preview_answer
+features[variable][] = node_preview_question
+features[variable][] = node_submitted_answer
+features[variable][] = node_submitted_question
+features[views_view][] = commons_bw_q_a
+features[views_view][] = commons_question_answers
+features_exclude[dependencies][message] = message
+features_exclude[dependencies][commons_trusted_contacts] = commons_trusted_contacts
+features_exclude[field][message-commons_q_a_question_answered-field_target_nodes] = message-commons_q_a_question_answered-field_target_nodes
+features_exclude[field_base][og_group_ref_other_groups] = og_group_ref_other_groups
+features_exclude[field_base][og_group_ref] = og_group_ref
+features_exclude[field_base][field_body] = field_body
+features_exclude[field_base][field_radioactivity] = field_radioactivity
+features_exclude[field_base][body] = body
+features_exclude[field_base][field_target_nodes] = field_target_nodes
+features_exclude[field_instance][node-answer-og_group_ref_other_groups] = node-answer-og_group_ref_other_groups
+features_exclude[field_instance][node-question-og_group_ref_other_groups] = node-question-og_group_ref_other_groups
+features_exclude[field_instance][og_group_ref] = og_group_ref
+features_exclude[field_instance][node-answer-og_group_ref] = node-answer-og_group_ref
+features_exclude[field_instance][node-question-og_group_ref] = node-question-og_group_ref
diff --git a/modules/commons/commons_q_a/commons_q_a.install b/modules/commons/commons_q_a/commons_q_a.install
new file mode 100644
index 0000000..32a6078
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.install
@@ -0,0 +1,127 @@
+<?php
+
+/**
+ * Update the Rate module settings for changes to the Up/Down widget.
+ */
+function commons_q_a_update_3100() {
+    $revert = array(
+      'commons_like' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Disable comments on Question nodes. Don't feature answers by default
+ * (http://drupal.org/node/1921498).
+ */
+function commons_q_a_update_3101() {
+    $revert = array(
+      'commons_q_a' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Disable summary on Question/Answer nodes.
+ */
+function commons_q_a_update_3102() {
+    $revert = array(
+      'commons_q_a' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Update the Commons Q&A widget per http://drupal.org/node/1940644.
+ */
+function commons_q_a_update_3103() {
+  // The Commons Q&A widget is defined via a hook_strongarm_alter()
+  // implementation altering rate_widgets variable, defined by commons_like.
+    $revert = array(
+      'commons_like' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Disable comments on Answer nodes.
+ */
+function commons_q_a_update_3104() {
+    $revert = array(
+      'commons_q_a' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Link the 'Answer added' activity stream message to the Answer node as
+ * displayed on the question per http://drupal.org/node/1946120.
+ */
+function commons_q_a_update_3105() {
+    $revert = array(
+      'commons_q_a' => array('field_instance', 'message_type', 'variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Use the standard user picture image size.
+ */
+function commons_q_a_update_3106() {
+    $revert = array(
+      'commons_q_a' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Remove the "Like" widget from answer nodes, since they have a +/- widget.
+ * Related issue: https://drupal.org/node/1935312.
+ */
+function commons_q_a_update_3107() {
+  $revert = array(
+    'commons_like' => array('variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Standardize Browsing Widget views.
+ */
+function commons_q_a_update_3108() {
+  $revert = array(
+    'commons_q_a' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Display sticky content at top of lists.
+ */
+function commons_q_a_update_3109() {
+  $revert = array(
+    'commons_q_a' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Indicate in the view that empty answers text is overridden by commons_q_a.
+ */
+function commons_q_a_update_3110() {
+  $revert = array(
+    'commons_q_a' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.module b/modules/commons/commons_q_a/commons_q_a.module
new file mode 100644
index 0000000..b406183
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.module
@@ -0,0 +1,459 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Q&A feature.
+ */
+
+include_once 'commons_q_a.features.inc';
+
+/**
+ * Implements hook_theme().
+ */
+function commons_q_a_theme() {
+  return array(
+    'rate_template_commons_thumbs_up_down' => array(
+      'variables' => array('links' => NULL, 'results' => NULL, 'mode' => NULL, 'just_voted' => FALSE, 'content_type' => NULL, 'content_id' => NULL, 'display_options' => NULL),
+      'template' => 'commons-thumbs-up-down',
+    ),
+  );
+}
+
+
+/**
+* Implements hook_commons_bw_group_widget().
+*/
+function commons_q_a_commons_bw_group_widget() {
+  return array(
+    'commons_q_a' => array(
+      'title' => t('Q & A'),
+      'type' => 'view',
+      'vid' => 'commons_bw_q_a',
+      'display' => 'default',
+      'weight' => 5,
+      'bundle' => 'question',
+    ),
+  );
+}
+
+/**
+ * Implements hook_node_view().
+ *
+ * Provides an answer button to bring a user down to the answer form.
+ */
+function commons_q_a_node_view($node, $view_mode) {
+  if ($node->type == 'question' && $view_mode == 'full') {
+    // Remove add comment link.
+    unset($node->content['links']['comment']);
+    // Add the answer link below.
+    if (commons_q_a_check_answer_access($node)) {
+      $node->content['links']['answer'] = array(
+        '#theme' => 'links__node__answer',
+        '#links' => array(
+          'answer-add' => array(
+            'title' => t('Answer'),
+            'attributes' => array(
+              'title' => t('Answer this question'),
+            ),
+            'href' => 'node/' . $node->nid,
+            'fragment' => 'answer',
+          ),
+        ),
+      );
+    }
+    return $node;
+  }
+}
+
+/**
+ * Implements hook_form_FROM_ID_alter().
+ */
+function commons_q_a_form_commons_bw_partial_node_form_alter(&$form, &$form_state) {
+  if (empty($form['#entity']) || $form['#entity']->type != 'question') {
+    return;
+  }
+
+  $form['title']['#markup'] = '<h3>' . t('Ask a question') . '</h3>';
+
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#title_display'] = 'invisible';
+  $form['body'][$language][0]['#required'] = TRUE;
+  $form['body'][$language][0]['#placeholder'] = t('Ask anything. Let the community answer openly.');
+  $form['body'][$language][0]['#resizable'] = FALSE;
+
+  // Set fields as hideable so the forms can be compacted.
+  $form['body']['#attributes']['class'][] = 'trigger-field';
+  foreach (array('field_media', 'field_image', 'og_group_ref', 'choice_wrapper', 'actions') as $field) {
+    if (isset($form[$field])) {
+      $form[$field]['#attributes']['class'][] = 'hideable-field';
+    }
+  }
+
+  $form['actions']['submit']['#value'] = t('Ask');
+  $form['#pre_render'][] = 'commons_q_a_form_commons_bw_partial_node_form_after_build';
+}
+
+/**
+ * After-build call-back.
+ * See commons_q_a_form_commons_bw_partial_node_form_alter().
+ */
+function commons_q_a_form_commons_bw_partial_node_form_after_build($form) {
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#pre_render'] = array();
+  $form['body'][$language][0]['format']['#access'] = FALSE;
+  $form['body'][$language][0]['value']['#rows'] = 3;
+
+  return $form;
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ *
+ * Display questions on the browsing widget main view.
+ */
+function commons_q_a_views_default_views_alter(&$views) {
+  if (!empty($views['commons_bw_all'])) {
+    $views['commons_bw_all']->display['default']->display_options['filters']['type']['value']['question'] = 'question';
+  }
+}
+
+/*
+ * Run an access check to see if the current user can create answer nodes based
+ * off of the question node.
+ */
+function commons_q_a_check_answer_access($question) {
+  $group_ref = array();
+  if (!empty($question->og_group_ref[LANGUAGE_NONE])) {
+    foreach ($question->og_group_ref[LANGUAGE_NONE] as $key => $value) {
+      // Check to see the user has access to the group the question is in, only attach to those groups they have permission to post in.
+      if (og_user_access('node', $value['target_id'], 'create answer content')) {
+        $group_ref[] = $value['target_id'];
+        return TRUE;
+      }
+    }
+  }
+  // If user belongs to no groups, or no groups are assigned to the Question, check node_access for user.
+  else {
+    if (node_access('create', 'answer')) {
+      return TRUE;
+    }
+  }
+  return FALSE;
+}
+
+/**
+ * Implements hook_views_pre_render().
+ */
+function commons_q_a_views_pre_render(&$view) {
+  if ($view->name == 'commons_question_answers' && !empty($view->args[0])) {
+    // If the user has access to post into any of the groups associated
+    // with the question, embed a simplified answer node form.
+    global $user;
+
+    if (user_is_anonymous()) {
+      $account = drupal_anonymous_user();
+    }
+    else {
+      $account = $user;
+    }
+
+    $question_nid = $view->args[0];
+    $question = node_load($question_nid);
+
+    $answer_access = commons_q_a_check_answer_access($question);
+    // Check global user access before showing the answer form.
+    if ($answer_access) {
+      $view->empty['area']->options['content'] = t("This question hasn't been answered yet. You can be the first to answer it!");
+      module_load_include('inc', 'node', 'node.pages');
+      $types = node_type_get_types();
+      $node = (object) array(
+        'uid' => $account->uid,
+        'name' => (isset($account->name) ? $account->name : ''),
+        'type' => 'answer', 'language' => LANGUAGE_NONE
+      );
+      // Prepopulate the Related question field
+      // with Entityreference Prepopulate, which looks strictly at $_GET.
+      $_GET['field_related_question'] = $view->args[0];
+      if (!empty($group_ref)) {
+        $_GET['og_group_ref'] = implode(',', $group_ref);
+      }
+      $answer_form = drupal_get_form('answer_node_form', $node);
+      $answer_form['header'] = array(
+        '#markup' => '<h3 id="answer" name="answer">' . t('Add a new answer') . '</h3>',
+        '#weight' => -10,
+      );
+      // Hide any vertical tabs that might be present.
+      $answer_form['additional_settings']['#access'] = FALSE;
+      // Hide the Related question field.
+      $answer_form['field_related_question']['#access'] = FALSE;
+      // Add the form to the attachment_after part of the view,
+      $view->attachment_after .= drupal_render($answer_form);
+      // We only need to add the form once if the user has access to
+      // post questions into any of the groups associated with the parent.
+      return;
+    }
+    // Tell Anonymous users to login.
+    elseif ($account->uid === 0) {
+      $view->empty['area']->options['content'] = t("This question hasn't been answered yet. !create to be the first to answer it!", array('!create' => l(t("Login or create an account"), 'user')));
+      return;
+    }
+    // If the user is not anonymous, but cannot answer the question. Don't tell
+    // them they should be the first to answer it.
+    else {
+      $view->empty['area']->options['content'] = t("This question hasn't been answered yet.");
+      return;
+    }
+  }
+}
+
+/*
+ * Implements hook_module_implements_alter().
+ * Set commons_q_a form alter to happen after node so the title doesn't get reset.
+ */
+function commons_q_a_module_implements_alter(&$implementations, $hook) {
+  if ($hook == 'form_alter') {
+    $group = $implementations['commons_q_a'];
+    unset($implementations['commons_q_a']);
+    $implementations['commons_q_a'] = $group;
+  }
+}
+
+/**
+* Implements hook_form_alter().
+*/
+function commons_q_a_form_alter(&$form, &$form_state, $form_id) {
+  // Unset the groups audience field. Answers programatically inherit
+  // the group membership of their respective questions.
+  if ($form_id == 'answer_node_form') {
+    $form['og_group_ref']['#access'] = FALSE;
+    $form['actions']['submit']['#submit'][] = 'commons_q_a_answer_submit';
+    // Ensure that the answer node inherits group membership from the
+    // parent question by preventing users from changing the audience through
+    // the Trusted Contacts toggle when commons_trusted_contacts.module
+    // is enabled.
+    $form_state['hide_audience_toggle'] = TRUE;
+  }
+  if ($form_id == 'question_node_form' && empty($form['#node']->nid)) {
+    drupal_set_title(t('Ask a question'));
+  }
+  if ($form_id == 'comment_node_question_form' || $form_id == 'comment_node_answer_form') {
+    $form['container'] = array(
+      '#type' => 'fieldset',
+      '#title' => t('Add new comment'),
+      '#collapsible' => TRUE,
+      '#collapsed' => TRUE,
+      '#weight' => 2,
+    );
+    $form['container']['author'] = $form['author'];
+    $form['container']['comment_body'] = $form['comment_body'];
+    $form['container']['actions'] = $form['actions'];
+    unset($form['author']);
+    unset($form['subject']);  // We don't need a subject, they're pointless within comments.
+    unset($form['comment_body']);
+    unset($form['actions']);
+  }
+}
+
+/**
+ * Implements hook_field_attach_submit().
+ */
+function commons_q_a_field_attach_submit($entity_type, &$entity, $form, &$form_state) {
+  // Questions should inherit the group membership of the related question.
+  if ($entity_type == 'node' && $entity->type == 'answer' && empty($entity->nid)) {
+    $question = node_load($entity->field_related_question[LANGUAGE_NONE][0]['target_id']);
+    $entity->og_group_ref = $question->og_group_ref;
+  }
+}
+
+/**
+ * Implements hook_commons_bw_create_all_widget().
+ */
+function commons_q_a_commons_bw_create_all_widget($group) {
+   if (og_user_access('node', $group->nid, 'create question content')) {
+      $link = l(t('Ask a question'),'node/add/question',
+      array('attributes' => array('class' => 'commons-q-a-create'), 'query' => array('og_group_ref' => $group->nid))
+    );
+    return array(
+      'commons_q_a' => array(
+        'link' => $link,
+        'text' => t('Learn the best answer'),
+        '#weight' => 5,
+      ),
+    );
+  }
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_q_a_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'question' => array(
+        'media' => TRUE,
+        'is_group_content' => TRUE,
+      ),
+      'answer' => array(
+        'exclude_topics' => TRUE,
+        'exclude_rate' => TRUE,
+        'is_group_content' => TRUE,
+      ),
+    ),
+  );
+}
+
+
+/**
+ * Submit handler for the submit button on the answer node form.
+ */
+function commons_q_a_answer_submit($form, &$form_state) {
+  // Redirect the user back to the related question.
+  $form_state['redirect'] = 'node/' . $form_state['values']['field_related_question'][LANGUAGE_NONE][0]['target_id'];
+}
+
+/**
+ * Implements commons_activity_streams_message_selection_alter().
+ */
+function commons_q_a_commons_activity_streams_message_selection_alter(&$message_type, $hook, $node) {
+    // Provide a special message type that uses "User asked the question"
+    // phrasing when a new question node is created.
+    if ($hook == 'node_insert' && $node->type == 'question') {
+    $message_type = 'commons_q_a_question_asked';
+  }
+
+  // Provide a special message type that uses "User answered the question"
+  // phrasing when a new answer node is created.
+  if ($hook == 'node_insert' && $node->type == 'answer') {
+    $message_type = 'commons_q_a_question_answered';
+  }
+}
+
+/**
+ * Preprocess function for the commons_like template.
+ */
+function commons_q_a_preprocess_rate_template_commons_thumbs_up_down(&$variables) {
+  extract($variables);
+
+  $up_classes = 'rate-number-up-down-btn-up';
+  $down_classes = 'rate-number-up-down-btn-down';
+  if (isset($results['user_vote'])) {
+    switch ($results['user_vote']) {
+      case $links[0]['value']:
+        $up_classes .= ' rate-voted';
+        break;
+      case $links[1]['value']:
+        $down_classes .= ' rate-voted';
+        break;
+    }
+  }
+
+  $variables['up_button'] = theme('rate_button', array('text' => $links[0]['text'], 'href' => $links[0]['href'], 'class' => $up_classes));
+  $variables['down_button'] = theme('rate_button', array('text' => $links[1]['text'], 'href' => $links[1]['href'], 'class' => $down_classes));
+  if ($results['rating'] > 0) {
+    $score = $results['rating'];
+    $score_class = 'positive';
+  }
+  elseif ($results['rating'] < 0) {
+    $score = $results['rating'];
+    $score_class = 'negative';
+  }
+  else {
+    $score = 0;
+    $score_class = 'neutral';
+  }
+  $variables['score'] = $score;
+  $variables['score_class'] = $score_class;
+
+  $info = array();
+  if ($mode == RATE_CLOSED) {
+    $info[] = t('Voting is closed.');
+  }
+  if ($mode != RATE_COMPACT && $mode != RATE_COMPACT_DISABLED) {
+    if (isset($results['user_vote'])) {
+      $info[] = t('You voted \'@option\'.', array('@option' => $results['user_vote'] == 1 ? $links[0]['text'] : $links[1]['text']));
+    }
+  }
+  $variables['info'] = implode(' ', $info);
+}
+
+/**
+ * Implements hook_rate_templates().
+ */
+function commons_q_a_rate_templates() {
+  $templates = array();
+
+  $templates['commons_thumbs_up_down'] = new stdClass();
+  $templates['commons_thumbs_up_down']->value_type = 'points';
+  $templates['commons_thumbs_up_down']->options = array(
+    array(1, 'up'),
+    array(-1, 'down'),
+  );
+  $templates['commons_thumbs_up_down']->theme = 'rate_template_commons_thumbs_up_down';
+  $templates['commons_thumbs_up_down']->css = drupal_get_path('module', 'commons_q_a') . '/commons-thumbs-up-down.css';
+  $templates['commons_thumbs_up_down']->customizable = FALSE;
+  $templates['commons_thumbs_up_down']->translate = TRUE;
+  $templates['commons_thumbs_up_down']->use_source_translation = TRUE;
+  $templates['commons_thumbs_up_down']->template_title = t('Commons Thumbs up / down');
+
+  return $templates;
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+ function commons_q_a_strongarm_alter(&$items) {
+  // Add Rate module widget configuration used for thumbs up/down
+  // rating of answers.
+  if (!empty($items['rate_widgets']->value)) {
+    $items['rate_widgets']->value[] = commons_q_a_rate_widget();
+  }
+}
+
+
+/**
+ * Return a Rate module widget configuration used for thumbs up/down
+ * rating of answers.
+ */
+function commons_q_a_rate_widget() {
+  return (object) array(
+    'name' => 'commons_answer',
+    'tag' => 'commons_thumbs_up_down',
+    'title' => 'Answer',
+    'node_types' => array(
+      0 => 'answer',
+    ),
+    'comment_types' => array(),
+    'options' => array(
+      0 => array(
+        0 => 1,
+        1 => 'up',
+      ),
+      1 => array(
+        0 => -1,
+        1 => 'down',
+      ),
+    ),
+    'template' => 'commons_thumbs_up_down',
+    'node_display' => '2',
+    'teaser_display' => FALSE,
+    'comment_display' => '2',
+    'node_display_mode' => '1',
+    'teaser_display_mode' => '1',
+    'comment_display_mode' => '1',
+    'roles' => array(
+      2 => '2',
+      1 => 0,
+    ),
+    'allow_voting_by_author' => 1,
+    'noperm_behaviour' => '3',
+    'displayed' => '1',
+    'displayed_just_voted' => '1',
+    'description' => '',
+    'description_in_compact' => TRUE,
+    'delete_vote_on_second_click' => '1',
+    'value_type' => 'points',
+    'theme' => 'rate_template_commons_thumbs_up_down',
+    'css' => 'profiles/commons/modules/contrib/commons_q_a/commons-thumbs-up-down.css',
+    'translate' => TRUE,
+    'use_source_translation' => TRUE,
+  );
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.strongarm.inc b/modules/commons/commons_q_a/commons_q_a.strongarm.inc
new file mode 100644
index 0000000..623db62
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.strongarm.inc
@@ -0,0 +1,323 @@
+<?php
+/**
+ * @file
+ * commons_q_a.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_q_a_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_answer';
+  $strongarm->value = 0;
+  $export['comment_anonymous_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_question';
+  $strongarm->value = 0;
+  $export['comment_anonymous_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_answer';
+  $strongarm->value = '0';
+  $export['comment_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_answer';
+  $strongarm->value = 1;
+  $export['comment_default_mode_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_question';
+  $strongarm->value = 1;
+  $export['comment_default_mode_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_answer';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_question';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_answer';
+  $strongarm->value = 1;
+  $export['comment_form_location_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_question';
+  $strongarm->value = 1;
+  $export['comment_form_location_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_answer';
+  $strongarm->value = '1';
+  $export['comment_preview_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_question';
+  $strongarm->value = '1';
+  $export['comment_preview_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_question';
+  $strongarm->value = '0';
+  $export['comment_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_answer';
+  $strongarm->value = 0;
+  $export['comment_subject_field_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_question';
+  $strongarm->value = 0;
+  $export['comment_subject_field_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_q_a_question_answered';
+  $strongarm->value = array(
+    'view_modes' => array(
+      'message_notify_email_subject' => array(
+        'custom_settings' => TRUE,
+      ),
+      'message_notify_email_body' => array(
+        'custom_settings' => TRUE,
+      ),
+      'full' => array(
+        'custom_settings' => FALSE,
+      ),
+      'diff_standard' => array(
+        'custom_settings' => FALSE,
+      ),
+      'token' => array(
+        'custom_settings' => FALSE,
+      ),
+    ),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'default' => array(
+            'weight' => '0',
+            'visible' => TRUE,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'default' => array(
+            'weight' => '1',
+            'visible' => TRUE,
+          ),
+        ),
+        'message__message_text__2' => array(
+          'default' => array(
+            'weight' => '2',
+            'visible' => TRUE,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_q_a_question_answered'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_q_a_question_asked';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_q_a_question_asked'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__answer';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '-5',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__question';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '0',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_answer';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_question';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_answer';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_question';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_answer';
+  $strongarm->value = array(
+    0 => 'status',
+  );
+  $export['node_options_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_question';
+  $strongarm->value = array(
+    0 => 'status',
+    1 => 'revision',
+  );
+  $export['node_options_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_answer';
+  $strongarm->value = '1';
+  $export['node_preview_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_question';
+  $strongarm->value = '1';
+  $export['node_preview_question'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_answer';
+  $strongarm->value = 1;
+  $export['node_submitted_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_question';
+  $strongarm->value = 1;
+  $export['node_submitted_question'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_q_a/commons_q_a.views_default.inc b/modules/commons/commons_q_a/commons_q_a.views_default.inc
new file mode 100644
index 0000000..8d70d39
--- /dev/null
+++ b/modules/commons/commons_q_a/commons_q_a.views_default.inc
@@ -0,0 +1,241 @@
+<?php
+/**
+ * @file
+ * commons_q_a.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_q_a_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_bw_q_a';
+  $view->description = 'Commons Q&A listing for the group browsing widget.';
+  $view->tag = 'Commons Q&A, Commons Browsing Widget';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Browsing Widget - Q&A';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '3';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'entity';
+  $handler->display->display_options['row_options']['view_mode'] = 'teaser';
+  /* Header: Global: Node partial form */
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['id'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['table'] = 'views';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['field'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['bundle'] = 'question';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No questions have been asked in this group.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Sticky */
+  $handler->display->display_options['sorts']['sticky']['id'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['table'] = 'node';
+  $handler->display->display_options['sorts']['sticky']['field'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['order'] = 'DESC';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'most recent';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['gid']['break_phrase'] = TRUE;
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'question' => 'question',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+  $translatables['commons_bw_q_a'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No questions have been asked in this group.'),
+    t('OG membership from node'),
+    t('following'),
+    t('most recent'),
+    t('most active'),
+    t('All'),
+    t('Following'),
+  );
+  $export['commons_bw_q_a'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_question_answers';
+  $view->description = '';
+  $view->tag = 'Commons Q&A';
+  $view->base_table = 'node';
+  $view->human_name = 'Answers to a question';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Answers';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'entity';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'This Empty text is overridden in commons_q_a.module';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Contextual filter: Content: Related question (field_related_question) */
+  $handler->display->display_options['arguments']['field_related_question_target_id']['id'] = 'field_related_question_target_id';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['table'] = 'field_data_field_related_question';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['field'] = 'field_related_question_target_id';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['field_related_question_target_id']['validate']['type'] = 'node';
+  $handler->display->display_options['arguments']['field_related_question_target_id']['validate_options']['types'] = array(
+    'question' => 'question',
+  );
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'answer' => 'answer',
+  );
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['argument_input'] = array(
+    'field_related_question_target_id' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'Content: Related Question (field_related_question)',
+    ),
+  );
+  $handler->display->display_options['inherit_panels_path'] = '1';
+  $translatables['commons_question_answers'] = array(
+    t('Master'),
+    t('Answers'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('This Empty text is overridden in commons_q_a.module'),
+    t('All'),
+    t('Content pane'),
+    t('Commons'),
+  );
+  $export['commons_question_answers'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_q_a/config.rb b/modules/commons/commons_q_a/config.rb
new file mode 100644
index 0000000..ae8fc12
--- /dev/null
+++ b/modules/commons/commons_q_a/config.rb
@@ -0,0 +1,20 @@
+# Require any additional compass plugins here.
+
+# Set this to the root of your project when deployed:
+http_path = "/"
+css_dir = "/"
+sass_dir = "/"
+images_dir = "images"
+
+# output_style = :expanded or :nested or :compact or :compressed
+output_style = :expanded
+
+relative_assets = true
+
+# line_comments and debug_info can be activated by setting the environment
+# flag to "development"
+line_comments = (environment == :development) ? true : false
+
+sass_options = {
+  :debug_info => (environment == :development) ? true : false
+}
diff --git a/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.features.inc b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.features.inc
new file mode 100644
index 0000000..7abcc63
--- /dev/null
+++ b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.features.inc
@@ -0,0 +1,17 @@
+<?php
+/**
+ * @file
+ * commons_q_a_pages.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_q_a_pages_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "panelizer" && $api == "panelizer") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.info b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.info
new file mode 100644
index 0000000..deb6d34
--- /dev/null
+++ b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.info
@@ -0,0 +1,13 @@
+name = Commons Q&A Pages
+description = Page layout settings for individual Question and Answe pages
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = ctools
+dependencies[] = panelizer
+dependencies[] = strongarm
+features[ctools][] = panelizer:panelizer:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[panelizer_defaults][] = node:question:default
+features[variable][] = panelizer_defaults_node_answer
+features[variable][] = panelizer_defaults_node_question
diff --git a/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.module b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.module
new file mode 100644
index 0000000..0c6267f
--- /dev/null
+++ b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Q&A Pages feature.
+ */
+
+include_once 'commons_q_a_pages.features.inc';
diff --git a/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.panelizer.inc b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.panelizer.inc
new file mode 100644
index 0000000..40b1cc0
--- /dev/null
+++ b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.panelizer.inc
@@ -0,0 +1,107 @@
+<?php
+/**
+ * @file
+ * commons_q_a_pages.panelizer.inc
+ */
+
+/**
+ * Implements hook_panelizer_defaults().
+ */
+function commons_q_a_pages_panelizer_defaults() {
+  $export = array();
+
+  $panelizer = new stdClass();
+  $panelizer->disabled = FALSE; /* Edit this to true to make a default panelizer disabled initially */
+  $panelizer->api_version = 1;
+  $panelizer->name = 'node:question:default';
+  $panelizer->title = 'Default';
+  $panelizer->panelizer_type = 'node';
+  $panelizer->panelizer_key = 'question';
+  $panelizer->no_blocks = FALSE;
+  $panelizer->css_id = '';
+  $panelizer->css = '';
+  $panelizer->pipeline = 'standard';
+  $panelizer->contexts = array();
+  $panelizer->relationships = array();
+  $panelizer->access = array();
+  $panelizer->view_mode = 'page_manager';
+  $panelizer->css_class = '';
+  $panelizer->title_element = 'H2';
+  $panelizer->link_to_entity = TRUE;
+  $panelizer->extra = '';
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '%node:title';
+  $display->uuid = '2c245308-3234-c5b4-91e7-f5fe2f9da43d';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-41485caa-aed0-2114-ad9d-9c94d4087ce4';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'node_content';
+    $pane->subtype = 'node_content';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'links' => 1,
+      'no_extras' => 0,
+      'override_title' => 0,
+      'override_title_text' => '',
+      'identifier' => '',
+      'link' => 0,
+      'leave_node_title' => 1,
+      'build_mode' => 'full',
+      'context' => 'panelizer',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '41485caa-aed0-2114-ad9d-9c94d4087ce4';
+    $display->content['new-41485caa-aed0-2114-ad9d-9c94d4087ce4'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-41485caa-aed0-2114-ad9d-9c94d4087ce4';
+    $pane = new stdClass();
+    $pane->pid = 'new-2e482384-35e1-4b64-a169-0972690b6228';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_question_answers-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'context' => array(
+        0 => 'panelizer',
+      ),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '2e482384-35e1-4b64-a169-0972690b6228';
+    $display->content['new-2e482384-35e1-4b64-a169-0972690b6228'] = $pane;
+    $display->panels['two_66_33_first'][1] = 'new-2e482384-35e1-4b64-a169-0972690b6228';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = '0';
+  $panelizer->display = $display;
+  $export['node:question:default'] = $panelizer;
+
+  return $export;
+}
diff --git a/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.strongarm.inc b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.strongarm.inc
new file mode 100644
index 0000000..122d6cc
--- /dev/null
+++ b/modules/commons/commons_q_a/modules/commons_q_a_pages/commons_q_a_pages.strongarm.inc
@@ -0,0 +1,66 @@
+<?php
+/**
+ * @file
+ * commons_q_a_pages.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_q_a_pages_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'panelizer_defaults_node_answer';
+  $strongarm->value = array(
+    'status' => 0,
+    'view modes' => array(
+      'page_manager' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+      'default' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+      'teaser' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+    ),
+  );
+  $export['panelizer_defaults_node_answer'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'panelizer_defaults_node_question';
+  $strongarm->value = array(
+    'status' => 1,
+    'view modes' => array(
+      'page_manager' => array(
+        'status' => 1,
+        'default' => 1,
+        'choice' => 0,
+      ),
+      'default' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+      'teaser' => array(
+        'status' => 0,
+        'default' => 0,
+        'choice' => 0,
+      ),
+    ),
+  );
+  $export['panelizer_defaults_node_question'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.features.field_base.inc b/modules/commons/commons_radioactivity/commons_radioactivity.features.field_base.inc
new file mode 100644
index 0000000..cc53940
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.features.field_base.inc
@@ -0,0 +1,34 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_radioactivity_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_radioactivity'
+  $field_bases['field_radioactivity'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_radioactivity',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'energy' => array(
+        0 => 'radioactivity_energy',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'radioactivity',
+    'settings' => array(),
+    'translatable' => 0,
+    'type' => 'radioactivity',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.features.field_instance.inc b/modules/commons/commons_radioactivity/commons_radioactivity.features.field_instance.inc
new file mode 100644
index 0000000..03574bc
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.features.field_instance.inc
@@ -0,0 +1,72 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_radioactivity_field_default_field_instances() {
+  // Get a list of content types that should have the Radioactivity field added.
+  $commons_radioactivity_entity_types = commons_radioactivity_get_radioactive_entity_types();
+  if (!empty($commons_radioactivity_entity_types)) {
+    foreach ($commons_radioactivity_entity_types as $entity_type => $bundles) {
+      foreach (array_keys($bundles) as $bundle) {
+        commons_radioactivity_field_definition($field_instances, $entity_type, $bundle);
+      }
+    }
+  }
+  return $field_instances;
+}
+
+/**
+ * Contains a field definition export for the Radioactivity field for re-use
+ * across content types.
+ */
+function commons_radioactivity_field_definition(&$field_instances, $entity_type, $bundle) {
+  $field_instances["$entity_type-$bundle-field_radioactivity"] = array(
+    'bundle' => $bundle,
+    'default_value' => array(
+      0 => array(
+        'radioactivity_energy' => '8',
+      ),
+    ),
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'radioactivity',
+        'settings' => array(
+          'energy' => 10,
+          'type' => 'none',
+          'accuracy' => '100',
+        ),
+        'type' => 'radioactivity_combo_formatter',
+        'weight' => 3,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => $entity_type,
+    'field_name' => 'field_radioactivity',
+    'label' => 'Radioactivity',
+    'required' => 0,
+    'settings' => array(
+      'history_limit' => 8,
+      'profile' => "commons_ra_$entity_type",
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'radioactivity',
+      'settings' => array(),
+      'type' => 'radioactivity_basic_widget',
+      'weight' => '3',
+    ));
+}
\ No newline at end of file
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.features.inc b/modules/commons/commons_radioactivity/commons_radioactivity.features.inc
new file mode 100644
index 0000000..82ef197
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.features.inc
@@ -0,0 +1,24 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_radioactivity_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "radioactivity" && $api == "radioactivity_decay_profile") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_radioactivity_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.info b/modules/commons/commons_radioactivity/commons_radioactivity.info
new file mode 100644
index 0000000..e3f4551
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.info
@@ -0,0 +1,18 @@
+name = Commons Radioactivity
+description = Helps to identify interesting content by automatically determining a decaying radioactivity value for individual pieces of conte
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = field_sql_storage
+dependencies[] = radioactivity
+dependencies[] = strongarm
+dependencies[] = views
+features[ctools][] = radioactivity:radioactivity_decay_profile:1
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_base][] = field_radioactivity
+features[radioactivity_decay_profile][] = commons_ra_node
+features[variable][] = commons_radioactivity_entity_types
+features[views_view][] = commons_radioactivity_admin
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.module b/modules/commons/commons_radioactivity/commons_radioactivity.module
new file mode 100644
index 0000000..7a5cfe4
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.module
@@ -0,0 +1,203 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Radioactivity feature.
+ */
+
+// Include files contain hook implementations for the corresponding modules.
+include_once 'commons_radioactivity.features.inc';
+include_once 'includes/incidents/commons_radioactivity.incidents_comment.inc';
+include_once 'includes/incidents/commons_radioactivity.incidents_flag.inc';
+include_once 'includes/incidents/commons_radioactivity.incidents_votingapi.inc';
+
+
+// Define constants for Commons Radioactivity incidents.
+// These could be changed to variables and made more configurable.
+define('COMMONS_RADIOACTIVITY_COMMENT', 2);
+define('COMMONS_RADIOACTIVITY_LIKE', 4);
+define('COMMONS_RADIOACTIVITY_NODE_IN_GROUP', 4);
+define('COMMONS_RADIOACTIVITY_FLAG_NODE', 6);
+
+/**
+* Implements hook_form_alter().
+*/
+function commons_radioactivity_form_alter(&$form, &$form_state, $form_id) {
+  if (isset($form['#node_edit_form']) && isset($form['field_radioactivity']) && user_access("edit radioactivity")) {
+    $form['field_radioactivity']['#type'] = 'fieldset';
+    $form['field_radioactivity']['#title'] = t('Radioactivity energy');
+    $form['field_radioactivity']['#collapsed'] = TRUE;
+    $form['field_radioactivity']['#group'] = 'additional_settings';
+  }
+}
+/**
+* Implements hook_system_info_alter().
+*/
+function commons_radioactivity_system_info_alter(&$info, $file, $type) {
+  // Commons Radioactivity dynamically adds field_radioactivity to
+  // content types that implement commons_radioactivity_field.
+  // We must add a corresponding line for each field instance
+  // to commons_radioactivity.info so that Features is aware of the instance
+  // and can sucessfully revert the field_instance component back
+  // to its default state.
+  if ($file->name == 'commons_radioactivity') {
+    $commons_radioactivity_entity_types = commons_radioactivity_get_radioactive_entity_types();
+    if (!empty($commons_radioactivity_entity_types)) {
+      foreach ($commons_radioactivity_entity_types as $entity_type => $bundles) {
+        foreach(array_keys($bundles) as $bundle) {
+          $info['features']['field_instance'][] = "$entity_type-$bundle-field_radioactivity";
+        }
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ */
+function commons_radioactivity_views_default_views_alter(&$views) {
+  // Add a "most active" exposed sort to Commons BW views.
+  foreach ($views as $view_id => $view) {
+    if (strpos($view_id, 'commons_bw_') === 0) {
+      $views[$view_id]->display['default']->display_options['sorts']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+      $views[$view_id]->display['default']->display_options['sorts']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+      $views[$view_id]->display['default']->display_options['sorts']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+      $views[$view_id]->display['default']->display_options['sorts']['field_radioactivity_radioactivity_energy']['order'] = 'DESC';
+      $views[$view_id]->display['default']->display_options['sorts']['field_radioactivity_radioactivity_energy']['exposed'] = TRUE;
+      $views[$view_id]->display['default']->display_options['sorts']['field_radioactivity_radioactivity_energy']['expose']['label'] = 'most active';
+    }
+  }
+}
+
+/**
+ * Implements hook_features_pipe_alter().
+ *
+ */
+function commons_radioactivity_features_pipe_alter(&$pipe, $data, $export) {
+  // Prevent Commons Radioactivity fields from being piped in features
+  // when a content type includes those fields.
+  if (!empty($pipe['field_instance'])) {
+    foreach ($pipe['field_instance'] as $delta => $value) {
+      $args = explode('-', $value);
+      $field_name = $args[2];
+      if ($field_name == 'field_radioactivity') {
+        unset($pipe['field_instance'][$delta]);
+      }
+    }
+  }
+  if (!empty($pipe['field_base'])) {
+    foreach ($pipe['field_base'] as $delta => $value) {
+      if ($delta == 'field_radioactivity') {
+        unset($pipe['field_base'][$delta]);
+      }
+    }
+  }
+}
+
+/**
+* Returns an array of entity types that are enabled via Commons Radioactivity.
+*/
+function commons_radioactivity_get_radioactive_entity_types() {
+  // Find all Commons Entity integrations.
+  $commons_entity_integrations = commons_entity_integration_info();
+  if (empty($commons_entity_integrations)) {
+    return array();
+  }
+
+  foreach ($commons_entity_integrations as $entity_type => $integration) {
+    foreach ($integration as $bundle => $options) {
+      if (isset($options['radioactivity_exclude']) && $options['radioactivity_exclude'] == TRUE) {
+        unset($commons_entity_integrations[$entity_type][$bundle]);
+      }
+    }
+    // If an entity type has no integrations, don't return it.
+    if (empty($commons_entity_integrations[$entity_type])) {
+      unset($commons_entity_integrations[$entity_type]);
+    }
+  }
+
+  return $commons_entity_integrations;
+
+}
+/**
+* Helper function to create Radioactivity incidents for nodes.
+*/
+function commons_radioactivity_incident_node($node, $value) {
+  $profile = radioactivity_get_field_profile('node', $node->type, 'field_radioactivity');
+
+  // Return if radioactivity doesn't exist or hasn't been created for the node yet
+  if (empty($node->field_radioactivity)) {
+    return;
+  }
+  // Prevent groups from going negative in energy.
+  if ($node->type == 'group' && $node->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy'] + $value < 0) {
+    return;
+  }
+  if ($profile && $profile->storageObject) {
+    $profile->storageObject->addIncident(new RadioactivityIncident('node', $node->type, 'field_radioactivity', LANGUAGE_NONE, $node->nid, $value, time()));
+  }
+  // If this node is a member of groups, generate an incident for each group.
+  if (!empty($node->og_group_ref)) {
+    commons_radioactivity_incident_groups($node, $value);
+  }
+}
+
+/**
+* Helper function to create Radioactivity incidents for groups
+* to which a node belongs.
+*/
+function commons_radioactivity_incident_groups($node, $value) {
+  $gids = array();
+  foreach ($node->og_group_ref[LANGUAGE_NONE] as $field) {
+    $gids[] = $field['target_id'];
+  }
+  // @Todo: We may wish to instead simply select the types of these groups.
+  $groups = node_load_multiple($gids);
+  foreach ($groups as $group) {
+    commons_radioactivity_incident_node($group, $value);
+  }
+}
+
+/**
+* When a node is moved between groups, create incidents that offset
+* the change in radioactivity for the former and newly containing groups.
+*/
+function commons_radioactivity_process_node_group_membership_change($node) {
+  $gids_original = array();
+  $gids_updated = array();
+  $groups_removed = array();
+  $groups_added = array();
+  // Collect any gids from the original node.
+  if (!empty($node->original->og_group_ref[LANGUAGE_NONE])) {
+    foreach ($node->original->og_group_ref[LANGUAGE_NONE] as $key => $field) {
+      $gids_original[] = $field['target_id'];
+    }
+  }
+  // Collect any gids from the updated node.
+  if (!empty($node->og_group_ref[LANGUAGE_NONE])) {
+    foreach ($node->og_group_ref[LANGUAGE_NONE] as $key => $field) {
+      $gids_updated[] = $field['target_id'];
+    }
+  }
+
+  // Find the gids that are being removed from the node with this update.
+  $gids_removed = array_diff($gids_original, $gids_updated);
+  // Find the gids that are being added to the node with this update.
+  $gids_added = array_diff($gids_updated, $gids_original);
+
+  if (!empty($gids_removed)) {
+    $groups_removed = entity_load_multiple_by_name('node', $gids_removed);
+    // Add negative incidents for groups that are no longer associated
+    // with this node.
+    foreach ($groups_removed as $key => $group) {
+      // We create an incident equal to the negative current value of this node.
+      commons_radioactivity_incident_node($group, -1 * $node->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy']);
+    }
+  }
+  // Add positive incidents for groups that are newly associated with this node.
+  if (!empty($gids_added)) {
+    $groups_added = entity_load_multiple_by_name('node', $gids_added);
+    foreach ($groups_added as $key => $group) {
+      commons_radioactivity_incident_node($group, $node->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy']);
+    }
+  }
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.radioactivity_decay_profile.inc b/modules/commons/commons_radioactivity/commons_radioactivity.radioactivity_decay_profile.inc
new file mode 100644
index 0000000..6f73af9
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.radioactivity_decay_profile.inc
@@ -0,0 +1,27 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity.radioactivity_decay_profile.inc
+ */
+
+/**
+ * Implements hook_default_radioactivity_decay_profile().
+ */
+function commons_radioactivity_default_radioactivity_decay_profile() {
+  $export = array();
+
+  $radioactivity_decay_profile = new stdClass();
+  $radioactivity_decay_profile->disabled = FALSE; /* Edit this to true to make a default radioactivity_decay_profile disabled initially */
+  $radioactivity_decay_profile->api_version = 1;
+  $radioactivity_decay_profile->machine_name = 'commons_ra_node';
+  $radioactivity_decay_profile->name = 'Commons Radioactivity (nodes)';
+  $radioactivity_decay_profile->description = '';
+  $radioactivity_decay_profile->enable_decay = 1;
+  $radioactivity_decay_profile->granularity = '60';
+  $radioactivity_decay_profile->half_life = 21600;
+  $radioactivity_decay_profile->cut_off = '0.1';
+  $radioactivity_decay_profile->storage = 'Live';
+  $export['commons_ra_node'] = $radioactivity_decay_profile;
+
+  return $export;
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.strongarm.inc b/modules/commons/commons_radioactivity/commons_radioactivity.strongarm.inc
new file mode 100644
index 0000000..71389df
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.strongarm.inc
@@ -0,0 +1,28 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_radioactivity_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'commons_radioactivity_entity_types';
+  $strongarm->value = array(
+    'node' => array(
+      'group' => 1,
+      'poll' => 1,
+      'post' => 1,
+      'wiki' => 1,
+    ),
+  );
+  $export['commons_radioactivity_entity_types'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity.views_default.inc b/modules/commons/commons_radioactivity/commons_radioactivity.views_default.inc
new file mode 100644
index 0000000..46325a7
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity.views_default.inc
@@ -0,0 +1,181 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_radioactivity_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_radioactivity_admin';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Radioactivity Admin';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Commons Radioactivity Administrative page';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['access']['perm'] = 'administer content types';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '20';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'title' => 'title',
+    'type' => 'type',
+    'name' => 'name',
+    'field_radioactivity' => 'field_radioactivity',
+    'created' => 'created',
+    'last_updated' => 'last_updated',
+  );
+  $handler->display->display_options['style_options']['default'] = 'field_radioactivity';
+  $handler->display->display_options['style_options']['info'] = array(
+    'title' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'type' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'name' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'field_radioactivity' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'desc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'created' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'last_updated' => array(
+      'sortable' => 1,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  /* Relationship: Content: Author */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'node';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Type */
+  $handler->display->display_options['fields']['type']['id'] = 'type';
+  $handler->display->display_options['fields']['type']['table'] = 'node';
+  $handler->display->display_options['fields']['type']['field'] = 'type';
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = 'Author';
+  /* Field: Content: Radioactivity */
+  $handler->display->display_options['fields']['field_radioactivity']['id'] = 'field_radioactivity';
+  $handler->display->display_options['fields']['field_radioactivity']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['fields']['field_radioactivity']['field'] = 'field_radioactivity';
+  $handler->display->display_options['fields']['field_radioactivity']['click_sort_column'] = 'radioactivity_energy';
+  $handler->display->display_options['fields']['field_radioactivity']['settings'] = array(
+    'energy' => '0',
+    'type' => 'energy',
+  );
+  /* Field: Content: Post date */
+  $handler->display->display_options['fields']['created']['id'] = 'created';
+  $handler->display->display_options['fields']['created']['table'] = 'node';
+  $handler->display->display_options['fields']['created']['field'] = 'created';
+  $handler->display->display_options['fields']['created']['label'] = 'Created';
+  $handler->display->display_options['fields']['created']['date_format'] = 'short';
+  /* Field: Content: Updated/commented date */
+  $handler->display->display_options['fields']['last_updated']['id'] = 'last_updated';
+  $handler->display->display_options['fields']['last_updated']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['last_updated']['field'] = 'last_updated';
+  $handler->display->display_options['fields']['last_updated']['label'] = 'Last update/comment';
+  $handler->display->display_options['fields']['last_updated']['date_format'] = 'short';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Radioactivity (field_radioactivity:radioactivity_energy) */
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['operator'] = '>';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['value']['value'] = '0';
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'page');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['path'] = 'commons-radioactivity-admin';
+  $translatables['commons_radioactivity_admin'] = array(
+    t('Master'),
+    t('Commons Radioactivity Administrative page'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('author'),
+    t('Title'),
+    t('Type'),
+    t('Author'),
+    t('Radioactivity'),
+    t('Created'),
+    t('Last update/comment'),
+    t('Page'),
+  );
+  $export['commons_radioactivity_admin'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.features.inc b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.features.inc
new file mode 100644
index 0000000..fd3ce07
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.features.inc
@@ -0,0 +1,12 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity_groups.features.inc
+ */
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_radioactivity_groups_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.info b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.info
new file mode 100644
index 0000000..54e8dd2
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.info
@@ -0,0 +1,12 @@
+name = Commons Radioactivity Groups
+description = Views integration for Group radioactivity
+core = 7.x
+package = Commons - Building Blocks
+dependencies[] = commons_radioactivity
+dependencies[] = og
+dependencies[] = views_content
+dependencies[] = views_field_view
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[views_view][] = commons_radioactivity_groups_active_in_group
+features[views_view][] = commons_radioactivity_groups_most_active
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.install b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.install
new file mode 100644
index 0000000..cb52424
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.install
@@ -0,0 +1,12 @@
+<?php
+
+/**
+ * Use content type machine names for generating CSS classes.
+ */
+function commons_radioactivity_groups_update_7300() {
+  $revert = array(
+    'commons_radioactivity_groups' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.module b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.module
new file mode 100644
index 0000000..4a0d282
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.module
@@ -0,0 +1,33 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Radioactivity Groups feature.
+ */
+
+include_once 'commons_radioactivity_groups.features.inc';
+
+/**
+* Implements hook_node_insert().
+*/
+function commons_radioactivity_groups_node_insert($node) {
+  // If there are no groups associated with this node
+  // then there's nothing to do here.
+  if (empty($node->og_group_ref) || !isset($node->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy'])) {
+    return;
+  }
+  commons_radioactivity_incident_groups($node, $node->field_radioactivity[LANGUAGE_NONE][0]['radioactivity_energy']);
+}
+
+/**
+* Implements hook_node_update().
+*/
+function commons_radioactivity_groups_node_update($node) {
+  // If there are no groups associated with this node
+  // then there's nothing to do here.
+  if (!isset($node->og_group_ref)) {
+    return;
+  }
+  if ($node->og_group_ref !== $node->original->og_group_ref) {
+    commons_radioactivity_process_node_group_membership_change($node);
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.views_default.inc b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.views_default.inc
new file mode 100644
index 0000000..5b412f5
--- /dev/null
+++ b/modules/commons/commons_radioactivity/commons_radioactivity_groups/commons_radioactivity_groups.views_default.inc
@@ -0,0 +1,239 @@
+<?php
+/**
+ * @file
+ * commons_radioactivity_groups.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_radioactivity_groups_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_radioactivity_groups_active_in_group';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Radioactivity - Active content in a group';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Active in this group';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Type */
+  $handler->display->display_options['fields']['type']['id'] = 'type';
+  $handler->display->display_options['fields']['type']['table'] = 'node';
+  $handler->display->display_options['fields']['type']['field'] = 'type';
+  $handler->display->display_options['fields']['type']['label'] = '';
+  $handler->display->display_options['fields']['type']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['type']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['type']['machine_name'] = TRUE;
+  /* Field: Content: Nid */
+  $handler->display->display_options['fields']['nid']['id'] = 'nid';
+  $handler->display->display_options['fields']['nid']['table'] = 'node';
+  $handler->display->display_options['fields']['nid']['field'] = 'nid';
+  $handler->display->display_options['fields']['nid']['label'] = '';
+  $handler->display->display_options['fields']['nid']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['nid']['element_label_colon'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  $handler->display->display_options['fields']['title']['element_class'] = 'type-[type]';
+  $handler->display->display_options['fields']['title']['element_label_colon'] = FALSE;
+  /* Field: Global: View */
+  $handler->display->display_options['fields']['view']['id'] = 'view';
+  $handler->display->display_options['fields']['view']['table'] = 'views';
+  $handler->display->display_options['fields']['view']['field'] = 'view';
+  $handler->display->display_options['fields']['view']['label'] = '';
+  $handler->display->display_options['fields']['view']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['view']['hide_empty'] = TRUE;
+  $handler->display->display_options['fields']['view']['view'] = 'commons_groups_recent_content';
+  $handler->display->display_options['fields']['view']['arguments'] = '[!nid]';
+  /* Sort criterion: Content: Radioactivity (field_radioactivity:radioactivity_energy) */
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['order'] = 'DESC';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_action'] = 'not found';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Radioactivity (field_radioactivity:radioactivity_energy) */
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['operator'] = '>=';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['value']['value'] = '.1';
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['argument_input'] = array(
+    'gid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'OG membership: Group ID',
+    ),
+  );
+  $translatables['commons_radioactivity_groups_active_in_group'] = array(
+    t('Master'),
+    t('Active in this group'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('OG membership from node'),
+    t('All'),
+    t('Content pane'),
+    t('Commons'),
+  );
+  $export['commons_radioactivity_groups_active_in_group'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_radioactivity_groups_most_active';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Most Active Groups';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Most active groups';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '3';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Field: Content: Nid */
+  $handler->display->display_options['fields']['nid']['id'] = 'nid';
+  $handler->display->display_options['fields']['nid']['table'] = 'node';
+  $handler->display->display_options['fields']['nid']['field'] = 'nid';
+  $handler->display->display_options['fields']['nid']['label'] = '';
+  $handler->display->display_options['fields']['nid']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['nid']['element_label_colon'] = FALSE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Global: View */
+  $handler->display->display_options['fields']['view']['id'] = 'view';
+  $handler->display->display_options['fields']['view']['table'] = 'views';
+  $handler->display->display_options['fields']['view']['field'] = 'view';
+  $handler->display->display_options['fields']['view']['label'] = '';
+  $handler->display->display_options['fields']['view']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['view']['hide_empty'] = TRUE;
+  $handler->display->display_options['fields']['view']['view'] = 'commons_groups_recent_content';
+  $handler->display->display_options['fields']['view']['arguments'] = '[!nid]';
+  /* Sort criterion: Content: Radioactivity (field_radioactivity:radioactivity_energy) */
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['order'] = 'DESC';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Field: Group (group_group) */
+  $handler->display->display_options['filters']['group_group_value']['id'] = 'group_group_value';
+  $handler->display->display_options['filters']['group_group_value']['table'] = 'field_data_group_group';
+  $handler->display->display_options['filters']['group_group_value']['field'] = 'group_group_value';
+  $handler->display->display_options['filters']['group_group_value']['value'] = array(
+    1 => '1',
+  );
+  /* Filter criterion: Content: Radioactivity (field_radioactivity:radioactivity_energy) */
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['operator'] = '>=';
+  $handler->display->display_options['filters']['field_radioactivity_radioactivity_energy']['value']['value'] = '.1';
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $translatables['commons_radioactivity_groups_most_active'] = array(
+    t('Master'),
+    t('Most active groups'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Content pane'),
+    t('Commons'),
+  );
+  $export['commons_radioactivity_groups_most_active'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_comment.inc b/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_comment.inc
new file mode 100644
index 0000000..9d4f96a
--- /dev/null
+++ b/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_comment.inc
@@ -0,0 +1,60 @@
+<?php
+
+/**
+* Implements hook_comment_insert().
+*   Increase Radioactivity when a node recieves a comment.
+*/
+function commons_radioactivity_comment_insert($comment) {
+  // Moderated comments should not add radioactivity.
+  if (!$comment->status) {
+    return;
+  }
+  $node = node_load($comment->nid);
+  // A user's comment on her own node should not add radioactivity.
+  if ($node->uid == $comment->uid) {
+    return;
+  }
+  commons_radioactivity_incident_node($node, COMMONS_RADIOACTIVITY_COMMENT);
+}
+
+/**
+* Implements hook_comment_insert().
+*   Increase Radioactivity when a node recieves a comment.
+*/
+function commons_radioactivity_comment_delete($comment) {
+  // Deleting a comment that wasn't published shouldn't affect radioactivity.
+  if (!$comment->status) {
+    return;
+  }
+  $node = node_load($comment->nid);
+  // This comment didn't add radioactivity originally, so we don't need to
+  // offset any with its deletion.
+  if ($node->uid == $comment->uid) {
+    return;
+  }
+  commons_radioactivity_incident_node($node, -1 * COMMONS_RADIOACTIVITY_COMMENT);
+}
+
+/**
+* Implements hook_comment_update().
+*   Change radioactivity when a comment is published or unpuiblished.
+*/
+function commons_radioactivity_comment_update($comment) {
+  // $comment_change will be equal to 1 if we're changing the publishing status
+  // of the comment.
+  $comment_change = $comment->status + $comment->original->status;
+  // Is this comment's published status changing?
+  if ($comment_change == 1) {
+    $node = node_load($comment->nid);
+    switch ($comment->status) {
+      // The comment is being unpublished.
+      case 0:
+        commons_radioactivity_comment_delete($comment);
+        break;
+      // The comment is being published.
+      case 1;
+        commons_radioactivity_comment_insert($comment);
+        break;
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_flag.inc b/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_flag.inc
new file mode 100644
index 0000000..c2d6794
--- /dev/null
+++ b/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_flag.inc
@@ -0,0 +1,28 @@
+<?php
+
+/**
+* Implements hook_flag().
+*   Trigger radioactivity incidents when a user follows a ndoe or group.
+*/
+function commons_radioactivity_flag($op, $flag, $content_id, $account, $fcid) {
+  if (in_array($flag->name, array('commons_follow_node', 'commons_follow_group'))) {
+
+    $node = node_load($content_id);
+
+    if ($op == 'flag') {
+      // A user following her own node shouldn't add to its radioactivity.
+      if ($node->uid == $account->uid) {
+        return;
+      }
+      commons_radioactivity_incident_node($node,  COMMONS_RADIOACTIVITY_FLAG_NODE);
+    }
+
+    if ($op == 'unflag') {
+      // A user unfollowing her own node shouldn't add to its radioactivity.
+      if ($node->uid == $account->uid) {
+        return;
+      }
+      commons_radioactivity_incident_node($node,  -1 * COMMONS_RADIOACTIVITY_FLAG_NODE);
+    }
+  }
+}
diff --git a/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_votingapi.inc b/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_votingapi.inc
new file mode 100644
index 0000000..a075ccb
--- /dev/null
+++ b/modules/commons/commons_radioactivity/includes/incidents/commons_radioactivity.incidents_votingapi.inc
@@ -0,0 +1,34 @@
+<?php
+
+/**
+* Implements hook_votingapi_insert().
+*   Increase Radioactivity when a node receives a "Like."
+*/
+function commons_radioactivity_votingapi_insert($votes) {
+  foreach ($votes as $vote) {
+    if ($vote['tag'] == 'commons_like' && $vote['entity_type'] == 'node') {
+      $node = node_load($vote['entity_id']);
+      // A user's vote on her own node should not increase radioactivity.
+      if ($node->uid != $vote['uid']) {
+        commons_radioactivity_incident_node($node, COMMONS_RADIOACTIVITY_LIKE);
+      }
+    }
+  }
+}
+
+/**
+* Implements hook_votingapi_insert().
+*   Decrease Radioactivity when a "Like" is cancelled.
+*/
+function commons_radioactivity_votingapi_delete($votes) {
+  foreach ($votes as $vote) {
+    if (isset($vote['tag']) && $vote['tag'] == 'commons_like' && $vote['entity_type'] == 'node') {
+      $node = node_load($vote['entity_id']);
+      // A user's vote on her own node did not increase radioactivity, so
+      // we don't need to offset it when the vote is deleted.
+      if ($node->uid != $vote['uid']) {
+        commons_radioactivity_incident_node($node, -1 * COMMONS_RADIOACTIVITY_LIKE);
+      }
+    }
+  }
+}
diff --git a/modules/commons/commons_search/commons_search.features.inc b/modules/commons/commons_search/commons_search.features.inc
new file mode 100644
index 0000000..61b7b0e
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.features.inc
@@ -0,0 +1,26 @@
+<?php
+/**
+ * @file
+ * commons_search.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_search_ctools_plugin_api() {
+  list($module, $api) = func_get_args();
+  if ($module == "panelizer" && $api == "panelizer") {
+    return array("version" => "1");
+  }
+  list($module, $api) = func_get_args();
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_search_views_api() {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_search/commons_search.features.menu_links.inc b/modules/commons/commons_search/commons_search.features.menu_links.inc
new file mode 100644
index 0000000..7246f98
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.features.menu_links.inc
@@ -0,0 +1,36 @@
+<?php
+/**
+ * @file
+ * commons_search.features.menu_links.inc
+ */
+
+/**
+ * Implements hook_menu_default_menu_links().
+ */
+function commons_search_menu_default_menu_links() {
+  $menu_links = array();
+
+  // Exported menu link: main-menu:events
+  $menu_links['main-menu:search'] = array(
+    'menu_name' => 'main-menu',
+    'link_path' => 'search',
+    'router_path' => 'search',
+    'link_title' => 'Search',
+    'options' => array(
+      'attributes' => array(),
+    ),
+    'module' => 'menu',
+    'hidden' => 0,
+    'external' => 0,
+    'has_children' => 0,
+    'expanded' => 0,
+    'weight' => 3,
+    'customized' => 1,
+  );
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Search');
+
+
+  return $menu_links;
+}
diff --git a/modules/commons/commons_search/commons_search.features.user_permission.inc b/modules/commons/commons_search/commons_search.features.user_permission.inc
new file mode 100644
index 0000000..86974d4
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.features.user_permission.inc
@@ -0,0 +1,47 @@
+<?php
+/**
+ * @file
+ * commons_search.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_search_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: search content.
+  $permissions['search content'] = array(
+    'name' => 'search content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'search',
+  );
+
+  // Exported permission: use advanced search.
+  $permissions['use advanced search'] = array(
+    'name' => 'use advanced search',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'search',
+  );
+
+  // Exported permission: use custom search.
+  $permissions['use custom search'] = array(
+    'name' => 'use custom search',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'custom_search',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_search/commons_search.info b/modules/commons/commons_search/commons_search.info
new file mode 100644
index 0000000..a1789c7
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.info
@@ -0,0 +1,63 @@
+name = Commons Search
+description = Provide the global search block.
+core = 7.x
+package = Commons - Search
+dependencies[] = ctools
+dependencies[] = custom_search
+dependencies[] = features
+dependencies[] = search
+dependencies[] = strongarm
+dependencies[] = views
+dependencies[] = views_load_more
+stylesheets[all][] = css/commons_search.css
+features[ctools][] = panelizer:panelizer:1
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:1
+features[menu_links][] = main-menu:search
+features[user_permission][] = search content
+features[user_permission][] = use advanced search
+features[user_permission][] = use custom search
+features[variable][] = custom_search_any_force
+features[variable][] = custom_search_any_restricts
+features[variable][] = custom_search_content_types_region
+features[variable][] = custom_search_content_types_weight
+features[variable][] = custom_search_criteria_negative_display
+features[variable][] = custom_search_criteria_negative_label
+features[variable][] = custom_search_criteria_negative_region
+features[variable][] = custom_search_criteria_negative_weight
+features[variable][] = custom_search_criteria_or_display
+features[variable][] = custom_search_criteria_or_label
+features[variable][] = custom_search_criteria_or_region
+features[variable][] = custom_search_criteria_or_weight
+features[variable][] = custom_search_criteria_phrase_display
+features[variable][] = custom_search_criteria_phrase_label
+features[variable][] = custom_search_criteria_phrase_region
+features[variable][] = custom_search_criteria_phrase_weight
+features[variable][] = custom_search_custom_paths_region
+features[variable][] = custom_search_custom_paths_weight
+features[variable][] = custom_search_delta
+features[variable][] = custom_search_image
+features[variable][] = custom_search_image_path
+features[variable][] = custom_search_label
+features[variable][] = custom_search_label_visibility
+features[variable][] = custom_search_max_length
+features[variable][] = custom_search_node_types
+features[variable][] = custom_search_node_types_excluded
+features[variable][] = custom_search_order
+features[variable][] = custom_search_paths
+features[variable][] = custom_search_paths_selector
+features[variable][] = custom_search_paths_selector_label
+features[variable][] = custom_search_paths_selector_label_visibility
+features[variable][] = custom_search_search_box_region
+features[variable][] = custom_search_search_box_weight
+features[variable][] = custom_search_size
+features[variable][] = custom_search_submit_button_region
+features[variable][] = custom_search_submit_button_weight
+features[variable][] = custom_search_submit_text
+features[variable][] = custom_search_text
+features[variable][] = custom_search_type_selector
+features[variable][] = custom_search_type_selector_all
+features[variable][] = custom_search_type_selector_label
+features[variable][] = custom_search_type_selector_label_visibility
+features[views_view][] = group_search
\ No newline at end of file
diff --git a/modules/commons/commons_search/commons_search.install b/modules/commons/commons_search/commons_search.install
new file mode 100644
index 0000000..5b26689
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.install
@@ -0,0 +1,8 @@
+<?php
+
+/**
+ * Disable rich_snippets module
+ */
+function commons_search_update_7001() {
+  module_disable(array('rich_snippets'));
+}
diff --git a/modules/commons/commons_search/commons_search.module b/modules/commons/commons_search/commons_search.module
new file mode 100644
index 0000000..4a04560
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.module
@@ -0,0 +1,135 @@
+<?php
+/**
+ * commons_search.module
+ * Code for the Commons Search feature.
+ */
+
+include_once 'commons_search.features.inc';
+
+/**
+ * Implements hook_module_implements_alter().
+ */
+function commons_search_module_implements_alter(&$implementations, $hook) {
+  if ($hook == 'form_alter') {
+    // We move commons_search to the end so it gets processed last.
+    $group = $implementations['commons_search'];
+    unset($implementations['commons_search']);
+    $implementations['commons_search'] = $group;
+  }
+}
+
+/**
+ * Custom search form that switches between Core and Solr depending on which is
+ * the enabled search module.
+ */
+function commons_search_form_alter(&$form, &$form_state, $form_id) {
+
+  if ($form_id == 'search_block_form') {
+    // Move the textfield to after the drop down.
+    $site_key = 'c-all';
+    $form['search_block_form']['#weight'] = 1;
+    if (module_exists('commons_search_core')) {
+      // We're using faceted core search, so change Site search key to reflect
+      // the change of search engines.
+      $site_key = 'o-search_facetapi';
+    }
+    else {
+      if (module_exists('apachesolr_search')) {
+        // Are we using Apache Solr? If so change the Site search key to reflect
+        // the change of search engines.
+        $site_key = 'o-solr';
+      }
+    }
+    // Overwrite all options so we only have 3 (at most).
+    $form['custom_search_types']['#options'] = array(
+      $site_key => t('Site'),
+      'c-user' => t('Users'),
+    );
+    $group = FALSE;
+    $node = current_path();
+    if ((strrpos($node, 'node/') !== FALSE || strrpos($node, 'group/') !== FALSE)
+      && is_numeric(substr($node, strrpos($node, '/') + 1))
+    ) {
+      // If we're on a page that looks like a group node, see if it is actually
+      // a group node.
+      $node = node_load(substr($node, strrpos($node, '/') + 1));
+      if (!empty($node)) {
+        $group = ($node->type == 'group');
+      }
+    }
+    if ($group) {
+      // Current page is a group node, so add group search option to the
+      // dropdown menu and set the current group id.
+      $form['custom_search_types']['#options']['o-commons_search'] = t('This group');
+      $form['custom_search_types']["#default_value"] = 'o-commons_search';
+      $form_state['search_group_id'] = $node->nid;
+    }
+    if (arg(0) == 'search') {
+      // If we've already searched, refill the search box with the current
+      // search keywords.
+      $form['search_block_form']['#default_value'] = check_plain(arg(2));
+    }
+    $keys = arg(2);
+    if (!module_exists('commons_search_solr') && !empty($keys)) {
+      // Remove the search keys from the form action only if we're using core search.
+      $form['#action'] = str_replace("/" . check_plain(arg(2)), '', $form['#action']);
+    }
+  }
+}
+
+/**
+ * Search form submit handler.
+ * Add group id filter if appropriate.
+ */
+function commons_search_search_form_submit($form, &$form_state) {
+  if ($form_state['values']['custom_search_types'] == 'o-commons_search'
+    && isset($form_state['search_group_id'])
+  ) {
+    $keys = $form_state['values']['search_block_form'];
+    if (module_exists('apachesolr_search')) {
+      // Add on a filter to the solr query to only list results within the
+      // specified group.
+      $qm = (strpos($form_state['redirect'], '?') !== FALSE ? '' : '?');
+      $form_state['redirect'] .= $qm . '&f[1]=sm_og_group_ref:node:' . $form_state['search_group_id'];
+    }
+    else {
+      // Using core search to search within a group doesn't work, so we simply
+      // use a view with exposed search terms to do the searching.
+      drupal_goto('search/group/' . $form_state['search_group_id'], array('query' => array('keys' => $keys)));
+    }
+  }
+  else {
+    if ($form_state['values']['custom_search_types'] == 'c-user') {
+      // Force update the redirect on User search since Custom Search is weird.
+      $keys = check_plain($form_state['values']['search_block_form']);
+      $form_state['redirect'] = 'search/user/' . $keys;
+    }
+  }
+}
+
+function commons_search_process_search_result(&$variables) {
+}
+/**
+ * Implements hook_preprocess_hook().
+ */
+function commons_search_process_search_results(&$variables) {
+  $variables['result_count'] = count($variables['results']);
+  if (isset($variables['response'])
+    && isset($variables['response']->request)
+    && preg_match('/sm_og_group_ref:"node:([0-9]+)"&/', urldecode($variables['response']->request), $match)
+  ) {
+    $group = node_load($match[1]);
+    $title = t('Search within !group', array('!group' => '<em>' . $group->title . '</em>'));
+    $variables['title'] = $title;
+  }
+}
+
+/**
+ * Implements hook_theme_registry_alter().
+ */
+function commons_search_theme_registry_alter(&$theme_registry) {
+  // Remove AT breadcrumb preprocess since it adds raw RDFa data into the title.
+  $theme_registry['breadcrumb']['preprocess functions'] = array_flip($theme_registry['breadcrumb']['preprocess functions']);
+  unset($theme_registry['breadcrumb']['preprocess functions']['adaptivetheme_preprocess_breadcrumb']);
+  $theme_registry['breadcrumb']['preprocess functions'] = array_flip($theme_registry['breadcrumb']['preprocess functions']);
+}
diff --git a/modules/commons/commons_search/commons_search.strongarm.inc b/modules/commons/commons_search/commons_search.strongarm.inc
new file mode 100644
index 0000000..5b4734d
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.strongarm.inc
@@ -0,0 +1,353 @@
+<?php
+/**
+ * @file
+ * commons_search.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_search_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_any_force';
+  $strongarm->value = 1;
+  $export['custom_search_any_force'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_any_restricts';
+  $strongarm->value = 0;
+  $export['custom_search_any_restricts'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_content_types_region';
+  $strongarm->value = 'block';
+  $export['custom_search_content_types_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_content_types_weight';
+  $strongarm->value = '0';
+  $export['custom_search_content_types_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_negative_display';
+  $strongarm->value = 0;
+  $export['custom_search_criteria_negative_display'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_negative_label';
+  $strongarm->value = 'Containing none of the words';
+  $export['custom_search_criteria_negative_label'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_negative_region';
+  $strongarm->value = 'block';
+  $export['custom_search_criteria_negative_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_negative_weight';
+  $strongarm->value = '8';
+  $export['custom_search_criteria_negative_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_or_display';
+  $strongarm->value = 0;
+  $export['custom_search_criteria_or_display'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_or_label';
+  $strongarm->value = 'Containing any of the words';
+  $export['custom_search_criteria_or_label'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_or_region';
+  $strongarm->value = 'block';
+  $export['custom_search_criteria_or_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_or_weight';
+  $strongarm->value = '6';
+  $export['custom_search_criteria_or_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_phrase_display';
+  $strongarm->value = 0;
+  $export['custom_search_criteria_phrase_display'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_phrase_label';
+  $strongarm->value = 'Containing the phrase';
+  $export['custom_search_criteria_phrase_label'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_phrase_region';
+  $strongarm->value = 'block';
+  $export['custom_search_criteria_phrase_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_criteria_phrase_weight';
+  $strongarm->value = '7';
+  $export['custom_search_criteria_phrase_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_custom_paths_region';
+  $strongarm->value = 'block';
+  $export['custom_search_custom_paths_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_custom_paths_weight';
+  $strongarm->value = '9';
+  $export['custom_search_custom_paths_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_delta';
+  $strongarm->value = '';
+  $export['custom_search_delta'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_image';
+  $strongarm->value = '';
+  $export['custom_search_image'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_image_path';
+  $strongarm->value = '';
+  $export['custom_search_image_path'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_label';
+  $strongarm->value = '';
+  $export['custom_search_label'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_label_visibility';
+  $strongarm->value = 1;
+  $export['custom_search_label_visibility'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_max_length';
+  $strongarm->value = '128';
+  $export['custom_search_max_length'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_node_types';
+  $strongarm->value = array(
+    'document' => 0,
+    'event' => 0,
+    'group' => 0,
+    'notice' => 0,
+    'page' => 0,
+    'post' => 0,
+    'wiki' => 0,
+  );
+  $export['custom_search_node_types'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_node_types_excluded';
+  $strongarm->value = array(
+    'document' => 0,
+    'event' => 0,
+    'group' => 0,
+    'notice' => 0,
+    'page' => 0,
+    'post' => 0,
+    'wiki' => 0,
+  );
+  $export['custom_search_node_types_excluded'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_order';
+  $strongarm->value = array(
+    'search_box' => array(
+      'sort' => '-1',
+      'region' => 'block',
+    ),
+    'criteria_or' => array(
+      'sort' => '6',
+      'region' => 'block',
+    ),
+    'criteria_phrase' => array(
+      'sort' => '7',
+      'region' => 'block',
+    ),
+    'criteria_negative' => array(
+      'sort' => '8',
+      'region' => 'block',
+    ),
+    'custom_paths' => array(
+      'sort' => '9',
+      'region' => 'block',
+    ),
+    'submit_button' => array(
+      'sort' => '10',
+      'region' => 'block',
+    ),
+    'content_types' => array(
+      'sort' => '0',
+      'region' => 'block',
+    ),
+  );
+  $export['custom_search_order'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_paths';
+  $strongarm->value = '';
+  $export['custom_search_paths'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_paths_selector';
+  $strongarm->value = 'select';
+  $export['custom_search_paths_selector'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_paths_selector_label';
+  $strongarm->value = 'Customize your search';
+  $export['custom_search_paths_selector_label'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_paths_selector_label_visibility';
+  $strongarm->value = 0;
+  $export['custom_search_paths_selector_label_visibility'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_search_box_region';
+  $strongarm->value = 'block';
+  $export['custom_search_search_box_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_search_box_weight';
+  $strongarm->value = '-1';
+  $export['custom_search_search_box_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_size';
+  $strongarm->value = '15';
+  $export['custom_search_size'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_submit_button_region';
+  $strongarm->value = 'block';
+  $export['custom_search_submit_button_region'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_submit_button_weight';
+  $strongarm->value = '10';
+  $export['custom_search_submit_button_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_submit_text';
+  $strongarm->value = 'Search';
+  $export['custom_search_submit_text'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_text';
+  $strongarm->value = '';
+  $export['custom_search_text'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_type_selector';
+  $strongarm->value = 'select';
+  $export['custom_search_type_selector'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_type_selector_all';
+  $strongarm->value = 'Site';
+  $export['custom_search_type_selector_all'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_type_selector_label';
+  $strongarm->value = 'Search for';
+  $export['custom_search_type_selector_label'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_type_selector_label_visibility';
+  $strongarm->value = 0;
+  $export['custom_search_type_selector_label_visibility'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/commons_search.views_default.inc b/modules/commons/commons_search/commons_search.views_default.inc
new file mode 100644
index 0000000..010c402
--- /dev/null
+++ b/modules/commons/commons_search/commons_search.views_default.inc
@@ -0,0 +1,124 @@
+<?php
+/**
+ * @file
+ * commons_search.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_search_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'group_search';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'Group Search';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Search within group';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['exposed_form']['options']['expose_sort_order'] = FALSE;
+  $handler->display->display_options['exposed_form']['options']['autosubmit'] = TRUE;
+  $handler->display->display_options['pager']['type'] = 'load_more';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '0';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'node';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No results found.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Search: Score */
+  $handler->display->display_options['sorts']['score']['id'] = 'score';
+  $handler->display->display_options['sorts']['score']['table'] = 'search_index';
+  $handler->display->display_options['sorts']['score']['field'] = 'score';
+  $handler->display->display_options['sorts']['score']['order'] = 'DESC';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Search: Search Terms */
+  $handler->display->display_options['filters']['keys']['id'] = 'keys';
+  $handler->display->display_options['filters']['keys']['table'] = 'search_index';
+  $handler->display->display_options['filters']['keys']['field'] = 'keys';
+  $handler->display->display_options['filters']['keys']['exposed'] = TRUE;
+  $handler->display->display_options['filters']['keys']['expose']['operator_id'] = 'keys_op';
+  $handler->display->display_options['filters']['keys']['expose']['label'] = 'Search Terms';
+  $handler->display->display_options['filters']['keys']['expose']['operator'] = 'keys_op';
+  $handler->display->display_options['filters']['keys']['expose']['identifier'] = 'keys';
+  $handler->display->display_options['filters']['keys']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+  );
+
+  /* Display: Page */
+  $handler = $view->new_display('page', 'Page', 'page_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['path'] = 'search/group/%';
+  $translatables['group_search'] = array(
+    t('Master'),
+    t('Search within group'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No results found.'),
+    t('OG membership from node'),
+    t('All'),
+    t('Search Terms'),
+    t('Page'),
+  );
+  $export['group_search'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/css/commons_search.css b/modules/commons/commons_search/css/commons_search.css
new file mode 100644
index 0000000..6885430
--- /dev/null
+++ b/modules/commons/commons_search/css/commons_search.css
@@ -0,0 +1,3 @@
+div.view-group-search div.view-filters {
+ /*display: none;*/
+}
\ No newline at end of file
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.facetapi_defaults.inc b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.facetapi_defaults.inc
new file mode 100644
index 0000000..fdd4884
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.facetapi_defaults.inc
@@ -0,0 +1,331 @@
+<?php
+/**
+ * @file
+ * commons_search_core.facetapi_defaults.inc
+ */
+
+/**
+ * Implements hook_facetapi_default_facet_settings().
+ */
+function commons_search_core_facetapi_default_facet_settings() {
+  $export = array();
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search::author';
+  $facet->searcher = 'search';
+  $facet->realm = '';
+  $facet->facet = 'author';
+  $facet->enabled = FALSE;
+  $facet->settings = array(
+    'operator' => 'and',
+    'hard_limit' => '50',
+    'dependencies' => array(
+      'roles' => array(),
+    ),
+    'facet_mincount' => 1,
+    'facet_missing' => 0,
+    'flatten' => 0,
+    'query_type' => 'term',
+  );
+  $export['search::author'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search::bundle';
+  $facet->searcher = 'search';
+  $facet->realm = '';
+  $facet->facet = 'bundle';
+  $facet->enabled = FALSE;
+  $facet->settings = array(
+    'operator' => 'and',
+    'hard_limit' => '50',
+    'dependencies' => array(
+      'roles' => array(),
+    ),
+    'facet_mincount' => 1,
+    'facet_missing' => 0,
+    'flatten' => 0,
+    'query_type' => 'term',
+  );
+  $export['search::bundle'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search::changed';
+  $facet->searcher = 'search';
+  $facet->realm = '';
+  $facet->facet = 'changed';
+  $facet->enabled = FALSE;
+  $facet->settings = array(
+    'operator' => 'and',
+    'hard_limit' => '50',
+    'dependencies' => array(
+      'roles' => array(),
+    ),
+    'facet_mincount' => 1,
+    'facet_missing' => 0,
+    'flatten' => 0,
+    'query_type' => 'date_range',
+  );
+  $export['search::changed'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search::created';
+  $facet->searcher = 'search';
+  $facet->realm = '';
+  $facet->facet = 'created';
+  $facet->enabled = FALSE;
+  $facet->settings = array(
+    'operator' => 'and',
+    'hard_limit' => '50',
+    'dependencies' => array(
+      'roles' => array(),
+      'bundle' => 'none',
+      'bundle_selected' => array(),
+    ),
+    'facet_mincount' => 1,
+    'facet_missing' => 0,
+    'flatten' => 0,
+    'query_type' => 'date_range',
+  );
+  $export['search::created'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search::field_topics';
+  $facet->searcher = 'search';
+  $facet->realm = '';
+  $facet->facet = 'field_topics';
+  $facet->enabled = FALSE;
+  $facet->settings = array(
+    'operator' => 'and',
+    'hard_limit' => '50',
+    'dependencies' => array(
+      'roles' => array(),
+    ),
+    'facet_mincount' => 1,
+    'facet_missing' => 0,
+    'flatten' => 0,
+    'query_type' => 'term',
+  );
+  $export['search::field_topics'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search:block:author';
+  $facet->searcher = 'search';
+  $facet->realm = 'block';
+  $facet->facet = 'author';
+  $facet->enabled = TRUE;
+  $facet->settings = array(
+    'weight' => 0,
+    'widget' => 'facetapi_links',
+    'filters' => array(),
+    'active_sorts' => array(
+      'active' => 'active',
+      'count' => 'count',
+      'display' => 'display',
+      'indexed' => 0,
+    ),
+    'sort_weight' => array(
+      'active' => '-50',
+      'count' => '-49',
+      'display' => '-48',
+      'indexed' => '0',
+    ),
+    'sort_order' => array(
+      'active' => '3',
+      'count' => '3',
+      'display' => '4',
+      'indexed' => '4',
+    ),
+    'empty_behavior' => 'text',
+    'soft_limit' => '20',
+    'nofollow' => 1,
+    'show_expanded' => 0,
+    'empty_text' => array(
+      'value' => 'None available.',
+      'format' => 'filtered_html',
+    ),
+    'submit_realm' => 'Save and go back to realm settings',
+  );
+  $export['search:block:author'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search:block:bundle';
+  $facet->searcher = 'search';
+  $facet->realm = 'block';
+  $facet->facet = 'bundle';
+  $facet->enabled = TRUE;
+  $facet->settings = array(
+    'weight' => 0,
+    'widget' => 'facetapi_links',
+    'filters' => array(),
+    'active_sorts' => array(
+      'active' => 'active',
+      'count' => 'count',
+      'display' => 'display',
+      'indexed' => 0,
+    ),
+    'sort_weight' => array(
+      'active' => '-50',
+      'count' => '-49',
+      'display' => '-48',
+      'indexed' => '0',
+    ),
+    'sort_order' => array(
+      'active' => '3',
+      'count' => '3',
+      'display' => '4',
+      'indexed' => '4',
+    ),
+    'empty_behavior' => 'text',
+    'soft_limit' => '20',
+    'nofollow' => 1,
+    'show_expanded' => 0,
+    'empty_text' => array(
+      'value' => 'No options available',
+      'format' => 'filtered_html',
+    ),
+    'submit_realm' => 'Save and go back to realm settings',
+  );
+  $export['search:block:bundle'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search:block:changed';
+  $facet->searcher = 'search';
+  $facet->realm = 'block';
+  $facet->facet = 'changed';
+  $facet->enabled = TRUE;
+  $facet->settings = array(
+    'weight' => 0,
+    'widget' => 'date_range',
+    'filters' => array(),
+    'active_sorts' => array(
+      'active' => 'active',
+      'indexed' => 'indexed',
+      'count' => 0,
+      'display' => 0,
+    ),
+    'sort_weight' => array(
+      'active' => '-50',
+      'indexed' => '-49',
+      'count' => '0',
+      'display' => '0',
+    ),
+    'sort_order' => array(
+      'active' => '3',
+      'indexed' => '4',
+      'count' => '4',
+      'display' => '4',
+    ),
+    'empty_behavior' => 'none',
+    'soft_limit' => '20',
+    'nofollow' => 1,
+    'show_expanded' => 0,
+    'empty_text' => array(
+      'value' => '',
+      'format' => 'filtered_html',
+    ),
+    'submit_realm' => 'Save and go back to realm settings',
+  );
+  $export['search:block:changed'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search:block:created';
+  $facet->searcher = 'search';
+  $facet->realm = 'block';
+  $facet->facet = 'created';
+  $facet->enabled = TRUE;
+  $facet->settings = array(
+    'weight' => 0,
+    'widget' => 'date_range',
+    'filters' => array(),
+    'active_sorts' => array(
+      'active' => 'active',
+      'indexed' => 'indexed',
+      'count' => 0,
+      'display' => 0,
+    ),
+    'sort_weight' => array(
+      'active' => '-50',
+      'indexed' => '-49',
+      'count' => '0',
+      'display' => '0',
+    ),
+    'sort_order' => array(
+      'active' => '3',
+      'indexed' => '4',
+      'count' => '4',
+      'display' => '4',
+    ),
+    'empty_behavior' => 'text',
+    'soft_limit' => '20',
+    'nofollow' => 1,
+    'show_expanded' => 0,
+    'empty_text' => array(
+      'value' => 'None available',
+      'format' => 'filtered_html',
+    ),
+    'submit_realm' => 'Save and go back to realm settings',
+  );
+  $export['search:block:created'] = $facet;
+
+  $facet = new stdClass();
+  $facet->disabled = FALSE; /* Edit this to true to make a default facet disabled initially */
+  $facet->api_version = 1;
+  $facet->name = 'search:block:field_topics';
+  $facet->searcher = 'search';
+  $facet->realm = 'block';
+  $facet->facet = 'field_topics';
+  $facet->enabled = TRUE;
+  $facet->settings = array(
+    'weight' => 0,
+    'widget' => 'facetapi_links',
+    'filters' => array(),
+    'active_sorts' => array(
+      'active' => 'active',
+      'count' => 'count',
+      'display' => 'display',
+      'indexed' => 0,
+    ),
+    'sort_weight' => array(
+      'active' => '-50',
+      'count' => '-49',
+      'display' => '-48',
+      'indexed' => '0',
+    ),
+    'sort_order' => array(
+      'active' => '3',
+      'count' => '3',
+      'display' => '4',
+      'indexed' => '4',
+    ),
+    'empty_behavior' => 'text',
+    'soft_limit' => '20',
+    'nofollow' => 1,
+    'show_expanded' => 0,
+    'empty_text' => array(
+      'value' => 'No options available',
+      'format' => 'filtered_html',
+    ),
+    'submit_realm' => 'Save and go back to realm settings',
+  );
+  $export['search:block:field_topics'] = $facet;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.features.inc b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.features.inc
new file mode 100644
index 0000000..b131a18
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.features.inc
@@ -0,0 +1,23 @@
+<?php
+/**
+ * @file
+ * commons_search_core.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_search_core_ctools_plugin_api() {
+  list($module, $api) = func_get_args();
+  if ($module == "facetapi" && $api == "facetapi_defaults") {
+    return array("version" => "1");
+  }
+  list($module, $api) = func_get_args();
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  list($module, $api) = func_get_args();
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.info b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.info
new file mode 100644
index 0000000..e0fc12f
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.info
@@ -0,0 +1,31 @@
+name = Commons Search Core
+description = Core search with facets.
+core = 7.x
+package = Commons - Search
+dependencies[] = commons_search
+dependencies[] = date_facets
+dependencies[] = facetapi
+dependencies[] = page_manager
+dependencies[] = search_facetapi
+dependencies[] = strongarm
+features[ctools][] = facetapi:facetapi_defaults:1
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = strongarm:strongarm:1
+features[facetapi][] = search::author
+features[facetapi][] = search::bundle
+features[facetapi][] = search::changed
+features[facetapi][] = search::created
+features[facetapi][] = search::field_topics
+features[facetapi][] = search:block:author
+features[facetapi][] = search:block:bundle
+features[facetapi][] = search:block:changed
+features[facetapi][] = search:block:created
+features[facetapi][] = search:block:field_topics
+features[features_api][] = api:1
+features[page_manager_handlers][] = search_search_facetapi_panel_context
+features[page_manager_handlers][] = search_search_facetapi_panel_context_2
+features[variable][] = page_manager_search_disabled_search_facetapi
+features[variable][] = custom_search_other
+features[variable][] = search_active_modules
+features[variable][] = search_default_module
+features_exclude[dependencies][ctools] = ctools
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.install b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.install
new file mode 100644
index 0000000..41ae876
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.install
@@ -0,0 +1,39 @@
+<?php
+/**
+ * Installation file for Commons Search Core feature.
+ */
+
+/**
+ * Implements hook_enable().
+ */
+function commons_search_core_enable() {
+  // Disable Solr search module upon enabling this module.
+  if (module_exists('commons_search_solr')) {
+    module_disable(array('commons_search_solr', 'apachesolr_search', 'apachesolr', 'apachesolr_user', 'commons_events_solr', 'commons_search_solr_user'), FALSE);
+  }
+  // Set active search modules to be only Faceted Navigation and User.
+  variable_set('search_active_modules', array(
+    'search_facetapi' => 'search_facetapi',
+    'user' => 'user',
+    'node' => 0,
+  ));
+  // Set custom search active search modules.
+  variable_set('custom_search_other', array(
+    'search_facetapi' => 'search_facetapi',
+    'user' => 'user',
+  ));
+  // Set default search module for Core.
+  variable_set('search_default_module', 'search_facetapi');
+  cache_clear_all('*', 'cache_block', TRUE);
+}
+
+/**
+ * Revert the core search page to have a single column variant when no search
+ * has happened and the normal two column variant when a search has happened.
+ */
+function commons_search_core_update_7001() {
+  $revert = array(
+    'commons_search_core' => array('page_manager_handlers'),
+  );
+  features_revert($revert);
+}
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.module b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.module
new file mode 100644
index 0000000..4f12897
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Search Core feature.
+ */
+
+include_once 'commons_search_core.features.inc';
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.pages_default.inc b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.pages_default.inc
new file mode 100644
index 0000000..e469d0b
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.pages_default.inc
@@ -0,0 +1,326 @@
+<?php
+/**
+ * @file
+ * commons_search_core.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_handlers().
+ */
+function commons_search_core_default_page_manager_handlers() {
+  $export = array();
+
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'search_search_facetapi_panel_context';
+  $handler->task = 'search';
+  $handler->subtask = 'search_facetapi';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'Non-empty keywords, two column',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+    'access' => array(
+      'plugins' => array(
+        0 => array(
+          'name' => 'string_length',
+          'settings' => array(
+            'operator' => '>',
+            'length' => '0',
+          ),
+          'context' => 'argument_string_1',
+          'not' => FALSE,
+        ),
+      ),
+      'logic' => 'and',
+    ),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_33_66';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_33_66_top' => NULL,
+      'two_33_66_first' => NULL,
+      'two_33_66_second' => NULL,
+      'two_33_66_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = '2d31d4ab-5756-44a4-f984-8107b8587b40';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-4be3b380-7f67-ecf4-6974-607450056b42';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = 'facetapi-yz9XmKQdPPifJdPJudYeRDV3PpGykc25';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Topics',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '4be3b380-7f67-ecf4-6974-607450056b42';
+    $display->content['new-4be3b380-7f67-ecf4-6974-607450056b42'] = $pane;
+    $display->panels['two_33_66_first'][0] = 'new-4be3b380-7f67-ecf4-6974-607450056b42';
+    $pane = new stdClass();
+    $pane->pid = 'new-19883d03-0e72-1f84-4d13-5daf49510352';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = 'facetapi-NjamMRlUSiv6J1uYtpZ6KmDlsOuSofFX';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Type',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '19883d03-0e72-1f84-4d13-5daf49510352';
+    $display->content['new-19883d03-0e72-1f84-4d13-5daf49510352'] = $pane;
+    $display->panels['two_33_66_first'][1] = 'new-19883d03-0e72-1f84-4d13-5daf49510352';
+    $pane = new stdClass();
+    $pane->pid = 'new-d8cfd787-a04d-ef94-dda0-a486cf0e46be';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = 'facetapi-lyyyTQZmDqHX6b30Dx4mzfY6gEOR5Y0j';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Author',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = 'd8cfd787-a04d-ef94-dda0-a486cf0e46be';
+    $display->content['new-d8cfd787-a04d-ef94-dda0-a486cf0e46be'] = $pane;
+    $display->panels['two_33_66_first'][2] = 'new-d8cfd787-a04d-ef94-dda0-a486cf0e46be';
+    $pane = new stdClass();
+    $pane->pid = 'new-3c939ace-59f2-5ea4-5da0-d1450d651449';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = 'facetapi-gw7MYX93nFUXP6kzts1Eay6QpCVVSaOt';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Date created',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 3;
+    $pane->locks = array();
+    $pane->uuid = '3c939ace-59f2-5ea4-5da0-d1450d651449';
+    $display->content['new-3c939ace-59f2-5ea4-5da0-d1450d651449'] = $pane;
+    $display->panels['two_33_66_first'][3] = 'new-3c939ace-59f2-5ea4-5da0-d1450d651449';
+    $pane = new stdClass();
+    $pane->pid = 'new-95278c06-53e1-a984-4139-71b99c4d3ddf';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = 'facetapi-BFZ195FyIkWBzXNTaq3jevkbxSWXJpMb';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => 'Date changed',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 4;
+    $pane->locks = array();
+    $pane->uuid = '95278c06-53e1-a984-4139-71b99c4d3ddf';
+    $display->content['new-95278c06-53e1-a984-4139-71b99c4d3ddf'] = $pane;
+    $display->panels['two_33_66_first'][4] = 'new-95278c06-53e1-a984-4139-71b99c4d3ddf';
+    $pane = new stdClass();
+    $pane->pid = 'new-2ed6ed31-b23a-50d4-dd1c-dd2eae53cedb';
+    $pane->panel = 'two_33_66_second';
+    $pane->type = 'search_result';
+    $pane->subtype = 'search_result';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'type' => 'search_facetapi',
+      'log' => 0,
+      'override_empty' => 0,
+      'empty_title' => '',
+      'empty' => '',
+      'empty_format' => 'plain_text',
+      'override_no_key' => 0,
+      'no_key_title' => '',
+      'no_key' => '',
+      'no_key_format' => 'plain_text',
+      'context' => 'argument_string_1',
+      'override_title' => 1,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '2ed6ed31-b23a-50d4-dd1c-dd2eae53cedb';
+    $display->content['new-2ed6ed31-b23a-50d4-dd1c-dd2eae53cedb'] = $pane;
+    $display->panels['two_33_66_second'][0] = 'new-2ed6ed31-b23a-50d4-dd1c-dd2eae53cedb';
+    $pane = new stdClass();
+    $pane->pid = 'new-74dd20d4-0d10-dea4-019a-808cfe544eac';
+    $pane->panel = 'two_33_66_top';
+    $pane->type = 'search_form';
+    $pane->subtype = 'search_form';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'type' => 'search_facetapi',
+      'form' => 'simple',
+      'path_type' => 'default',
+      'path' => '',
+      'override_prompt' => 0,
+      'prompt' => '',
+      'context' => 'argument_string_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '74dd20d4-0d10-dea4-019a-808cfe544eac';
+    $display->content['new-74dd20d4-0d10-dea4-019a-808cfe544eac'] = $pane;
+    $display->panels['two_33_66_top'][0] = 'new-74dd20d4-0d10-dea4-019a-808cfe544eac';
+  $display->hide_title = PANELS_TITLE_PANE;
+  $display->title_pane = 'new-2ed6ed31-b23a-50d4-dd1c-dd2eae53cedb';
+  $handler->conf['display'] = $display;
+  $export['search_search_facetapi_panel_context'] = $handler;
+
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'search_search_facetapi_panel_context_2';
+  $handler->task = 'search';
+  $handler->subtask = 'search_facetapi';
+  $handler->handler = 'panel_context';
+  $handler->weight = 1;
+  $handler->conf = array(
+    'title' => 'Empty keywords, single column',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+    'access' => array(
+      'plugins' => array(
+        0 => array(
+          'name' => 'string_length',
+          'settings' => array(
+            'operator' => '=',
+            'length' => '0',
+          ),
+          'context' => 'argument_string_1',
+          'not' => FALSE,
+        ),
+      ),
+      'logic' => 'and',
+    ),
+  );
+  $display = new panels_display();
+  $display->layout = 'one';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_33_66_top' => NULL,
+      'two_33_66_first' => NULL,
+      'two_33_66_second' => NULL,
+      'two_33_66_bottom' => NULL,
+      'one_main' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = '34b80be5-404f-b7d4-b167-a3be8362179a';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-c690489f-a85f-a4a4-050c-f542d996de37';
+    $pane->panel = 'one_main';
+    $pane->type = 'search_form';
+    $pane->subtype = 'search_form';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'type' => 'search_facetapi',
+      'form' => 'simple',
+      'path_type' => 'default',
+      'path' => '',
+      'override_prompt' => 0,
+      'prompt' => '',
+      'context' => 'argument_string_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'c690489f-a85f-a4a4-050c-f542d996de37';
+    $display->content['new-c690489f-a85f-a4a4-050c-f542d996de37'] = $pane;
+    $display->panels['one_main'][0] = 'new-c690489f-a85f-a4a4-050c-f542d996de37';
+  $display->hide_title = PANELS_TITLE_PANE;
+  $display->title_pane = '0';
+  $handler->conf['display'] = $display;
+  $export['search_search_facetapi_panel_context_2'] = $handler;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_core/commons_search_core.strongarm.inc b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.strongarm.inc
new file mode 100644
index 0000000..c7ba10b
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_core/commons_search_core.strongarm.inc
@@ -0,0 +1,48 @@
+<?php
+/**
+ * @file
+ * commons_search_core.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_search_core_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'page_manager_search_disabled_search_facetapi';
+  $strongarm->value = FALSE;
+  $export['page_manager_search_disabled_search_facetapi'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'search_active_modules';
+  $strongarm->value = array(
+    'search_facetapi' => 'search_facetapi',
+    'user' => 0,
+    'node' => 0,
+  );
+  $export['search_active_modules'] = $strongarm;
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'search_default_module';
+  $strongarm->value = 'search_facetapi';
+  $export['search_default_module'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_other';
+  $strongarm->value = array(
+    'search_facetapi' => 'search_facetapi',
+    'user' => 'user',
+  );
+  $export['custom_search_other'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.apachesolr_search_defaults.inc b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.apachesolr_search_defaults.inc
new file mode 100644
index 0000000..1bf367f
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.apachesolr_search_defaults.inc
@@ -0,0 +1,36 @@
+<?php
+/**
+ * @file
+ * commons_search_solr.apachesolr_search_defaults.inc
+ */
+
+/**
+ * Implements hook_apachesolr_search_default_searchers().
+ */
+function commons_search_solr_apachesolr_search_default_searchers() {
+  $export = array();
+
+  $searcher = new stdClass();
+  $searcher->disabled = FALSE; /* Edit this to true to make a default searcher disabled initially */
+  $searcher->api_version = 3;
+  $searcher->page_id = 'core_search';
+  $searcher->label = 'Core Search';
+  $searcher->description = 'Core Search';
+  $searcher->search_path = 'search/site';
+  $searcher->page_title = 'Site';
+  $searcher->env_id = apachesolr_default_environment();
+  $searcher->settings = array(
+    'fq' => array(),
+    'apachesolr_search_custom_enable' => FALSE,
+    'apachesolr_search_search_type' => 'custom',
+    'apachesolr_search_search_box' => TRUE,
+    'apachesolr_search_per_page' => 10,
+    'apachesolr_search_browse' => 'blocks',
+    'apachesolr_search_spellcheck' => TRUE,
+    'apachesolr_search_allow_user_input' => FALSE,
+    'apachesolr_search_not_removable' => TRUE,
+  );
+  $export['core_search'] = $searcher;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.features.inc b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.features.inc
new file mode 100644
index 0000000..b97d1fd
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.features.inc
@@ -0,0 +1,26 @@
+<?php
+/**
+ * @file
+ * commons_search_solr.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_search_solr_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "apachesolr_search" && $api == "apachesolr_search_defaults") {
+    return array("version" => "3");
+  }
+  if ($module == "facetapi" && $api == "facetapi_defaults") {
+    return array("version" => "1");
+  }
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  if ($module == "pm_existing_pages" && $api == "pm_existing_pages") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.info b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.info
new file mode 100644
index 0000000..0be45c0
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.info
@@ -0,0 +1,29 @@
+name = Commons Search Solr
+description = Site search using Apache Solr server.
+core = 7.x
+package = Commons - Search
+dependencies[] = apachesolr
+dependencies[] = apachesolr_proximity
+dependencies[] = apachesolr_search
+dependencies[] = commons_search
+dependencies[] = ctools
+dependencies[] = date_facets
+dependencies[] = facetapi
+dependencies[] = page_manager
+dependencies[] = pm_existing_pages
+dependencies[] = strongarm
+features[apachesolr_search_page][] = core_search
+features[ctools][] = apachesolr_search:apachesolr_search_defaults:3
+features[ctools][] = facetapi:facetapi_defaults:1
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = pm_existing_pages:pm_existing_pages:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[page_manager_existing_pages][] = solr_search
+features[page_manager_handlers][] = pm_existing_pages_solr_search_panel_context
+features[variable][] = apachesolr_search_default_search_page
+features[variable][] = custom_search_other
+features[variable][] = page_manager_search_disabled_apachesolr_search
+features[variable][] = pm_existing_pages_disabled_solr_search
+features[variable][] = search_active_modules
+features[variable][] = search_default_module
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.install b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.install
new file mode 100644
index 0000000..c1d8e1f
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.install
@@ -0,0 +1,33 @@
+<?php
+/**
+ * Installation file for Commons Search Solr feature.
+ */
+
+/**
+ * Implements hook_enable().
+ */
+function commons_search_solr_enable() {
+  // Disable Core search module upon enabling this module.
+  if (module_exists('commons_search_core')) {
+    module_disable(array('commons_search_core'), FALSE);
+  }
+  if (module_exists('search_facetapi')) {
+    module_disable(array('search_facetapi'), FALSE);
+  }
+  // Ensure that Commons Search Solr variables are reverted in cases such as
+  // when switching from Core to Solr search.
+  $revert = array('commons_search_solr' => array('variable', 'apachesolr_search_page'));
+  features_revert($revert);
+  cache_clear_all();
+  commons_search_solr_create_facets();
+}
+
+/**
+ * Set default environment to display facet blocks in configured regions.
+ */
+function commons_search_solr_update_7001() {
+  $revert = array(
+    'commons_search_solr' => array('apachesolr_search_page'),
+  );
+  features_revert($revert);
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.module b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.module
new file mode 100644
index 0000000..91f175c
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.module
@@ -0,0 +1,499 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Search Solr feature.
+ */
+
+include_once 'commons_search_solr.features.inc';
+
+/**
+ * Get the search adapter and Solr environment for dynamic faceting.
+ */
+function commons_search_solr_search_environment() {
+  return "apachesolr@" . apachesolr_default_environment();
+}
+
+/**
+ * Dynamically create facets rather than let Features do it, so we can have
+ * facets based on the current default Solr environment.
+ */
+function commons_search_solr_create_facets($env_id = NULL) {
+  $facets = commons_search_solr_facet_definitions();
+  // Add each facet to the database with a merge so we don't have duplicates.
+  if (empty($env_id)) {
+    $env_id = commons_search_solr_search_environment();
+  }
+  foreach($facets as $facet) {
+    $facet['settings'] = serialize($facet['settings']);
+    $facet['name'] = $env_id . $facet['name'];
+    $facet['searcher'] = $env_id;
+    $merge = db_merge('facetapi')
+      ->key(array('name' => $facet['name']))
+      ->fields($facet)
+      ->execute();
+  }
+}
+
+/**
+ * Base facet definitions.
+ */
+function commons_search_solr_facet_definitions() {
+  $facets = array();
+
+  // Node author facet.
+  $facets[] = array(
+    'name' => ':block:author',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'author',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+    ),
+  );
+
+  // Node type facet.
+  $facets[] = array(
+    'name' => ':block:bundle',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'bundle',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+    ),
+  );
+
+  // Node changed date facet.
+  $facets[] = array(
+    'name' => ':block:changed',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'changed',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'date_range',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'indexed' => 'indexed',
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'indexed' => -49,
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'indexed' => 4,
+        'count' => 4,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+      'empty_text' => array(
+        'value' => '',
+        'format' => 'filtered_html',
+      ),
+    ),
+  );
+  $facets[] = array(
+    'name' => '::changed',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => '',
+    'facet' => 'changed',
+    'enabled' => 0,
+    'settings' => array(
+      'operator' => 'and',
+      'hard_limit' => 50,
+      'dependencies' => array(
+        'roles' => array(),
+      ),
+      'facet_mincount' => 1,
+      'facet_missing' => 0,
+      'flatten' => 0,
+      'query_type' => 'date_range',
+    ),
+  );
+
+  // Node created date facet.
+  $facets[] = array(
+    'name' => ':block:created',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'created',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'date_range',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'indexed' => 'indexed',
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'indexed' => -49,
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'indexed' => 4,
+        'count' => 4,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+      'empty_text' => array(
+        'value' => '',
+        'format' => 'filtered_html',
+      ),
+    ),
+  );
+  $facets[] = array(
+    'name' => '::created',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => '',
+    'facet' => 'created',
+    'enabled' => 0,
+    'settings' => array(
+      'operator' => 'and',
+      'hard_limit' => 50,
+      'dependencies' => array(
+        'roles' => array(),
+      ),
+      'facet_mincount' => 1,
+      'facet_missing' => 0,
+      'flatten' => 0,
+      'query_type' => 'date_range',
+    ),
+  );
+
+  // Node field_date facet.
+  $facets[] = array(
+    'name' => ':block:dm_field_date',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'dm_field_date',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'date_range',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'indexed' => 'indexed',
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'indexed' => -49,
+        'count' => 0,
+        'display' => 0,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'indexed' => 4,
+        'count' => 4,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+      'empty_text' => array(
+        'value' => '',
+        'format' => 'filtered_html',
+      ),
+    ),
+  );
+  $facets[] = array(
+    'name' => '::dm_field_date',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => '',
+    'facet' => 'dm_field_date',
+    'enabled' => 0,
+    'settings' => array(
+      'operator' => 'and',
+      'hard_limit' => 50,
+      'dependencies' => array(
+        'roles' => array(),
+      ),
+      'facet_mincount' => 1,
+      'facet_missing' => 0,
+      'flatten' => 0,
+      'query_type' => 'date_range',
+    ),
+  );
+
+  // Node field_topics facet.
+  $facets[] = array(
+    'name' => ':block:im_field_topics',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'im_field_topics',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+        'indexed' => 0,
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+        'indexed' => 0,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+        'indexed' => 4,
+      ),
+      'empty_behavior' => 'text',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+      'empty_text' => array(
+        'value' => 'None available',
+        'format' => 'filtered_html',
+      ),
+    ),
+  );
+  $facets[] = array(
+    'name' => '::im_field_topics',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => '',
+    'facet' => 'im_field_topics',
+    'enabled' => 0,
+    'settings' => array(
+      'operator' => 'and',
+      'hard_limit' => 50,
+      'dependencies' => array(
+        'roles' => array(),
+      ),
+      'facet_mintcount' => 1,
+      'facet_missing' => 0,
+      'flatten' => 0,
+      'query_type' => 'term',
+    ),
+  );
+
+  // Node field_location facet.
+  $facets[] = array(
+    'name' => ':block:sm_field_location',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'sm_field_location',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+    ),
+  );
+
+  // Node group reference facet.
+  $facets[] = array(
+    'name' => ':block:sm_og_group_ref',
+    'searcher' => commons_search_solr_search_environment(),
+    'realm' => 'block',
+    'facet' => 'sm_og_group_ref',
+    'enabled' => 1,
+    'settings' => array(
+      'weight' => 0,
+      'widget' => 'facetapi_links',
+      'filters' => array(),
+      'active_sorts' => array(
+        'active' => 'active',
+        'count' => 'count',
+        'display' => 'display',
+      ),
+      'sort_weight' => array(
+        'active' => -50,
+        'count' => -49,
+        'display' => -48,
+      ),
+      'sort_order' => array(
+        'active' => 3,
+        'count' => 3,
+        'display' => 4,
+      ),
+      'empty_behavior' => 'none',
+      'soft_limit' => 20,
+      'nofollow' => 1,
+      'show_expanded' => 0,
+    ),
+  );
+  return $facets;
+}
+
+/**
+ * Get the panels subtype for the facet block.
+ */
+function commons_search_solr_panel_facet_subtype($facet_name) {
+  return 'facetapi-' . facetapi_hash_delta($facet_name);
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_search_solr_form_apachesolr_environment_edit_form_alter(&$form, &$form_state) {
+  $form['actions']['save']['#submit'][] = 'commons_search_solr_environment_form_submit';
+}
+
+/**
+ * When the environment changes, create facets for that environment.
+ */
+function commons_search_solr_environment_form_submit($form, $form_state) {
+  if ($form_state['values']['make_default'] == 1) {
+    commons_search_solr_create_facets('apachesolr@' . $form_state['build_info']['args']['0']['env_id']);
+    // Need to clear caches so we can rebuild block definitions.
+    cache_clear_all('*', 'cache_block', TRUE);
+    cache_clear_all('*', 'cache_apachesolr', TRUE);
+  }
+}
+
+/**
+ * Implements hook_modules_enabled().
+ */
+function commons_search_solr_modules_enabled($modules) {
+  if (in_array('acquia_search', $modules)) {
+    // If Acquia Search is enabled later, we need to force update our facets,
+    // otherwise our Events Solr page has no facets.
+    commons_search_solr_create_facets(ACQUIA_SEARCH_ENVIRONMENT_ID);
+  }
+  if (in_array('commons_search_solr_user', $modules)) {
+    // We disable core user search with of Solr user search, via the
+    // search_active_modules variable which is exporter by commons_search_solr
+    // and altered in commons_search_solr_user_strongarm_alter().
+    $revert = array('commons_search_solr' => array('variable'));
+    features_revert($revert);
+  }
+}
+
+
+/**
+ * Feature module hook. Invoked on a Feature module after that module is
+ * enabled.
+ *
+ * @param $component
+ *   String name of the component that has just been enabled.
+ */
+function commons_search_solr_post_features_enable_feature($component) {
+  if ($component == 'apachesolr_search_page') {
+    features_revert(array('commons_search_solr' => array('apachesolr_search_page')));
+  }
+}
+
+
+/**
+ * Implements hook_modules_disabled().
+ */
+function commons_search_solr_modules_disabled($modules) {
+  if (in_array('commons_search_solr_user', $modules)) {
+    // We disable core user search with of Solr user search, via the
+    // search_active_modules variable which is exporter by commons_search_solr
+    // and altered in commons_search_solr_user_strongarm_alter().
+    $revert = array('commons_search_solr' => array('variable'));
+    features_revert($revert);
+  }
+}
+
+/**
+ * Implements hook_apachesolr_process_results().
+ */
+function commons_search_solr_apachesolr_process_results(&$results, DrupalSolrQueryInterface $query) {
+  foreach($results AS $rkey => $result) {
+    if ($results[$rkey]['fields']['entity_type'] == 'node') {
+      if ($node = node_load($results[$rkey]['fields']['entity_id'])) {
+        $node_view = node_view($node, 'teaser');
+        $results[$rkey]['snippet'] = drupal_render($node_view);
+      }
+    }
+    if ($results[$rkey]['fields']['entity_type'] == 'user') {
+      if ($account = user_load($results[$rkey]['fields']['entity_id'])) {
+        $user_view = user_view($account, 'search_results');
+        $results[$rkey]['snippet'] = drupal_render($user_view);
+      }
+    }
+  }
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.pages_default.inc b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.pages_default.inc
new file mode 100644
index 0000000..7f76c67
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.pages_default.inc
@@ -0,0 +1,213 @@
+<?php
+/**
+ * @file
+ * commons_search_solr.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_handlers().
+ */
+function commons_search_solr_default_page_manager_handlers() {
+  $export = array();
+
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'pm_existing_pages_solr_search_panel_context';
+  $handler->task = 'pm_existing_pages';
+  $handler->subtask = 'solr_search';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'search',
+    'no_blocks' => 0,
+    'pipeline' => 'standard',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_33_66';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_33_66_top' => NULL,
+      'two_33_66_first' => NULL,
+      'two_33_66_second' => NULL,
+      'two_33_66_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = '06329041-e13c-1174-ed2a-d4a50d0aa4d2';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-463814d4-a8ba-7b94-c9d5-77faae3cea01';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_search_solr_panel_facet_subtype(commons_search_solr_search_environment() . ':block:sm_og_group_ref');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => t('Groups'),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '463814d4-a8ba-7b94-c9d5-77faae3cea01';
+    $display->content['new-463814d4-a8ba-7b94-c9d5-77faae3cea01'] = $pane;
+    $display->panels['two_33_66_first'][0] = 'new-463814d4-a8ba-7b94-c9d5-77faae3cea01';
+    $pane = new stdClass();
+    $pane->pid = 'new-7accd7bf-9b29-ce34-8de0-528f3a89ba02';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_search_solr_panel_facet_subtype(commons_search_solr_search_environment() . ':block:im_field_topics');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => t('Topics'),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '7accd7bf-9b29-ce34-8de0-528f3a89ba02';
+    $display->content['new-7accd7bf-9b29-ce34-8de0-528f3a89ba02'] = $pane;
+    $display->panels['two_33_66_first'][1] = 'new-7accd7bf-9b29-ce34-8de0-528f3a89ba02';
+    $pane = new stdClass();
+    $pane->pid = 'new-0ff4a758-76a3-1944-29fe-a19ae7f1abd1';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_search_solr_panel_facet_subtype(commons_search_solr_search_environment() . ':block:bundle');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => t('Type'),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = '0ff4a758-76a3-1944-29fe-a19ae7f1abd1';
+    $display->content['new-0ff4a758-76a3-1944-29fe-a19ae7f1abd1'] = $pane;
+    $display->panels['two_33_66_first'][2] = 'new-0ff4a758-76a3-1944-29fe-a19ae7f1abd1';
+    $pane = new stdClass();
+    $pane->pid = 'new-971af469-d142-9b34-4d91-7d2b2b06d750';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_search_solr_panel_facet_subtype(commons_search_solr_search_environment() . ':block:author');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => t('Author'),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 3;
+    $pane->locks = array();
+    $pane->uuid = '971af469-d142-9b34-4d91-7d2b2b06d750';
+    $display->content['new-971af469-d142-9b34-4d91-7d2b2b06d750'] = $pane;
+    $display->panels['two_33_66_first'][3] = 'new-971af469-d142-9b34-4d91-7d2b2b06d750';
+    $pane = new stdClass();
+    $pane->pid = 'new-9580c1e3-390b-0954-65a6-3804ab628265';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_search_solr_panel_facet_subtype(commons_search_solr_search_environment() . ':block:created');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => t('Date created'),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 4;
+    $pane->locks = array();
+    $pane->uuid = '9580c1e3-390b-0954-65a6-3804ab628265';
+    $display->content['new-9580c1e3-390b-0954-65a6-3804ab628265'] = $pane;
+    $display->panels['two_33_66_first'][4] = 'new-9580c1e3-390b-0954-65a6-3804ab628265';
+    $pane = new stdClass();
+    $pane->pid = 'new-036759bf-aab4-5b04-8d88-81e0debf0e23';
+    $pane->panel = 'two_33_66_first';
+    $pane->type = 'block';
+    $pane->subtype = commons_search_solr_panel_facet_subtype(commons_search_solr_search_environment() . ':block:changed');
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 1,
+      'override_title_text' => t('Date changed'),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 5;
+    $pane->locks = array();
+    $pane->uuid = '036759bf-aab4-5b04-8d88-81e0debf0e23';
+    $display->content['new-036759bf-aab4-5b04-8d88-81e0debf0e23'] = $pane;
+    $display->panels['two_33_66_first'][5] = 'new-036759bf-aab4-5b04-8d88-81e0debf0e23';
+    $pane = new stdClass();
+    $pane->pid = 'new-da122a41-c889-4be4-519a-f29568f411ef';
+    $pane->panel = 'two_33_66_second';
+    $pane->type = 'pm_existing_pages';
+    $pane->subtype = 'pm_existing_pages';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      0 => 'task_id',
+      1 => 'pane_title_from_menu',
+      'task_id' => 'solr_search',
+      'pane_title_from_menu' => 0,
+      'override_title' => 1,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'da122a41-c889-4be4-519a-f29568f411ef';
+    $display->content['new-da122a41-c889-4be4-519a-f29568f411ef'] = $pane;
+    $display->panels['two_33_66_second'][0] = 'new-da122a41-c889-4be4-519a-f29568f411ef';
+  $display->hide_title = PANELS_TITLE_NONE;
+  $display->title_pane = '0';
+  $handler->conf['display'] = $display;
+  $export['pm_existing_pages_solr_search_panel_context'] = $handler;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.pm_existing_pages.inc b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.pm_existing_pages.inc
new file mode 100644
index 0000000..e1e6787
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.pm_existing_pages.inc
@@ -0,0 +1,23 @@
+<?php
+/**
+ * @file
+ * commons_search_solr.pm_existing_pages.inc
+ */
+
+/**
+ * Implements hook_pm_existing_pages_info().
+ */
+function commons_search_solr_pm_existing_pages_info() {
+  $export = array();
+
+  $pm_existing_page = new stdClass();
+  $pm_existing_page->api_version = 1;
+  $pm_existing_page->name = 'solr_search';
+  $pm_existing_page->label = 'ApacheSolr site search';
+  $pm_existing_page->context = '';
+  $pm_existing_page->paths = 'search/site
+search/site/%';
+  $export['solr_search'] = $pm_existing_page;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.strongarm.inc b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.strongarm.inc
new file mode 100644
index 0000000..ee2a643
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr/commons_search_solr.strongarm.inc
@@ -0,0 +1,61 @@
+<?php
+/**
+ * @file
+ * commons_search_solr.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_search_solr_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'apachesolr_search_default_search_page';
+  $strongarm->value = 'core_search';
+  $export['apachesolr_search_default_search_page'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'custom_search_other';
+  $strongarm->value = array(
+    'apachesolr_search' => 'apachesolr_search',
+    'user' => 'user',
+  );
+  $export['custom_search_other'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'page_manager_search_disabled_apachesolr_search';
+  $strongarm->value = TRUE;
+  $export['page_manager_search_disabled_apachesolr_search'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'pm_existing_pages_disabled_solr_search';
+  $strongarm->value = FALSE;
+  $export['pm_existing_pages_disabled_solr_search'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'search_active_modules';
+  $strongarm->value = array(
+    'apachesolr_search' => 'apachesolr_search',
+  );
+  $export['search_active_modules'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'search_default_module';
+  $strongarm->value = 'apachesolr_search';
+  $export['search_default_module'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons-search-solr-user-results.tpl.php b/modules/commons/commons_search/modules/commons_search_solr_user/commons-search-solr-user-results.tpl.php
new file mode 100644
index 0000000..2fe9ad2
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons-search-solr-user-results.tpl.php
@@ -0,0 +1,23 @@
+<?php
+
+/**
+ * @file
+ * Default theme implementation for displaying solr user search results.
+ *
+ * Available variables:
+ * - $results: All results.
+ * - $title: The title for the grouping of content.
+ *
+ *
+ * @see template_preprocess_commons_search_solr_user_results()
+ *
+ * @ingroup themeable
+ */
+?>
+
+<div class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <h3<?php print $title_attributes; ?>><?php print $title; ?></h3>
+  <div<?php print $content_attributes; ?>>
+    <?php print render($content); ?>
+  </div>
+</div>
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.apachesolr_search_defaults.inc b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.apachesolr_search_defaults.inc
new file mode 100644
index 0000000..c30b96f
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.apachesolr_search_defaults.inc
@@ -0,0 +1,37 @@
+<?php
+/**
+ * @file
+ * commons_search_solr_user.apachesolr_search_defaults.inc
+ */
+
+/**
+ * Implements hook_apachesolr_search_default_searchers().
+ */
+function commons_search_solr_user_apachesolr_search_default_searchers() {
+  $export = array();
+
+  $searcher = new stdClass();
+  $searcher->disabled = FALSE; /* Edit this to true to make a default searcher disabled initially */
+  $searcher->api_version = 3;
+  $searcher->page_id = 'user_search';
+  $searcher->label = 'User Search';
+  $searcher->description = 'User Search';
+  $searcher->search_path = 'people';
+  $searcher->page_title = 'People';
+  $searcher->env_id = apachesolr_default_environment();
+  $searcher->settings = array(
+    'fq' => array(
+      0 => 'entity_type:user',
+    ),
+    'apachesolr_search_custom_enable' => 1,
+    'apachesolr_search_search_type' => 'custom',
+    'apachesolr_search_per_page' => 12,
+    'apachesolr_search_browse' => 'none',
+    'apachesolr_search_spellcheck' => 1,
+    'apachesolr_search_search_box' => 1,
+    'apachesolr_search_allow_user_input' => 0,
+  );
+  $export['user_search'] = $searcher;
+
+  return $export;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.features.inc b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.features.inc
new file mode 100644
index 0000000..0d862f2
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.features.inc
@@ -0,0 +1,15 @@
+<?php
+/**
+ * @file
+ * commons_search_solr_user.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_search_solr_user_ctools_plugin_api() {
+  list($module, $api) = func_get_args();
+  if ($module == "apachesolr_search" && $api == "apachesolr_search_defaults") {
+    return array("version" => "3");
+  }
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.features.menu_links.inc b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.features.menu_links.inc
new file mode 100644
index 0000000..55be9a1
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.features.menu_links.inc
@@ -0,0 +1,36 @@
+<?php
+/**
+ * @file
+ * commons_search_solr_user.features.menu_links.inc
+ */
+
+/**
+ * Implements hook_menu_default_menu_links().
+ */
+function commons_search_solr_user_menu_default_menu_links() {
+  $menu_links = array();
+
+  // Exported menu link: main-menu:people
+  $menu_links['main-menu:people'] = array(
+    'menu_name' => 'main-menu',
+    'link_path' => 'people',
+    'router_path' => 'people',
+    'link_title' => 'People',
+    'options' => array(
+      'attributes' => array(),
+    ),
+    'module' => 'menu',
+    'hidden' => 0,
+    'external' => 0,
+    'has_children' => 0,
+    'expanded' => 0,
+    'weight' => 5,
+    'customized' => 1,
+  );
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('People');
+
+
+  return $menu_links;
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.info b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.info
new file mode 100644
index 0000000..b5c8055
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.info
@@ -0,0 +1,14 @@
+name = Commons Search Solr User
+description = Provides user entity indexing capabilities to Apache Solr, and search functionality
+core = 7.x
+package = Commons - Search
+dependencies[] = apachesolr_search
+dependencies[] = apachesolr_user
+dependencies[] = commons_search_solr
+dependencies[] = ctools
+dependencies[] = features
+dependencies[] = menu
+features[apachesolr_search_page][] = user_search
+features[ctools][] = apachesolr_search:apachesolr_search_defaults:3
+features[features_api][] = api:1
+features[menu_links][] = main-menu:people
\ No newline at end of file
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.install b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.install
new file mode 100644
index 0000000..6a55be5
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.install
@@ -0,0 +1,55 @@
+<?php
+/**
+ * @file
+ * Commons Search Solr User install script.
+ */
+
+/**
+ * Implements hook_install().
+ */
+function commons_search_solr_user_install() {
+  db_update('system')
+    ->fields(array(
+      'weight' => 150,
+    ))
+    ->condition('name', 'commons_search_solr_user')
+    ->execute();
+}
+
+/**
+ * Implements hook_enable().
+ */
+function commons_search_solr_user_enable() {
+  // Commons_search_solr_user alters the search_active_modules variable
+  // defined by commons_search_solr. Now that it's disabled, let's revert it.
+  $revert = array('commons_search_solr' => array('variable'));
+  features_revert($revert);
+  // We need to tell Solr to index users.
+  db_merge('apachesolr_index_bundles')
+    ->key(array(
+      'env_id' => apachesolr_default_environment(),
+      'entity_type' => 'user',
+      'bundle' => 'user',
+    ))
+    ->fields(array(
+      'env_id' => apachesolr_default_environment(),
+      'entity_type' => 'user',
+      'bundle' => 'user',
+    ))
+    ->execute();
+
+  // Make sure the user search page was created so we can modify it. Do this manually
+  // Because features revert isn't reliable in all cases, we load the export and do the save.
+  module_load_include('inc', 'commons_search_solr_user', 'commons_search_solr_user.apachesolr_search_defaults');
+  $default_search_page = commons_search_solr_user_apachesolr_search_default_searchers();
+  apachesolr_search_page_save(get_object_vars($default_search_page['user_search']));
+
+  // Revert the trusted contacts module if its enabled, since we need to
+  // re-apply the search options that come with the feature.
+  if (module_exists('commons_trusted_contacts')) {
+    $revert = array(
+      'commons_trusted_contacts' => array('field_instance'),
+    );
+    features_revert($revert);
+  }
+}
diff --git a/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.module b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.module
new file mode 100644
index 0000000..319e9fe
--- /dev/null
+++ b/modules/commons/commons_search/modules/commons_search_solr_user/commons_search_solr_user.module
@@ -0,0 +1,367 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Search Solr User feature.
+ */
+
+include_once 'commons_search_solr_user.features.inc';
+
+/**
+ * Process documents
+ */
+function commons_search_solr_user_apachesolr_index_document_build_user($document, $entity, $env_id) {
+  // Flag module API: obtain all UIDs that have flagged the user.
+  $flagging_users = module_invoke('flag', 'get_content_flags', 'user', $entity->uid, 'commons_follow_user');
+  foreach ($flagging_users as $uid => $flaginfo) {
+    // Add each flag to the document index, as an integer multiple value field.
+    $document->setMultiValue('im_flag_commons_follow_user', $uid);
+  }
+
+  if (!empty($entity->field_name_first)) {
+    $document->addField('tes_firstname', $entity->field_name_first[LANGUAGE_NONE][0]['value']);
+  }
+  if (!empty($entity->field_name_last)) {
+    $document->addField('tes_lastname', $entity->field_name_last[LANGUAGE_NONE][0]['value']);
+  }
+  $document->addField('tes_username', $entity->name);
+}
+
+function commons_search_solr_user_apachesolr_query_alter($query) {
+  global $user;
+  // Search in partial usernames.
+  $query->addParam('qf', 'tes_firstname');
+  $query->addParam('qf', 'tes_lastname');
+  $query->addParam('qf', 'tes_username');
+
+  if (isset($_GET['flagged']) && $flagged = check_plain($_GET['flagged'])) {
+    $query->addFilter('im_flag_commons_follow_user', $user->uid);
+  }
+}
+
+/**
+ * Implements hook_theme().
+ */
+function commons_search_solr_user_theme($existing, $type, $theme, $path) {
+  return array(
+    'commons_search_solr_user_results' => array(
+      'variables' => array(
+        'title' => '',
+        'results' => array(),
+      ),
+      'template' => 'commons-search-solr-user-results',
+    ),
+  );
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+function commons_search_solr_user_strongarm_alter(&$items) {
+  // Commons_search_solr_user replaces core user search, so remove it
+  // from the list of active search modules.
+  if (!empty($items['search_active_modules']->value['user'])) {
+    unset($items['search_active_modules']->value['user']);
+  }
+}
+
+/**
+ * Implements hook_apachesolr_search_page_alter().
+ * We override the default search page for people here when no results are entered.
+ * This gives us a default people listing which we can filter to who we are following.
+ */
+function commons_search_solr_user_apachesolr_search_page_alter(&$build, $search_page) {
+  global $user;
+  if ($search_page['page_id'] == 'user_search'
+    && isset($build['search_results']['#markup'])
+    && empty($build['search_form']['basic']['keys']['#default_value'])
+  ) {
+    // If the #markup item is set, it usually means we have no Solr results.
+    // So lets just fetch all users that are active, and display those.
+
+    // First check to see if the flagged key is set. If so we don't want to query
+    // Using EFQ because flags aren't entities.
+    $limit = isset($search_page['settings']['apachesolr_search_per_page']) ? $search_page['settings']['apachesolr_search_per_page'] : 12;
+    $flagged = (isset($_GET['flagged']) && is_numeric($_GET['flagged'])) ? check_plain($_GET['flagged']) : 0;
+
+    $out_results = array();
+    if ($flagged && $flag = flag_get_flag('commons_follow_user')) {
+      // Get the count of flagged users for a particular account.
+      $fl_results = db_select('flag_content', 'f')
+        ->fields('f', array('content_id', 'uid'))
+        ->condition('f.content_type', 'user', '=')
+        ->condition('f.uid', $user->uid, '=')
+        ->condition('f.fid', $flag->fid, '=')
+        ->extend('PagerDefault')->limit($limit)
+        ->addTag('commons_search_solr_user_people')
+        ->addMetaData('flagged', $flagged)
+        ->execute();
+      while ($record = $fl_results->fetchAssoc()) {
+        $out_results[] = user_view(user_load($record['content_id']), 'search_results');
+      }
+      $build['pager'] = array('#theme' => 'pager');
+    }
+
+    // If we aren't dealing with followed users, use the standard EFQ format and query
+    // all users.
+    else {
+      $users = new EntityFieldQuery();
+      $results = $users->entityCondition('entity_type', 'user')
+        ->propertyCondition('status', 1)
+        ->addTag('commons_search_solr_user_people')
+        ->pager($limit, 1)
+        ->execute();
+      $user_ids = array_keys($results['user']);
+      foreach ($user_ids as $uid) {
+        $out_results[] = user_view(user_load($uid), 'search_results');($user_ids);
+      }
+      $build['pager'] = array(
+        // As nice as it would be to make this use #theme, it is a bit more
+        // trouble than it is worth to process $user->pager to conform to
+        // renderable array standards. A custom theme suggestion should work
+        // for most, if not all, situations for theme overrides.
+        '#markup' => theme('pager__commons_search_solr_user', $users->pager),
+      );
+    }
+
+    // Build renderable arrays for display.
+    if (!empty($out_results)) {
+      $build['search_results'] = array(
+        '#theme' => 'commons_search_solr_user_results',
+        '#title' => t('People directory'),
+        '#results' => $out_results,
+      );
+    }
+  }
+}
+
+/**
+ * Implements hook_user_view_alter().
+ */
+function commons_search_solr_user_user_view_alter(&$build) {
+  if ($build['#view_mode'] == 'search_results') {
+    // Add the user name linked to the profile.
+    $build['username'] = array(
+      '#theme' => 'username',
+      '#account' => $build['#account'],
+      '#prefix' => '<h4>',
+      '#suffix' => '</h4>',
+      '#weight' => 0,
+    );
+
+    // Add the user image linked to the profile.
+    $user_picture_uri = !empty($build['#account']->picture) ? $build['#account']->picture->uri : variable_get('user_picture_default', '');
+
+    $build['user_picture'] = array(
+      '#theme' => 'image_formatter',
+      '#item' => array(
+        'uri' => $user_picture_uri,
+        'alt' => t('Profile image'),
+      ),
+      '#image_style' => '50x50',
+      '#path' => array(
+        'path' => 'user/' . $build['#account']->uid,
+        'options' => array(
+          'attributes' => array(
+            'class' => array('user-picture'),
+          ),
+        ),
+      ),
+      '#weight' => 1,
+    );
+
+    // Add a section of associated groups.
+    if (!empty($build['#account']->og_user_node[LANGUAGE_NONE])) {
+      $groups = array();
+      foreach ($build['#account']->og_user_node[LANGUAGE_NONE] AS $og_node) {
+        if ($gnode = node_load($og_node['target_id'])) {
+          $groups['group-item group-' . $gnode->nid] = array(
+            'title' => $gnode->title,
+            'href' => 'node/' . $gnode->nid,
+            'attributes' => array(
+              'class' => array('group-link'),
+            ),
+          );
+        }
+      }
+      $build['group_membership'] = array(
+        '#theme' => 'links__profile_groups',
+        '#links' => $groups,
+        '#heading' => array(
+          'text' => t('Recently contributed to'),
+          'level' => 'h5',
+          'class' => array('associated-groups-title'),
+        ),
+        '#attributes' => array(
+          'class' => array(
+            'associated-groups'
+          ),
+        ),
+        '#weight' => 3,
+      );
+    }
+
+    // Strip out unnecessary formatting from the actions and push them to the
+    // bottom of the display.
+    if (isset($build['flags'])) {
+      // Remove the reported user if it exists
+      if (isset($build['flags']['abuse_user'])) {
+        unset($build['flags']['abuse_user']);
+      }
+
+      unset($build['flags']['#type']);
+      foreach ($build['flags'] as $key => &$data) {
+        if (substr($key, 0, 1) != '#' && isset($data['#type'])) {
+          unset($data['#type']);
+        }
+      }
+
+      $build['flags']['#weight'] = 4;
+    }
+
+    // Hide the history.
+    if (isset($build['summary'])) {
+      $build['summary']['#access'] = FALSE;
+    }
+  }
+}
+
+/**
+ * Implements hook_entity_info_alter().
+ */
+function commons_search_solr_user_entity_info_alter(&$entity_info) {
+  // Create a search results display mode for user entities.
+  $entity_info['user']['view modes']['search_results'] = array(
+    'label' => t('Search results'),
+    'custom settings' => TRUE,
+  );
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ */
+function commons_search_solr_user_form_alter(&$form, &$form_state, $form_id) {
+  if ($form_id == 'search_block_form') {
+    unset($form['custom_search_types']['#options']['c-user']);
+    $form['custom_search_types']['#options']['s-user'] = t('People');
+    if (strtolower(arg(0)) == 'people') {
+      $form['search_block_form']['#default_value'] = urldecode(arg(1));
+      $other_options = $form['custom_search_types']['#options'];
+      $form['custom_search_types']['#options'] = array_merge(array('s-user' => t('People')), $other_options);
+    }
+    //We want to override the #submit with our own, the other submits aren't relevant for the user page
+    $form['#submit'][]= 'commons_search_solr_user_search_submit';
+  }
+}
+
+function commons_search_solr_user_form_apachesolr_search_custom_page_search_form_alter(&$form, &$form_state) {
+  if ($form['#search_page']['page_id'] == 'user_search') {
+    $form['#attributes']['class'][] = 'user-search-form';
+    $form['basic']['flagged'] = array(
+      '#type' => 'checkbox',
+      '#title' => t('Following'),
+      '#default_value' => (empty($_GET['flagged']) ? FALSE : TRUE),
+      '#attributes' => array('onclick' => 'this.form.submit();'),
+    );
+    $form['basic']['retain-filters']['#type'] = 'hidden';
+    $form['basic']['retain-filters']['#value'] = 0;
+    $form['basic']['keys']['#title'] = t('Limit to');
+    $form['basic']['submit']['#value'] = t('Search');
+    $form['basic']['submit']['#weight'] = 10;
+    $form['#submit'][] = 'commons_search_solr_user_user_search_submit';
+  }
+}
+
+function commons_search_solr_user_user_search_submit($form, &$form_state) {
+  $form_state['redirect']['1']['query']['flagged'] = $form_state['values']['flagged'];
+}
+
+/**
+ * Submit handler that handles only the redirection to our Solr user directory.
+ */
+function commons_search_solr_user_search_submit($form, &$form_state) {
+  if ($form_state['values']['custom_search_types'] == 's-user') {
+    $user_search_page = apachesolr_search_page_load('user_search');
+    $keys = '/' . $form_state['values']['search_block_form'];
+    $form_state['redirect'] = $user_search_page['search_path'] . $keys;
+  }
+}
+
+/**
+ * Implements hook_module_implements_alter().
+ * This puts the solr_user hook at the end of the form_alters for custom search
+ * Otherwise the form_alter will get overridden by the other plethora of search
+ * modules.
+ */
+function commons_search_solr_user_module_implements_alter(&$modules, $hook) {
+  switch ($hook) {
+    case 'form_alter':
+      // Move this module to be last for form alterations.
+      $module = $modules['commons_search_solr_user'];
+      unset($modules['commons_search_solr_user']);
+      $modules['commons_search_solr_user'] = $module;
+      break;
+  }
+}
+
+/**
+ * Preprocess user profile.
+ *
+ * @param array $variables
+ */
+function commons_search_solr_user_preprocess_user_profile(&$variables, $hook) {
+  if ($variables['elements']['#view_mode'] == 'search_results') {
+    $variables['theme_hook_suggestions'][] = 'user_profile__search_results';
+  }
+}
+
+/**
+ * Implements hook_preprocess_commons_search_solr_user_results().
+ */
+function commons_search_solr_user_preprocess_commons_search_solr_user_results(&$variables, $hook) {
+  // Add classed to the results header.
+  $variables['title_attributes_array']['class'][] = 'user-search-results-title';
+  // Add a class to the results wrapper.
+  $variables['content_attributes_array']['class'][] = 'user-search-results-content';
+
+  // Populate the content array.
+  $variables['content'] = array();
+  if (!empty($variables['results'])) {
+    $variables['content']['results'] = $variables['results'];
+  }
+}
+
+/**
+ * Implements hook_process_hook().
+ */
+function commons_search_solr_user_process_search_results(&$variables, $hook) {
+  if ($variables['search_page']['page_id'] == 'user_search') {
+    // We set the title to be blank so it doesn't display 'Search results'.
+    $variables['title'] = ' ';
+  }
+}
+
+/**
+ * Feature module hook. Invoked on a Feature module after that module is
+ * enabled.
+ *
+ * @param $component
+ *   String name of the component that has just been enabled.
+ */
+function commons_search_solr_user_post_features_enable_feature($component) {
+  if ($component == 'apachesolr_search_page') {
+    $revert = array(
+      'commons_search_solr_user' => array('apachesolr_search_page'),
+    );
+    features_revert($revert);
+
+    // We must clear the menu cache before trying to set a link, otherwise the menu
+    // system won't show the people link because it doesn't think the page exists
+    // even though the link exists in the menu.
+    drupal_static_reset('apachesolr_search_load_all_search_pages');
+
+    $revert = array(
+      'commons_search_solr_user' => array('menu_links'),
+    );
+    features_revert($revert);
+  }
+}
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.features.inc b/modules/commons/commons_site_homepage/commons_site_homepage.features.inc
new file mode 100644
index 0000000..2c9f02a
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.features.inc
@@ -0,0 +1,24 @@
+<?php
+/**
+ * @file
+ * commons_site_homepage.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_site_homepage_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_site_homepage_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.info b/modules/commons/commons_site_homepage/commons_site_homepage.info
new file mode 100644
index 0000000..60f9e39
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.info
@@ -0,0 +1,21 @@
+name = Commons Site Homepage
+description = Provides a homepage for the site for anonymous and authenticated users
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_activity_streams
+dependencies[] = commons_featured
+dependencies[] = commons_follow
+dependencies[] = commons_radioactivity_groups
+dependencies[] = entity
+dependencies[] = page_manager
+dependencies[] = strongarm
+dependencies[] = views
+dependencies[] = views_litepager
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[page_manager_pages][] = commons_home
+features[variable][] = site_frontpage
+features[views_view][] = commons_homepage_content
+features_exclude[dependencies][views_content] = views_content
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.install b/modules/commons/commons_site_homepage/commons_site_homepage.install
new file mode 100644
index 0000000..23564ab
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.install
@@ -0,0 +1,15 @@
+<?php
+
+/**
+ * Add the tabbed browsing widget to the site homepage
+ * per http://drupal.org/node/1969088.
+ */
+function commons_site_homepage_update_7301() {
+  $revert = array(
+    'commons_site_homepage' => array(
+      'page_manager_pages',
+    ),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.module b/modules/commons/commons_site_homepage/commons_site_homepage.module
new file mode 100644
index 0000000..4b6c52c
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.module
@@ -0,0 +1,108 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Site Homepage feature.
+ */
+
+include_once 'commons_site_homepage.features.inc';
+
+/**
+* Implements hook_form_alter().
+*/
+function commons_site_homepage_form_alter(&$form, &$form_state, $form_id) {
+  // Redirect users to the site homepage after login or registration.
+  if ($form_id == 'user_register_form' || $form_id == 'user_login') {
+    $form['#submit'][] = 'commons_homepage_user_register_login_submit';
+  }
+  if ($form_id == 'views_exposed_form' && $form['#id'] == 'views-exposed-form-commons-homepage-content-panel-pane-1') {
+    // We customize the text inside the exposed filter form elements
+    // to allow for them to form a sentence, such as:
+    // "Show Groups I'm following sorted by last updated first"
+    $form['following']['#options'][1] = t('following');
+    $form['following']['#options'][0] = t('not following');
+    // Users should never be able to show groups in this listing.
+    unset($form['type']['#options']['group']);
+    $form['type']['#options']['All'] = t('all content');
+    $form['sort_by']['#title'] = t('sorted by');
+    foreach ($form['type']['#options'] as $type => $name) {
+      if ($type != 'All') {
+        $form['type']['#options'][$type] = t(strtolower(substr($name, 0, 1)) . substr($name,1) . 's');
+      }
+    }
+  }
+}
+
+function commons_homepage_user_register_login_submit($form, &$form_state) {
+  $form_state['redirect'] = variable_get('site_frontpage', 'home');
+}
+
+/**
+ * Implements hook_block_info().
+ */
+function commons_site_homepage_block_info() {
+  $blocks['commons_site_homepage'] = array(
+    'info' => t('Commons anonymous homepage Sign up/login buttons'),
+    'cache' => DRUPAL_NO_CACHE,
+  );
+  return $blocks;
+}
+
+/**
+ * Implements hook_block_view().
+ *  Defines a simple "Signup or Login" block for use
+ *  on the anonymous site homepage.
+ */
+function commons_site_homepage_block_view() {
+  $block['content'] = '';
+  if (variable_get('user_register', USER_REGISTER_VISITORS_ADMINISTRATIVE_APPROVAL)) {
+    $block['content'] .= l(t('Signup'), 'user/register', array('attributes' => array('class' => 'commons-sign-up', 'title' => t('Sign up')))) . ' ';
+  }
+  $block['content'] .= l(t('Login'), 'user/login', array('attributes' => array('class' => 'commons-login')));
+  $block['subject'] = '';
+  return $block;
+}
+
+/**
+ * Implements hook_default_page_manager_pages_alter().
+ */
+function commons_site_homepage_default_page_manager_pages_alter(&$items) {
+  if (isset($items['commons_home'])) {
+    $items['commons_home']->default_handlers['page_commons_home_panel_context_2']->conf['display']->content['new-2ab570f0-8498-44f4-e9d0-9977e3d8d4df']->configuration['title'] = variable_get('commons_anonymous_welcome_title', t('The open-source alternative for enterprise-scale business software'));
+    $items['commons_home']->default_handlers['page_commons_home_panel_context_2']->conf['display']->content['new-2ab570f0-8498-44f4-e9d0-9977e3d8d4df']->configuration['body'] = variable_get('commons_anonymous_welcome_body', t('Enable social networking to create productive interactions. Whether your community is public or private, Commons does it!'));
+
+    $pane = new stdClass();
+    $pane->pid = 'new-94106ddd-1278-0954-c5ba-b59ff1b9bf49';
+    $pane->panel = 'three_33_first';
+    $pane->type = 'views';
+    $pane->subtype = 'commons_events_upcoming';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_pager_settings' => 0,
+      'use_pager' => 0,
+      'nodes_per_page' => '5',
+      'pager_id' => '0',
+      'offset' => '0',
+      'more_link' => 0,
+      'feed_icons' => 0,
+      'panel_args' => 0,
+      'link_to_view' => 0,
+      'args' => '',
+      'url' => '',
+      'display' => 'commons_events_upcoming_global_block',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '94106ddd-1278-0954-c5ba-b59ff1b9bf49';
+    $items['commons_home']->default_handlers['page_commons_home_panel_context_2']->conf['display']->content['new-94106ddd-1278-0954-c5ba-b59ff1b9bf49'] = $pane;
+    $items['commons_home']->default_handlers['page_commons_home_panel_context_2']->conf['display']->panels['three_33_first'][1] = 'new-94106ddd-1278-0954-c5ba-b59ff1b9bf49';
+  }
+}
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.pages_default.inc b/modules/commons/commons_site_homepage/commons_site_homepage.pages_default.inc
new file mode 100644
index 0000000..213f998
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.pages_default.inc
@@ -0,0 +1,356 @@
+<?php
+/**
+ * @file
+ * commons_site_homepage.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_pages().
+ */
+function commons_site_homepage_default_page_manager_pages() {
+  $page = new stdClass();
+  $page->disabled = FALSE; /* Edit this to true to make a default page disabled initially */
+  $page->api_version = 1;
+  $page->name = 'commons_home';
+  $page->task = 'page';
+  $page->admin_title = 'Home';
+  $page->admin_description = 'Site home page for anonymous and authenticated users.';
+  $page->path = 'home';
+  $page->access = array(
+    'type' => 'none',
+    'settings' => NULL,
+  );
+  $page->menu = array(
+    'type' => 'normal',
+    'title' => 'Home',
+    'weight' => '-10',
+    'name' => 'main-menu',
+    'parent' => array(
+      'type' => 'none',
+      'title' => '',
+      'weight' => 0,
+      'name' => 'navigation',
+    ),
+  );
+  $page->arguments = array();
+  $page->conf = array();
+  $page->default_handlers = array();
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'page_commons_home_panel_context';
+  $handler->task = 'page';
+  $handler->subtask = 'commons_home';
+  $handler->handler = 'panel_context';
+  $handler->weight = 0;
+  $handler->conf = array(
+    'title' => 'Home (authenticated)',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+    'access' => array(
+      'plugins' => array(
+        0 => array(
+          'name' => 'role',
+          'settings' => array(
+            'rids' => array(
+              0 => 2,
+            ),
+          ),
+          'context' => 'logged-in-user',
+          'not' => FALSE,
+        ),
+      ),
+      'logic' => 'and',
+    ),
+  );
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = 'What\'s going on?';
+  $display->uuid = '84741210-79de-a174-5d6f-8ebfcb061f03';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-97c7ce09-3cb1-6b34-a940-8fda43e609cc';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'commons_bw_group';
+    $pane->subtype = 'commons_bw_group';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '97c7ce09-3cb1-6b34-a940-8fda43e609cc';
+    $display->content['new-97c7ce09-3cb1-6b34-a940-8fda43e609cc'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-97c7ce09-3cb1-6b34-a940-8fda43e609cc';
+    $pane = new stdClass();
+    $pane->pid = 'new-b20add8c-2daf-4684-45f3-212d60c7f31e';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_activity_streams_activity-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'b20add8c-2daf-4684-45f3-212d60c7f31e';
+    $display->content['new-b20add8c-2daf-4684-45f3-212d60c7f31e'] = $pane;
+    $display->panels['two_66_33_second'][0] = 'new-b20add8c-2daf-4684-45f3-212d60c7f31e';
+    $pane = new stdClass();
+    $pane->pid = 'new-da301a84-b9a5-8664-cd4b-1e84d7dd9f42';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_featured-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = 'da301a84-b9a5-8664-cd4b-1e84d7dd9f42';
+    $display->content['new-da301a84-b9a5-8664-cd4b-1e84d7dd9f42'] = $pane;
+    $display->panels['two_66_33_second'][1] = 'new-da301a84-b9a5-8664-cd4b-1e84d7dd9f42';
+    $pane = new stdClass();
+    $pane->pid = 'new-895dfc63-a30f-f734-3185-c40c407b4af0';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_groups_contributors-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = '895dfc63-a30f-f734-3185-c40c407b4af0';
+    $display->content['new-895dfc63-a30f-f734-3185-c40c407b4af0'] = $pane;
+    $display->panels['two_66_33_second'][2] = 'new-895dfc63-a30f-f734-3185-c40c407b4af0';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = '0';
+  $handler->conf['display'] = $display;
+  $page->default_handlers[$handler->name] = $handler;
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'page_commons_home_panel_context_2';
+  $handler->task = 'page';
+  $handler->subtask = 'commons_home';
+  $handler->handler = 'panel_context';
+  $handler->weight = 1;
+  $handler->conf = array(
+    'title' => 'Home (anonymous)',
+    'no_blocks' => 0,
+    'pipeline' => 'standard',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+    'access' => array(
+      'plugins' => array(
+        0 => array(
+          'name' => 'role',
+          'settings' => array(
+            'rids' => array(
+              0 => 1,
+            ),
+          ),
+          'context' => 'logged-in-user',
+          'not' => FALSE,
+        ),
+      ),
+      'logic' => 'and',
+    ),
+  );
+  $display = new panels_display();
+  $display->layout = 'three_3x33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+      'three_33_top' => NULL,
+      'three_33_first' => NULL,
+      'three_33_second' => NULL,
+      'three_33_third' => NULL,
+      'three_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = 'afa005f6-cf15-78e4-d53d-8885db3cde39';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-0ae8e5a2-44f6-8584-21f2-8be6e340e62f';
+    $pane->panel = 'three_33_first';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_groups_contributors-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '0ae8e5a2-44f6-8584-21f2-8be6e340e62f';
+    $display->content['new-0ae8e5a2-44f6-8584-21f2-8be6e340e62f'] = $pane;
+    $display->panels['three_33_first'][0] = 'new-0ae8e5a2-44f6-8584-21f2-8be6e340e62f';
+    $pane = new stdClass();
+    $pane->pid = 'new-b6e290b7-1d2b-5db4-a181-28befdcde628';
+    $pane->panel = 'three_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_radioactivity_groups_most_active-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'b6e290b7-1d2b-5db4-a181-28befdcde628';
+    $display->content['new-b6e290b7-1d2b-5db4-a181-28befdcde628'] = $pane;
+    $display->panels['three_33_second'][0] = 'new-b6e290b7-1d2b-5db4-a181-28befdcde628';
+    $pane = new stdClass();
+    $pane->pid = 'new-800b2f8a-307f-0e14-4174-626a1c5c4cd9';
+    $pane->panel = 'three_33_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_featured-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '800b2f8a-307f-0e14-4174-626a1c5c4cd9';
+    $display->content['new-800b2f8a-307f-0e14-4174-626a1c5c4cd9'] = $pane;
+    $display->panels['three_33_third'][0] = 'new-800b2f8a-307f-0e14-4174-626a1c5c4cd9';
+    $pane = new stdClass();
+    $pane->pid = 'new-58e71a00-2b87-ab64-31c5-4fdc9e99a2d4';
+    $pane->panel = 'three_33_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_activity_streams_activity-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '58e71a00-2b87-ab64-31c5-4fdc9e99a2d4';
+    $display->content['new-58e71a00-2b87-ab64-31c5-4fdc9e99a2d4'] = $pane;
+    $display->panels['three_33_third'][1] = 'new-58e71a00-2b87-ab64-31c5-4fdc9e99a2d4';
+    $pane = new stdClass();
+    $pane->pid = 'new-7d40d7ca-0ea5-9a54-4d1f-8b6240e72bf0';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'block';
+    $pane->subtype = 'commons_site_homepage-commons_site_homepage';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '7d40d7ca-0ea5-9a54-4d1f-8b6240e72bf0';
+    $display->content['new-7d40d7ca-0ea5-9a54-4d1f-8b6240e72bf0'] = $pane;
+    $display->panels['three_33_top'][0] = 'new-7d40d7ca-0ea5-9a54-4d1f-8b6240e72bf0';
+    $pane = new stdClass();
+    $pane->pid = 'new-2ab570f0-8498-44f4-e9d0-9977e3d8d4df';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'custom';
+    $pane->subtype = 'custom';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'admin_title' => 'Anonymous homepage welcome text',
+      'title' => 'Welcome to our community',
+      'body' => 'Share your thoughts, find answers to your questions.',
+      'format' => 'filtered_html',
+      'substitute' => TRUE,
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '2ab570f0-8498-44f4-e9d0-9977e3d8d4df';
+    $display->content['new-2ab570f0-8498-44f4-e9d0-9977e3d8d4df'] = $pane;
+    $display->panels['three_33_top'][1] = 'new-2ab570f0-8498-44f4-e9d0-9977e3d8d4df';
+  $display->hide_title = PANELS_TITLE_NONE;
+  $display->title_pane = '0';
+  $handler->conf['display'] = $display;
+  $page->default_handlers[$handler->name] = $handler;
+  $pages['commons_home'] = $page;
+
+  return $pages;
+
+}
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.strongarm.inc b/modules/commons/commons_site_homepage/commons_site_homepage.strongarm.inc
new file mode 100644
index 0000000..52ec3d3
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.strongarm.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * commons_site_homepage.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_site_homepage_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'site_frontpage';
+  $strongarm->value = 'home';
+  $export['site_frontpage'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.variable.inc b/modules/commons/commons_site_homepage/commons_site_homepage.variable.inc
new file mode 100644
index 0000000..012fb5d
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.variable.inc
@@ -0,0 +1,40 @@
+<?php
+
+/**
+ * @file
+ * Variables for the Commons Site Homepage module.
+ */
+
+/**
+ * Implements hook_variable_group_info().
+ */
+function commons_site_homepage_variable_group_info() {
+  $groups['commons_site_homepage'] = array(
+    'title' => t('Commons Site Homepage'),
+    'description' => t("Text that will be shown on your community's homepage to help new visitors understand what your community is about and why they should join."),
+  );
+
+  return $groups;
+}
+
+/**
+ * Implements hook_variable_info().
+ */
+function commons_site_homepage_variable_info($options) {
+  $variable['commons_anonymous_welcome_title'] = array(
+    'type' => 'string',
+    'title' => t('Welcome headline', array(), $options),
+    'description' => t('A short description of the community that visitors can understand at a glance.'),
+    'default' => 'The open-source alternative for enterprise-scale business software',
+    'group' => 'commons_site_homepage',
+  );
+  $variable['commons_anonymous_welcome_body'] = array(
+    'type' => 'string',
+    'title' => t('Welcome body text', array(), $options),
+    'description' => t('A couple of sentences elaborating about your community.'),
+    'default' => 'Enable social networking to create productive interactions. Whether your community is public or private, Commons does it!',
+    'group' => 'commons_site_homepage',
+  );
+
+  return $variable;
+}
diff --git a/modules/commons/commons_site_homepage/commons_site_homepage.views_default.inc b/modules/commons/commons_site_homepage/commons_site_homepage.views_default.inc
new file mode 100644
index 0000000..9984858
--- /dev/null
+++ b/modules/commons/commons_site_homepage/commons_site_homepage.views_default.inc
@@ -0,0 +1,173 @@
+<?php
+/**
+ * @file
+ * commons_site_homepage.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_site_homepage_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_homepage_content';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node';
+  $view->human_name = 'commons_homepage_content';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['exposed_form']['options']['expose_sort_order'] = FALSE;
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '4';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '1';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'entity';
+  $handler->display->display_options['row_options']['view_mode'] = 'teaser';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No content matched the filters you selected.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Sort criterion: Content: Updated date */
+  $handler->display->display_options['sorts']['changed']['id'] = 'changed';
+  $handler->display->display_options['sorts']['changed']['table'] = 'node';
+  $handler->display->display_options['sorts']['changed']['field'] = 'changed';
+  $handler->display->display_options['sorts']['changed']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['changed']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['changed']['expose']['label'] = 'last updated first';
+  /* Sort criterion: Content: Radioactivity (field_radioactivity:radioactivity_energy) */
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['id'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['table'] = 'field_data_field_radioactivity';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['field'] = 'field_radioactivity_radioactivity_energy';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['field_radioactivity_radioactivity_energy']['expose']['label'] = 'most active';
+  /* Contextual filter: Content: Nid */
+  $handler->display->display_options['arguments']['nid']['id'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['table'] = 'node';
+  $handler->display->display_options['arguments']['nid']['field'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['nid']['default_argument_type'] = 'commons_follow_node';
+  $handler->display->display_options['arguments']['nid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['nid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['nid']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['nid']['specify_validation'] = TRUE;
+  $handler->display->display_options['arguments']['nid']['validate']['fail'] = 'empty';
+  $handler->display->display_options['arguments']['nid']['break_phrase'] = TRUE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['group'] = 1;
+  $handler->display->display_options['filters']['type']['exposed'] = TRUE;
+  $handler->display->display_options['filters']['type']['expose']['operator_id'] = 'type_op';
+  $handler->display->display_options['filters']['type']['expose']['label'] = 'Showing';
+  $handler->display->display_options['filters']['type']['expose']['operator'] = 'type_op';
+  $handler->display->display_options['filters']['type']['expose']['identifier'] = 'type';
+  $handler->display->display_options['filters']['type']['expose']['remember'] = TRUE;
+  $handler->display->display_options['filters']['type']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+    3 => 0,
+  );
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: User Follow */
+  $handler->display->display_options['filters']['cf_user_follow']['id'] = 'cf_user_follow';
+  $handler->display->display_options['filters']['cf_user_follow']['table'] = 'node';
+  $handler->display->display_options['filters']['cf_user_follow']['field'] = 'cf_user_follow';
+  $handler->display->display_options['filters']['cf_user_follow']['value'] = '0';
+  $handler->display->display_options['filters']['cf_user_follow']['exposed'] = TRUE;
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['operator_id'] = '';
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['label'] = 'I\'m';
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['operator'] = 'cf_user_follow_op';
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['identifier'] = 'following';
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['required'] = TRUE;
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['remember'] = TRUE;
+  $handler->display->display_options['filters']['cf_user_follow']['expose']['remember_roles'] = array(
+    2 => '2',
+    1 => 0,
+    3 => 0,
+  );
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type_1']['id'] = 'type_1';
+  $handler->display->display_options['filters']['type_1']['table'] = 'node';
+  $handler->display->display_options['filters']['type_1']['field'] = 'type';
+  $handler->display->display_options['filters']['type_1']['operator'] = 'not in';
+  $handler->display->display_options['filters']['type_1']['value'] = array(
+    'group' => 'group',
+  );
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'panel_pane_1');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_title'] = 'What\'s going on?';
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['allow']['use_pager'] = 0;
+  $handler->display->display_options['allow']['items_per_page'] = 0;
+  $handler->display->display_options['allow']['offset'] = 0;
+  $handler->display->display_options['allow']['link_to_view'] = 0;
+  $handler->display->display_options['allow']['more_link'] = 0;
+  $handler->display->display_options['allow']['path_override'] = 0;
+  $handler->display->display_options['allow']['title_override'] = 0;
+  $handler->display->display_options['allow']['exposed_form'] = 0;
+  $handler->display->display_options['allow']['fields_override'] = 0;
+  $handler->display->display_options['inherit_panels_path'] = '1';
+  $translatables['commons_homepage_content'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No content matched the filters you selected.'),
+    t('last updated first'),
+    t('most active'),
+    t('All'),
+    t('Showing'),
+    t('I\'m'),
+    t('Content pane'),
+    t('What\'s going on?'),
+    t('Commons'),
+  );
+  $export['commons_homepage_content'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_social_sharing/commons_social_sharing.features.inc b/modules/commons/commons_social_sharing/commons_social_sharing.features.inc
new file mode 100644
index 0000000..4dc0370
--- /dev/null
+++ b/modules/commons/commons_social_sharing/commons_social_sharing.features.inc
@@ -0,0 +1,14 @@
+<?php
+/**
+ * @file
+ * commons_social_sharing.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_social_sharing_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_social_sharing/commons_social_sharing.info b/modules/commons/commons_social_sharing/commons_social_sharing.info
new file mode 100644
index 0000000..a16a207
--- /dev/null
+++ b/modules/commons/commons_social_sharing/commons_social_sharing.info
@@ -0,0 +1,18 @@
+name = Commons Social Sharing
+description = Provide links to share content to external social services such as Facebook and Google+
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ctools
+dependencies[] = sharethis
+dependencies[] = strongarm
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[variable][] = sharethis_button_option
+features[variable][] = sharethis_comments
+features[variable][] = sharethis_late_load
+features[variable][] = sharethis_location
+features[variable][] = sharethis_node_option
+features[variable][] = sharethis_option_extras
+features[variable][] = sharethis_teaser_option
+features[variable][] = sharethis_weight
+features[variable][] = sharethis_widget_option
diff --git a/modules/commons/commons_social_sharing/commons_social_sharing.module b/modules/commons/commons_social_sharing/commons_social_sharing.module
new file mode 100644
index 0000000..2a0bc9e
--- /dev/null
+++ b/modules/commons/commons_social_sharing/commons_social_sharing.module
@@ -0,0 +1,43 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Social Sharing feature.
+ */
+
+include_once 'commons_social_sharing.features.inc';
+
+
+/**
+ * Implements hook_features_export_alter().
+ */
+function commons_social_sharing_features_export_alter(&$export, $module_name) {
+  // Prevent
+  if($module_name == 'commons_social_sharing' && isset($export['features']['variable'])) {
+    unset($export['features']['variable']);
+  }
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+ function commons_social_sharing_strongarm_alter(&$items) {
+  // Expose the Post content type for 'liking' via the Commons_social_sharing module
+  // by altering the configuration for the Rate.module widget that it provides.
+  if (!empty($items['rate_widgets']->value)) {
+    foreach($items['rate_widgets']->value as $key => $widget) {
+      if ($widget->name == 'commons_social_sharing') {
+        $commons_entity_integrations = commons_entity_integration_info();
+        if (!empty($commons_entity_integrations['node'])) {
+          foreach ($commons_entity_integrations['node'] as $bundle => $options) {
+            if (!isset($options['exclude_rate']) || $options['exclude_rate'] != TRUE) {
+              $items['rate_widgets']->value[$key]->node_types[] = $bundle;
+            }
+            if (!isset($options['exclude_rate_comments']) || $options['exclude_rate_comments'] != TRUE) {
+              $items['rate_widgets']->value[$key]->comment_types[] = $bundle;
+            }
+          }
+        }
+      }
+    }
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_social_sharing/commons_social_sharing.strongarm.inc b/modules/commons/commons_social_sharing/commons_social_sharing.strongarm.inc
new file mode 100644
index 0000000..7e351c4
--- /dev/null
+++ b/modules/commons/commons_social_sharing/commons_social_sharing.strongarm.inc
@@ -0,0 +1,80 @@
+<?php
+/**
+ * @file
+ * commons_social_sharing.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_social_sharing_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_button_option';
+  $strongarm->value = 'stbc_vcount';
+  $export['sharethis_button_option'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_comments';
+  $strongarm->value = 0;
+  $export['sharethis_comments'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_late_load';
+  $strongarm->value = 0;
+  $export['sharethis_late_load'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_location';
+  $strongarm->value = 'links';
+  $export['sharethis_location'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_node_option';
+  $strongarm->value = 'group,page,post,0,0,0,0,0,0';
+  $export['sharethis_node_option'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_option_extras';
+  $strongarm->value = array(
+    'Facebook Like:fblike' => 'Facebook Like:fblike',
+    'Google Plus One:plusone' => 0,
+  );
+  $export['sharethis_option_extras'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_teaser_option';
+  $strongarm->value = 1;
+  $export['sharethis_teaser_option'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_weight';
+  $strongarm->value = '10';
+  $export['sharethis_weight'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'sharethis_widget_option';
+  $strongarm->value = 'st_multi';
+  $export['sharethis_widget_option'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_topics/commons_topics.features.field_base.inc b/modules/commons/commons_topics/commons_topics.features.field_base.inc
new file mode 100644
index 0000000..d43d7b9
--- /dev/null
+++ b/modules/commons/commons_topics/commons_topics.features.field_base.inc
@@ -0,0 +1,48 @@
+<?php
+/**
+ * @file
+ * commons_topics.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_topics_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_topics'
+  $field_bases['field_topics'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_topics',
+    'foreign keys' => array(
+      'tid' => array(
+        'columns' => array(
+          'tid' => 'tid',
+        ),
+        'table' => 'taxonomy_term_data',
+      ),
+    ),
+    'indexes' => array(
+      'tid' => array(
+        0 => 'tid',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'taxonomy',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => array(
+          'vocabulary' => 'topics',
+          'parent' => 0,
+        ),
+      ),
+    ),
+    'translatable' => 0,
+    'type' => 'taxonomy_term_reference',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_topics/commons_topics.features.field_instance.inc b/modules/commons/commons_topics/commons_topics.features.field_instance.inc
new file mode 100644
index 0000000..9bed7dd
--- /dev/null
+++ b/modules/commons/commons_topics/commons_topics.features.field_instance.inc
@@ -0,0 +1,66 @@
+<?php
+/**
+ * @file
+ * commons_topics.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_topics_field_default_field_instances() {
+  $field_instances = array();
+
+  // Get a list of content types that should have the field_topics field added.
+  $commons_groups_entity_types = commons_topics_get_entity_types_with_topics();
+  if (!empty($commons_groups_entity_types)) {
+    foreach ($commons_groups_entity_types as $entity_type => $bundles) {
+      foreach(array_keys($bundles) as $bundle) {
+        commons_topics_field_definition($field_instances, $entity_type, $bundle);
+      }
+    }
+  }
+
+  return $field_instances;
+}
+
+function commons_topics_field_definition(&$field_instances, $entity_type, $bundle) {
+  // Exported field_instance: 'ENTITY_TYPE-BUNDLE-field_topics'
+  $field_instances["$entity_type-$bundle-field_topics"] = array(
+    'bundle' => $bundle,
+    'default_value' => NULL,
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'taxonomy',
+        'settings' => array(),
+        'type' => 'taxonomy_term_reference_link',
+        'weight' => '6',
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => $entity_type,
+    'field_name' => 'field_topics',
+    'label' => 'Topics',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'taxonomy',
+      'settings' => array(
+        'autocomplete_path' => 'taxonomy/autocomplete',
+        'size' => 60,
+      ),
+      'type' => 'taxonomy_autocomplete',
+      'weight' => '13',
+    ),
+  );
+}
diff --git a/modules/commons/commons_topics/commons_topics.features.taxonomy.inc b/modules/commons/commons_topics/commons_topics.features.taxonomy.inc
new file mode 100644
index 0000000..1ca8d6f
--- /dev/null
+++ b/modules/commons/commons_topics/commons_topics.features.taxonomy.inc
@@ -0,0 +1,36 @@
+<?php
+/**
+ * @file
+ * commons_topics.features.taxonomy.inc
+ */
+
+/**
+ * Implements hook_taxonomy_default_vocabularies().
+ */
+function commons_topics_taxonomy_default_vocabularies() {
+  return array(
+    'topics' => array(
+      'name' => 'Topics',
+      'machine_name' => 'topics',
+      'description' => '',
+      'hierarchy' => 0,
+      'module' => 'taxonomy',
+      'weight' => 0,
+      'rdf_mapping' => array(
+        'rdftype' => array(
+          0 => 'skos:ConceptScheme',
+        ),
+        'name' => array(
+          'predicates' => array(
+            0 => 'dc:title',
+          ),
+        ),
+        'description' => array(
+          'predicates' => array(
+            0 => 'rdfs:comment',
+          ),
+        ),
+      ),
+    ),
+  );
+}
diff --git a/modules/commons/commons_topics/commons_topics.info b/modules/commons/commons_topics/commons_topics.info
new file mode 100644
index 0000000..7546f1a
--- /dev/null
+++ b/modules/commons/commons_topics/commons_topics.info
@@ -0,0 +1,8 @@
+name = Commons Topics
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = features
+dependencies[] = taxonomy
+features[features_api][] = api:2
+features[field_base][] = field_topics
+features[taxonomy][] = topics
diff --git a/modules/commons/commons_topics/commons_topics.module b/modules/commons/commons_topics/commons_topics.module
new file mode 100644
index 0000000..b4dc6dd
--- /dev/null
+++ b/modules/commons/commons_topics/commons_topics.module
@@ -0,0 +1,87 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Topics feature.
+ */
+
+/**
+* Implements hook_system_info_alter().
+*/
+function commons_topics_system_info_alter(&$info, $file, $type) {
+  // Commons Topics dynamically adds field_topics to content types that implement
+  // commons_topics_field. We must add a corresponding line for each field
+  // instance to commons_topics.info so that Features is aware of the instance
+  // and can sucessfully revert the field_instance component back to its
+  // default state.
+  if ($file->name == 'commons_topics') {
+    $commons_topics_entity_types = commons_topics_get_entity_types_with_topics();
+    if (!empty($commons_topics_entity_types)) {
+      foreach ($commons_topics_entity_types as $entity_type => $bundles) {
+        foreach(array_keys($bundles) as $bundle) {
+          $info['features']['field_instance'][] = "$entity_type-$bundle-field_topics";
+        }
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter();
+ */
+function commons_topics_form_node_form_alter(&$form, &$form_state) {
+  if (isset($form['field_topics'])) {
+    $form['topics_wrapper'] = array(
+      '#type' => 'fieldset',
+      '#title' => t('Topics'),
+      '#collapsible' => TRUE,
+      '#collapsed' => FALSE,
+      '#group' => 'additional_settings',
+      '#weight' => -15,
+    );
+    $form['topics_wrapper']['field_topics'] = $form['field_topics'];
+    $form['field_topics'] = array('#language' => NULL);
+    $form['#attached']['js'] = array(
+      drupal_get_path('module', 'commons_topics') . '/js/commons_topics.js',
+    );
+  }
+}
+
+/**
+ * Returns an array of entity types that are enabled via Commons.
+ */
+function commons_topics_get_entity_types_with_topics() {
+  // Find all Commons Entity integrations.
+  $commons_entity_integrations = commons_entity_integration_info();
+  if (empty($commons_entity_integrations)) {
+    return array();
+  }
+
+  foreach ($commons_entity_integrations as $entity_type => $integration) {
+    foreach ($integration as $bundle => $options) {
+      if (isset($options['exclude_topics']) && $options['exclude_topics'] == TRUE) {
+        unset($commons_entity_integrations[$entity_type][$bundle]);
+      }
+    }
+    // If an entity type has no integrations, don't return it.
+    if (empty($commons_entity_integrations[$entity_type])) {
+      unset($commons_entity_integrations[$entity_type]);
+    }
+  }
+
+  return $commons_entity_integrations;
+}
+
+/**
+ * Implements hook_features_pipe_alter().
+ */
+function commons_topics_features_pipe_alter(&$pipe, $data, $export) {
+  if (!empty($pipe['field_instance'])) {
+    foreach ($pipe['field_instance'] as $delta => $value) {
+      $args = explode('-', $value);
+      $field_name = $args[2];
+      if ($field_name == 'field_topics') {
+        unset($pipe['field_instance'][$delta]);
+      }
+    }
+  }
+}
diff --git a/modules/commons/commons_topics/js/commons_topics.js b/modules/commons/commons_topics/js/commons_topics.js
new file mode 100644
index 0000000..8d7c175
--- /dev/null
+++ b/modules/commons/commons_topics/js/commons_topics.js
@@ -0,0 +1,15 @@
+(function ($) {
+  Drupal.behaviors.commons_topics_update_legend = {
+    attach: function (context, settings) {
+      $(':input[name^="field_topics"]').change(function() {
+        if ($(':input[name^="field_topics"]').val() == "") {
+          $("[id^='edit-topics-wrapper'] .summary").text(Drupal.t("No topics"));
+        }
+        else {
+          $("[id^='edit-topics-wrapper'] .summary").text($(':input[name^="field_topics"]').val());
+        }
+      });
+      $(':input[name^="field_topics"]').change();
+    }
+  };
+})(jQuery);
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.commons_utility_links.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.commons_utility_links.inc
new file mode 100644
index 0000000..3ffe7ea
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.commons_utility_links.inc
@@ -0,0 +1,57 @@
+<?php
+
+/**
+ * @file
+ * Commons Utility Links hooks implemented by the Commons Trusted Contacts module.
+ */
+
+/**
+ * Implements hook_commons_utility_links().
+ */
+function commons_trusted_contacts_commons_utility_links() {
+  $links = array();
+
+  if (user_is_logged_in()) {
+    global $user;
+    $account = $user;
+
+    // Check for unread invitations.
+    $unread_invitations = count(commons_trusted_contacts_get_pending_invitations($account->uid));
+
+    // Check for unread messages.
+    $unread_messages = privatemsg_unread_count($account);
+
+    // Provide a default mailbox icon pointing to the private messages UI when
+    // there are no unread messages or invitations.
+    if (empty($unread_invitations) && empty($unread_messages)) {
+      $links['no-unread-messages'] = array(
+        'href' => 'user/' . $user->uid . '/contacts',
+        'query' => array('qt-commons_trusted_contacts' => 'messages'),
+        'title' => t('No unread messages'),
+        'weight' => -9,
+      );
+    }
+
+    // Add a link to the user's invitations.
+    if ($unread_invitations) {
+      $links['unread-invitations']= array(
+        'href' => 'user/' . $user->uid . '/contacts',
+        'query' => array('qt-commons_trusted_contacts' => 'invitations'),
+        'title' => format_plural($unread_invitations, '1 invitation', '@count invitations'),
+        'weight' => -8,
+      );
+    }
+
+    // Add a link to the user's unread messages.
+    if ($unread_messages) {
+      $links['unread-messages']= array(
+        'href' => 'user/' . $user->uid . '/contacts',
+        'query' => array('qt-commons_trusted_contacts' => 'messages'),
+        'title' => format_plural($unread_messages, '1 message', '@count messages'),
+        'weight' => -7,
+      );
+    }
+  }
+
+  return $links;
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.field_base.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.field_base.inc
new file mode 100644
index 0000000..3edeb77
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.field_base.inc
@@ -0,0 +1,335 @@
+<?php
+/**
+ * @file
+ * commons_trusted_contacts.features.field_base.inc
+ */
+
+/**
+ * Implements hook_field_default_field_bases().
+ */
+function commons_trusted_contacts_field_default_field_bases() {
+  $field_bases = array();
+
+  // Exported field_base: 'field_approving_user'
+  $field_bases['field_approving_user'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_approving_user',
+    'foreign keys' => array(
+      'users' => array(
+        'columns' => array(
+          'target_id' => 'uid',
+        ),
+        'table' => 'users',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'target_type' => 'user',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'field_confirmation'
+  $field_bases['field_confirmation'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_confirmation',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => '',
+        1 => '',
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => 0,
+    'type' => 'list_boolean',
+  );
+
+  // Exported field_base: 'field_membership_token'
+  $field_bases['field_membership_token'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_membership_token',
+    'foreign keys' => array(
+      'format' => array(
+        'columns' => array(
+          'format' => 'format',
+        ),
+        'table' => 'filter_format',
+      ),
+    ),
+    'indexes' => array(
+      'format' => array(
+        0 => 'format',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'text',
+    'settings' => array(
+      'max_length' => 100,
+    ),
+    'translatable' => 0,
+    'type' => 'text',
+  );
+
+  // Exported field_base: 'field_my_request'
+  $field_bases['field_my_request'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_my_request',
+    'foreign keys' => array(),
+    'indexes' => array(
+      'value' => array(
+        0 => 'value',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'list',
+    'settings' => array(
+      'allowed_values' => array(
+        0 => 0,
+        1 => 1,
+      ),
+      'allowed_values_function' => '',
+    ),
+    'translatable' => 0,
+    'type' => 'list_boolean',
+  );
+
+  // Exported field_base: 'field_original_og_membership'
+  $field_bases['field_original_og_membership'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_original_og_membership',
+    'foreign keys' => array(
+      'og_membership' => array(
+        'columns' => array(
+          'target_id' => 'id',
+        ),
+        'table' => 'og_membership',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(
+          'trusted_contacts' => 'trusted_contacts',
+        ),
+      ),
+      'target_type' => 'og_membership',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'field_requesting_user'
+  $field_bases['field_requesting_user'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_requesting_user',
+    'foreign keys' => array(
+      'users' => array(
+        'columns' => array(
+          'target_id' => 'uid',
+        ),
+        'table' => 'users',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'base',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'views-select-list' => array(
+            'status' => 0,
+          ),
+        ),
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'target_type' => 'user',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'field_response_date'
+  $field_bases['field_response_date'] = array(
+    'active' => 1,
+    'cardinality' => 1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'field_response_date',
+    'foreign keys' => array(),
+    'indexes' => array(),
+    'locked' => 0,
+    'module' => 'date',
+    'settings' => array(
+      'cache_count' => 4,
+      'cache_enabled' => 0,
+      'granularity' => array(
+        'day' => 'day',
+        'hour' => 'hour',
+        'minute' => 'minute',
+        'month' => 'month',
+        'second' => 'second',
+        'year' => 'year',
+      ),
+      'timezone_db' => 'UTC',
+      'todate' => '',
+      'tz_handling' => 'site',
+    ),
+    'translatable' => 0,
+    'type' => 'datestamp',
+  );
+
+  // Exported field_base: 'og_user_group_ref'
+  $field_bases['og_user_group_ref'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'og_user_group_ref',
+    'foreign keys' => array(
+      'users' => array(
+        'columns' => array(
+          'target_id' => 'uid',
+        ),
+        'table' => 'users',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'og',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'og_behavior' => array(
+            'status' => TRUE,
+          ),
+        ),
+        'membership_type' => 'og_membership_type_default',
+        'target_bundles' => array(
+          'user' => 'user',
+        ),
+      ),
+      'handler_submit' => 'Change handler',
+      'target_type' => 'user',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  // Exported field_base: 'user_trusted_contacts'
+  $field_bases['user_trusted_contacts'] = array(
+    'active' => 1,
+    'cardinality' => -1,
+    'deleted' => 0,
+    'entity_types' => array(),
+    'field_name' => 'user_trusted_contacts',
+    'foreign keys' => array(
+      'users' => array(
+        'columns' => array(
+          'target_id' => 'uid',
+        ),
+        'table' => 'users',
+      ),
+    ),
+    'indexes' => array(
+      'target_id' => array(
+        0 => 'target_id',
+      ),
+    ),
+    'locked' => 0,
+    'module' => 'entityreference',
+    'settings' => array(
+      'handler' => 'og',
+      'handler_settings' => array(
+        'behaviors' => array(
+          'og_behavior' => array(
+            'status' => TRUE,
+          ),
+        ),
+        'membership_type' => 'trusted_contacts',
+        'sort' => array(
+          'type' => 'none',
+        ),
+        'target_bundles' => array(),
+      ),
+      'handler_submit' => 'Change handler',
+      'target_type' => 'user',
+    ),
+    'translatable' => 0,
+    'type' => 'entityreference',
+  );
+
+  return $field_bases;
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.field_instance.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.field_instance.inc
new file mode 100644
index 0000000..f5be65e
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.field_instance.inc
@@ -0,0 +1,592 @@
+<?php
+/**
+ * @file
+ * commons_trusted_contacts.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_trusted_contacts_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-trusted_contact_request_approved-field_approving_user'
+  $field_instances['message-trusted_contact_request_approved-field_approving_user'] = array(
+    'bundle' => 'trusted_contact_request_approved',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_approving_user',
+    'label' => 'Approving user',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'message-trusted_contact_request_pending-field_requesting_user'
+  $field_instances['message-trusted_contact_request_pending-field_requesting_user'] = array(
+    'bundle' => 'trusted_contact_request_pending',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 0,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_requesting_user',
+    'label' => 'Requesting User',
+    'required' => 1,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'og_membership-trusted_contacts-field_confirmation'
+  $field_instances['og_membership-trusted_contacts-field_confirmation'] = array(
+    'bundle' => 'trusted_contacts',
+    'default_value' => array(
+      0 => array(
+        'value' => 0,
+      ),
+    ),
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'list',
+        'settings' => array(),
+        'type' => 'list_default',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'og_membership',
+    'field_name' => 'field_confirmation',
+    'label' => 'Confirmation',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(
+        'display_label' => 0,
+      ),
+      'type' => 'options_onoff',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'og_membership-trusted_contacts-field_membership_token'
+  $field_instances['og_membership-trusted_contacts-field_membership_token'] = array(
+    'bundle' => 'trusted_contacts',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 4,
+      ),
+    ),
+    'entity_type' => 'og_membership',
+    'field_name' => 'field_membership_token',
+    'label' => 'Membership Token',
+    'required' => 1,
+    'settings' => array(
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => 60,
+      ),
+      'type' => 'text_textfield',
+      'weight' => 5,
+    ),
+  );
+
+  // Exported field_instance: 'og_membership-trusted_contacts-field_my_request'
+  $field_instances['og_membership-trusted_contacts-field_my_request'] = array(
+    'bundle' => 'trusted_contacts',
+    'default_value' => array(
+      0 => array(
+        'value' => 0,
+      ),
+    ),
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'list',
+        'settings' => array(),
+        'type' => 'list_default',
+        'weight' => 3,
+      ),
+    ),
+    'entity_type' => 'og_membership',
+    'field_name' => 'field_my_request',
+    'label' => 'My request',
+    'required' => 0,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(
+        'display_label' => 0,
+      ),
+      'type' => 'options_onoff',
+      'weight' => 4,
+    ),
+  );
+
+  // Exported field_instance: 'og_membership-trusted_contacts-field_original_og_membership'
+  $field_instances['og_membership-trusted_contacts-field_original_og_membership'] = array(
+    'bundle' => 'trusted_contacts',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'entityreference',
+        'settings' => array(
+          'link' => FALSE,
+        ),
+        'type' => 'entityreference_label',
+        'weight' => 2,
+      ),
+    ),
+    'entity_type' => 'og_membership',
+    'field_name' => 'field_original_og_membership',
+    'label' => 'Original OG Membership',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 3,
+    ),
+  );
+
+  // Exported field_instance: 'og_membership-trusted_contacts-field_response_date'
+  $field_instances['og_membership-trusted_contacts-field_response_date'] = array(
+    'bundle' => 'trusted_contacts',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'date',
+        'settings' => array(
+          'format_type' => 'long',
+          'fromto' => 'both',
+          'multiple_from' => '',
+          'multiple_number' => '',
+          'multiple_to' => '',
+        ),
+        'type' => 'date_default',
+        'weight' => 1,
+      ),
+    ),
+    'entity_type' => 'og_membership',
+    'field_name' => 'field_response_date',
+    'label' => 'Response date',
+    'required' => 0,
+    'settings' => array(
+      'default_value' => 'now',
+      'default_value2' => 'same',
+      'default_value_code' => '',
+      'default_value_code2' => '',
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'date',
+      'settings' => array(
+        'increment' => 15,
+        'input_format' => 'm/d/Y - H:i:s',
+        'input_format_custom' => '',
+        'label_position' => 'above',
+        'text_parts' => array(),
+        'year_range' => '-3:+3',
+      ),
+      'type' => 'date_popup',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'user-user-user_trusted_contacts'
+  $field_instances['user-user-user_trusted_contacts'] = array(
+    'bundle' => 'user',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 4,
+      ),
+      'search_results' => array(
+        'custom settings' => TRUE,
+        'label' => 'hidden',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 16,
+      ),
+    ),
+    'entity_type' => 'user',
+    'field_name' => 'user_trusted_contacts',
+    'label' => 'User Trusted Contacts',
+    'required' => FALSE,
+    'settings' => array(
+      'behaviors' => array(
+        'og_widget' => array(
+          'admin' => array(
+            'widget_type' => 'entityreference_autocomplete',
+          ),
+          'default' => array(
+            'widget_type' => 'entityreference_autocomplete',
+          ),
+          'status' => TRUE,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'custom settings' => FALSE,
+        'label' => 'hidden',
+        'type' => 'hidden',
+      ),
+      'teaser' => array(
+        'custom settings' => FALSE,
+        'label' => 'hidden',
+        'type' => 'hidden',
+      ),
+    ),
+    'widget' => array(
+      'module' => 'og',
+      'settings' => array(),
+      'type' => 'og_complex',
+      'weight' => '2',
+    ),
+  );
+
+  // Exported field_instance: 'user-user-group_group'
+  $field_instances['user-user-group_group'] = array(
+    'bundle' => 'user',
+    'default_value' => array(
+      0 => array(
+        'value' => 1,
+      ),
+    ),
+    'deleted' => '0',
+    'description' => 'Determine if this is an OG group.',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'commons_trusted_contacts',
+        'settings' => array(
+          'allowed_values' => array(
+            0 => 'Not a group',
+            1 => 'Group',
+          ),
+          'allowed_values_function' => '',
+        ),
+        'type' => 'trusted_contact',
+        'weight' => '3',
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'display_label' => 1,
+    'entity_type' => 'user',
+    'field_name' => 'group_group',
+    'label' => 'Group',
+    'required' => FALSE,
+    'settings' => array(
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'custom settings' => FALSE,
+        'label' => 'Full',
+        'type' => 'og_group_subscribe',
+      ),
+      'teaser' => array(
+        'custom settings' => FALSE,
+        'label' => 'Teaser',
+        'type' => 'og_group_subscribe',
+      ),
+    ),
+    'widget' => array(
+      'module' => 'options',
+      'settings' => array(
+        'display_label' => 0,
+        'og_hide' => TRUE,
+      ),
+      'type' => 'options_onoff',
+      'weight' => 0,
+    ),
+  );
+
+  // Exported field_instance: 'user-user-group_access'
+  $field_instances['user-user-group_access'] = array(
+    'bundle' => 'user',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'module' => 'list',
+        'settings' => array(),
+        'type' => 'list_default',
+        'weight' => 13,
+      ),
+    ),
+    'display_in_partial_form' => 0,
+    'entity_type' => 'user',
+    'field_name' => 'group_access',
+    'label' => 'Group visibility',
+    'required' => 1,
+    'settings' => array(
+      'user_register_form' => 0,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'options',
+      'settings' => array(),
+      'type' => 'options_buttons',
+      'weight' => 13,
+    ),
+  );
+  // Provide appropriate settings for our fields when users are
+  // indexed by Solr. ApacheSolr_User uses the 'search_index' view mode
+  // to render the user document for indexing. Since this view mode doesn't
+  // exist in Commons, the 'default' view mode is used. We need to ensure
+  // that this does not include the names of the user's trusted contacts, so
+  // that a search for users named "Jane Smith" doesn't include a result for
+  // each user who calls Jane a contact.
+  if (module_exists('commons_search_solr_user')) {
+    $field_instances['user-user-group_group']['view modes']['search_results'] = array(
+      'label' => 'hidden',
+      'module' => 'commons_trusted_contacts',
+      'settings' => array(),
+      'type' => 'trusted_contact',
+    );
+    $field_instances['user-user-group_group']['display']['search_results'] = array(
+      'label' => 'hidden',
+      'module' => 'commons_trusted_contacts',
+      'settings' => array(
+        'allowed_values' => array(
+          0 => 'Not a group',
+          1 => 'Group',
+        ),
+        'allowed_values_function' => '',
+      ),
+      'type' => 'trusted_contact',
+      'weight' => 17,
+    );
+    $field_instances['user-user-user_trusted_contacts']['display']['search_results'] = array(
+      'label' => 'hidden',
+      'custom settings' => TRUE,
+      'type' => 'hidden',
+      'weight' => 16,
+    );
+  }
+
+  $group_content_entity_types = commons_groups_get_group_content_entity_types();
+  foreach(array_keys($group_content_entity_types['node']) as $type) {
+    commons_trusted_contacts_field_definition_group($field_instances, 'node', $type);
+  }
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Approving user');
+  t('Confirmation');
+  t('Membership Token');
+  t('My request');
+  t('Original OG Membership');
+  t('Requesting User');
+  t('Response date');
+  t('User Trusted Contacts');
+
+  return $field_instances;
+}
+
+function commons_trusted_contacts_field_definition_group(&$field_instances, $entity_type, $bundle) {
+  // Exported field_instance: 'node-post-og_user_group_ref'
+  $field_instances["$entity_type-$bundle-og_user_group_ref"] = array(
+    'bundle' => $bundle,
+    'default_value' => NULL,
+    'default_value_function' => 'commons_groups_entityreference_default_value',
+    'deleted' => '0',
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'inline',
+        'module' => 'og_ui',
+        'settings' => array(),
+        'type' => 'og_list_default',
+        'weight' => 11,
+      ),
+      'teaser' => array(
+        'label' => 'inline',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => $entity_type,
+    'field_name' => 'og_user_group_ref',
+    'label' => 'Visible to trusted contacts of',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'og_widget' => array(
+          'admin' => array(
+            'widget_type' => 'entityreference_autocomplete_tags',
+          ),
+          'default' => array(
+            'widget_type' => 'entityreference_autocomplete_tags',
+          ),
+          'status' => TRUE,
+        ),
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'view modes' => array(
+      'full' => array(
+        'custom settings' => FALSE,
+        'label' => 'Full',
+        'type' => 'og_list_default',
+      ),
+      'teaser' => array(
+        'custom settings' => FALSE,
+        'label' => 'Teaser',
+        'type' => 'og_list_default',
+      ),
+    ),
+    'widget' => array(
+      'active' => 0,
+      'module' => 'og',
+      'settings' => array(),
+      'type' => 'og_complex',
+      'weight' => 5,
+    ),
+  );
+
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.inc
new file mode 100644
index 0000000..b8b2f51
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.inc
@@ -0,0 +1,92 @@
+<?php
+/**
+ * @file
+ * commons_trusted_contacts.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_trusted_contacts_ctools_plugin_api() {
+  list($module, $api) = func_get_args();
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_trusted_contacts_views_api() {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_trusted_contacts_default_message_type() {
+  $items = array();
+  $items['trusted_contact_request_approved'] = entity_import('message_type', '{
+    "name" : "trusted_contact_request_approved",
+    "description" : "Trusted-Contact request approved",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "commons_notify",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "\\u003Cp\\u003E[message:field-approving-user:name] approved your Trusted-Contact request.\\u003C\\/p\\u003E\\r\\n",
+          "format" : "full_html",
+          "safe_value" : "\\u003Cp\\u003E[message:field-approving-user:name] approved your Trusted-Contact request.\\u003C\\/p\\u003E\\n"
+        },
+        {
+          "value" : "\\u003Cp\\u003E[message:field-approving-user:name] approved your Trusted-Contact request.\\u003C\\/p\\u003E\\r\\n\\r\\n\\u003Cp\\u003ELearn more at:\\u0026nbsp;\\u003Cspan style=\\u0022font-size: 13.333333015441895px;\\u0022\\u003E[message:field-approving-user:url:absolute]\\u003C\\/span\\u003E\\u003C\\/p\\u003E\\r\\n",
+          "format" : "full_html",
+          "safe_value" : "\\u003Cp\\u003E[message:field-approving-user:name] approved your Trusted-Contact request.\\u003C\\/p\\u003E\\n\\n\\u003Cp\\u003ELearn more at:\\u0026nbsp;\\u003Cspan style=\\u0022font-size: 13.333333015441895px;\\u0022\\u003E[message:field-approving-user:url:absolute]\\u003C\\/span\\u003E\\u003C\\/p\\u003E\\n"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  $items['trusted_contact_request_pending'] = entity_import('message_type', '{
+    "name" : "trusted_contact_request_pending",
+    "description" : "Trusted-Contact request pending",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "commons_notify",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "\\u003Cp\\u003EYou have a Trusted-Contact request pending from [message:field-requesting-user:name]\\u003C\\/p\\u003E\\r\\n",
+          "format" : "full_html",
+          "safe_value" : "\\u003Cp\\u003EYou have a Trusted-Contact request pending from [message:field-requesting-user:name]\\u003C\\/p\\u003E\\n"
+        },
+        {
+          "value" : "\\u003Cp\\u003EHello,\\u003C\\/p\\u003E\\r\\n\\r\\n\\u003Cp\\u003EYou have a Trusted-Contact request pending from [message:field-requesting-user:name]\\u003C\\/p\\u003E\\r\\n\\r\\n\\u003Cp\\u003EYou may approve or ignore.\\u003C\\/p\\u003E\\r\\n\\r\\n\\u003Cp\\u003E\\u003Ca href=\\u0022@{approve-url}\\u0022\\u003EApprove\\u003C\\/a\\u003E | \\u003Ca href=\\u0022@{ignore-url}\\u0022\\u003EIgnore\\u003C\\/a\\u003E\\u003C\\/p\\u003E\\r\\n",
+          "format" : "full_html",
+          "safe_value" : "\\u003Cp\\u003EHello,\\u003C\\/p\\u003E\\n\\n\\u003Cp\\u003EYou have a Trusted-Contact request pending from [message:field-requesting-user:name]\\u003C\\/p\\u003E\\n\\n\\u003Cp\\u003EYou may approve or ignore.\\u003C\\/p\\u003E\\n\\n\\u003Cp\\u003E\\u003Ca href=\\u0022@{approve-url}\\u0022\\u003EApprove\\u003C\\/a\\u003E | \\u003Ca href=\\u0022@{ignore-url}\\u0022\\u003EIgnore\\u003C\\/a\\u003E\\u003C\\/p\\u003E\\n"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
+
+/**
+ * Implements hook_default_og_membership_type().
+ */
+function commons_trusted_contacts_default_og_membership_type() {
+  $items = array();
+  $items['trusted_contacts'] = entity_import('og_membership_type', '{
+    "name" : "trusted_contacts",
+    "description" : "Trusted Contacts",
+    "language" : "",
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.user_permission.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.user_permission.inc
new file mode 100644
index 0000000..b820a79
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.features.user_permission.inc
@@ -0,0 +1,44 @@
+<?php
+/**
+ * @file
+ * commons_trusted_contacts.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_trusted_contacts_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: delete privatemsg.
+  $permissions['delete privatemsg'] = array(
+    'name' => 'delete privatemsg',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'privatemsg',
+  );
+
+  // Exported permission: read privatemsg.
+  $permissions['read privatemsg'] = array(
+    'name' => 'read privatemsg',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'privatemsg',
+  );
+
+  // Exported permission: write privatemsg.
+  $permissions['write privatemsg'] = array(
+    'name' => 'write privatemsg',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'privatemsg',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.info b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.info
new file mode 100644
index 0000000..4c658b6
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.info
@@ -0,0 +1,54 @@
+name = Commons Trusted Contacts
+description = Commons Trusted Contacts Functionality
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = commons_groups
+dependencies[] = ctools
+dependencies[] = date
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = list
+dependencies[] = message
+dependencies[] = og
+dependencies[] = og_ui
+dependencies[] = options
+dependencies[] = privatemsg
+dependencies[] = strongarm
+dependencies[] = text
+dependencies[] = views
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_base][] = field_approving_user
+features[field_base][] = field_confirmation
+features[field_base][] = field_membership_token
+features[field_base][] = field_my_request
+features[field_base][] = field_original_og_membership
+features[field_base][] = field_requesting_user
+features[field_base][] = field_response_date
+features[field_base][] = og_user_group_ref
+features[field_base][] = user_trusted_contacts
+features[field_instance][] = message-trusted_contact_request_approved-field_approving_user
+features[field_instance][] = message-trusted_contact_request_pending-field_requesting_user
+features[field_instance][] = og_membership-trusted_contacts-field_confirmation
+features[field_instance][] = og_membership-trusted_contacts-field_membership_token
+features[field_instance][] = og_membership-trusted_contacts-field_my_request
+features[field_instance][] = og_membership-trusted_contacts-field_original_og_membership
+features[field_instance][] = og_membership-trusted_contacts-field_response_date
+features[field_instance][] = user-user-user_trusted_contacts
+features[field_instance][] = user-user-group_access
+features[message_type][] = trusted_contact_request_approved
+features[message_type][] = trusted_contact_request_pending
+features[og_membership_type][] = trusted_contacts
+features[user_permission][] = delete privatemsg
+features[user_permission][] = read privatemsg
+features[user_permission][] = write privatemsg
+features[variable][] = field_bundle_settings_message__trusted_contact_request_approved
+features[variable][] = field_bundle_settings_message__trusted_contact_request_pending
+features[variable][] = privatemsg_display_profile_links
+features[views_view][] = trusted_contacts
+features[views_view][] = trusted_contacts_invitations
+features_exclude[field][message-trusted_contact_request_approved-field_approving_user] = message-trusted_contact_request_approved-field_approving_user
+features_exclude[field][message-trusted_contact_request_pending-field_requesting_user] = message-trusted_contact_request_pending-field_requesting_user
+files[] = views/handlers/commons_groups_handler_send_message.inc
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.install b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.install
new file mode 100644
index 0000000..79b4148
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.install
@@ -0,0 +1,80 @@
+<?php
+
+/**
+ * Implements hook_requirements().
+ *
+ * After install, make sure that all users are set as group.
+ */
+function commons_trusted_contacts_requirements($phase) {
+  $requirements = array();
+
+  if ($phase == 'runtime') {
+
+    // Count the current number of users.
+    $query = new EntityFieldQuery;
+    $user_count = $query->entityCondition('entity_type', 'user')
+      // Ignore the anonymous user.
+      ->propertyCondition('uid', 0, '<>')
+      ->count()
+      ->execute();
+
+    // Count the current number of user groups.
+    $query = new EntityFieldQuery();
+    $group_count = $query
+      ->entityCondition('entity_type', 'user')
+      ->fieldCondition(OG_GROUP_FIELD, 'value', 1, '=')
+      ->count()
+      ->execute();
+
+    // Check if there are more users than "group" users.
+    if ($user_count > $group_count) {
+      $requirements['commons_trusted_contacts_users_updated']['title'] = t('Trusted contacts');
+      $requirements['commons_trusted_contacts_users_updated']['severity'] = REQUIREMENT_ERROR;
+      $requirements['commons_trusted_contacts_users_updated']['description'] = t('Some users need an update. !link.', array('!link' => l(t('Upgrade users'), 'admin/people/trusted-contacts-upgrade')));
+      $requirements['commons_trusted_contacts_users_updated']['value'] = t('Users upgrade needed');
+    }
+  }
+
+  return $requirements;
+}
+
+
+/**
+ * Implements hook_install().
+ */
+function commons_trusted_contacts_install() {
+  // Do not inform the user about new messages on login.
+  variable_set('privatemsg_display_loginmessage', FALSE);
+}
+
+/**
+ * Use absolute URLs for pending invitation emails.
+ */
+function commons_trusted_contacts_update_3100() {
+  $revert = array(
+    'commons_trusted_contacts' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Change the background options widget to use autocomplete instead
+ * See https://drupal.org/node/2151637 for more info
+ */
+function commons_trusted_contacts_update_3101() {
+  $revert = array(
+    'commons_trusted_contacts' => array('field_instance', 'field_base'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Set the limit for trusted contacts to unlimited for existing sites.
+ */
+function commons_trusted_contacts_update_3102() {
+
+  variable_set('commons_trusted_contacts_limit', 0);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.module b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.module
new file mode 100644
index 0000000..4f6b97c
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.module
@@ -0,0 +1,1282 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Trusted Contacts feature.
+ */
+
+include_once 'commons_trusted_contacts.features.inc';
+
+/**
+ * Implements hook_system_info_alter().
+ */
+function commons_trusted_contacts_system_info_alter(&$info, $file, $type) {
+  if ($file->name == 'commons_trusted_contacts') {
+    // This field base for group_group is defined in Commons Groups.
+    $info['features']['field_instance'][] = "user-user-group_group";
+    $group_content_entity_types = commons_groups_get_group_content_entity_types();
+    foreach (array_keys($group_content_entity_types['node']) as $bundle) {
+      $info['features']['field_instance'][] = "node-$bundle-og_user_group_ref";
+    }
+  }
+}
+
+/**
+ * Implements hook_user_presave().
+ *
+ */
+function commons_trusted_contacts_user_presave(&$edit, $account, $category) {
+  // Ensure that a value is always set for the user's group_access field,
+  // so that the user remains public while content shared with the user's
+  // trusted contacts group is private. If the value of $user->group_access
+  // is not set, og_access.module will throw an exception in
+  // _og_access_verify_access_field_existence().
+  if (empty($edit['group_access'][LANGUAGE_NONE])) {
+    $edit['group_access'][LANGUAGE_NONE][0]['value'] = 0;
+  }
+}
+/**
+ * Implements hook_pathauto_alias_alter
+ * Since all content by default goes into 'groups/group-name/node-name', we want
+ * to do something different with private user posts. Thus we alter the alias
+ * to be users/user-name/feed/node-title
+ */
+function commons_trusted_contacts_pathauto_alias_alter(&$alias, &$context) {
+  // We're only looking for nodes and non-groups to alter, if it isn't a node return.
+  if ($context['module'] != 'node') {
+    return;
+  }
+
+  // Check to see if the node belongs to a group (aka og_user_group_ref) and alter
+  // the alias appropriately.
+  if (og_get_group_type('node', $context['data']['node']->type, 'group content')
+    && !empty($context['data']['node']->og_user_group_ref[LANGUAGE_NONE])
+  ) {
+    $alias = token_replace('users/[node:og-user-group-ref:0:name]/trusted-content/[node:title]', $context['data'], array(
+      'sanitize' => FALSE,
+      'clear' => TRUE,
+      'callback' => 'pathauto_clean_token_values',
+      'language' => (object) array('language' => $context['language']),
+      'pathauto' => TRUE,
+    ));
+  }
+}
+
+/**
+ * Implements hook_menu().
+ */
+function commons_trusted_contacts_menu() {
+  $items = array();
+
+  $items['admin/people/trusted-contacts-upgrade'] = array(
+    'page callback' => 'commons_trusted_contacts_users_upgrade_batch_init',
+    'access arguments' => array('administer site configuration'),
+    'type' => MENU_CALLBACK,
+  );
+
+  $items['request-trust/%user/%/%'] = array(
+    'page callback' => 'commons_trusted_contacts_request_trust',
+    'page arguments' => array(1, 3),
+    'access callback' => 'commons_trusted_contacts_request_trust_access',
+    'access arguments' => array(1,2),
+    'type' => MENU_CALLBACK,
+  );
+
+  $items['un-trust/%user/%/%'] = array(
+    'page callback' => 'commons_trusted_contacts_un_trust',
+    'page arguments' => array(1, 3),
+    'access callback' => 'commons_trusted_contacts_un_trust_access',
+    'access arguments' => array(1, 2),
+    'type' => MENU_CALLBACK,
+  );
+
+  $items['approve-trust/%entity_object/%'] = array(
+    'load arguments' => array('og_membership'),
+    'page callback' => 'commons_trusted_contacts_approve_trust',
+    'page arguments' => array(1),
+    'access callback' => 'commons_trusted_contacts_approve_trust_access',
+    'access arguments' => array(1, 2),
+    'type' => MENU_CALLBACK,
+  );
+
+  $items['ignore-trust/%entity_object/%'] = array(
+    'load arguments' => array('og_membership'),
+    'page callback' => 'commons_trusted_contacts_ignore_trust',
+    'page arguments' => array(1),
+    'access callback' => 'commons_trusted_contacts_ignore_trust_access',
+    'access arguments' => array(1, 2),
+    'type' => MENU_CALLBACK,
+  );
+
+  $items['user/%user/contacts/messages/popup/%user'] = array(
+    'page callback' => 'drupal_get_form',
+    'page arguments' => array('commons_trusted_contacts_messages_popup', 5),
+    'access callback' => 'commons_trusted_contacts_privatemsg_write_access',
+    'access arguments' => array(5),
+    'type' => MENU_CALLBACK,
+  );
+
+  $items['user/%user/contacts'] = array(
+    'title' => t('Private Messages & Invitations'),
+    'page callback' => 'commons_trusted_contacts_tab',
+    'access callback' => 'commons_trusted_contacts_tab_access',
+    'access arguments' => array(1),
+    'type' => MENU_LOCAL_TASK,
+  );
+
+  return $items;
+}
+
+/**
+ * Access callback for trusted contacts related pages;
+ */
+function commons_trusted_contacts_tab_access($account) {
+  global $user;
+
+  if (user_access('administer group')) {
+    // Admin user.
+    return TRUE;
+  }
+
+  if ($user->uid == $account->uid) {
+    // User's own pages.
+    return TRUE;
+  }
+
+  return FALSE;
+}
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_trusted_contacts_menu_alter(&$items) {
+  // Remove the groups UI for user entities.
+  $items['user/%/group']['access callback'] = FALSE;
+
+  // Make sure only Trusted-Contacts send messages to each other.
+  // By default, PrivateMsg module only checks user permissions.
+  $items['messages/new']['access callback'] = 'commons_trusted_contacts_privatemsg_write_access';
+  $items['messages/new']['access arguments'] = array(2);
+
+  // Remove original private messages pages.
+  unset($items['messages']);
+  unset($items['messages/list']);
+}
+
+/**
+ * Implements hook_admin_paths().
+ */
+function commons_trusted_contacts_admin_paths() {
+  $paths = array(
+    'user/*/contacts/messages/popup/*' => TRUE,
+  );
+
+  return $paths;
+}
+
+/**
+ * Implements hook_module_implements_alter().
+ */
+function commons_trusted_contacts_module_implements_alter(&$implementations, $hook) {
+  // We need to alter form elements added by the Views Bulk Operations module.
+  // VBO is is alphabetically subsequent to commons_trusted_contacts
+  // and has the same weight, so we need this alter to ensure that
+  // our hook_form_alter() implementation runs after VBO, so that the
+  // elements VBO adds are already present when we alter the form.
+  if ($hook == 'form_alter') {
+    $group = $implementations['commons_trusted_contacts'];
+    unset($implementations['commons_trusted_contacts']);
+    $implementations['commons_trusted_contacts'] = $group;
+  }
+  if ($hook == 'node_presave') {
+    $group = $implementations['commons_trusted_contacts'];
+    unset($implementations['commons_trusted_contacts']);
+    $implementations['commons_trusted_contacts'] = $group;
+  }
+}
+
+/**
+ * Implements hook_form_user_admin_settings_alter().
+ */
+function commons_trusted_contacts_form_user_admin_settings_alter(&$form, &$form_state) {
+  $form['commons_trusted_contacts'] = array(
+    '#type' => 'fieldset',
+    '#title' => t('Commons Trusted Contacts'),
+    '#weight' => 0,
+    '#description' => t("Important! Lowering this number will restrict users over the new limit from adding or approving any trusted contacts until they go below it."),
+  );
+  $form['commons_trusted_contacts']['commons_trusted_contacts_limit'] = array(
+    '#type' => 'textfield',
+    '#title' => t('Maximum number of trusted contacts per user'),
+    '#default_value' => variable_get('commons_trusted_contacts_limit', 1000),
+    '#description' => t('This setting defaults to 1000 maximum contacts for performance reasons, and should be sufficient for most sites. Set to 0 for no limit.'),
+  );
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_trusted_contacts_form_alter(&$form, &$form_state, $form_id) {
+  // Don't allow users to change the recipient of a private message.
+  // In combination with commons_trusted_contacts_privatemsg_write_access(),
+  // we prevent users from sending private messages to users who are not their
+  // trusted contacts.
+  if ($form_id == 'privatemsg_new') {
+    $form['recipient']['#access'] = FALSE;
+  }
+  // Hide the Approve/Ignore buttons when there are no pending trusted
+  // contact requests.
+  if ($form_id == 'views_form_trusted_contacts_invitations_default') {
+    if (empty($form_state['build_info']['args'][0]->result)) {
+      $form['select']['#access'] = FALSE;
+    }
+  }
+  // Hide the Break Contact button when a user has no trusted contacts.
+  if ($form_id == 'views_form_trusted_contacts_default') {
+    if (empty($form_state['build_info']['args'][0]->result)) {
+      $form['select']['#access'] = FALSE;
+    }
+  }
+  if ($form_id == 'privatemsg_list') {
+    // Load privatemsg.pages.inc and ensure it is automatically reloaded if
+    // this form is rebuilt via AJAX or other means.
+    form_load_include($form_state, 'inc', 'privatemsg', 'privatemsg.pages');
+  }
+}
+
+/**
+ * Page callback; Trusted contacts related pages.
+ */
+function commons_trusted_contacts_tab() {
+  global $user;
+  $account = $user;
+  $tabs = array();
+
+  $view = views_get_view('trusted_contacts');
+  $view->get_total_rows = TRUE;
+  $view->execute();
+  $tabs['contacts'] = array(
+    'title' => t('Trusted Contacts') . ' <span class="commons-bw-result-count">' . $view->total_rows . '</span>',
+    'contents' => views_embed_view('trusted_contacts'),
+  );
+
+  module_load_include('inc', 'privatemsg', 'privatemsg.pages');
+
+  $tabs['messages'] = array(
+    'title' => t('Messages') . ' <span class="commons-bw-result-count">' . privatemsg_unread_count($account) . '</span>',
+    'contents' => privatemsg_list_page(),
+  );
+
+
+  $tabs['invitations'] = array(
+    'title' => t('Invitations') . ' <span class="commons-bw-result-count">' . count(commons_trusted_contacts_get_pending_invitations($account->uid)) . '</span>',
+    'contents' => views_embed_view('trusted_contacts_invitations'),
+  );
+
+  $settings = array(
+    'style' => 'Commons Tabs',
+    'ajax' => FALSE,
+    'html' => TRUE,
+    'default_tab' => 'invitations',
+  );
+
+  return quicktabs_build_quicktabs('commons_trusted_contacts', $settings, $tabs);
+}
+
+/**
+ * Implement hook_field_formatter_info().
+ */
+function commons_trusted_contacts_field_formatter_info() {
+  return array(
+    'trusted_contact' => array(
+      'label' => t('Trusted Contact'),
+      'field types' => array('list_boolean'),
+      'settings' => array(
+        'field_name' => FALSE,
+      ),
+    ),
+    'approve_ignore' => array(
+      'label' => t('Approve/Ignore request'),
+      'field types' => array('text'),
+    ),
+  );
+}
+
+/**
+ * Implements hook_field_formatter_view().
+ *
+ * This is a copy of og_field_formatter_view() which was adapted for the
+ * "Trusted Contacts" functionality, so most changes are around the phrasing,
+ * and allowing users to send private messages.
+ *
+ * @see og_field_formatter_view()
+ */
+function commons_trusted_contacts_field_formatter_view($entity_type, $entity, $field, $instance, $langcode, $items, $display) {
+  global $user;
+
+  $element = array();
+  $settings = $display['settings'];
+
+  switch ($display['type']) {
+    case 'trusted_contact':
+      $account = clone $user;
+      if (!og_is_group($entity_type, $entity)) {
+        return;
+      }
+
+      // Hide the trust link from anonymous and users without subscribe access.
+      list($id, , $bundle) = entity_extract_ids($entity_type, $entity);
+      $user_is_active_member = og_is_member($entity_type, $id, 'user', $account, array(OG_STATE_ACTIVE));
+      if (!$account->uid || !og_user_access('user', $entity->uid, 'subscribe') && !$user_is_active_member) {
+        return;
+      }
+
+      if (!empty($entity->uid) && ($entity->uid == $account->uid)) {
+        // User is the group manager.
+        return;
+      }
+
+
+      if ($user_is_active_member) {
+        $links['title'] = t('Message');
+        $links['href'] = 'user/' . $user->uid . '/contacts/messages/popup/' . $id;
+      }
+      else {
+        if (og_is_member($entity_type, $id, 'user', $account, array(OG_STATE_PENDING))) {
+          // If user is pending, they should not be able to apply for
+          // membership.
+          $element[0] = array(
+            '#theme' => 'html_tag__request_pending',
+            '#tag' => 'span',
+            '#value' => t('Awaiting confirmation'),
+            '#attributes' => array(
+              'class' => array('trusted-request-pending'),
+            ),
+          );
+          return $element;
+        }
+        else {
+          if (og_is_member($entity_type, $id, 'user', $account, array(OG_STATE_BLOCKED))) {
+            // If user is blocked, they should not be able to apply for
+            // membership.
+            return;
+          }
+
+          // Check if user can subscribe to the field.
+          if (empty($settings['field_name']) && $audience_field_name = og_get_best_group_audience_field('user', $account, $entity_type, $bundle)) {
+            $settings['field_name'] = $audience_field_name;
+          }
+          if (!$settings['field_name']) {
+            return;
+          }
+
+          $field_info = field_info_field($settings['field_name']);
+
+          // Check if entity is referencable.
+          if ($field_info['settings']['target_type'] != $entity_type) {
+            // Group type doesn't match.
+            return;
+          }
+          if (!empty($field_info['settings']['handler_settings']['target_bundles']) && !in_array($bundle, $field_info['settings']['handler_settings']['target_bundles'])) {
+            // Bundles don't match.
+            return;
+          }
+
+          if (!og_check_field_cardinality('user', $account, $settings['field_name'])) {
+            $element[0] = array('#markup' => format_plural($field_info['cardinality'], 'You are already registered to another group', 'You are already registered to @count groups'));
+            return $element;
+          }
+
+          $token = drupal_get_token('request' . ':' . $id . ':' . $account->uid);
+          $url = "request-trust/$id/$token/nojs";
+
+          $links['title'] = t('Add as trusted contact');
+          if ($account->uid) {
+            $links['href'] = $url;
+            $links['options'] = array(
+              'attributes' => array(
+                'class' => array('use-ajax'),
+                'id' => 'user-' . $entity->uid
+              )
+            );
+
+            // Ensure that the drupal.ajax and jquery.form libraries are always
+            // loaded for AJAX toggle links.
+            $element['#attached'] = array(
+              'library' => array(
+                array('system', 'drupal.ajax'),
+                array('system', 'jquery.form'),
+              ),
+            );
+          }
+          else {
+            $links['href'] = 'user/login';
+            $links['options'] = array('query' => array('destination' => $url));
+          }
+        }
+      }
+
+      if (!empty($links['title'])) {
+        $links += array('options' => array());
+        $element[0] = array(
+          '#type' => 'link',
+          '#title' => $links['title'],
+          '#href' => $links['href'],
+          '#options' => $links['options'],
+        );
+        return $element;
+      }
+      // User didn't have permissions.
+      break;
+
+    case 'approve_ignore':
+
+      $approve = l(t('Approve'), 'approve-trust/' . $entity->id . '/' . $items[0]['value']);
+      $ignore = l(t('Ignore'), 'ignore-trust/' . $entity->id . '/' . $items[0]['value']);
+
+      $element[0] = array(
+        '#markup' => $approve . ' ' . $ignore,
+      );
+      return $element;
+  }
+}
+
+/**
+ * Implements hook_og_membership_insert().
+ *
+ * Trusted Contacts are 2 users that are members on each other's groups.
+ * Whenever a user joins another user's group as a Trusted Contact, the second
+ * user must also become a member on the first user's group.
+ */
+function commons_trusted_contacts_og_membership_insert(OgMembership $og_membership) {
+  if ($og_membership->type != 'trusted_contacts' || $og_membership->group_type != 'user') {
+    // Not a Trusted-Contact membership type.
+    return;
+  }
+
+  if (!empty($og_membership->_skip_membership_insert)) {
+    // Prevent recursion.
+    return;
+  }
+
+  if ($og_membership->gid == $og_membership->etid) {
+    // A user was created.
+    return;
+  }
+
+  // We're using a custom token because Drupal provides a token that relies on
+  // logged-in user, and here we want the token to be used by the responding
+  // user when approving/ignoring the logged-in user's request.
+  $token = md5(rand(100000000, 9999999999));
+
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+  $wrapper->field_my_request->set(1);
+  $wrapper->field_membership_token->set($token);
+
+  $values = array(
+    'entity' => $og_membership->gid,
+    'field_name' => 'user_trusted_contacts',
+    'state' => $og_membership->state,
+  );
+
+  // Get a non-saved OG Membership object.
+  $og_membership2 = og_group('user', $og_membership->etid, $values, FALSE);
+
+  $wrapper2 = entity_metadata_wrapper('og_membership', $og_membership2);
+  $wrapper2->field_original_og_membership->set($og_membership);
+  $wrapper2->field_my_request->set(0);
+  $wrapper2->field_membership_token->set($token);
+
+  // Prevent recursion.
+  $og_membership2->_skip_membership_insert = TRUE;
+  $wrapper2->save();
+
+
+  // Make sure OG membership is updated, and not re-inserted.
+  unset($og_membership->is_new);
+  $og_membership->_skip_membership_update = TRUE;
+  $wrapper->save();
+}
+
+/**
+ * Implements hook_og_membership_update().
+ *
+ * Trusted Contacts are 2 users that are members on each other's groups.
+ * Whenever one of the OG memberships is updated, the other membership must be
+ * updated accordingly.
+ */
+function commons_trusted_contacts_og_membership_update(OgMembership $og_membership) {
+  if ($og_membership->type != 'trusted_contacts' || $og_membership->group_type != 'user') {
+    // Not a Trusted-Contact membership type.
+    return;
+  }
+
+  if (!empty($og_membership->_skip_membership_update)) {
+    // Prevent recursion.
+    return;
+  }
+
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+
+  $wrapper_original = entity_metadata_wrapper('og_membership', $og_membership->original);
+
+  // Set the second OG Membership according to the first one.
+  // As we are referencing the requesting user to the requested user, we want to
+  // keep everything synced.
+  $query = new EntityFieldQuery();
+  $return = $query
+    ->entityCondition('entity_type', 'og_membership')
+    ->propertyCondition('group_type', 'user')
+    ->propertyCondition('entity_type', 'user')
+    ->propertyCondition('etid', $og_membership->gid)
+    ->propertyCondition('gid', $og_membership->etid)
+    ->execute();
+
+  // Membership not found, return but throw an error to watchdog.
+  if (!isset($return['og_membership'])) {
+    watchdog('commons_trusted_contacts', "Warning: expected trusted contact link not found between " . $og_membership->gid . " and " . $og_membership->etid, WATCHDOG_WARNING);
+    return;
+  }
+
+  $membership_id = key($return['og_membership']);
+
+  $wrapper2 = entity_metadata_wrapper('og_membership', $membership_id);
+  $og_membership2 = $wrapper2->value();
+
+  if ($wrapper->state->value() != $wrapper_original->state->value()) {
+    // State was changed.
+    $wrapper2->state->set($wrapper->state->value());
+
+    if ($wrapper_original->state->value() == OG_STATE_PENDING) {
+      // Responding to a Trusted-Contact request.
+      $confirmation = $wrapper->state->value() == OG_STATE_ACTIVE;
+      $wrapper->field_confirmation->set($confirmation);
+      $wrapper->field_response_date->set(time());
+
+      // Prevent recursion.
+      $og_membership->_skip_membership_update = TRUE;
+
+      // Clone the Og membership, as in EntityAPIController::save() the
+      // entity->original property is removed. However since are re-saving the
+      // same updated entity, we want to make sure it doesn't happen on the
+      // original one, thus causing notices for example in
+      // og_og_membership_update()
+      $og_membership_clone = clone $og_membership;
+      $og_membership_clone->save();
+
+      // Subtract 1 from unread invitations count.
+      $account = user_load($og_membership->gid);
+    }
+  }
+
+  if ($wrapper->field_confirmation->value() != $wrapper_original->field_confirmation->value()) {
+    // Confirmation was changed.
+    $wrapper2->field_confirmation->set($wrapper->field_confirmation->value());
+  }
+
+  if ($wrapper->field_response_date->value() != $wrapper_original->field_response_date->value()) {
+    // Response Date was changed.
+    $wrapper2->field_response_date->set($wrapper->field_response_date->value());
+  }
+
+  // Prevent recursion.
+  $og_membership2->_skip_membership_update = TRUE;
+  $wrapper2->save();
+}
+
+/**
+ * Implements hook_og_membership_delete().
+ *
+ * Trusted Contacts are 2 users that are members on each other's groups.
+ * Whenever one of the OG memberships is deleted, the other membership must be
+ * deleted too.
+ */
+function commons_trusted_contacts_og_membership_delete(OgMembership $og_membership) {
+  if ($og_membership->type != 'trusted_contacts' || $og_membership->group_type != 'user') {
+    // Not a Trusted-Contact membership type.
+    return;
+  }
+
+  if (!og_is_member('user', $og_membership->etid, 'user', $og_membership->gid)) {
+    // Prevent recursion.
+    return;
+  }
+
+  // Delete the "opposite" OG membership too.
+  og_ungroup('user', $og_membership->etid, 'user', $og_membership->gid);
+}
+
+/**
+ * Menu callback; Creates a Trusted-Contact Invitation.
+ *
+ * Adding two users to each-other's groups, and setting the memberships' states
+ * to 'Pending'.
+ *
+ * @param $account
+ *    The group in which the logged-in user wants to join.
+ */
+function commons_trusted_contacts_request_trust($account, $ajax) {
+  global $user;
+  $requestor = $user;
+
+  if ($account->uid == $user->uid) {
+    // Users cannot join their own group.
+    return;
+  }
+  if (!commons_trusted_contacts_check_limit($requestor, $account, $ajax)) {
+    return;
+  }
+
+  // This actually adds 2 OG memberships - one for each user.
+  $og_membership = og_group('user', $account, array(
+    'field_name' => 'user_trusted_contacts',
+    'state' => OG_STATE_PENDING,
+  ));
+
+  // Notify.
+
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+  $token = $wrapper->field_membership_token->value();
+  $options = array('absolute' => TRUE);
+  $arguments = array(
+    '@{approve-url}' => url('approve-trust/' . $og_membership->id . '/' . $token, $options),
+    '@{ignore-url}' => url('ignore-trust/' . $og_membership->id . '/' . $token, $options),
+  );
+  $message = message_create('trusted_contact_request_pending', array(
+    'uid' => $account->uid,
+    'arguments' => $arguments,
+  ));
+
+  $wrapper = entity_metadata_wrapper('message', $message);
+  $wrapper->field_requesting_user->set($requestor);
+  $wrapper->save();
+
+  message_notify_send_message($message);
+
+  // Ajax
+
+  if ($ajax == 'ajax') {
+    $commands = array();
+    $element = array(
+      'element' => array(
+        '#value' => t('Awaiting confirmation'),
+        '#tag' => 'span',
+        '#attributes' => array(
+          'class' => array('trusted-request-pending'),
+        ),
+      ),
+    );
+    $commands[] = ajax_command_replace('#user-' . $account->uid, theme('html_tag__request_pending', $element));
+    $page = array('#type' => 'ajax', '#commands' => $commands);
+    ajax_deliver($page);
+  }
+  else {
+    drupal_goto('user/' . $og_membership->gid);
+  }
+}
+
+/**
+ * Menu callback; "Breaks" a Trusted-Contact relation between two users by
+ * ungrouping each of them from the other's group.
+ *
+ * @param $account
+ *    The account which the logged-in user wants to break contact with.
+ */
+function commons_trusted_contacts_un_trust($account, $ajax) {
+  global $user;
+
+  // This actually deletes 2 OG memberships, one for each user,
+  // in commons_trusted_contacts_og_membership_delete().
+  og_ungroup('user', $account->uid);
+
+  // Ajax
+
+  if ($ajax == 'ajax') {
+    $token = drupal_get_token('request' . ':' . $account->uid . ':' . $user->uid);
+    $new = l(t('Trusted Contact'), 'request-trust/' . $account->uid . '/' . $token . '/nojs', array('attributes' => array('class' => array('use-ajax'))));
+
+    $commands = array();
+    $commands[] = ajax_command_replace(".field-name-group-group a", $new);
+    $page = array('#type' => 'ajax', '#commands' => $commands);
+    ajax_deliver($page);
+  }
+  else {
+    drupal_goto('user/' . $account->uid);
+  }
+}
+
+/**
+ * Menu callback; Approving a Trusted-Contact Invitation by setting each user's
+ * membership state to 'Active'.
+ *
+ * @param $og_membership
+ *    The membership in which the logged-in user is the group and the requesting
+ *    user is the member.
+ */
+function commons_trusted_contacts_approve_trust(OgMembership $og_membership) {
+  global $user;
+
+  if ($og_membership->gid != $user->uid) {
+    // Users can only approve their requests.
+    return;
+  }
+
+  // Get approving user.
+  $account = user_load($og_membership->gid);
+
+  if (!commons_trusted_contacts_check_limit($account, $og_membership->etid)) {
+    return;
+  }
+
+  // This actually changes both OG memberships - one for each user.
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+  $wrapper->state->set(OG_STATE_ACTIVE);
+  $wrapper->save();
+
+  // Notify.
+
+  $message = message_create('trusted_contact_request_approved', array('uid' => $og_membership->etid));
+
+  $wrapper = entity_metadata_wrapper('message', $message);
+  $wrapper->field_approving_user->set($account);
+  $wrapper->save();
+
+  message_notify_send_message($message);
+
+  // Redirect to Invitations screen.
+  drupal_goto('user/' . $user->uid . '/contacts', array('query' => array('qt-commons_trusted_contacts' => 'invitations')));
+}
+
+/**
+ * Menu callback; Ignoring a Trusted-Contact Invitation.
+ *
+ * Setting each user's membership state to 'Blocked'.
+ *
+ * @param $og_membership
+ *    The membership in which the logged-in user is the group and the requesting
+ *    user is the member.
+ */
+function commons_trusted_contacts_ignore_trust(OgMembership $og_membership) {
+  global $user;
+
+  if ($og_membership->gid != $user->uid) {
+    // Users can only ignore their requests.
+    return;
+  }
+
+  // This actually changes both OG memberships - one for each user.
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+  $wrapper->state->set(OG_STATE_BLOCKED);
+  $wrapper->save();
+
+  // Redirect to Invitations screen.
+  drupal_goto('user/' . $user->uid . '/contacts', array('query' => array('qt-commons_trusted_contacts' => 'invitations')));
+}
+
+/**
+ * Internal check to see if a user or its contact has gone over the limit.
+ *
+ * @param $requestor The current user checking the limit.
+ * @param $requestee The user of the other side of the relationship.
+ * @param bool $ajax To use ajax or not.
+ * @return bool - False for over the limit, True for under the limit.
+ */
+function commons_trusted_contacts_check_limit($requestor, $requestee, $ajax = FALSE) {
+  // Validate that neither the requesting user nor the target user has exceeded
+  // her trusted contacts limit.
+  if ($contacts_limit = variable_get('commons_trusted_contacts_limit', 1000)) {
+    $requestor_groups = og_get_entity_groups('user', $requestor, array(OG_STATE_ACTIVE), 'user_trusted_contacts');
+    $requestee_groups = og_get_entity_groups('user', $requestee, array(OG_STATE_ACTIVE), 'user_trusted_contacts');
+
+    // This should always be set, because the user is a member of their own group.
+    // But we know funky things can happen, so lets add a check just in case.
+    $requestor_memberships = $requestor_groups['user'] ? count($requestor_groups['user']) : 0;
+    $requestee_memberships = $requestee_groups['user'] ? count($requestee_groups['user']) : 0;
+
+    $message = '';
+    $exceeds_limit = FALSE;
+
+    // We use greater than because the membership count includes the user.
+    if ($requestor_memberships > $contacts_limit) {
+      $exceeds_limit = TRUE;
+
+      drupal_set_message(
+        t('You have exceeded the limit of @limit trusted contacts. Before you can add more contacts, you must <a href="@remove-contacts-links">remove some of your existing contacts.</a>',
+          array(
+            '@limit' => $contacts_limit,
+            '@remove-contacts-link' => url('user/' . $requestor->uid . '/contacts',
+              array(
+                'query' => array(
+                  'qt-commons_trusted_contacts' => 'contacts',
+                ),
+                'fragment' => 'qt-commons_trusted_contacts',
+              )
+            ),
+          )
+        )
+      );
+    }
+    if ($requestee_memberships > $contacts_limit) {
+      $exceeds_limit = TRUE;
+
+      drupal_set_message(t('@requestee has exceeded the limit of @limit trusted contacts and cannot accept any more contacts at this time.',
+        array(
+          '@requestee' => $requestee->name,
+          '@limit' => $contacts_limit,
+        ))
+      );
+    }
+    if ($exceeds_limit) {
+      if ($ajax == 'ajax') {
+        $commands = array();
+        $commands[] = ajax_command_append('#messages', theme('status_messages'));
+        $page = array('#type' => 'ajax', '#commands' => $commands);
+        ajax_deliver($page);
+      }
+      else {
+        drupal_goto();
+      }
+      return FALSE;
+    }
+  }
+  return TRUE;
+}
+
+/**
+ * Access callback for creating a Trusted-Contact request; Makes sure that the
+ * token is correct.
+ *
+ * @param $account
+ *    The group in which the logged-in user wants to join.
+ */
+function commons_trusted_contacts_request_trust_access($account, $token) {
+  global $user;
+
+  return drupal_valid_token($token, 'request' . ':' . $account->uid . ':' . $user->uid) && user_is_logged_in();
+}
+
+/**
+ * Access callback for breaking a Trusted-Contact relation; Makes sure that the
+ * token is correct.
+ *
+ * @param $account
+ *    The account which the logged-in user wants to break contact with.
+ */
+function commons_trusted_contacts_un_trust_access($account, $token) {
+  global $user;
+
+  return drupal_valid_token($token, 'untrust' . ':' . $account->uid . ':' . $user->uid) && user_is_logged_in();
+}
+
+/**
+ * Access callback for approving an invitation; Makes sure that the token is
+ * correct.
+ *
+ * @param $og_membership
+ *    The membership in which the logged-in user is the group and the requesting
+ *    user is the member.
+ */
+function commons_trusted_contacts_approve_trust_access(OgMembership $og_membership, $token) {
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+
+  return ($wrapper->field_membership_token->value() == $token) && user_is_logged_in();
+}
+
+/**
+ * Access callback for ignoring an invitation; Makes sure that the token is
+ * correct.
+ *
+ * @param $og_membership
+ *    The membership in which the logged-in user is the group and the requesting
+ *    user is the member.
+ */
+function commons_trusted_contacts_ignore_trust_access(OgMembership $og_membership, $token) {
+  $wrapper = entity_metadata_wrapper('og_membership', $og_membership);
+
+  return $wrapper->field_membership_token->value() == $token && user_is_logged_in();
+}
+
+/**
+ * Returns whether or not two users are trusted contacts.
+ *
+ * @param $uid
+ *    User ID.
+ *
+ * @param $account
+ *    Optional; Other user's object. If not provided, current user will be used.
+ */
+function commons_group_is_trusted_contact($uid, $account = NULL) {
+  if (empty($account)) {
+    global $user;
+    $account = $user;
+  }
+
+  return og_is_member('user', $uid, 'user', $account, array(OG_STATE_ACTIVE));
+}
+
+/**
+ * Access callback for writing a private message to another user;
+ * Checks permissions and makes sure that the given user and the logged-in user
+ * are Trusted-Contacts.
+ *
+ * @param $uid
+ *    Addressee's user object or User ID.
+ */
+function commons_trusted_contacts_privatemsg_write_access($account) {
+  global $user;
+
+  if (user_access('administer group')) {
+    // Always allow admin to send private messages.
+    return TRUE;
+  }
+
+  $uid = isset($account->uid) ? $account->uid : $account;
+
+  return (privatemsg_user_access('write privatemsg') && commons_group_is_trusted_contact($uid));
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ */
+function commons_trusted_contacts_form_privatemsg_new_alter(&$form, &$form_state) {
+  global $user;
+
+  // According to design, 'body' field should be 'plain_text' by default.
+  $form['body']['#format'] = 'plain_text';
+
+  // Alter markup of 'Cancel' button so it will link to our URL instead of the
+  // default one.
+  $form['actions']['cancel'] = array(
+    '#type' => 'link',
+    '#title' => t('Cancel'),
+    '#href' => 'user/' . $user->uid . '/contacts',
+    '#options' => array(
+      'query' => array('qt-commons_trusted_contacts' => 'messages'),
+    ),
+  );
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ *
+ * Alter destination of 'Delete' button so it will link to our URL instead of
+ * the default one.
+ */
+function commons_trusted_contacts_form_privatemsg_delete_alter(&$form, &$form_state) {
+  global $user;
+
+  if ($form['delete_destination']['#value'] == 'messages') {
+    // TODO: Redirect to the messages quick-tab.
+    $form['delete_destination']['#value'] = 'user/' . $user->uid . '/contacts';
+  }
+}
+
+
+/**
+ * Implements hook_form_FORM_ID_alter().
+ *
+ * Adds the audience type widget to the partial node form.
+ */
+function commons_trusted_contacts_form_commons_bw_partial_node_form_alter(&$form, &$form_state) {
+  if (!empty($form_state['group_id'])) {
+    return;
+  }
+
+  if (!module_exists('og_access')) {
+    return;
+  }
+  commons_trusted_contacts_form_add_privacy_toggle($form, $form_state);
+  $form['#validate'][] = 'commons_trusted_contacts_partial_node_form_validate';
+}
+
+/**
+ * Adds privacy toggle to a node edit/add form.
+ */
+function commons_trusted_contacts_form_add_privacy_toggle(&$form, &$form_state) {
+  $form['group_audience_type'] = array(
+    '#type' => 'radios',
+    '#title' => t('Post to'),
+    '#title_display' => 'invisible',
+    '#default_value' => empty($form[OG_AUDIENCE_FIELD][LANGUAGE_NONE][0]['default']['#default_value']) ? 'private' : 'custom',
+    '#options' => array(
+      'custom' => t('Post to specific groups'),
+      'private' => t('Post privately to all trusted contacts'),
+    ),
+    '#weight' => 70,
+    '#attributes' => array(
+      'class' => array('hideable-field'),
+    ),
+    '#access' => empty($form_state['hide_audience_toggle']),
+    // Normally Form API states (https://api.drupal.org/api/drupal/includes!common.inc/function/drupal_process_states/7)
+    // Would be used here, but it does not support loading multiple similar
+    // forms on the same page. This is why a simple javascript files is needed
+    // to perform the task of hiding the groups fields.
+    '#attached' => array(
+      'js' => array(
+        drupal_get_path('module', 'commons_trusted_contacts') . '/scripts/commons-trusted-contacts.js',
+      ),
+    ),
+  );
+}
+
+/**
+ * Implements hook_form_FORM_ID_alter()
+ * Adds Privacy selection to full form for node/add or node/edit.
+ */
+function commons_trusted_contacts_form_node_form_alter(&$form, &$form_state) {
+  // Act only on Commons Groups group content entities.
+  $group_content_entity_types = commons_groups_get_group_content_entity_types();
+  if (!isset($group_content_entity_types['node'][$form['#node']->type])) {
+    return;
+  }
+  if (empty($form['og_user_group_ref']) || !module_exists('og_access') || og_is_group_type('node', $form_state['node']->type)) {
+    return;
+  }
+
+  // Add the privacy toggle.
+  commons_trusted_contacts_form_add_privacy_toggle($form, $form_state);
+
+  // Change the weight for groups to show under the group toggle.
+  $form['og_group_ref']['#weight'] = $form['group_audience_type']['#weight'] + 1;
+
+  // For content types without user group reference fields, show a public option.
+  // Otherwise, the toggle would look odd for 'specific groups' and then not have
+  // any groups showing below it.
+  if (empty($form[OG_AUDIENCE_FIELD])) {
+    $form['group_audience_type']['#options']['custom'] = t('Post site-wide');
+  }
+}
+
+/**
+ * Validation handler; Make sure that a group is selected in case the
+ * group_audience_type is set to "Specific groups".
+ */
+function commons_trusted_contacts_partial_node_form_validate($form, $form_state) {
+  if ($form_state['values']['group_audience_type'] == 'custom' && empty($form_state['values'][OG_AUDIENCE_FIELD][LANGUAGE_NONE][0])) {
+    form_set_error(OG_AUDIENCE_FIELD, t('Please enter one more groups where this content will be posted.'));
+    return FALSE;
+  }
+}
+
+/**
+ * Implements hook_node_presave().
+ *
+ * Override the group fields.
+ */
+function commons_trusted_contacts_node_presave($node) {
+  if (!module_exists('og_access') || og_is_group('node', $node)) {
+    return;
+  }
+  // Act only on Commons Groups group content entities.
+  $group_content_entity_types = commons_groups_get_group_content_entity_types();
+  if (!isset($group_content_entity_types['node'][$node->type])) {
+    return;
+  }
+  // We're posting from the short form on the site-wide homepage.
+  if (isset($node->form_state['values']['group_audience_type'])) {
+    $group_audience_type = $node->form_state['values']['group_audience_type'];
+  }
+  // We're posting from the full node creation form.
+  if (isset($node->group_audience_type)) {
+    $group_audience_type = $node->group_audience_type;
+  }
+
+  $wrapper = entity_metadata_wrapper('node', $node);
+  // The content is submitted to the author's trusted contacts group, rather
+  // than to specific groups.
+  if (isset($group_audience_type) && $group_audience_type == 'private') {
+    $wrapper->og_user_group_ref->set(array($node->uid));
+    $wrapper->group_content_access->set(OG_CONTENT_ACCESS_PRIVATE);
+
+    // Remove any existing selected groups.
+    $wrapper->{OG_AUDIENCE_FIELD}->set(array());
+  }
+  // The content is submitted to specific groups.
+  else if (!empty($node->{OG_AUDIENCE_FIELD}[LANGUAGE_NONE])) {
+    // Extract group IDs from selection.
+    $group_ids = array();
+    foreach ($node->{OG_AUDIENCE_FIELD}[LANGUAGE_NONE] as $group) {
+      $group_ids[] = $group['target_id'];
+    }
+    $wrapper->{OG_AUDIENCE_FIELD}->set($group_ids);
+    $wrapper->og_user_group_ref->set(array());
+  }
+}
+
+/**
+ * Implements hook_action_info().
+ *
+ * @see views_bulk_operations_action_info()
+ */
+function commons_trusted_contacts_action_info() {
+  $actions = array();
+  $files = commons_trusted_contacts_operations_load_action_includes();
+  foreach ($files as $filename) {
+    $action_info_fn = 'commons_trusted_contacts_' . str_replace('.', '_', basename($filename, '.inc')) . '_info';
+    $action_info = call_user_func($action_info_fn);
+    if (is_array($action_info)) {
+      $actions += $action_info;
+    }
+  }
+
+  return $actions;
+}
+
+/**
+ * Loads the VBO actions placed in their own include files.
+ *
+ * @return
+ *   An array of containing filenames of the included actions.
+ *
+ * @see views_bulk_operations_load_action_includes()
+ */
+function commons_trusted_contacts_operations_load_action_includes() {
+  static $loaded = FALSE;
+
+  $path = drupal_get_path('module', 'commons_trusted_contacts') . '/includes/actions/';
+  $files = array(
+    'set_state_active.action.inc',
+    'set_state_blocked.action.inc',
+    'mark_as_read.action.inc',
+  );
+
+  if (!$loaded) {
+    foreach ($files as $file) {
+      include_once $path . $file;
+    }
+    $loaded = TRUE;
+  }
+
+  return $files;
+}
+
+/**
+ * Menu callback; Write Private Message popup form.
+ *
+ * @param $account
+ *    The addressee's account.
+ */
+function commons_trusted_contacts_messages_popup($form, &$form_state, $account) {
+  global $user;
+
+  // Include original functions.
+  module_load_include('inc', 'privatemsg', 'privatemsg.pages');
+
+  $form = privatemsg_new($form, $form_state, $account->uid, 'New private message from ' . $user->name);
+
+  $form['actions'] = array('#type' => 'actions');
+
+  $form['actions']['submit'] = array(
+    '#type' => 'submit',
+    '#value' => t('Send'),
+  );
+
+  $wrapper = entity_metadata_wrapper('user', $account);
+  $picture_path = empty($account->picture) ? variable_get('user_picture_default') : $wrapper->value()->picture->uri;
+
+  $form['user_picture'] = array(
+    '#theme' => 'image_style',
+    '#style_name' => '50x50_avatar',
+    '#path' => $picture_path,
+    '#prefix' => '<div class="user-picture">',
+    '#suffix' => '</div>',
+    '#weight' => -50,
+  );
+
+  $form['body']['#format'] = 'plain_text';
+
+  unset($form['token']);
+
+  $form['subject']['#type'] = 'hidden';
+
+  $form['recipient']['#type'] = 'hidden';
+
+  drupal_set_title(t('Direct Message @recipient', array('@recipient' => format_username($account))));
+
+  return $form;
+}
+
+/**
+ * Helper function to get all of the pending invitations for a given
+ * recipient user. Returns an array of OG memberships.
+ */
+function commons_trusted_contacts_get_pending_invitations($uid) {
+  $query = new EntityFieldQuery();
+  $return = $query
+    ->entityCondition('entity_type', 'og_membership')
+    ->propertyCondition('group_type', 'user')
+    ->propertyCondition('entity_type', 'user')
+    ->propertyCondition('gid', $uid)
+    ->propertyCondition('etid', $uid, '!=')
+    ->propertyCondition('state', OG_STATE_PENDING)
+    ->propertyCondition('type', 'trusted_contacts')
+    ->fieldCondition('field_my_request', 'value', 1)
+    ->execute();
+  return !empty($return['og_membership']) ? $return['og_membership'] : array();
+}
+
+
+/**
+ * Menu callback; Batch for setting users as groups.
+ */
+function commons_trusted_contacts_users_upgrade_batch_init() {
+  // Fetch all users.
+  $query = new EntityFieldQuery;
+  $result = $query->entityCondition('entity_type', 'user')
+    ->propertyCondition('uid', 0, '<>')
+    ->execute();
+  $uids = array_keys($result['user']);
+
+  // Remove the users that are already set as group.
+  $ignore_uids = og_get_all_group('user');
+  $uids = array_diff($uids, $ignore_uids);
+
+  // Build the operations array.
+  $uids_chunks = array_chunk($uids, variable_get('commons_trusted_contacts_upgrade_batch_size', 200));
+  $operations = array();
+  foreach ($uids_chunks as $uids) {
+    $operations[] = array(
+      'commons_trusted_contacts_batch_worker',
+      array($uids)
+    );
+  }
+
+  $batch = array(
+    'title' => t('Upgrading users...'),
+    'operations' => array(),
+    'init_message' => t('Commencing'),
+    'progress_message' => t('Processed @current out of @total.'),
+    'error_message' => t('An error occurred during processing'),
+    'finished' => 'commons_trusted_contacts_batch_finished',
+    'operations' => $operations,
+  );
+
+  batch_set($batch);
+  batch_process('<front>');
+}
+
+/**
+ * Batch callback; Set users as groups.
+ */
+function commons_trusted_contacts_batch_worker($uids, &$context) {
+  foreach ($uids as $uid) {
+    $wrapper = entity_metadata_wrapper('user', $uid);
+    $wrapper->{OG_GROUP_FIELD}->set(TRUE);
+    $wrapper->save();
+
+    $context['results']['processed']++;
+  }
+}
+
+/**
+ * Batch callback; "Finished" message.
+ */
+function commons_trusted_contacts_batch_finished($success, $results, $operations) {
+  if ($success) {
+    $message = format_plural($results['processed'], t('One user processed.'), t('@count users processed.'));
+  }
+  else {
+    $message = t('Error encountered while upgrading users.');
+  }
+
+  drupal_set_message($message);
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.strongarm.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.strongarm.inc
new file mode 100644
index 0000000..748743f
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.strongarm.inc
@@ -0,0 +1,89 @@
+<?php
+/**
+ * @file
+ * commons_trusted_contacts.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_trusted_contacts_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__trusted_contact_request_approved';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__trusted_contact_request_approved'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__trusted_contact_request_pending';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__trusted_contact_request_pending'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'privatemsg_display_profile_links';
+  $strongarm->value = '0';
+  $export['privatemsg_display_profile_links'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.views.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.views.inc
new file mode 100644
index 0000000..10e1e28
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.views.inc
@@ -0,0 +1,17 @@
+<?php
+
+/**
+ * Implements hook_views_data().
+ */
+function commons_trusted_contacts_views_data() {
+  $data['og_membership']['send_message'] = array(
+    'title' => t('Send Message'),
+    'help' => t('Views handler.'),
+    'real field' => 'etid',
+    'field' => array(
+      'handler' => 'commons_trusted_contacts_handler_send_message',
+    ),
+  );
+
+  return $data;
+}
diff --git a/modules/commons/commons_trusted_contacts/commons_trusted_contacts.views_default.inc b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.views_default.inc
new file mode 100644
index 0000000..e03e61a
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/commons_trusted_contacts.views_default.inc
@@ -0,0 +1,416 @@
+<?php
+/**
+ * @file
+ * commons_trusted_contacts.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_trusted_contacts_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'trusted_contacts';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'og_membership';
+  $view->human_name = 'Trusted Contacts';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Trusted Contacts';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['style_plugin'] = 'table';
+  $handler->display->display_options['style_options']['columns'] = array(
+    'field_name_first' => 'field_name_first',
+    'field_name_last' => 'field_name_first',
+  );
+  $handler->display->display_options['style_options']['default'] = '-1';
+  $handler->display->display_options['style_options']['info'] = array(
+    'field_name_first' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+    'field_name_last' => array(
+      'sortable' => 0,
+      'default_sort_order' => 'asc',
+      'align' => '',
+      'separator' => '',
+      'empty_column' => 0,
+    ),
+  );
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['label'] = 'No Contacts';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'You have no trusted contacts.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: OG membership: Group User from OG membership */
+  $handler->display->display_options['relationships']['og_membership_related_user_group']['id'] = 'og_membership_related_user_group';
+  $handler->display->display_options['relationships']['og_membership_related_user_group']['table'] = 'og_membership';
+  $handler->display->display_options['relationships']['og_membership_related_user_group']['field'] = 'og_membership_related_user_group';
+  /* Relationship: OG membership: User from OG membership */
+  $handler->display->display_options['relationships']['og_membership_related_user']['id'] = 'og_membership_related_user';
+  $handler->display->display_options['relationships']['og_membership_related_user']['table'] = 'og_membership';
+  $handler->display->display_options['relationships']['og_membership_related_user']['field'] = 'og_membership_related_user';
+  /* Field: Bulk operations: OG membership */
+  $handler->display->display_options['fields']['views_bulk_operations']['id'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['table'] = 'og_membership';
+  $handler->display->display_options['fields']['views_bulk_operations']['field'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['display_type'] = '1';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['enable_select_all_pages'] = 1;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['force_single'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['entity_load_capacity'] = '10';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_operations'] = array(
+    'action::views_bulk_operations_delete_item' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_script_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_modify_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'show_all_tokens' => 1,
+        'display_values' => array(
+          '_all_' => '_all_',
+        ),
+      ),
+    ),
+    'action::og_set_state_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::og_user_roles_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_argument_selector_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'url' => '',
+      ),
+    ),
+    'action::og_membership_delete_action' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Break Contact',
+    ),
+    'action::system_send_email_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::commons_groups_set_state_active_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::commons_groups_set_state_blocked_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::panelizer_set_status_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+  );
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'og_membership_related_user';
+  $handler->display->display_options['fields']['name']['label'] = 'Contact';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: OG membership: Response date */
+  $handler->display->display_options['fields']['field_response_date']['id'] = 'field_response_date';
+  $handler->display->display_options['fields']['field_response_date']['table'] = 'field_data_field_response_date';
+  $handler->display->display_options['fields']['field_response_date']['field'] = 'field_response_date';
+  $handler->display->display_options['fields']['field_response_date']['label'] = 'Contact since';
+  $handler->display->display_options['fields']['field_response_date']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_response_date']['type'] = 'format_interval';
+  $handler->display->display_options['fields']['field_response_date']['settings'] = array(
+    'interval' => '2',
+    'interval_display' => 'time ago',
+  );
+  /* Field: OG membership: Send Message */
+  $handler->display->display_options['fields']['send_message']['id'] = 'send_message';
+  $handler->display->display_options['fields']['send_message']['table'] = 'og_membership';
+  $handler->display->display_options['fields']['send_message']['field'] = 'send_message';
+  $handler->display->display_options['fields']['send_message']['label'] = '';
+  $handler->display->display_options['fields']['send_message']['element_label_colon'] = FALSE;
+  /* Contextual filter: User: Uid */
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'users';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['relationship'] = 'og_membership_related_user_group';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'current_user';
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+  /* Contextual filter: User: Uid */
+  $handler->display->display_options['arguments']['uid_1']['id'] = 'uid_1';
+  $handler->display->display_options['arguments']['uid_1']['table'] = 'users';
+  $handler->display->display_options['arguments']['uid_1']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid_1']['relationship'] = 'og_membership_related_user';
+  $handler->display->display_options['arguments']['uid_1']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid_1']['default_argument_type'] = 'current_user';
+  $handler->display->display_options['arguments']['uid_1']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid_1']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid_1']['summary_options']['items_per_page'] = '25';
+  $handler->display->display_options['arguments']['uid_1']['not'] = TRUE;
+  /* Filter criterion: OG membership: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'trusted_contacts' => 'trusted_contacts',
+  );
+  /* Filter criterion: OG membership: State */
+  $handler->display->display_options['filters']['state']['id'] = 'state';
+  $handler->display->display_options['filters']['state']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['state']['field'] = 'state';
+  $handler->display->display_options['filters']['state']['value'] = array(
+    1 => '1',
+  );
+  $export['trusted_contacts'] = $view;
+
+  $view = new view();
+  $view->name = 'trusted_contacts_invitations';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'og_membership';
+  $view->human_name = 'Trusted Contacts Invitations';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Invitations';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'none';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'full';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['style_plugin'] = 'table';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['label'] = 'No Invitations';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'You have no pending invitations.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: OG membership: Group User from OG membership */
+  $handler->display->display_options['relationships']['og_membership_related_user_group']['id'] = 'og_membership_related_user_group';
+  $handler->display->display_options['relationships']['og_membership_related_user_group']['table'] = 'og_membership';
+  $handler->display->display_options['relationships']['og_membership_related_user_group']['field'] = 'og_membership_related_user_group';
+  /* Relationship: OG membership: User from OG membership */
+  $handler->display->display_options['relationships']['og_membership_related_user']['id'] = 'og_membership_related_user';
+  $handler->display->display_options['relationships']['og_membership_related_user']['table'] = 'og_membership';
+  $handler->display->display_options['relationships']['og_membership_related_user']['field'] = 'og_membership_related_user';
+  /* Field: Bulk operations: OG membership */
+  $handler->display->display_options['fields']['views_bulk_operations']['id'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['table'] = 'og_membership';
+  $handler->display->display_options['fields']['views_bulk_operations']['field'] = 'views_bulk_operations';
+  $handler->display->display_options['fields']['views_bulk_operations']['label'] = '';
+  $handler->display->display_options['fields']['views_bulk_operations']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['display_type'] = '1';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['enable_select_all_pages'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['force_single'] = 0;
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_settings']['entity_load_capacity'] = '10';
+  $handler->display->display_options['fields']['views_bulk_operations']['vbo_operations'] = array(
+    'action::views_bulk_operations_delete_item' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_script_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_modify_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'show_all_tokens' => 1,
+        'display_values' => array(
+          '_all_' => '_all_',
+        ),
+      ),
+    ),
+    'action::og_set_state_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::og_user_roles_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::views_bulk_operations_argument_selector_action' => array(
+      'selected' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+      'settings' => array(
+        'url' => '',
+      ),
+    ),
+    'action::og_membership_delete_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::system_send_email_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+    'action::commons_trusted_contacts_set_state_active_action' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Approve',
+    ),
+    'action::commons_trusted_contacts_set_state_blocked_action' => array(
+      'selected' => 1,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 1,
+      'override_label' => 1,
+      'label' => 'Ignore',
+    ),
+    'action::panelizer_set_status_action' => array(
+      'selected' => 0,
+      'postpone_processing' => 0,
+      'skip_confirmation' => 0,
+      'override_label' => 0,
+      'label' => '',
+    ),
+  );
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'og_membership_related_user';
+  $handler->display->display_options['fields']['name']['label'] = 'Contact';
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: OG membership: Membership Token */
+  $handler->display->display_options['fields']['field_membership_token']['id'] = 'field_membership_token';
+  $handler->display->display_options['fields']['field_membership_token']['table'] = 'field_data_field_membership_token';
+  $handler->display->display_options['fields']['field_membership_token']['field'] = 'field_membership_token';
+  $handler->display->display_options['fields']['field_membership_token']['label'] = '';
+  $handler->display->display_options['fields']['field_membership_token']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['field_membership_token']['type'] = 'approve_ignore';
+  /* Field: OG membership: Created */
+  $handler->display->display_options['fields']['created']['id'] = 'created';
+  $handler->display->display_options['fields']['created']['table'] = 'og_membership';
+  $handler->display->display_options['fields']['created']['field'] = 'created';
+  $handler->display->display_options['fields']['created']['label'] = 'Recieved';
+  $handler->display->display_options['fields']['created']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['created']['date_format'] = 'time ago';
+  /* Contextual filter: User: Uid */
+  $handler->display->display_options['arguments']['uid']['id'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['table'] = 'users';
+  $handler->display->display_options['arguments']['uid']['field'] = 'uid';
+  $handler->display->display_options['arguments']['uid']['relationship'] = 'og_membership_related_user_group';
+  $handler->display->display_options['arguments']['uid']['default_action'] = 'default';
+  $handler->display->display_options['arguments']['uid']['default_argument_type'] = 'current_user';
+  $handler->display->display_options['arguments']['uid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['uid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['uid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: OG membership: State */
+  $handler->display->display_options['filters']['state']['id'] = 'state';
+  $handler->display->display_options['filters']['state']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['state']['field'] = 'state';
+  $handler->display->display_options['filters']['state']['value'] = array(
+    2 => '2',
+  );
+  /* Filter criterion: OG membership: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'trusted_contacts' => 'trusted_contacts',
+  );
+  /* Filter criterion: OG membership: My request (field_my_request) */
+  $handler->display->display_options['filters']['field_my_request_value']['id'] = 'field_my_request_value';
+  $handler->display->display_options['filters']['field_my_request_value']['table'] = 'field_data_field_my_request';
+  $handler->display->display_options['filters']['field_my_request_value']['field'] = 'field_my_request_value';
+  $handler->display->display_options['filters']['field_my_request_value']['value'] = array(
+    1 => '1',
+  );
+  $export['trusted_contacts_invitations'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_trusted_contacts/includes/actions/mark_as_read.action.inc b/modules/commons/commons_trusted_contacts/includes/actions/mark_as_read.action.inc
new file mode 100644
index 0000000..df9e666
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/includes/actions/mark_as_read.action.inc
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * Action to set the state of a user in a group.
+ */
+
+function commons_trusted_contacts_mark_as_read_action_info() {
+  return array('commons_trusted_contacts_mark_as_read_action' => array(
+    'type' => 'privatemsg_message',
+    'label' => t('Mark as read'),
+    'configurable' => FALSE,
+  ));
+}
+
+function commons_trusted_contacts_mark_as_read_action($privatemsg_message) {
+  db_update('pm_index')
+    ->fields(array('is_new' => PRIVATEMSG_READ))
+    ->condition('mid', $privatemsg_message->mid)
+    ->execute();
+}
+
diff --git a/modules/commons/commons_trusted_contacts/includes/actions/set_state_active.action.inc b/modules/commons/commons_trusted_contacts/includes/actions/set_state_active.action.inc
new file mode 100644
index 0000000..0e69e93
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/includes/actions/set_state_active.action.inc
@@ -0,0 +1,29 @@
+<?php
+/**
+ * @file
+ * Action to set the state of a user in a group.
+ */
+
+function commons_trusted_contacts_set_state_active_action_info() {
+  return array('commons_trusted_contacts_set_state_active_action' => array(
+    'type' => 'og_membership',
+    'label' => t('Set Membership state to Active'),
+    'configurable' => FALSE,
+  ));
+}
+
+function commons_trusted_contacts_set_state_active_action($og_membership) {
+  if ($og_membership->state == OG_STATE_ACTIVE) {
+    return;
+  }
+
+  // Don't process the group manager, if exists.
+  $group = entity_load_single($og_membership->group_type, $og_membership->gid);
+  if (!empty($group->uid) && $group->uid == $og_membership->etid && $og_membership->entity_type == 'user') {
+    return;
+  }
+
+  $og_membership->state = OG_STATE_ACTIVE;
+  $og_membership->save();
+}
+
diff --git a/modules/commons/commons_trusted_contacts/includes/actions/set_state_blocked.action.inc b/modules/commons/commons_trusted_contacts/includes/actions/set_state_blocked.action.inc
new file mode 100644
index 0000000..817f08e
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/includes/actions/set_state_blocked.action.inc
@@ -0,0 +1,29 @@
+<?php
+/**
+ * @file
+ * Action to set the state of a user in a group.
+ */
+
+function commons_trusted_contacts_set_state_blocked_action_info() {
+  return array('commons_trusted_contacts_set_state_blocked_action' => array(
+    'type' => 'og_membership',
+    'label' => t('Set Membership state to Blocked'),
+    'configurable' => FALSE,
+  ));
+}
+
+function commons_trusted_contacts_set_state_blocked_action($og_membership) {
+  if ($og_membership->state == OG_STATE_BLOCKED) {
+    return;
+  }
+
+  // Don't process the group manager, if exists.
+  $group = entity_load_single($og_membership->group_type, $og_membership->gid);
+  if (!empty($group->uid) && $group->uid == $og_membership->etid && $og_membership->entity_type == 'user') {
+    return;
+  }
+
+  $og_membership->state = OG_STATE_BLOCKED;
+  $og_membership->save();
+}
+
diff --git a/modules/commons/commons_trusted_contacts/scripts/commons-trusted-contacts.js b/modules/commons/commons_trusted_contacts/scripts/commons-trusted-contacts.js
new file mode 100644
index 0000000..04c0877
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/scripts/commons-trusted-contacts.js
@@ -0,0 +1,37 @@
+(function ($) {
+
+/**
+ * Initially hide the group selection and make it visible when the custom
+ * audience radio is selected.
+ */
+Drupal.behaviors.commonsAudienceToggle = {
+  attach: function (context, settings) {
+    $('.commons-bw-partial-node-form, .node-form', context).once('commonsAudienceToggle', function(){
+      // Load items into simple variables to make things a bit easier to read.
+      var form = $(this),
+          groupReference = form.find('.field-name-og-group-ref'),
+          radioToggle = form.find('input[name=group_audience_type]');
+
+      // Hide the group selection on load only if custom is not selected.
+      if ($('input:radio[name=group_audience_type]:checked').val() != 'custom') {
+        groupReference.addClass('element-hidden');
+      }
+
+      // When the "custom" audience radio is selected, make the group selection
+      // visible.
+      radioToggle.change(function () {
+        var radio = $(this),
+            radioValue = radio.val();
+
+        if (radioValue == 'custom' && radio.is(':checked')) {
+          groupReference.removeClass('element-hidden');
+        }
+        else {
+          groupReference.addClass('element-hidden');
+        }
+      });
+    });
+  }
+}
+
+})(jQuery);
diff --git a/modules/commons/commons_trusted_contacts/views/handlers/commons_groups_handler_send_message.inc b/modules/commons/commons_trusted_contacts/views/handlers/commons_groups_handler_send_message.inc
new file mode 100644
index 0000000..cc78eff
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/views/handlers/commons_groups_handler_send_message.inc
@@ -0,0 +1,10 @@
+<?php
+
+class commons_trusted_contacts_handler_send_message extends views_handler_field {
+
+  function render($values) {
+    global $user;
+
+    return l(t('Send private message'), 'user/' . $user->uid . '/contacts/messages/popup/' . $values->og_membership_etid);
+  }
+}
diff --git a/modules/commons/commons_trusted_contacts/views/handlers/commons_trusted_contacts_handler_send_message.inc b/modules/commons/commons_trusted_contacts/views/handlers/commons_trusted_contacts_handler_send_message.inc
new file mode 100644
index 0000000..cc78eff
--- /dev/null
+++ b/modules/commons/commons_trusted_contacts/views/handlers/commons_trusted_contacts_handler_send_message.inc
@@ -0,0 +1,10 @@
+<?php
+
+class commons_trusted_contacts_handler_send_message extends views_handler_field {
+
+  function render($values) {
+    global $user;
+
+    return l(t('Send private message'), 'user/' . $user->uid . '/contacts/messages/popup/' . $values->og_membership_etid);
+  }
+}
diff --git a/modules/commons/commons_user_profile_pages/commons_user_profile_pages.features.inc b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.features.inc
new file mode 100644
index 0000000..f73c07a
--- /dev/null
+++ b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.features.inc
@@ -0,0 +1,14 @@
+<?php
+/**
+ * @file
+ * commons_user_profile_pages.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_user_profile_pages_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_user_profile_pages/commons_user_profile_pages.info b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.info
new file mode 100644
index 0000000..e6b9782
--- /dev/null
+++ b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.info
@@ -0,0 +1,13 @@
+name = Commons User Profile Pages
+description = Exports a default user profile page, powered by the Panels module.
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_activity_streams
+dependencies[] = commons_follow
+dependencies[] = commons_profile_base
+dependencies[] = commons_profile_social
+dependencies[] = ctools
+dependencies[] = page_manager
+features[ctools][] = page_manager:pages_default:1
+features[features_api][] = api:2
+features[page_manager_handlers][] = user_view_panel_context
diff --git a/modules/commons/commons_user_profile_pages/commons_user_profile_pages.install b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.install
new file mode 100644
index 0000000..7e0ce9e
--- /dev/null
+++ b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.install
@@ -0,0 +1,20 @@
+<?php
+
+/**
+* Implements hook_enable().
+*/
+function commons_user_profile_pages_enable() {
+  // We need Page Manager to respond to the node view menu callback.
+  // Since all Panelized moduels need this variable set, we use variable_set
+  // rather than exporting via Strongarm in order to avoid Features conflicts.
+  variable_set('page_manager_user_view_disabled', FALSE);
+}
+
+/**
+ * Add the Trusted Contacts & Private Messaging control to the
+ * default user profile page.
+ */
+function commons_user_profile_pages_update_7301() {
+  features_revert(array('commons_user_profile_pages' => array('page_manager_handlers')));
+  return array();
+}
diff --git a/modules/commons/commons_user_profile_pages/commons_user_profile_pages.module b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.module
new file mode 100644
index 0000000..fe9fb12
--- /dev/null
+++ b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.module
@@ -0,0 +1,37 @@
+<?php
+/**
+ * @file
+ * Code for the Commons User Profile Pages feature.
+ */
+
+include_once 'commons_user_profile_pages.features.inc';
+
+/*
+ * Implements hook_modules_enabled().
+ */
+function commons_user_profile_pages_modules_enabled($modules) {
+  // Enable the panel that relies on trusted contacts to show group_group data
+  // within the user profile.
+  if (in_array('commons_trusted_contacts', $modules)) {
+    $revert = array(
+      'commons_user_profile_pages' => array('pages_default'),
+    );
+    features_revert($revert);
+    return array();
+  }
+}
+
+/*
+ * Implements hook_modules_disabled().
+ */
+function commons_user_profile_pages_modules_disabled($modules) {
+  // Disable the panel that relies on trusted contacts to show group_group data
+  // within the user profile.
+  if (in_array('commons_trusted_contacts', $modules)) {
+    $revert = array(
+      'commons_user_profile_pages' => array('pages_default'),
+    );
+    features_revert($revert);
+    return array();
+  }
+}
\ No newline at end of file
diff --git a/modules/commons/commons_user_profile_pages/commons_user_profile_pages.pages_default.inc b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.pages_default.inc
new file mode 100644
index 0000000..245e1ac
--- /dev/null
+++ b/modules/commons/commons_user_profile_pages/commons_user_profile_pages.pages_default.inc
@@ -0,0 +1,332 @@
+<?php
+/**
+ * @file
+ * commons_user_profile_pages.pages_default.inc
+ */
+
+/**
+ * Implements hook_default_page_manager_handlers().
+ */
+function commons_user_profile_pages_default_page_manager_handlers() {
+  $export = array();
+
+  $handler = new stdClass();
+  $handler->disabled = FALSE; /* Edit this to true to make a default handler disabled initially */
+  $handler->api_version = 1;
+  $handler->name = 'user_view_panel_context';
+  $handler->task = 'user_view';
+  $handler->subtask = '';
+  $handler->handler = 'panel_context';
+  $handler->weight = -99;
+  $handler->conf = array(
+    'title' => 'User profile',
+    'no_blocks' => 0,
+    'pipeline' => 'ipe',
+    'body_classes_to_remove' => '',
+    'body_classes_to_add' => '',
+    'css_id' => '',
+    'css' => '',
+    'contexts' => array(),
+    'relationships' => array(),
+  );
+  $display = new panels_display();
+  $display->layout = 'three_3x33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'three_33_top' => NULL,
+      'three_33_first' => NULL,
+      'three_33_second' => NULL,
+      'three_33_third' => NULL,
+      'three_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '';
+  $display->uuid = '8b3ae903-c1dc-bcc4-71b3-a1bdd65c494d';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-cde013ca-1d6e-1e14-9171-8ccb1331008f';
+    $pane->panel = 'three_33_first';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_activity_streams_user_activity-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'context' => array(
+        0 => 'argument_entity_id:user_1',
+      ),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'cde013ca-1d6e-1e14-9171-8ccb1331008f';
+    $display->content['new-cde013ca-1d6e-1e14-9171-8ccb1331008f'] = $pane;
+    $display->panels['three_33_first'][0] = 'new-cde013ca-1d6e-1e14-9171-8ccb1331008f';
+    $pane = new stdClass();
+    $pane->pid = 'new-f4cdb777-e56d-b974-4953-9b5f2dc9b594';
+    $pane->panel = 'three_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_groups_user_groups-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'context' => array(
+        0 => 'argument_entity_id:user_1',
+      ),
+      'override_title' => 1,
+      'override_title_text' => 'Groups %user:field_name_first contributes to',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'f4cdb777-e56d-b974-4953-9b5f2dc9b594';
+    $display->content['new-f4cdb777-e56d-b974-4953-9b5f2dc9b594'] = $pane;
+    $display->panels['three_33_second'][0] = 'new-f4cdb777-e56d-b974-4953-9b5f2dc9b594';
+    $pane = new stdClass();
+    $pane->pid = 'new-2183ff7a-9286-81a4-39fb-25b7d4973c3b';
+    $pane->panel = 'three_33_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_follow_user_following-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '2183ff7a-9286-81a4-39fb-25b7d4973c3b';
+    $display->content['new-2183ff7a-9286-81a4-39fb-25b7d4973c3b'] = $pane;
+    $display->panels['three_33_third'][0] = 'new-2183ff7a-9286-81a4-39fb-25b7d4973c3b';
+    $pane = new stdClass();
+    $pane->pid = 'new-b0ac54f1-a0c8-a334-a53d-47581e23257d';
+    $pane->panel = 'three_33_third';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_follow_user_followers-panel_pane_1';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array();
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = 'b0ac54f1-a0c8-a334-a53d-47581e23257d';
+    $display->content['new-b0ac54f1-a0c8-a334-a53d-47581e23257d'] = $pane;
+    $display->panels['three_33_third'][1] = 'new-b0ac54f1-a0c8-a334-a53d-47581e23257d';
+    $pane = new stdClass();
+    $pane->pid = 'new-d3fbb9db-cd0f-b8f4-1572-0e80c4a66c83';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'user_picture';
+    $pane->subtype = 'user_picture';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 1,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'd3fbb9db-cd0f-b8f4-1572-0e80c4a66c83';
+    $display->content['new-d3fbb9db-cd0f-b8f4-1572-0e80c4a66c83'] = $pane;
+    $display->panels['three_33_top'][0] = 'new-d3fbb9db-cd0f-b8f4-1572-0e80c4a66c83';
+    $pane = new stdClass();
+    $pane->pid = 'new-918d67a4-4642-0364-a570-10f387184ae1';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'entity_field';
+    $pane->subtype = 'user:field_bio';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'label' => 'hidden',
+      'formatter' => 'text_default',
+      'delta_limit' => 0,
+      'delta_offset' => '0',
+      'delta_reversed' => FALSE,
+      'formatter_settings' => array(),
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 1;
+    $pane->locks = array();
+    $pane->uuid = '918d67a4-4642-0364-a570-10f387184ae1';
+    $display->content['new-918d67a4-4642-0364-a570-10f387184ae1'] = $pane;
+    $display->panels['three_33_top'][1] = 'new-918d67a4-4642-0364-a570-10f387184ae1';
+    $pane = new stdClass();
+    $pane->pid = 'new-b51e0fa8-7402-1104-3597-9bd7665546ae';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'entity_field';
+    $pane->subtype = 'user:field_facebook_url';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'label' => 'hidden',
+      'formatter' => 'link_default',
+      'delta_limit' => 0,
+      'delta_offset' => '0',
+      'delta_reversed' => FALSE,
+      'formatter_settings' => array(),
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 2;
+    $pane->locks = array();
+    $pane->uuid = 'b51e0fa8-7402-1104-3597-9bd7665546ae';
+    $display->content['new-b51e0fa8-7402-1104-3597-9bd7665546ae'] = $pane;
+    $display->panels['three_33_top'][2] = 'new-b51e0fa8-7402-1104-3597-9bd7665546ae';
+    $pane = new stdClass();
+    $pane->pid = 'new-20f47a2e-7cb8-a944-8944-3f15009131f7';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'entity_field';
+    $pane->subtype = 'user:field_linkedin_url';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'label' => 'hidden',
+      'formatter' => 'link_default',
+      'delta_limit' => 0,
+      'delta_offset' => '0',
+      'delta_reversed' => FALSE,
+      'formatter_settings' => array(),
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 3;
+    $pane->locks = array();
+    $pane->uuid = '20f47a2e-7cb8-a944-8944-3f15009131f7';
+    $display->content['new-20f47a2e-7cb8-a944-8944-3f15009131f7'] = $pane;
+    $display->panels['three_33_top'][3] = 'new-20f47a2e-7cb8-a944-8944-3f15009131f7';
+    $pane = new stdClass();
+    $pane->pid = 'new-ac8d8150-6ff4-8654-c594-9c46cfe746d3';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'entity_field';
+    $pane->subtype = 'user:field_twitter_url';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'label' => 'hidden',
+      'formatter' => 'link_default',
+      'delta_limit' => 0,
+      'delta_offset' => '0',
+      'delta_reversed' => FALSE,
+      'formatter_settings' => array(),
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 4;
+    $pane->locks = array();
+    $pane->uuid = 'ac8d8150-6ff4-8654-c594-9c46cfe746d3';
+    $display->content['new-ac8d8150-6ff4-8654-c594-9c46cfe746d3'] = $pane;
+    $display->panels['three_33_top'][4] = 'new-ac8d8150-6ff4-8654-c594-9c46cfe746d3';
+    $pane = new stdClass();
+    $pane->pid = 'new-67c3df7b-1a3b-db24-f974-a3b27f8988d9';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'token';
+    $pane->subtype = 'user:flag-commons-follow-user-link';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'sanitize' => 1,
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 1,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 5;
+    $pane->locks = array();
+    $pane->uuid = '67c3df7b-1a3b-db24-f974-a3b27f8988d9';
+    $display->content['new-67c3df7b-1a3b-db24-f974-a3b27f8988d9'] = $pane;
+    $display->panels['three_33_top'][5] = 'new-67c3df7b-1a3b-db24-f974-a3b27f8988d9';
+    $pane = new stdClass();
+    $pane->pid = 'new-38b23f27-878a-f264-dd90-e55305d0f70c';
+    $pane->panel = 'three_33_top';
+    $pane->type = 'entity_field';
+    $pane->subtype = 'user:group_group';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'label' => 'hidden',
+      'formatter' => 'trusted_contact',
+      'delta_limit' => 0,
+      'delta_offset' => '0',
+      'delta_reversed' => FALSE,
+      'formatter_settings' => array(),
+      'context' => 'argument_entity_id:user_1',
+      'override_title' => 0,
+      'override_title_text' => '',
+    );
+    $pane->cache = array();
+    $pane->style = array();
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 6;
+    $pane->locks = array();
+    $pane->uuid = '38b23f27-878a-f264-dd90-e55305d0f70c';
+    $display->content['new-38b23f27-878a-f264-dd90-e55305d0f70c'] = $pane;
+    $display->panels['three_33_top'][6] = 'new-38b23f27-878a-f264-dd90-e55305d0f70c';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = '0';
+  $handler->conf['display'] = $display;
+  $export['user_view_panel_context'] = $handler;
+
+  return $export;
+}
diff --git a/modules/commons/commons_utility_links/commons_utility_links.api.php b/modules/commons/commons_utility_links/commons_utility_links.api.php
new file mode 100644
index 0000000..ac904e8
--- /dev/null
+++ b/modules/commons/commons_utility_links/commons_utility_links.api.php
@@ -0,0 +1,68 @@
+<?php
+
+/**
+ * @file
+ * Hooks provided by the Commons Utility Links module.
+ */
+
+/**
+ * @addtogroup hooks
+ * @{
+ */
+
+/**
+ * Define utility links.
+ *
+ * This hook allows modules to register utility links for the functionality that
+ * they provide. For example, a social integration module could use it to
+ * register a "Find Friends" utility link which points to a page where the
+ * current user can search for other site users that they have connected with on
+ * social networks such as Twitter or Facebook.
+ *
+ * @return
+ *   An associative array of utility links whose keys are used as its CSS class.
+ *   Each link should be itself an array, with the same elements used in
+ *   theme_links(), except for the addition of a 'weight' element that is used
+ *   for ordering the links.
+ *
+ * For a detailed usage example, see commons_utility_links.module.
+ *
+ * @see theme_links()
+ * @see hook_commons_utility_links_alter()
+ */
+function hook_commons_utility_links() {
+  $links = array();
+
+  if (user_is_logged_in()) {
+    global $user;
+    $account = $user;
+    $links['find_fiends']= array(
+      'href' => 'user/' . $account->uid . '/find_friends',
+      'title' => t('Find friends'),
+    );
+  }
+
+  return $links;
+}
+
+/**
+ * Perform alterations on utility links.
+ *
+ * @param $links
+ *   An associative array of utility links whose keys are used as its CSS class.
+ *   Each link should be itself an array, with the same elements used in
+ *   theme_links(), except for the addition of a 'weight' element that is used
+ *   for ordering the links.
+ *
+ * @see theme_links()
+ * @see hook_commons_utility_links()
+ */
+function hook_commons_utility_links_alter(&$links) {
+  // Change the title of the user account link from the user's name to
+  // 'Account'.
+  $links['name']['title'] = t('Account');
+}
+
+/**
+ * @} End of "addtogroup hooks".
+ */
diff --git a/modules/commons/commons_utility_links/commons_utility_links.commons_utility_links.inc b/modules/commons/commons_utility_links/commons_utility_links.commons_utility_links.inc
new file mode 100644
index 0000000..abe465c
--- /dev/null
+++ b/modules/commons/commons_utility_links/commons_utility_links.commons_utility_links.inc
@@ -0,0 +1,42 @@
+<?php
+
+/**
+ * @file
+ * Commons Utility Links hooks implemented by the Commons Utility Links module.
+ */
+
+/**
+ * Implements hook_commons_utility_links().
+ */
+function commons_utility_links_commons_utility_links() {
+  if (user_is_logged_in()) {
+    global $user;
+    $account = $user;
+    $links['name'] = array(
+      'href' => 'user',
+      'title' => format_username($account),
+      'weight' => -10,
+    );
+    $links['logout'] = array(
+      'href' => 'user/logout',
+      'title' => t('Logout'),
+      'weight' => 9,
+    );
+  }
+  else {
+    if (variable_get('user_register', USER_REGISTER_VISITORS_ADMINISTRATIVE_APPROVAL)) {
+      $links['signup'] = array(
+        'href' => 'user/register',
+        'title' => t('Signup'),
+        'weight' => -10,
+      );
+    }
+    $links['login'] = array(
+      'href' => 'user/login',
+      'title' => t('Login'),
+      'weight' => -9,
+    );
+  }
+
+  return $links;
+}
diff --git a/modules/commons/commons_utility_links/commons_utility_links.info b/modules/commons/commons_utility_links/commons_utility_links.info
new file mode 100644
index 0000000..bf991bf
--- /dev/null
+++ b/modules/commons/commons_utility_links/commons_utility_links.info
@@ -0,0 +1,3 @@
+core = 7.x
+name = Commons Utility links block
+package = "Commons - Building blocks"
\ No newline at end of file
diff --git a/modules/commons/commons_utility_links/commons_utility_links.install b/modules/commons/commons_utility_links/commons_utility_links.install
new file mode 100644
index 0000000..39607b3
--- /dev/null
+++ b/modules/commons/commons_utility_links/commons_utility_links.install
@@ -0,0 +1,56 @@
+<?php
+/**
+ * @file
+ * Commons Utility Links install script.
+ */
+
+/**
+ * Implements hook_install().
+ */
+function commons_utility_links_install() {
+  cache_clear_all('*', 'cache_block', TRUE);
+ // Place site blocks in the menu_bar and header regions.
+  $utility_block = array(
+    'module' => 'commons_utility_links',
+    'delta' => 'commons_utility_links',
+    'theme' => 'commons_origins',
+    'visibility' => 0,
+    'region' => 'header',
+    'status' => 1,
+    'pages' => '0',
+    'cache' => DRUPAL_NO_CACHE,
+    'title' => '<none>',
+  );
+  drupal_write_record('block', $utility_block);
+
+  db_update('block')
+    ->fields(array('region' => 'header'))
+    ->fields(array('cache' => DRUPAL_NO_CACHE))
+    ->condition('delta', 'commons_utility_links')
+    ->condition('module', 'commons_utility_links')
+    ->condition('theme', 'commons_origins')
+    ->execute();
+}
+
+/**
+ * Remove utility_links block, and enable commons_utility_links, that never caches.
+ */
+function commons_utility_links_update_7301() {
+  db_delete('block')
+    ->condition('module', 'commons_utility_links')
+    ->condition('delta', 'utility_links')
+    ->execute();
+
+  db_update('block')
+    ->fields(array(
+      'cache' => DRUPAL_NO_CACHE,
+      'region' => 'header',
+      'status' => 1,
+      'title' => '<none>',
+    ))
+    ->condition('delta', 'commons_utility_links')
+    ->condition('module', 'commons_utility_links')
+    ->condition('theme', 'commons_origins')
+    ->execute();
+  cache_clear_all('*', 'cache_block', TRUE);
+}
diff --git a/modules/commons/commons_utility_links/commons_utility_links.module b/modules/commons/commons_utility_links/commons_utility_links.module
new file mode 100644
index 0000000..e8c2f5c
--- /dev/null
+++ b/modules/commons/commons_utility_links/commons_utility_links.module
@@ -0,0 +1,56 @@
+<?php
+
+/**
+ * Implements hook_hook_info().
+ */
+function commons_utility_links_hook_info() {
+  $hooks = array(
+    'commons_utility_links',
+    'commons_utility_links_alter',
+  );
+
+  return array_fill_keys($hooks, array('group' => 'commons_utility_links'));
+}
+
+/**
+ * Implements hook_block_info().
+ */
+function commons_utility_links_block_info() {
+  $blocks['commons_utility_links'] = array(
+    'info' => t('Commons utility links'),
+    'cache' => DRUPAL_NO_CACHE,
+    'visibility' => 0,
+    'status' => 1,
+    'pages' => 0,
+    'weight' => 1,
+  );
+
+  return $blocks;
+}
+
+/**
+ * Implements hook_block_view().
+ */
+function commons_utility_links_block_view($delta = '') {
+  $block = array();
+
+  // Gather all of the available utility links.
+  $links = module_invoke_all('commons_utility_links');
+  drupal_alter('commons_utility_links', $links);
+
+  if (!empty($links)) {
+    // Sort the links by weight before rendering them.
+    uasort($links, 'drupal_sort_weight');
+
+    $block['subject'] = NULL;
+    $block['content'] = array(
+      '#theme' => 'links__commons_utility_links',
+      '#links' => $links,
+      '#attributes' => array(
+        'class' => array('commons-utility-links'),
+      ),
+    );
+  }
+
+  return $block;
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.features.field_instance.inc b/modules/commons/commons_wikis/commons_wikis.features.field_instance.inc
new file mode 100644
index 0000000..56f04cd
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.features.field_instance.inc
@@ -0,0 +1,162 @@
+<?php
+/**
+ * @file
+ * commons_wikis.features.field_instance.inc
+ */
+
+/**
+ * Implements hook_field_default_field_instances().
+ */
+function commons_wikis_field_default_field_instances() {
+  $field_instances = array();
+
+  // Exported field_instance: 'message-commons_wikis_wiki_updated-field_target_nodes'
+  $field_instances['message-commons_wikis_wiki_updated-field_target_nodes'] = array(
+    'bundle' => 'commons_wikis_wiki_updated',
+    'default_value' => NULL,
+    'default_value_function' => '',
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 3,
+      ),
+      'message_notify_email_body' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+      'message_notify_email_subject' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'entity_type' => 'message',
+    'field_name' => 'field_target_nodes',
+    'label' => 'Target nodes',
+    'required' => 0,
+    'settings' => array(
+      'behaviors' => array(
+        'prepopulate' => array(
+          'status' => 0,
+        ),
+      ),
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'entityreference',
+      'settings' => array(
+        'match_operator' => 'CONTAINS',
+        'path' => '',
+        'size' => 60,
+      ),
+      'type' => 'entityreference_autocomplete',
+      'weight' => 2,
+    ),
+  );
+
+  // Exported field_instance: 'node-wiki-body'
+  $field_instances['node-wiki-body'] = array(
+    'bundle' => 'wiki',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(),
+        'type' => 'text_default',
+        'weight' => 0,
+      ),
+      'teaser' => array(
+        'label' => 'hidden',
+        'module' => 'text',
+        'settings' => array(
+          'trim_length' => 600,
+        ),
+        'type' => 'text_summary_or_trimmed',
+        'weight' => 1,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'body',
+    'label' => 'Body',
+    'required' => 1,
+    'settings' => array(
+      'display_summary' => 0,
+      'text_processing' => 1,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'rows' => 20,
+        'summary_rows' => 5,
+      ),
+      'type' => 'text_textarea_with_summary',
+      'weight' => 1,
+    ),
+  );
+
+  // Exported field_instance: 'node-wiki-title_field'
+  $field_instances['node-wiki-title_field'] = array(
+    'bundle' => 'wiki',
+    'default_value' => NULL,
+    'deleted' => 0,
+    'description' => '',
+    'display' => array(
+      'default' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 12,
+      ),
+      'teaser' => array(
+        'label' => 'above',
+        'settings' => array(),
+        'type' => 'hidden',
+        'weight' => 0,
+      ),
+    ),
+    'display_in_partial_form' => 1,
+    'entity_type' => 'node',
+    'field_name' => 'title_field',
+    'label' => 'Title',
+    'required' => 1,
+    'settings' => array(
+      'hide_label' => array(
+        'entity' => 0,
+        'page' => 0,
+      ),
+      'text_processing' => 0,
+      'user_register_form' => FALSE,
+    ),
+    'widget' => array(
+      'active' => 1,
+      'module' => 'text',
+      'settings' => array(
+        'size' => 60,
+      ),
+      'type' => 'text_textfield',
+      'weight' => -5,
+    ),
+  );
+
+  // Translatables
+  // Included for use with string extractors like potx.
+  t('Body');
+  t('Target nodes');
+  t('Title');
+
+  return $field_instances;
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.features.inc b/modules/commons/commons_wikis/commons_wikis.features.inc
new file mode 100644
index 0000000..13fd5b9
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.features.inc
@@ -0,0 +1,78 @@
+<?php
+/**
+ * @file
+ * commons_wikis.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_wikis_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "page_manager" && $api == "pages_default") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
+
+/**
+ * Implements hook_views_api().
+ */
+function commons_wikis_views_api($module = NULL, $api = NULL) {
+  return array("api" => "3.0");
+}
+
+/**
+ * Implements hook_default_message_type().
+ */
+function commons_wikis_default_message_type() {
+  $items = array();
+  $items['commons_wikis_wiki_updated'] = entity_import('message_type', '{
+    "name" : "commons_wikis_wiki_updated",
+    "description" : "Message when a wiki page has been updated.",
+    "argument_keys" : [],
+    "argument" : [],
+    "category" : "message_type",
+    "data" : { "purge" : { "override" : 0, "enabled" : 0, "quota" : "", "days" : "" } },
+    "language" : "",
+    "arguments" : null,
+    "message_text" : { "und" : [
+        {
+          "value" : "[message:user:picture:35x35]",
+          "format" : "full_html",
+          "safe_value" : "[message:user:picture:35x35]"
+        },
+        {
+          "value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E has updated the \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E wiki page",
+          "format" : "full_html",
+          "safe_value" : "\\u003Ca href=\\u0022[message:user:url:absolute]\\u0022\\u003E[message:user:name]\\u003C\\/a\\u003E has updated the \\u003Ca href=\\u0022[message:field-target-nodes:0:url]\\u0022\\u003E[message:field-target-nodes:0:title_field]\\u003C\\/a\\u003E wiki page"
+        },
+        {
+          "value" : "[commons-groups:in-groups-text]",
+          "format" : "full_html",
+          "safe_value" : "[commons-groups:in-groups-text]"
+        }
+      ]
+    },
+    "rdf_mapping" : []
+  }');
+  return $items;
+}
+
+/**
+ * Implements hook_node_info().
+ */
+function commons_wikis_node_info() {
+  $items = array(
+    'wiki' => array(
+      'name' => t('Wiki'),
+      'base' => 'node_content',
+      'description' => t('Create a collaborative document, allowing users to add, delete, or revise content. Provides document version controls.'),
+      'has_title' => '1',
+      'title_label' => t('Title'),
+      'help' => '',
+    ),
+  );
+  return $items;
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.features.og_features_permission.inc b/modules/commons/commons_wikis/commons_wikis.features.og_features_permission.inc
new file mode 100644
index 0000000..aa0cfb0
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.features.og_features_permission.inc
@@ -0,0 +1,53 @@
+<?php
+/**
+ * @file
+ * commons_wikis.features.og_features_permission.inc
+ */
+
+/**
+ * Implements hook_og_features_default_permissions().
+ */
+function commons_wikis_og_features_default_permissions() {
+  $permissions = array();
+
+  // Exported og permission: 'node:group:create wiki content'
+  $permissions['node:group:create wiki content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete any wiki content'
+  $permissions['node:group:delete any wiki content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:delete own wiki content'
+  $permissions['node:group:delete own wiki content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update any wiki content'
+  $permissions['node:group:update any wiki content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  // Exported og permission: 'node:group:update own wiki content'
+  $permissions['node:group:update own wiki content'] = array(
+    'roles' => array(
+      'administrator member' => 'administrator member',
+      'member' => 'member',
+    ),
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.features.user_permission.inc b/modules/commons/commons_wikis/commons_wikis.features.user_permission.inc
new file mode 100644
index 0000000..456a93f
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.features.user_permission.inc
@@ -0,0 +1,53 @@
+<?php
+/**
+ * @file
+ * commons_wikis.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_wikis_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'create wiki content'.
+  $permissions['create wiki content'] = array(
+    'name' => 'create wiki content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'delete own wiki content'.
+  $permissions['delete own wiki content'] = array(
+    'name' => 'delete own wiki content',
+    'roles' => array(
+      'administrator' => 'administrator',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit any wiki content'.
+  $permissions['edit any wiki content'] = array(
+    'name' => 'edit any wiki content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  // Exported permission: 'edit own wiki content'.
+  $permissions['edit own wiki content'] = array(
+    'name' => 'edit own wiki content',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'node',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.info b/modules/commons/commons_wikis/commons_wikis.info
new file mode 100644
index 0000000..f478856
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.info
@@ -0,0 +1,63 @@
+name = Commons Wikis
+description = Provides the wiki functionality for Drupal Commons
+core = 7.x
+package = Commons - Content types
+dependencies[] = commons_body
+dependencies[] = commons_groups
+dependencies[] = commons_topics
+dependencies[] = ctools
+dependencies[] = entity
+dependencies[] = entityreference
+dependencies[] = features
+dependencies[] = message
+dependencies[] = node
+dependencies[] = og
+dependencies[] = og_ui
+dependencies[] = page_manager
+dependencies[] = radioactivity
+dependencies[] = strongarm
+dependencies[] = taxonomy
+dependencies[] = text
+dependencies[] = views
+dependencies[] = views_content
+dependencies[] = views_litepager
+features[ctools][] = page_manager:pages_default:1
+features[ctools][] = strongarm:strongarm:1
+features[ctools][] = views:views_default:3.0
+features[features_api][] = api:2
+features[field_instance][] = message-commons_wikis_wiki_updated-field_target_nodes
+features[field_instance][] = node-wiki-body
+features[field_instance][] = node-wiki-title_field
+features[message_type][] = commons_wikis_wiki_updated
+features[node][] = wiki
+features[og_features_permission][] = node:group:create wiki content
+features[og_features_permission][] = node:group:delete any wiki content
+features[og_features_permission][] = node:group:delete own wiki content
+features[og_features_permission][] = node:group:update any wiki content
+features[og_features_permission][] = node:group:update own wiki content
+features[user_permission][] = create wiki content
+features[user_permission][] = delete own wiki content
+features[user_permission][] = edit any wiki content
+features[user_permission][] = edit own wiki content
+features[variable][] = additional_settings__active_tab_wiki
+features[variable][] = comment_anonymous_wiki
+features[variable][] = comment_default_mode_wiki
+features[variable][] = comment_default_per_page_wiki
+features[variable][] = comment_form_location_wiki
+features[variable][] = comment_preview_wiki
+features[variable][] = comment_subject_field_wiki
+features[variable][] = comment_wiki
+features[variable][] = enable_revisions_page_wiki
+features[variable][] = field_bundle_settings_message__commons_wikis_wiki_updated
+features[variable][] = field_bundle_settings_node__wiki
+features[variable][] = menu_options_wiki
+features[variable][] = menu_parent_wiki
+features[variable][] = node_options_wiki
+features[variable][] = node_preview_wiki
+features[variable][] = node_submitted_wiki
+features[variable][] = save_continue_wiki
+features[variable][] = show_diff_inline_wiki
+features[variable][] = show_preview_changes_wiki
+features[views_view][] = commons_bw_wikis
+features[views_view][] = commons_wikis_contributor_list
+features_exclude[dependencies][commons_trusted_contacts] = commons_trusted_contacts
diff --git a/modules/commons/commons_wikis/commons_wikis.install b/modules/commons/commons_wikis/commons_wikis.install
new file mode 100644
index 0000000..c2bb6df
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.install
@@ -0,0 +1,85 @@
+<?php
+
+/**
+ * Disable summary on Wiki nodes.
+ */
+function commons_wikis_update_7000() {
+  $revert = array(
+    'commons_wikis' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Update Wiki message type to remove error messages.
+ */
+function commons_wikis_update_7001() {
+  $revert = array(
+    'commons_wikis' => array('message_type', 'variable'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Update Wiki message type to show user picture as 35x35 image style.
+ */
+function commons_wikis_update_7002() {
+  $revert = array(
+    'commons_wikis' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Place Topics label above terms on Wiki pages.
+ */
+function commons_wikis_update_7003() {
+  $revert = array(
+    'commons_wikis' => array('field_instance'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Remove extra markup from message type for wikis.
+ */
+function commons_wikis_update_7004() {
+  $revert = array(
+    'commons_wikis' => array('message_type'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Clear views cache to have contributor view use new permission.
+ */
+function commons_wikis_update_7005() {
+  cache_clear_all('*', 'cache_views', TRUE);
+}
+
+/**
+ * Standardize Browsing Widget views.
+ */
+function commons_wikis_update_7006() {
+  $revert = array(
+    'commons_wikis' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Display sticky content at top of lists.
+ */
+function commons_wikis_update_7007() {
+  $revert = array(
+    'commons_wikis' => array('views_view'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.module b/modules/commons/commons_wikis/commons_wikis.module
new file mode 100644
index 0000000..c6e9ce4
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.module
@@ -0,0 +1,222 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Wikis feature.
+ */
+
+include_once 'commons_wikis.features.inc';
+
+/**
+* Implements hook_module_implements_alter().
+*/
+function commons_wikis_module_implements_alter(&$implementations, $hook) {
+  // We need to override access control for revision view callbacks
+  // in order to give all users permission to view wiki node revisions.
+  if ($hook == 'menu_alter') {
+    $group = $implementations['commons_wikis'];
+    unset($implementations['commons_wikis']);
+    $implementations['commons_wikis'] = $group;
+  }
+}
+
+/**
+ * Implements hook_commons_bw_create_all_widget().
+ */
+function commons_wikis_commons_bw_create_all_widget($group) {
+  if (og_user_access('node', $group->nid, 'create wiki content')) {
+    $link = l(t('Start a wiki'), 'node/add/wiki',
+      array('attributes' => array('class' => 'commons-wikis-create'), 'query' => array('og_group_ref' => $group->nid))
+    );
+    return array(
+      'commons_wikis' => array(
+        'link' => $link,
+        'text' => t('Collaborate on a document'),
+        '#weight' => 8,
+      ),
+    );
+  }
+}
+
+/**
+ * Implements hook_menu_alter().
+ */
+function commons_wikis_menu_alter(&$items) {
+  // Alter the two node menu revision items and change the
+  // access callback to our custom one.
+  $items['node/%node/revisions']['access arguments'][] = $items['node/%node/revisions']['access callback'];
+  $items['node/%node/revisions']['access callback'] = 'commons_wikis_user_revision_access';
+
+  $items['node/%node/revisions/%/view']['access arguments'][] = $items['node/%node/revisions']['access callback'];
+  $items['node/%node/revisions/%/view']['access callback'] = 'commons_wikis_user_revision_access';
+}
+
+/**
+ * Implements hook_views_default_views_alter().
+ *
+ * Display wikis on the browsing widget main view.
+ */
+function commons_wikis_views_default_views_alter(&$views) {
+  if (!empty($views['commons_bw_all'])) {
+    $views['commons_bw_all']->display['default']->display_options['filters']['type']['value']['wiki'] = 'wiki';
+  }
+}
+
+/**
+ * Custom access callback for viewing revision info.
+ */
+function commons_wikis_user_revision_access($node = NULL, $old_callback = '_node_revision_access') {
+  // Only use custom revision access for wikis. Access to other content types
+  // should be handled by the standard callback.
+  if ($node->type == 'wiki') {
+    // The content was posted to specific groups.
+    if (isset($node->og_group_ref[LANGUAGE_NONE][0]['target_id'])) {
+      return og_user_access('node', $node->og_group_ref[LANGUAGE_NONE][0]['target_id'], 'update any wiki content');
+    }
+    // The content was posted privately to all trusted contacts.
+    elseif (isset($node->og_user_group_ref[LANGUAGE_NONE][0]['target_id'])) {
+      return og_user_access('user', $node->og_user_group_ref[LANGUAGE_NONE][0]['target_id'], 'update any wiki content');
+    }
+  }
+  return $old_callback($node, 'view');
+}
+
+/**
+ * Implements hook_og_user_access_alter().
+ */
+function commons_wikis_og_user_access_alter(&$temp_perm, $context) {
+  // Only alter if we're dealing with updating wiki content.
+  if ($context['string'] != 'update any wiki content') {
+    return;
+  }
+
+  $account = $context['account'];
+  $group = $context['group'];
+  $group_type = $context['group_type'];
+
+  $wrapper = entity_metadata_wrapper($group_type, $group);
+  $entity_id = $wrapper->getIdentifier();
+
+  $group_content_restricted = (bool) !isset($wrapper->field_og_subscribe_settings) || (isset($wrapper->field_og_subscribe_settings) && $wrapper->field_og_subscribe_settings->value() != 'anyone');
+  $user_is_member = (bool) og_is_member($group_type, $entity_id, 'user', $account, array(OG_STATE_ACTIVE));
+
+  // Allow group members to be able to edit any wiki content within the group.
+  // Also grant access to non-members if both the group and content is public.
+  if (user_access('edit any wiki content', $account) && (!$group_content_restricted || $user_is_member)) {
+    $temp_perm['update any wiki content'] = TRUE;
+  }
+}
+
+/**
+ * Implements hook_form_FROM_ID_alter().
+ */
+function commons_wikis_form_commons_bw_partial_node_form_alter(&$form, &$form_state) {
+  if (empty($form['#entity']) || $form['#entity']->type != 'wiki') {
+    return;
+  }
+
+  $language = $form['title_field']['#language'];
+  $form['title_field'][$language][0]['value']['#title_display'] = 'invisible';
+  $form['title_field'][$language][0]['value']['#placeholder'] = t('Enter a Wiki title');
+
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['#title_display'] = 'invisible';
+  $form['body'][$language][0]['#resizable'] = FALSE;
+
+  // Set fields as hideable so the forms can be compacted.
+  $form['title_field']['#attributes']['class'][] = 'trigger-field';
+  foreach (array('body', 'og_group_ref', 'actions') as $field) {
+    if (isset($form[$field])) {
+      $form[$field]['#attributes']['class'][] = 'hideable-field';
+    }
+  }
+
+  $form['actions']['submit']['#value'] = t('Create');
+  $form['#pre_render'][] = 'commons_wikis_form_commons_bw_partial_node_form_after_build';
+}
+
+/**
+ * After-build call-back.
+ * See commons_wikis_form_commons_bw_partial_node_form_alter().
+ */
+function commons_wikis_form_commons_bw_partial_node_form_after_build($form) {
+  $language = $form['body']['#language'];
+  $form['body'][$language][0]['format']['#access'] = FALSE;
+  $form['body'][$language][0]['value']['#rows'] = 10;
+
+  return $form;
+}
+
+/**
+ * Implements hook_commons_bw_group_widget().
+ */
+function commons_wikis_commons_bw_group_widget() {
+  return array(
+    'commons_wikis' => array(
+      'title' => t('Wikis'),
+      'type' => 'view',
+      'vid' => 'commons_bw_wikis',
+      'display' => 'default',
+      'weight' => 8,
+      'bundle' => 'wiki',
+    ),
+  );
+}
+
+/**
+ * Implements hook_commons_entity_integration().
+ */
+function commons_wikis_commons_entity_integration() {
+  return array(
+    'node' => array(
+      'wiki' => array(
+        'auto_title_instance' => FALSE,
+        'is_group_content' => TRUE,
+      ),
+    ),
+  );
+}
+
+/**
+ * Implements hook_strongarm_alter().
+ */
+ function commons_wikis_strongarm_alter(&$items) {
+  // Expose the wiki content type for 'liking' via the Commons_like module
+  // by altering the configuration for the Rate.module widget that it provides.
+  if (!empty($items['rate_widgets']->value)) {
+    foreach($items['rate_widgets']->value as $key => $widget) {
+      if ($widget->name == 'commons_like') {
+        if (!in_array('wiki', $items['rate_widgets']->value[$key]->node_types)) {
+          $items['rate_widgets']->value[$key]->node_types[] = 'wiki';
+        }
+        if (!in_array('wiki', $items['rate_widgets']->value[$key]->comment_types)) {
+          $items['rate_widgets']->value[$key]->comment_types[] = 'wiki';
+        }
+      }
+    }
+  }
+  // Expose the wiki content type for integration with Commons Radioactivity
+  // and Commons Groups.
+  foreach (array('commons_radioactivity_entity_types', 'commons_groups_entity_types') as $key) {
+    if (isset($items[$key])) {
+      $items[$key]->value['node']['wiki'] = 1;
+    }
+  }
+}
+
+/**
+ * Implements hook_node_update().
+ */
+function commons_wikis_node_update($node) {
+  if ($node->type == 'wiki' && module_exists('message')) {
+    global $user;
+    commons_groups_first_contribution($user, $node);
+    $message = message_create('commons_wikis_wiki_updated', array('uid' => $user->uid, 'timestamp' => REQUEST_TIME));
+    $wrapper = entity_metadata_wrapper('message', $message);
+    // Save reference to the node in the node reference field.
+    // We use a multiple value field in case we wish to use the same
+    // field for grouping messages in the future
+    // (eg http://drupal.org/node/1757060).
+    $wrapper->field_target_nodes[] = $node;
+    $wrapper->save();
+  }
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.strongarm.inc b/modules/commons/commons_wikis/commons_wikis.strongarm.inc
new file mode 100644
index 0000000..d76fb68
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.strongarm.inc
@@ -0,0 +1,208 @@
+<?php
+/**
+ * @file
+ * commons_wikis.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_wikis_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'additional_settings__active_tab_wiki';
+  $strongarm->value = 'edit-workflow';
+  $export['additional_settings__active_tab_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_anonymous_wiki';
+  $strongarm->value = 0;
+  $export['comment_anonymous_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_mode_wiki';
+  $strongarm->value = 1;
+  $export['comment_default_mode_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_default_per_page_wiki';
+  $strongarm->value = '50';
+  $export['comment_default_per_page_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_form_location_wiki';
+  $strongarm->value = 1;
+  $export['comment_form_location_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_preview_wiki';
+  $strongarm->value = '1';
+  $export['comment_preview_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_subject_field_wiki';
+  $strongarm->value = 1;
+  $export['comment_subject_field_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'comment_wiki';
+  $strongarm->value = '2';
+  $export['comment_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'enable_revisions_page_wiki';
+  $strongarm->value = 1;
+  $export['enable_revisions_page_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_message__commons_wikis_wiki_updated';
+  $strongarm->value = array(
+    'view_modes' => array(),
+    'extra_fields' => array(
+      'form' => array(),
+      'display' => array(
+        'message__message_text__0' => array(
+          'message_notify_email_subject' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+        ),
+        'message__message_text__1' => array(
+          'message_notify_email_subject' => array(
+            'visible' => FALSE,
+            'weight' => 0,
+          ),
+          'message_notify_email_body' => array(
+            'visible' => TRUE,
+            'weight' => 0,
+          ),
+        ),
+      ),
+    ),
+  );
+  $export['field_bundle_settings_message__commons_wikis_wiki_updated'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'field_bundle_settings_node__wiki';
+  $strongarm->value = array(
+    'view_modes' => array(
+      'teaser' => array(
+        'custom_settings' => TRUE,
+      ),
+      'full' => array(
+        'custom_settings' => FALSE,
+      ),
+      'rss' => array(
+        'custom_settings' => FALSE,
+      ),
+      'search_index' => array(
+        'custom_settings' => FALSE,
+      ),
+      'search_result' => array(
+        'custom_settings' => FALSE,
+      ),
+      'token' => array(
+        'custom_settings' => FALSE,
+      ),
+    ),
+    'extra_fields' => array(
+      'form' => array(
+        'title' => array(
+          'weight' => '0',
+        ),
+      ),
+      'display' => array(),
+    ),
+  );
+  $export['field_bundle_settings_node__wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_options_wiki';
+  $strongarm->value = array(
+    0 => 'main-menu',
+  );
+  $export['menu_options_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'menu_parent_wiki';
+  $strongarm->value = 'main-menu:0';
+  $export['menu_parent_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_options_wiki';
+  $strongarm->value = array(
+    0 => 'status',
+    1 => 'revision',
+  );
+  $export['node_options_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_preview_wiki';
+  $strongarm->value = '1';
+  $export['node_preview_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'node_submitted_wiki';
+  $strongarm->value = 1;
+  $export['node_submitted_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'save_continue_wiki';
+  $strongarm->value = 'Save and add fields';
+  $export['save_continue_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'show_diff_inline_wiki';
+  $strongarm->value = 0;
+  $export['show_diff_inline_wiki'] = $strongarm;
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'show_preview_changes_wiki';
+  $strongarm->value = 1;
+  $export['show_preview_changes_wiki'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_wikis/commons_wikis.views_default.inc b/modules/commons/commons_wikis/commons_wikis.views_default.inc
new file mode 100644
index 0000000..3807929
--- /dev/null
+++ b/modules/commons/commons_wikis/commons_wikis.views_default.inc
@@ -0,0 +1,269 @@
+<?php
+/**
+ * @file
+ * commons_wikis.views_default.inc
+ */
+
+/**
+ * Implements hook_views_default_views().
+ */
+function commons_wikis_views_default_views() {
+  $export = array();
+
+  $view = new view();
+  $view->name = 'commons_bw_wikis';
+  $view->description = 'Commons Wikis listing for the group browsing widget.';
+  $view->tag = 'Commons Wikis, Commons Browsing Widget';
+  $view->base_table = 'node';
+  $view->human_name = 'Commons Browsing Widget - Wikis';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['use_ajax'] = TRUE;
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'lite';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '10';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['pager']['options']['id'] = '4';
+  $handler->display->display_options['pager']['options']['quantity'] = '9';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'entity';
+  $handler->display->display_options['row_options']['view_mode'] = 'teaser';
+  /* Header: Global: Node partial form */
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['id'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['table'] = 'views';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['field'] = 'commons_bw_node_partial_form';
+  $handler->display->display_options['header']['commons_bw_node_partial_form']['bundle'] = 'wiki';
+  /* No results behavior: Global: Text area */
+  $handler->display->display_options['empty']['area']['id'] = 'area';
+  $handler->display->display_options['empty']['area']['table'] = 'views';
+  $handler->display->display_options['empty']['area']['field'] = 'area';
+  $handler->display->display_options['empty']['area']['empty'] = TRUE;
+  $handler->display->display_options['empty']['area']['content'] = 'No wikis have been added to this group.';
+  $handler->display->display_options['empty']['area']['format'] = 'filtered_html';
+  /* Relationship: OG membership: OG membership from Node */
+  $handler->display->display_options['relationships']['og_membership_rel']['id'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['table'] = 'node';
+  $handler->display->display_options['relationships']['og_membership_rel']['field'] = 'og_membership_rel';
+  $handler->display->display_options['relationships']['og_membership_rel']['required'] = TRUE;
+  /* Field: Content: Title */
+  $handler->display->display_options['fields']['title']['id'] = 'title';
+  $handler->display->display_options['fields']['title']['table'] = 'node';
+  $handler->display->display_options['fields']['title']['field'] = 'title';
+  $handler->display->display_options['fields']['title']['label'] = '';
+  $handler->display->display_options['fields']['title']['alter']['word_boundary'] = FALSE;
+  $handler->display->display_options['fields']['title']['alter']['ellipsis'] = FALSE;
+  /* Field: Content: Body */
+  $handler->display->display_options['fields']['body']['id'] = 'body';
+  $handler->display->display_options['fields']['body']['table'] = 'field_data_body';
+  $handler->display->display_options['fields']['body']['field'] = 'body';
+  $handler->display->display_options['fields']['body']['label'] = '';
+  $handler->display->display_options['fields']['body']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['body']['type'] = 'text_summary_or_trimmed';
+  $handler->display->display_options['fields']['body']['settings'] = array(
+    'trim_length' => '600',
+  );
+  /* Field: Content: Comment count */
+  $handler->display->display_options['fields']['comment_count']['id'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['table'] = 'node_comment_statistics';
+  $handler->display->display_options['fields']['comment_count']['field'] = 'comment_count';
+  $handler->display->display_options['fields']['comment_count']['label'] = '';
+  $handler->display->display_options['fields']['comment_count']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['comment_count']['empty'] = 'No comments';
+  $handler->display->display_options['fields']['comment_count']['empty_zero'] = TRUE;
+  $handler->display->display_options['fields']['comment_count']['hide_alter_empty'] = FALSE;
+  $handler->display->display_options['fields']['comment_count']['separator'] = '';
+  $handler->display->display_options['fields']['comment_count']['suffix'] = ' comments';
+  /* Sort criterion: Content: Sticky */
+  $handler->display->display_options['sorts']['sticky']['id'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['table'] = 'node';
+  $handler->display->display_options['sorts']['sticky']['field'] = 'sticky';
+  $handler->display->display_options['sorts']['sticky']['order'] = 'DESC';
+  /* Sort criterion: Content: Post date */
+  $handler->display->display_options['sorts']['created']['id'] = 'created';
+  $handler->display->display_options['sorts']['created']['table'] = 'node';
+  $handler->display->display_options['sorts']['created']['field'] = 'created';
+  $handler->display->display_options['sorts']['created']['order'] = 'DESC';
+  $handler->display->display_options['sorts']['created']['exposed'] = TRUE;
+  $handler->display->display_options['sorts']['created']['expose']['label'] = 'most recent';
+  /* Contextual filter: OG membership: Group ID */
+  $handler->display->display_options['arguments']['gid']['id'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['table'] = 'og_membership';
+  $handler->display->display_options['arguments']['gid']['field'] = 'gid';
+  $handler->display->display_options['arguments']['gid']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['arguments']['gid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['gid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['gid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['gid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: Content: Published */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'node';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['value'] = 1;
+  $handler->display->display_options['filters']['status']['group'] = 1;
+  $handler->display->display_options['filters']['status']['expose']['operator'] = FALSE;
+  /* Filter criterion: Content: Type */
+  $handler->display->display_options['filters']['type']['id'] = 'type';
+  $handler->display->display_options['filters']['type']['table'] = 'node';
+  $handler->display->display_options['filters']['type']['field'] = 'type';
+  $handler->display->display_options['filters']['type']['value'] = array(
+    'wiki' => 'wiki',
+  );
+  /* Filter criterion: OG membership: Group_type */
+  $handler->display->display_options['filters']['group_type']['id'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['table'] = 'og_membership';
+  $handler->display->display_options['filters']['group_type']['field'] = 'group_type';
+  $handler->display->display_options['filters']['group_type']['relationship'] = 'og_membership_rel';
+  $handler->display->display_options['filters']['group_type']['value'] = array(
+    'node' => 'node',
+  );
+  $translatables['commons_bw_wikis'] = array(
+    t('Master'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('Items per page'),
+    t('- All -'),
+    t('Offset'),
+    t('Â« first'),
+    t('â¹ previous'),
+    t('next âº'),
+    t('last Â»'),
+    t('No wikis have been added to this group.'),
+    t('OG membership from node'),
+    t('following'),
+    t('No comments'),
+    t('.'),
+    t(' comments'),
+    t('most recent'),
+    t('most active'),
+    t('All'),
+    t('Following'),
+  );
+  $export['commons_bw_wikis'] = $view;
+
+  $view = new view();
+  $view->name = 'commons_wikis_contributor_list';
+  $view->description = '';
+  $view->tag = 'default';
+  $view->base_table = 'node_revision';
+  $view->human_name = 'Commons Wikis - Contributor List';
+  $view->core = 7;
+  $view->api_version = '3.0';
+  $view->disabled = FALSE; /* Edit this to true to make a default view disabled initially */
+
+  /* Display: Master */
+  $handler = $view->new_display('default', 'Master', 'default');
+  $handler->display->display_options['title'] = 'Contributors';
+  $handler->display->display_options['use_more_always'] = FALSE;
+  $handler->display->display_options['access']['type'] = 'perm';
+  $handler->display->display_options['cache']['type'] = 'none';
+  $handler->display->display_options['query']['type'] = 'views_query';
+  $handler->display->display_options['query']['options']['distinct'] = TRUE;
+  $handler->display->display_options['query']['options']['pure_distinct'] = TRUE;
+  $handler->display->display_options['exposed_form']['type'] = 'basic';
+  $handler->display->display_options['pager']['type'] = 'some';
+  $handler->display->display_options['pager']['options']['items_per_page'] = '4';
+  $handler->display->display_options['pager']['options']['offset'] = '0';
+  $handler->display->display_options['style_plugin'] = 'default';
+  $handler->display->display_options['row_plugin'] = 'fields';
+  /* Relationship: Content revision: User */
+  $handler->display->display_options['relationships']['uid']['id'] = 'uid';
+  $handler->display->display_options['relationships']['uid']['table'] = 'node_revision';
+  $handler->display->display_options['relationships']['uid']['field'] = 'uid';
+  /* Field: User: Picture */
+  $handler->display->display_options['fields']['picture']['id'] = 'picture';
+  $handler->display->display_options['fields']['picture']['table'] = 'users';
+  $handler->display->display_options['fields']['picture']['field'] = 'picture';
+  $handler->display->display_options['fields']['picture']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['picture']['label'] = '';
+  $handler->display->display_options['fields']['picture']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['picture']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['picture']['image_style'] = '50x50';
+  /* Field: User: Name */
+  $handler->display->display_options['fields']['name']['id'] = 'name';
+  $handler->display->display_options['fields']['name']['table'] = 'users';
+  $handler->display->display_options['fields']['name']['field'] = 'name';
+  $handler->display->display_options['fields']['name']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['name']['label'] = '';
+  $handler->display->display_options['fields']['name']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['name']['element_label_colon'] = FALSE;
+  /* Field: User: Uid */
+  $handler->display->display_options['fields']['uid']['id'] = 'uid';
+  $handler->display->display_options['fields']['uid']['table'] = 'users';
+  $handler->display->display_options['fields']['uid']['field'] = 'uid';
+  $handler->display->display_options['fields']['uid']['relationship'] = 'uid';
+  $handler->display->display_options['fields']['uid']['label'] = '';
+  $handler->display->display_options['fields']['uid']['exclude'] = TRUE;
+  $handler->display->display_options['fields']['uid']['element_label_colon'] = FALSE;
+  $handler->display->display_options['fields']['uid']['link_to_user'] = FALSE;
+  /* Field: Global: Custom text */
+  $handler->display->display_options['fields']['nothing']['id'] = 'nothing';
+  $handler->display->display_options['fields']['nothing']['table'] = 'views';
+  $handler->display->display_options['fields']['nothing']['field'] = 'nothing';
+  $handler->display->display_options['fields']['nothing']['label'] = '';
+  $handler->display->display_options['fields']['nothing']['alter']['text'] = '[picture]<span>[name]</span>';
+  $handler->display->display_options['fields']['nothing']['alter']['make_link'] = TRUE;
+  $handler->display->display_options['fields']['nothing']['alter']['path'] = 'user/[uid]';
+  $handler->display->display_options['fields']['nothing']['alter']['absolute'] = TRUE;
+  $handler->display->display_options['fields']['nothing']['element_label_colon'] = FALSE;
+  /* Contextual filter: Content revision: Nid */
+  $handler->display->display_options['arguments']['nid']['id'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['table'] = 'node_revision';
+  $handler->display->display_options['arguments']['nid']['field'] = 'nid';
+  $handler->display->display_options['arguments']['nid']['default_action'] = 'empty';
+  $handler->display->display_options['arguments']['nid']['default_argument_type'] = 'fixed';
+  $handler->display->display_options['arguments']['nid']['summary']['number_of_records'] = '0';
+  $handler->display->display_options['arguments']['nid']['summary']['format'] = 'default_summary';
+  $handler->display->display_options['arguments']['nid']['summary_options']['items_per_page'] = '25';
+  /* Filter criterion: User: Active */
+  $handler->display->display_options['filters']['status']['id'] = 'status';
+  $handler->display->display_options['filters']['status']['table'] = 'users';
+  $handler->display->display_options['filters']['status']['field'] = 'status';
+  $handler->display->display_options['filters']['status']['relationship'] = 'uid';
+  $handler->display->display_options['filters']['status']['value'] = '1';
+
+  /* Display: Content pane */
+  $handler = $view->new_display('panel_pane', 'Content pane', 'commons_wikis_contributor_pane');
+  $handler->display->display_options['defaults']['hide_admin_links'] = FALSE;
+  $handler->display->display_options['pane_category']['name'] = 'Commons';
+  $handler->display->display_options['pane_category']['weight'] = '0';
+  $handler->display->display_options['argument_input'] = array(
+    'nid' => array(
+      'type' => 'context',
+      'context' => 'entity:node.nid',
+      'context_optional' => 0,
+      'panel' => '0',
+      'fixed' => '',
+      'label' => 'Content: Nid',
+    ),
+  );
+  $translatables['commons_wikis_contributor_list'] = array(
+    t('Master'),
+    t('Contributors'),
+    t('more'),
+    t('Apply'),
+    t('Reset'),
+    t('Sort by'),
+    t('Asc'),
+    t('Desc'),
+    t('revision user'),
+    t('[picture]<span>[name]</span>'),
+    t('All'),
+    t('Content pane'),
+    t('Commons'),
+  );
+  $export['commons_wikis_contributor_list'] = $view;
+
+  return $export;
+}
diff --git a/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.features.inc b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.features.inc
new file mode 100644
index 0000000..42d5e2e
--- /dev/null
+++ b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.features.inc
@@ -0,0 +1,17 @@
+<?php
+/**
+ * @file
+ * commons_wikis_pages.features.inc
+ */
+
+/**
+ * Implements hook_ctools_plugin_api().
+ */
+function commons_wikis_pages_ctools_plugin_api($module = NULL, $api = NULL) {
+  if ($module == "panelizer" && $api == "panelizer") {
+    return array("version" => "1");
+  }
+  if ($module == "strongarm" && $api == "strongarm") {
+    return array("version" => "1");
+  }
+}
diff --git a/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.info b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.info
new file mode 100644
index 0000000..79e7c9a
--- /dev/null
+++ b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.info
@@ -0,0 +1,13 @@
+name = Commons Wikis Home
+description = Provides the panelizer feature for Wikis.
+core = 7.x
+package = Commons - Landing pages
+dependencies[] = commons_wikis
+dependencies[] = ctools
+dependencies[] = panelizer
+dependencies[] = strongarm
+features[ctools][] = panelizer:panelizer:1
+features[ctools][] = strongarm:strongarm:1
+features[features_api][] = api:2
+features[panelizer_defaults][] = node:wiki:default
+features[variable][] = panelizer_defaults_node_wiki
diff --git a/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.install b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.install
new file mode 100644
index 0000000..b1b9659
--- /dev/null
+++ b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.install
@@ -0,0 +1,12 @@
+<?php
+
+/**
+ * Update the wiki pages to remove the panelizer for comments.
+ */
+function commons_wikis_pages_update_7100() {
+    $revert = array(
+      'commons_wikis_pages' => array('panelizer_defaults'),
+  );
+  features_revert($revert);
+  return array();
+}
\ No newline at end of file
diff --git a/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.module b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.module
new file mode 100644
index 0000000..77fae1e
--- /dev/null
+++ b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.module
@@ -0,0 +1,7 @@
+<?php
+/**
+ * @file
+ * Code for the Commons Wikis landing page feature.
+ */
+
+include_once 'commons_wikis_pages.features.inc';
diff --git a/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.panelizer.inc b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.panelizer.inc
new file mode 100644
index 0000000..0444432
--- /dev/null
+++ b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.panelizer.inc
@@ -0,0 +1,108 @@
+<?php
+/**
+ * @file
+ * commons_wikis_pages.panelizer.inc
+ */
+
+/**
+ * Implements hook_panelizer_defaults().
+ */
+function commons_wikis_pages_panelizer_defaults() {
+  $export = array();
+
+  $panelizer = new stdClass();
+  $panelizer->disabled = FALSE; /* Edit this to true to make a default panelizer disabled initially */
+  $panelizer->api_version = 1;
+  $panelizer->name = 'node:wiki:default';
+  $panelizer->title = 'Default';
+  $panelizer->panelizer_type = 'node';
+  $panelizer->panelizer_key = 'wiki';
+  $panelizer->no_blocks = FALSE;
+  $panelizer->css_id = '';
+  $panelizer->css = '';
+  $panelizer->pipeline = 'ipe';
+  $panelizer->contexts = array();
+  $panelizer->relationships = array();
+  $panelizer->access = '';
+  $panelizer->view_mode = '';
+  $panelizer->css_class = '';
+  $panelizer->title_element = 'H2';
+  $panelizer->link_to_entity = TRUE;
+  $panelizer->extra = '';
+  $display = new panels_display();
+  $display->layout = 'two_66_33';
+  $display->layout_settings = array();
+  $display->panel_settings = array(
+    'style_settings' => array(
+      'default' => NULL,
+      'center' => NULL,
+      'two_66_33_top' => NULL,
+      'two_66_33_first' => NULL,
+      'two_66_33_second' => NULL,
+      'two_66_33_bottom' => NULL,
+    ),
+  );
+  $display->cache = array();
+  $display->title = '%node:title';
+  $display->uuid = 'bc4d1b4e-c149-dbf4-c1d9-20655cf95f31';
+  $display->content = array();
+  $display->panels = array();
+    $pane = new stdClass();
+    $pane->pid = 'new-8006578b-1091-e734-6d38-3c6a8052ccbd';
+    $pane->panel = 'two_66_33_first';
+    $pane->type = 'node_content';
+    $pane->subtype = 'node_content';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'links' => 1,
+      'no_extras' => 0,
+      'override_title' => 0,
+      'override_title_text' => '',
+      'identifier' => '',
+      'link' => 0,
+      'leave_node_title' => 0,
+      'build_mode' => 'full',
+      'context' => 'panelizer',
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = '8006578b-1091-e734-6d38-3c6a8052ccbd';
+    $display->content['new-8006578b-1091-e734-6d38-3c6a8052ccbd'] = $pane;
+    $display->panels['two_66_33_first'][0] = 'new-8006578b-1091-e734-6d38-3c6a8052ccbd';
+    $pane = new stdClass();
+    $pane->pid = 'new-bab0455d-e26a-6974-bd77-1e04bb5aece9';
+    $pane->panel = 'two_66_33_second';
+    $pane->type = 'views_panes';
+    $pane->subtype = 'commons_wikis_contributor_list-commons_wikis_contributor_pane';
+    $pane->shown = TRUE;
+    $pane->access = array();
+    $pane->configuration = array(
+      'context' => array(
+        0 => 'panelizer',
+      ),
+    );
+    $pane->cache = array();
+    $pane->style = array(
+      'settings' => NULL,
+    );
+    $pane->css = array();
+    $pane->extras = array();
+    $pane->position = 0;
+    $pane->locks = array();
+    $pane->uuid = 'bab0455d-e26a-6974-bd77-1e04bb5aece9';
+    $display->content['new-bab0455d-e26a-6974-bd77-1e04bb5aece9'] = $pane;
+    $display->panels['two_66_33_second'][0] = 'new-bab0455d-e26a-6974-bd77-1e04bb5aece9';
+  $display->hide_title = PANELS_TITLE_FIXED;
+  $display->title_pane = '0';
+  $panelizer->display = $display;
+  $export['node:wiki:default'] = $panelizer;
+
+  return $export;
+}
diff --git a/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.strongarm.inc b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.strongarm.inc
new file mode 100644
index 0000000..7790003
--- /dev/null
+++ b/modules/commons/commons_wikis/modules/commons_wikis_pages/commons_wikis_pages.strongarm.inc
@@ -0,0 +1,25 @@
+<?php
+/**
+ * @file
+ * commons_wikis_pages.strongarm.inc
+ */
+
+/**
+ * Implements hook_strongarm().
+ */
+function commons_wikis_pages_strongarm() {
+  $export = array();
+
+  $strongarm = new stdClass();
+  $strongarm->disabled = FALSE; /* Edit this to true to make a default strongarm disabled initially */
+  $strongarm->api_version = 1;
+  $strongarm->name = 'panelizer_defaults_node_wiki';
+  $strongarm->value = array(
+    'status' => 1,
+    'default' => 1,
+    'choice' => 0,
+  );
+  $export['panelizer_defaults_node_wiki'] = $strongarm;
+
+  return $export;
+}
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.features.ckeditor_profile.inc b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.ckeditor_profile.inc
new file mode 100644
index 0000000..9974e8a
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.ckeditor_profile.inc
@@ -0,0 +1,77 @@
+<?php
+/**
+ * @file
+ * commons_wysiwyg.features.ckeditor_profile.inc
+ */
+
+/**
+ * Implements hook_ckeditor_profile_defaults().
+ */
+function commons_wysiwyg_ckeditor_profile_defaults() {
+  $data = array(
+    'Advanced' => array(
+      'name' => 'Advanced',
+      'settings' => array(
+        'ss' => 2,
+        'default' => 't',
+        'show_toggle' => 't',
+        'uicolor' => 'default',
+        'uicolor_user' => 'default',
+        'toolbar' => '[
+    [\'Format\'],[\'Bold\',\'Italic\',\'Strike\'],[\'NumberedList\',\'BulletedList\',\'Indent\',\'Outdent\',\'Blockquote\'],[\'Link\',\'Unlink\',\'Image\']
+]',
+        'expand' => 't',
+        'width' => '100%',
+        'lang' => 'en',
+        'auto_lang' => 't',
+        'language_direction' => 'default',
+        'enter_mode' => 'p',
+        'shift_enter_mode' => 'br',
+        'font_format' => 'p;div;pre;address;h1;h2;h3;h4;h5;h6',
+        'custom_formatting' => 'f',
+        'formatting' => array(
+          'custom_formatting_options' => array(
+            'indent' => 'indent',
+            'breakBeforeOpen' => 'breakBeforeOpen',
+            'breakAfterOpen' => 'breakAfterOpen',
+            'breakAfterClose' => 'breakAfterClose',
+            'breakBeforeClose' => 0,
+            'pre_indent' => 0,
+          ),
+        ),
+        'css_mode' => 'theme',
+        'css_path' => '',
+        'css_style' => 'theme',
+        'styles_path' => '',
+        'filebrowser' => 'none',
+        'filebrowser_image' => '',
+        'filebrowser_flash' => '',
+        'UserFilesPath' => '%b%f/',
+        'UserFilesAbsolutePath' => '%d%b%f/',
+        'forcePasteAsPlainText' => 'f',
+        'html_entities' => 'f',
+        'scayt_autoStartup' => 'f',
+        'theme_config_js' => 'f',
+        'js_conf' => '',
+        'loadPlugins' => array(
+          'drupalbreaks' => array(
+            'name' => 'drupalbreaks',
+            'desc' => 'Plugin for inserting Drupal teaser and page breaks.',
+            'path' => '%plugin_dir%drupalbreaks/',
+            'buttons' => array(
+              'DrupalBreak' => array(
+                'label' => 'DrupalBreak',
+                'icon' => 'images/drupalbreak.png',
+              ),
+            ),
+            'default' => 't',
+          ),
+        ),
+      ),
+      'input_formats' => array(
+        'filtered_html' => 'Filtered HTML',
+      ),
+    ),
+  );
+  return $data;
+}
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.features.filter.inc b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.filter.inc
new file mode 100644
index 0000000..2ef3661
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.filter.inc
@@ -0,0 +1,44 @@
+<?php
+/**
+ * @file
+ * commons_wysiwyg.features.filter.inc
+ */
+
+/**
+ * Implements hook_filter_default_formats().
+ */
+function commons_wysiwyg_filter_default_formats() {
+  $formats = array();
+
+  // Exported format: Filtered HTML.
+  $formats['filtered_html'] = array(
+    'format' => 'filtered_html',
+    'name' => 'Filtered HTML',
+    'cache' => 1,
+    'status' => 1,
+    'weight' => 0,
+    'filters' => array(
+      'filter_html' => array(
+        'weight' => 1,
+        'status' => 1,
+        'settings' => array(
+          'allowed_html' => '<a> <em> <strong> <u> <cite> <blockquote> <code> <ul> <ol> <li> <dl> <dt> <dd> <h4> <h5> <h6>  <p> <br> <img> <strike>',
+          'filter_html_help' => 1,
+          'filter_html_nofollow' => 0,
+        ),
+      ),
+    ),
+  );
+
+  // Exported format: Full HTML.
+  $formats['full_html'] = array(
+    'format' => 'full_html',
+    'name' => 'Full HTML',
+    'cache' => 1,
+    'status' => 1,
+    'weight' => 1,
+    'filters' => array(),
+  );
+
+  return $formats;
+}
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.features.inc b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.inc
new file mode 100644
index 0000000..05a4b04
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.inc
@@ -0,0 +1,3 @@
+<?php
+
+// This file is deprecated and can be removed.
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.features.user_permission.inc b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.user_permission.inc
new file mode 100644
index 0000000..30d909a
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.features.user_permission.inc
@@ -0,0 +1,25 @@
+<?php
+/**
+ * @file
+ * commons_wysiwyg.features.user_permission.inc
+ */
+
+/**
+ * Implements hook_user_default_permissions().
+ */
+function commons_wysiwyg_user_default_permissions() {
+  $permissions = array();
+
+  // Exported permission: 'use text format filtered_html'.
+  $permissions['use text format filtered_html'] = array(
+    'name' => 'use text format filtered_html',
+    'roles' => array(
+      'administrator' => 'administrator',
+      'anonymous user' => 'anonymous user',
+      'authenticated user' => 'authenticated user',
+    ),
+    'module' => 'filter',
+  );
+
+  return $permissions;
+}
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.info b/modules/commons/commons_wysiwyg/commons_wysiwyg.info
new file mode 100644
index 0000000..a4e5358
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.info
@@ -0,0 +1,13 @@
+name = Commons WYSIWYG
+description = Provides a rich text editor for content creation.
+core = 7.x
+package = Commons - Building blocks
+dependencies[] = ckeditor
+dependencies[] = features
+dependencies[] = filter
+dependencies[] = strongarm
+features[ckeditor_profile][] = Advanced
+features[features_api][] = api:2
+features[filter][] = filtered_html
+features[filter][] = full_html
+features[user_permission][] = use text format filtered_html
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.install b/modules/commons/commons_wysiwyg/commons_wysiwyg.install
new file mode 100644
index 0000000..01e80d9
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.install
@@ -0,0 +1,25 @@
+<?php
+
+/**
+ * Update CKEditor config to be more friendly on devices with smaller
+ * screen sizes per http://drupal.org/node/1948466.
+ */
+function commons_wysiwyg_update_3100() {
+  $revert = array(
+      'commons_wysiwyg' => array('ckeditor_profile'),
+  );
+  features_revert($revert);
+  return array();
+}
+
+/**
+ * Update our CKEditor profile to help resolve issues editing
+ * text areas on iPad per https://drupal.org/node/2030087.
+ */
+function commons_wysiwyg_update_3101() {
+  $revert = array(
+      'commons_wysiwyg' => array('ckeditor_profile'),
+  );
+  features_revert($revert);
+  return array();
+}
diff --git a/modules/commons/commons_wysiwyg/commons_wysiwyg.module b/modules/commons/commons_wysiwyg/commons_wysiwyg.module
new file mode 100644
index 0000000..98f2347
--- /dev/null
+++ b/modules/commons/commons_wysiwyg/commons_wysiwyg.module
@@ -0,0 +1,22 @@
+<?php
+/**
+ * Implements hook_element_info_alter().
+ * Sets the default format if the user's default format is filtered_html.
+ */
+function commons_wysiwyg_element_info_alter(&$type) {
+  $type['text_format']['#pre_render'][] = 'commons_wysiwyg_process_filter_format';
+}
+
+/**
+ * Callback function to process the filter format and remove the fieldset.
+ * More info:  http://drupal.org/node/1949552
+ */
+function commons_wysiwyg_process_filter_format($element) {
+  global $user;
+  $formats = filter_formats($user);
+  if (count($formats) <= 2 && array_key_exists('filtered_html', $formats)) {
+    unset($element['format']);
+    $element['#format'] = 'filtered_html';
+  }
+  return $element;
+}
\ No newline at end of file
diff --git a/scripts/build.sh b/scripts/build.sh
new file mode 100755
index 0000000..9c0993d
--- /dev/null
+++ b/scripts/build.sh
@@ -0,0 +1,174 @@
+#!/bin/bash
+set -e
+
+#
+# Build the distribution using the same process used on Drupal.org
+#
+# When building, we expect that you're building within a directory structure like
+# the following:
+#   commons/
+#     /commons_profile
+#     /docroot
+#     /docroot2, etc, etc
+#     /repos
+#     /patches
+#     /screenshots
+#
+#
+# Usage: scripts/build.sh [-y] <destination> from the profile main directory.
+#
+# BUILD_ROOT = development path for commons
+# DESTINATION = docroot for commons builds
+
+confirm () {
+  read -r -p "${1:-Are you sure? [Y/n]} " response
+  case $response in
+    [yY][eE][sS]|[yY])
+      true
+      ;;
+    *)
+      false
+      ;;
+  esac
+}
+
+# Figure out directory real path.
+realpath () {
+  TARGET_FILE=$1
+
+  cd `dirname $TARGET_FILE`
+  TARGET_FILE=`basename $TARGET_FILE`
+
+  while [ -L "$TARGET_FILE" ]
+  do
+    TARGET_FILE=`readlink $TARGET_FILE`
+    cd `dirname $TARGET_FILE`
+    TARGET_FILE=`basename $TARGET_FILE`
+  done
+
+  PHYS_DIR=`pwd -P`
+  RESULT=$PHYS_DIR/$TARGET_FILE
+  echo $RESULT
+}
+
+usage() {
+  echo "Usage: build.sh [-y] <DESTINATION_PATH>" >&2
+  echo "Use -y to skip deletion confirmation" >&2
+  echo "Use --gitusername to use authenticated git instead of http" >&2
+  echo "Use --build_root to build the whole dir structure, not just the docroot" > &2
+  exit 1
+}
+
+BUILD_ROOT=`pwd -P`
+DESTINATION=$1
+ASK=true
+
+while getopts ":yhg:" opt; do
+  case $opt in
+    y)
+      DESTINATION=$2
+      ASK=false
+      ;;
+    h)
+      usage
+      ;;
+    \?)
+      echo "Invalid option: -$OPTARG" >&2
+      usage
+      ;;
+  esac
+done
+
+if [ "x$DESTINATION" == "x" ]; then
+  usage
+fi
+
+if [ ! -f drupal-org.make ]; then
+  echo "[error] Run this script from the distribution base path, eg scripts/build.sh"
+  exit 1
+fi
+
+DESTINATION=$(realpath $DESTINATION)
+
+case $OSTYPE in
+  darwin*)
+    TEMP_BUILD=`mktemp -d -t tmpdir`
+    ;;
+  *)
+    TEMP_BUILD=`mktemp -d`
+    ;;
+esac
+# Drush make expects destination to be empty.
+rmdir $TEMP_BUILD
+
+if [ -d $DESTINATION ]; then
+  echo "Removing existing destination: $DESTINATION"
+  if $ASK; then
+    confirm && chmod -R 777 $DESTINATION && rm -rf $DESTINATION
+    if [ -d $DESTINATION ]; then
+      echo "Aborted."
+      exit 1
+    fi
+  else
+    chmod -R 777 $DESTINATION && rm -rf $DESTINATION
+  fi
+  echo "done"
+fi
+
+# Build the profile.
+echo "Building the profile..."
+echo `pwd`
+
+if [[ -d $BUILD_PATH ]]; then
+    cd $BUILD_PATH
+    rm -rf ./publish
+    # do we have the profile?
+    if [[ -d $BUILD_PATH/commons_profile ]]; then
+      if [[ -d $BUILD_PATH/repos ]]; then
+        drush make commons_profile/build-commons.make --no-cache --working-copy --prepare-install ./publish
+      else
+        mkdir $BUILD_PATH/repos
+        mkdir $BUILD_PATH/repos/modules
+        mkdir $BUILD_PATH/repos/themes
+        build_distro $BUILD_PATH
+      fi
+      chmod -R 777 publish/sites/default
+      # symlink the profile to our dev copy
+      echo "untaring"
+      tar -czvf modules.tar.gz publish/profiles/commons/modules/contrib
+      tar -czvf themes.tar.gz publish/profiles/commons/themes/contrib
+      rm -rf publish/profiles/commons
+      ln -s $BUILD_PATH/commons_profile publish/profiles/commons
+      tar -zxvf modules.tar.gz
+      tar -zxvf themes.tar.gz
+    else
+      git clone --branch 7.x-3.x-merged ${USERNAME}@git.drupal.org:project/commons.git commons_profile
+      build_distro $BUILD_PATH
+    fi
+else
+  mkdir $BUILD_PATH
+  build_distro $BUILD_PATH $USERNAME
+fi
+
+
+
+drush make --no-cache --no-core --contrib-destination drupal-org.make tmp
+
+# Build a drupal-org-core.make file if it doesn't exist.
+if [ ! -f drupal-org-core.make ]; then
+  cat >> drupal-org-core.make <<EOF
+api = 2
+core = 7.x
+projects[drupal] = 7
+EOF
+fi
+
+# Build the distribution and copy the profile in place.
+echo "Building the distribution..."
+drush make drupal-org-core.make $TEMP_BUILD
+echo -n "Moving to destination... "
+cp -r tmp $TEMP_BUILD/profiles/commerce_kickstart
+rm -rf tmp
+cp -r . $TEMP_BUILD/profiles/commerce_kickstart
+mv $TEMP_BUILD $DESTINATION
+echo "done"
diff --git a/scripts/build_distro.sh b/scripts/build_distro.sh
new file mode 100755
index 0000000..193a604
--- /dev/null
+++ b/scripts/build_distro.sh
@@ -0,0 +1,282 @@
+#!/bin/bash
+#set -e
+
+#modules=(commons_activity_streams commons_featured commons_notices commons_profile_social commons_user_profile_pages commons_body commons_follow commons_notify commons_q_a commons_utility_links commons_bw commons_groups commons_pages commons_radioactivity commons_wikis commons_content_moderation commons_like commons_polls commons_search commons_wysiwyg commons_documents commons_location commons_posts commons_site_homepage commons_events commons_misc commons_profile_base commons_topics commons_social_sharing commons_trusted_contacts)
+#themes=(commons_origins)
+
+merge_repos() {
+  cd $BUILD_PATH/commons_profile
+  for i in "${modules[@]}"; do
+    if [[ -n $USERNAME ]]; then
+      git remote add ${i} ${USERNAME}@git.drupal.org:project/${i}.git
+    else
+      git remote add ${i} http://git.drupal.org/project/${i}.git
+    fi
+    git fetch ${i}
+    git merge -s ours --no-commit ${i}/7.x-3.x
+    git read-tree --prefix=modules/commons/${i} -u ${i}/7.x-3.x
+    git commit -m "Merged ${i} into Commons repo"
+    git remote rm ${i}
+    echo "Successfully added $i to commons profile"
+  done
+  #do the theme now
+  i=commons_origins
+  if [[ -n $USERNAME ]]; then
+    git remote add ${i} ${USERNAME}@git.drupal.org:project/${i}.git
+  else
+    git remote add ${i} http://git.drupal.org/project/${i}.git
+  fi
+  git fetch ${i}
+  git merge -s ours --no-commit ${i}/7.x-3.x
+  git read-tree --prefix=themes/commons/${i} -u ${i}/7.x-3.x
+  git commit -m "Merged ${i} into Commons repo"
+  echo "Successfully added $i to commons profile"
+}
+
+# this function is no longer needed because we're in one repo now.
+pull_git() {
+    cd $BUILD_PATH/commons_profile
+    if [[ -n $RESET ]]; then
+      git reset --hard HEAD
+    fi
+    git pull origin 7.x-3.x
+
+    cd $BUILD_PATH/repos/modules
+    for i in `ls | awk -F/ '{print $1}'`; do
+      echo $i
+      cd $i
+      if [[ -n $RESET ]]; then
+        git reset --hard HEAD
+      fi
+      git pull origin
+      cd ..
+    done
+}
+
+release_notes() {
+  rm -rf rn.txt
+  pull_git $BUILD_PATH
+  OUTPUT="<h2>Release Notes for $RELEASE</h2>"
+  cd $BUILD_PATH/commons_profile
+  OUTPUT="$OUTPUT <h3>Drupal Commons:</h3> `drush rn --date $FROM_DATE $TO_DATE`"
+
+  ## old repos. don't use this anymore
+  # cd $BUILD_PATH/repos/modules
+  # for i in "${modules[@]}"; do
+  #  echo $i
+  #  cd $i
+  #  RN=`drush rn --date $FROM_DATE $TO_DATE`
+  #  if [[ -n $RN ]]; then
+  #    OUTPUT="$OUTPUT <h3>$i:</h3> $RN"
+  #  fi
+  #  cd ..
+  #done
+  #cd $BUILD_PATH/repos/themes/commons_origins
+  #RN=`drush rn --date $FROM_DATE $TO_DATE`
+  #if [[ -n $RN ]]; then
+  #  OUTPUT="$OUTPUT <h3>commons_origins:</h3> $RN"
+  #fi
+
+  echo $OUTPUT >> $BUILD_PATH/rn.txt
+  echo "Release notes for $RELEASE created at $BUILD_PATH/rn.txt"
+}
+
+build_distro() {
+  if [[ -d $BUILD_PATH ]]; then
+      cd $BUILD_PATH
+      #backup the sites directory
+      if [[ -d docroot ]]; then
+        rm -rf ./docroot
+      fi
+      # do we have the profile?
+      if [[ -d $BUILD_PATH/commons_profile ]]; then
+        if [[ -d $BUILD_PATH/repos ]]; then
+          rm -f /tmp/commons.tar.gz
+          drush make --no-cache --prepare-install --drupal-org=core $BUILD_PATH/commons_profile/drupal-org-core.make $BUILD_PATH/docroot
+          drush make --no-cache --no-core --contrib-destination --tar $BUILD_PATH/commons_profile/drupal-org.make /tmp/commons
+        else
+          mkdir -p $BUILD_PATH/repos/modules/contrib
+          cd $BUILD_PATH/repos/modules/contrib
+          for i in "${modules[@]}"; do
+            echo "bringing in ${i} for $USERNAME";
+            if [[ -n $USERNAME ]]; then
+              git clone ${USERNAME}@git.drupal.org:project/${i}.git
+            else
+              git clone http://git.drupal.org/project/${i}.git
+            fi
+          done
+          cd $BUILD_PATH/repos
+          mkdir -p $BUILD_PATH/repos/themes/contrib
+          cd $BUILD_PATH/repos/themes
+          for i in "${themes[@]}"; do
+            if [[ -n $USERNAME ]]; then
+              git clone ${USERNAME}@git.drupal.org:project/${i}.git
+            else
+              git clone http://git.drupal.org/project/${i}.git
+            fi
+          done
+          build_distro $BUILD_PATH
+        fi
+        # symlink the profile sites folder to our dev copy
+        cd docroot
+        if [[ -d $BUILD_PATH/sites ]]; then
+          rm -rf $BUILD_PATH/docroot/sites
+          ln -s ../sites $BUILD_PATH/docroot/sites
+        else
+          mv $BUILD_PATH/docroot/sites $BUILD_PATH/sites
+          ln -s ../sites $BUILD_PATH/docroot/sites
+        fi
+        chmod -R 777 $BUILD_PATH/docroot/sites/default
+
+        ## put commons profile and modules into the profile folder
+        rm -rf docroot/profiles/commons
+        if [ -a $BUILD_PATH/repos.txt ]; then
+          UNTAR="tar -zxvf /tmp/commons.tar.gz -X $BUILD_PATH/repos.txt"
+        else
+          cd $BUILD_PATH/repos
+          find * -mindepth 1 -maxdepth 2 -type d -not -path ".*" -not -path "modules/.*" -not -path "themes/.*" -not -path "modules/contrib" -not -path "themes/contrib" > /tmp/repos.txt
+          # exclude repos since we're updating already by linking it to the repos directory.
+          UNTAR="tar -zxvf /tmp/commons.tar.gz -X /tmp/repos.txt"
+        fi
+        cd $BUILD_PATH/docroot/profiles
+        eval $UNTAR
+        cd commons
+        ln -s ../../../commons_profile/* .
+        ln -s ../../../../commons_profile/modules/commons ${BUILD_PATH}/docroot/profiles/commons/modules/
+        ln -s ../../../../commons_profile/themes/commons ${BUILD_PATH}/docroot/profiles/commons/themes/
+        for line in $(cat $BUILD_PATH/repos.txt); do
+          ln -s ../../../../../repos/${line} ${BUILD_PATH}/docroot/profiles/commons/$(echo ${line} | awk -F/ '{print $1}')/contrib/
+        done
+        chmod -R 775 $BUILD_PATH/docroot/profiles/commons
+      else
+        git clone --branch 7.x-3.x ${USERNAME}@git.drupal.org:project/commons.git commons_profile
+        build_distro $BUILD_PATH
+      fi
+  else
+    mkdir $BUILD_PATH
+    build_distro $BUILD_PATH $USERNAME
+  fi
+}
+
+site_install() {
+  read -p "You're about to DESTROY all data for site ${SITE} Are you sure? " -n 1 -r
+  if [[ $REPLY =~ ^[Yy]$ ]]; then
+    cd ${BUILD_PATH}/docroot/sites/${SITE}
+    drush -y sql-drop
+    drush site-install --site-name=${SITE} --account-name=admin --account-pass=${ADMIN_PASS} --account-mail=${ADMIN_EMAIL} --site-mail=commons_site@example.com -v -y commons commons_anonymous_welcome_text_form.commons_install_example_content=${DEMO_CONTENT} commons_anonymous_welcome_text_form.commons_anonymous_welcome_title="Commons Example Site" commons_anonymous_welcome_text_form.commons_anonymous_welcome_body="Using the site-install version of commons." commons_create_first_group.commons_first_group_title="Sales Group" commons_create_first_group.commons_first_group_body="This is the sales group from site-install."
+  fi
+}
+
+# This allows you to test the make file without needing to upload it to drupal.org and run the main make file.
+update() {
+  if [[ -d $DOCROOT ]]; then
+    cd $DOCROOT
+    # do we have the profile?
+    if [[ -d $DOCROOT/profiles/commons ]]; then
+      # do we have an installed commons profile?
+        rm -f /tmp/docroot.tar.gz
+        rm -f /tmp/commons.tar.gz
+        drush make --no-cache --tar --drupal-org=core profiles/commons/drupal-org-core.make /tmp/docroot
+        drush make --no-core --no-cache --tar --drupal-org profiles/commons/drupal-org.make /tmp/commons
+        cd ..
+        tar -zxvf /tmp/docroot.tar.gz
+        cd docroot/profiles/commons/modules/contrib
+        # remove the symlinks in the repos before we execute
+        find . -type l | awk -F/ '{print $2}' > /tmp/repos.txt
+        cd $DOCROOT/profiles
+        # exclude repos since we're updating already by linking it to the repos directory.
+        UNTAR="tar -zxvf /tmp/commons.tar.gz -X /tmp/repos.txt"
+        eval $UNTAR
+        echo "Successfully Updated drupal from make files"
+        exit 0
+    fi
+  fi
+  echo "Unable to find Build path or drupal root. Please run build first"
+  exit 1
+}
+
+case $1 in
+  site-install)
+    if [[ -n $2 ]] && [[ -n $3 ]]; then
+      BUILD_PATH=$2
+    else
+      echo "Usage build_distro.sh site-install [build_path] [site] [demo-content] [admin-email] [admin-pass]"
+    fi
+    if [[ -n $3 ]]; then
+      SITE=$3
+    else
+      SITE='default'
+    fi
+    if [[ -n $4 ]]; then
+      DEMO_CONTENT='TRUE'
+    else
+      DEMO_CONTENT='FALSE'
+    fi
+    if [[ -n $5 ]]; then
+      ADMIN_EMAIL=$5
+    else
+      ADMIN_EMAIL='admin@example.com'
+    fi
+    if [[ -n $6 ]]; then
+      ADMIN_PASS=$6
+    else
+      ADMIN_PASS='admin'
+    fi
+
+    site_install $BUILD_PATH $SITE $DEMO_CONTENT $ADMIN_EMAIL $ADMIN_PASS;;
+  pull)
+    if [[ -n $2 ]]; then
+      BUILD_PATH=$2
+      if [[ -n $3 ]]; then
+       RESET=1
+      fi
+    else
+      echo "Usage: build_distro.sh pull [build_path]"
+      exit 1
+    fi
+    pull_git $BUILD_PATH $RESET;;
+  build)
+    if [[ -n $2 ]]; then
+      BUILD_PATH=$2
+    else
+      echo "Usage: build_distro.sh build [build_path]"
+      exit 1
+    fi
+    if [[ -n $3 ]]; then
+      USERNAME=$3
+    fi
+    build_distro $BUILD_PATH $USERNAME;;
+  rn)
+    if [[ -n $2 ]] && [[ -n $3 ]] && [[ -n $4 ]] && [[ -n $5 ]]; then
+      BUILD_PATH=$2
+      RELEASE=$3
+      FROM_DATE=$4
+      TO_DATE=$5
+    else
+      echo "Usage: build_distro.sh rn [build_path] [release] [from_date] [to_date]"
+      exit 1
+    fi
+    release_notes $BUILD_PATH $RELEASE $FROM_DATE $TO_DATE;;
+  update)
+    if [[ -n $2 ]]; then
+      DOCROOT=$2
+    else
+      echo "Usage: build_distro.sh update [DOCROOT]"
+      exit 1
+    fi
+    if [[ -n $3 ]]; then
+      USERNAME=$3
+    fi
+    update $DOCROOT;;
+  merge_repos)
+    if [[ -n $2 ]]; then
+      BUILD_PATH=$2
+    else
+      echo "Usage: build_distro.sh build [build_path]"
+      exit 1
+    fi
+    if [[ -n $3 ]]; then
+      USERNAME=$3
+    fi
+    merge_repos $BUILD_PATH $USERNAME;;
+esac
diff --git a/tests/README.md b/tests/README.md
deleted file mode 100644
index d10f0e0..0000000
--- a/tests/README.md
+++ /dev/null
@@ -1,140 +0,0 @@
-# The Commons Test Suite
-
-Current status:  
-[![Build Status](https://travis-ci.org/acquia/commons3.png?branch=7.x-3.x)](https://travis-ci.org/acquia/commons3)
-
-This folder is the home for the Drupal Commons integration tests.  
-To run the tests on commits, the [drupal.org project](https://drupal.org/project/commons) is mirrored 
-to [Github](https://github.com/acquia/commons3) so we're able to use [Travis CI](https://travis-ci.org/) to run the tests.
-The Travis CI project page for Commons can be found [over here](https://travis-ci.org/acquia/commons3/).
-
-
-## The build process
-
-The Travis CI build process is configured within the [.travis.yml](../.travis.yml) file present in the root directory.  
-It currently includes:
-
-- building the -dev makefile using Drush
-- installing the resulting distribution using drush site-install
-- running the behat based tests ("features")
-
-
-## The stack
-
-### [Behat](http://behat.org/):  
-A php based Behavior Driven Development framework for testing your business expectations.  
-It drives the whole test lifecycle and allows us to formulate test cases as regular english sentences.
-### [Mink](http://mink.behat.org/):  
-Mink is an open source acceptance test framework for web applications.  
-It "remote controls" several different types of browsers (from Firefox to headless phantomjs based ones).
-### [Drupal Extension](https://drupal.org/project/drupalextension):  
-The Drupal Extension is an integration layer between Behat, Mink Extension, and Drupal. It provides step definitions for common testing scenarios specific to Drupal sites.
-The predefined drupal specific steps should save us a lot of time writing helper code for using the basic navigational elements.
-The currently (July 2013) defined steps are as follows:
-
-    $ bin/behat -dl
-    Given /^(?:that I|I) am at "(?P[^"]*)"$/
-     When /^I visit "(?P[^"]*)"$/
-     When /^I click "(?P<link>[^"]*)"$/
-    Given /^for "(?P<field>[^"]*)" I enter "(?P<value>[^"]*)"$/
-    Given /^I enter "(?P<value>[^"]*)" for "(?P<field>[^"]*)"$/
-     When /^I press the "(?P<button>[^"]*)" button$/
-     Then /^I should see the link "(?P<link>[^"]*)"$/
-     Then /^I should not see the link "(?P<link>[^"]*)"$/
-     Then /^I (?:|should )see the heading "(?P<heading>[^"]*)"$/
-     Then /^I (?:|should )not see the heading "(?P<heading>[^"]*)"$/
-     Then /^I should see the heading "(?P<heading>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-     Then /^I should see the "(?P<heading>[^"]*)" heading in the "(?P<region>[^"]*)"(?:| region)$/
-     When /^I (?:follow|click) "(?P<link>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-     Then /^I should see the link "(?P<link>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-     Then /^I should not see the link "(?P<link>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-     Then /^I should see (?:the text |)"(?P<text>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-     Then /^I should not see (?:the text |)"(?P<text>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-    Given /^I press "(?P<button>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
-    Given /^(?:|I )fill in "(?P<value>(?:[^"]|\\")*)" for "(?P<field>(?:[^"]|\\")*)" in the "(?P<region>[^"]*)"(?:| region)$/
-    Given /^(?:|I )fill in "(?P<field>(?:[^"]|\\")*)" with "(?P<value>(?:[^"]|\\")*)" in the "(?P<region>[^"]*)"(?:| region)$/
-     Then /^(?:I|I should) see the text "(?P<text>[^"]*)"$/
-     Then /^I should not see the text "(?P<text>[^"]*)"$/
-     Then /^I should get a "(?P<code>[^"]*)" HTTP response$/
-     Then /^I should not get a "(?P<code>[^"]*)" HTTP response$/
-    Given /^I check the box "(?P<checkbox>[^"]*)"$/
-    Given /^I uncheck the box "(?P<checkbox>[^"]*)"$/
-     When /^I select the radio button "(?P<label>[^"]*)" with the id "(?P<id>[^"]*)"$/
-     When /^I select the radio button "(?P<label>[^"]*)"$/
-    Given /^I am an anonymous user$/
-    Given /^I am not logged in$/
-    Given /^I am logged in as a user with the "(?P<role>[^"]*)" role$/
-    Given /^I click "(?P<link>[^"]*)" in the "(?P<row_text>[^"]*)" row$/
-    Given /^the cache has been cleared$/
-    Given /^I run cron$/
-    Given /^I am viewing (?:a|an) "(?P<type>[^"]*)" node with the title "(?P<title>[^"]*)"$/
-    Given /^(?:a|an) "(?P<type>[^"]*)" node with the title "(?P<title>[^"]*)"$/
-    Given /^I am viewing my "(?P<type>[^"]*)" node with the title "(?P<title>[^"]*)"$/
-    Given /^"(?P<type>[^"]*)" nodes:$/
-    Given /^I am viewing (?:a|an) "(?P<vocabulary>[^"]*)" term with the name "(?P<name>[^"]*)"$/
-    Given /^(?:a|an) "(?P<vocabulary>[^"]*)" term with the name "(?P<name>[^"]*)"$/
-    Given /^users:$/
-    Given /^"(?P<vocabulary>[^"]*)" terms:$/
-     Then /^I should see the error message(?:| containing) "([^"]*)"$/
-     Then /^I should see the following <error messages>$/
-    Given /^I should not see the error message(?:| containing) "([^"]*)"$/
-     Then /^I should not see the following <error messages>$/
-     Then /^I should see the success message(?:| containing) "([^"]*)"$/
-     Then /^I should see the following <success messages>$/
-    Given /^I should not see the success message(?:| containing) "([^"]*)"$/
-     Then /^I should not see the following <success messages>$/
-     Then /^I should see the message(?:| containing) "([^"]*)"$/
-     Then /^I should not see the message(?:| containing) "([^"]*)"$/
-     Then /^(?:|I )break$/
-    Given /^(?:|I )am on (?:|the )homepage$/
-     When /^(?:|I )go to (?:|the )homepage$/
-    Given /^(?:|I )am on "(?P<page>[^"]+)"$/
-     When /^(?:|I )go to "(?P<page>[^"]+)"$/
-     When /^(?:|I )reload the page$/
-     When /^(?:|I )move backward one page$/
-     When /^(?:|I )move forward one page$/
-     When /^(?:|I )press "(?P<button>(?:[^"]|\\")*)"$/
-     When /^(?:|I )follow "(?P<link>(?:[^"]|\\")*)"$/
-     When /^(?:|I )fill in "(?P<field>(?:[^"]|\\")*)" with "(?P<value>(?:[^"]|\\")*)"$/
-     When /^(?:|I )fill in "(?P<field>(?:[^"]|\\")*)" with:$/
-     When /^(?:|I )fill in "(?P<value>(?:[^"]|\\")*)" for "(?P<field>(?:[^"]|\\")*)"$/
-     When /^(?:|I )fill in the following:$/
-     When /^(?:|I )select "(?P<option>(?:[^"]|\\")*)" from "(?P<select>(?:[^"]|\\")*)"$/
-     When /^(?:|I )additionally select "(?P<option>(?:[^"]|\\")*)" from "(?P<select>(?:[^"]|\\")*)"$/
-     When /^(?:|I )check "(?P<option>(?:[^"]|\\")*)"$/
-     When /^(?:|I )uncheck "(?P<option>(?:[^"]|\\")*)"$/
-     When /^(?:|I )attach the file "(?P[^"]*)" to "(?P<field>(?:[^"]|\\")*)"$/
-     Then /^(?:|I )should be on "(?P<page>[^"]+)"$/
-     Then /^(?:|I )should be on (?:|the )homepage$/
-     Then /^the (?i)url(?-i) should match (?P<pattern>"([^"]|\\")*")$/
-     Then /^the response status code should be (?P<code>\d+)$/
-     Then /^the response status code should not be (?P<code>\d+)$/
-     Then /^(?:|I )should see "(?P<text>(?:[^"]|\\")*)"$/
-     Then /^(?:|I )should not see "(?P<text>(?:[^"]|\\")*)"$/
-     Then /^(?:|I )should see text matching (?P<pattern>"(?:[^"]|\\")*")$/
-     Then /^(?:|I )should not see text matching (?P<pattern>"(?:[^"]|\\")*")$/
-     Then /^the response should contain "(?P<text>(?:[^"]|\\")*)"$/
-     Then /^the response should not contain "(?P<text>(?:[^"]|\\")*)"$/
-     Then /^(?:|I )should see "(?P<text>(?:[^"]|\\")*)" in the "(?P<element>[^"]*)" element$/
-     Then /^(?:|I )should not see "(?P<text>(?:[^"]|\\")*)" in the "(?P<element>[^"]*)" element$/
-     Then /^the "(?P<element>[^"]*)" element should contain "(?P<value>(?:[^"]|\\")*)"$/
-     Then /^the "(?P<element>[^"]*)" element should not contain "(?P<value>(?:[^"]|\\")*)"$/
-     Then /^(?:|I )should see an? "(?P<element>[^"]*)" element$/
-     Then /^(?:|I )should not see an? "(?P<element>[^"]*)" element$/
-     Then /^the "(?P<field>(?:[^"]|\\")*)" field should contain "(?P<value>(?:[^"]|\\")*)"$/
-     Then /^the "(?P<field>(?:[^"]|\\")*)" field should not contain "(?P<value>(?:[^"]|\\")*)"$/
-     Then /^the "(?P<checkbox>(?:[^"]|\\")*)" checkbox should be checked$/
-     Then /^the checkbox "(?P<checkbox>(?:[^"]|\\")*)" (?:is|should be) checked$/
-     Then /^the "(?P<checkbox>(?:[^"]|\\")*)" checkbox should not be checked$/
-     Then /^the checkbox "(?P<checkbox>(?:[^"]|\\")*)" should (?:be unchecked|not be checked)$/
-     Then /^the checkbox "(?P<checkbox>(?:[^"]|\\")*)" is (?:unchecked|not checked)$/
-     Then /^(?:|I )should see (?P<num>\d+) "(?P<element>[^"]*)" elements?$/
-     Then /^print current URL$/
-     Then /^print last response$/
-     Then /^show last response$/
-
-## Writing new tests
-
-
-For information about how to write tests, I'd suggest looking at the official [behat documentation](http://docs.behat.org/quick_intro.html#define-your-feature).
-One small piece of information: When you tag a scenario with @javascript, it will be executed in Firefox/Selenium2 rather than using the default "headless" goute driver.
\ No newline at end of file
diff --git a/tests/behat.yml b/tests/behat.yml
deleted file mode 100644
index 462c643..0000000
--- a/tests/behat.yml
+++ /dev/null
@@ -1,12 +0,0 @@
-default:
-  paths:
-    features: 'features'
-  extensions:
-    Behat\MinkExtension\Extension:
-      goutte: ~
-      selenium2: ~
-      base_url: http://localhost/
-      default_session: 'goutte'
-      javascript_session: 'selenium2'
-    Drupal\DrupalExtension\Extension:
-      blackbox: ~
\ No newline at end of file
diff --git a/tests/behat/.gitignore b/tests/behat/.gitignore
new file mode 100644
index 0000000..d71a47f
--- /dev/null
+++ b/tests/behat/.gitignore
@@ -0,0 +1,5 @@
+behat.yml
+composer.lock
+composer.phar
+bin
+vendor
diff --git a/tests/behat/README.txt b/tests/behat/README.txt
new file mode 100644
index 0000000..f786af0
--- /dev/null
+++ b/tests/behat/README.txt
@@ -0,0 +1,22 @@
+Behat tests
+===========
+
+Setup
+-----
+
+ 1. Install Composer
+
+    php -r "eval('?>'.file_get_contents('https://getcomposer.org/installer'));"
+ 
+ 2. Install Behat and dependencies via Composer
+
+    php composer.phar install
+
+ 3. Copy behat.yml.example to behat.yml and modify
+
+    mv behat.template.yml behat.yml
+ 
+ 4. Run Behat and examine test results!
+ 
+    bin/behat
+
diff --git a/tests/behat/behat.template.yml b/tests/behat/behat.template.yml
new file mode 100644
index 0000000..4c8afb7
--- /dev/null
+++ b/tests/behat/behat.template.yml
@@ -0,0 +1,13 @@
+default:
+  paths:
+    features: 'features'
+  extensions:
+    Behat\MinkExtension\Extension:
+      goutte: ~
+      selenium2: ~
+      base_url: http://${drupal.uri}
+      files_path: ../../
+    Drupal\DrupalExtension\Extension:
+      blackbox: ~
+      drush:
+        root: ${drush.root}
diff --git a/tests/behat/behat.travis.yml b/tests/behat/behat.travis.yml
new file mode 100644
index 0000000..9f1c9da
--- /dev/null
+++ b/tests/behat/behat.travis.yml
@@ -0,0 +1,29 @@
+default:
+  paths:
+    features: 'features'
+  filters:
+    tags: "~@chrome"
+  extensions:
+    Behat\MinkExtension\Extension:
+      goutte: ~
+      selenium2: ~
+      base_url: http://127.0.0.1:8888
+      files_path: ../../
+    Drupal\DrupalExtension\Extension:
+      blackbox: ~
+      drush:
+        alias: self
+      # This will be setup by .travis.yml like so:
+      # export BEHAT_PARAMS="extensions[Drupal\\DrupalExtension\\Extension][drupal][drupal_root]=$DRUPAL_ROOT"
+      #drupal:
+      #  drupal_root: "/path/to/drupal/root"
+
+# Setup for Google Chrome only tests.
+chrome:
+  filters:
+    tags: "@chrome"
+  extensions:
+    Behat\MinkExtension\Extension:
+      selenium2:
+        browser: chrome
+        capabilities: {"browser": "chrome", "browserName": "chrome", "browserVersion": "ANY", "version": "ANY"}
diff --git a/tests/behat/composer.json b/tests/behat/composer.json
new file mode 100644
index 0000000..5bf9093
--- /dev/null
+++ b/tests/behat/composer.json
@@ -0,0 +1,20 @@
+{
+  "require": {
+    "drupal/drupal-extension": "*",
+
+    "symfony/css-selector": "2.4.2",
+    "symfony/finder": "2.4.2",
+    "symfony/yaml": "2.4.2",
+    "symfony/translation": "2.4.2",
+    "symfony/event-dispatcher": "2.4.2",
+    "symfony/filesystem": "2.4.2",
+    "symfony/config": "2.4.2",
+    "symfony/console": "2.4.2",
+    "symfony/process": "2.4.2",
+    "symfony/dom-crawler": "2.4.2",
+    "symfony/browser-kit": "2.4.2"
+  },
+  "config": {
+    "bin-dir": "bin/"
+  }
+}
diff --git a/tests/behat/features/bootstrap/FeatureContext.php b/tests/behat/features/bootstrap/FeatureContext.php
new file mode 100644
index 0000000..2e36560
--- /dev/null
+++ b/tests/behat/features/bootstrap/FeatureContext.php
@@ -0,0 +1,268 @@
+<?php
+
+use Behat\Behat\Context\ClosuredContextInterface,
+    Behat\Behat\Context\TranslatedContextInterface,
+    Behat\Behat\Context\BehatContext,
+    Behat\Behat\Event\StepEvent,
+    Behat\Behat\Exception\PendingException;
+use Behat\Gherkin\Node\PyStringNode,
+    Behat\Gherkin\Node\TableNode;
+use Drupal\DrupalExtension\Context\DrupalContext;
+use Drupal\Component\Utility\Random;
+
+//
+// Require 3rd-party libraries here:
+//
+//   require_once 'PHPUnit/Autoload.php';
+//   require_once 'PHPUnit/Framework/Assert/Functions.php';
+//
+
+/**
+ * Features context.
+ */
+class FeatureContext extends DrupalContext
+{
+  /**
+   * Initializes context.
+   * Every scenario gets it's own context object.
+   *
+   * @param array $parameters context parameters (set them up through behat.yml)
+   */
+  public function __construct(array $parameters) {
+    // Initialize your context here
+  }
+
+//
+// Place your definition and hook methods here:
+//
+//    /**
+//     * @Given /^I have done something with "([^"]*)"$/
+//     */
+//    public function iHaveDoneSomethingWith($argument)
+//    {
+//        doSomethingWith($argument);
+//    }
+//
+
+  /**
+   * @Given /^I switch to the frame "([^"]*)"$/
+   */
+  public function iSwitchToTheFrame($frame) {
+    $this->getSession()->switchToIFrame($frame);
+  }
+
+  /**
+   * @Given /^I switch out of all frames$/
+   */
+  public function iSwitchOutOfAllFrames() {
+    $this->getSession()->switchToIFrame();
+  }
+
+  /**
+   * @Then /^I should see the "([^"]*)" button$/
+   */
+  public function assertButton($label) {
+    $page = $this->getSession()->getPage();
+    $results = $page->findAll('css', "input[type=submit],input[type=button],button");
+    if (!empty($results)) {
+      foreach ($results as $result) {
+        if ($result->getTagName() == 'input' && $result->getAttribute('value') == $label) {
+          return;
+        }
+        elseif ($result->getText() == $label) {
+          return;
+        }
+      }
+    }
+    throw new \Exception(sprintf('The "%s" button was not found on the page %s', $label, $region, $this->getSession()->getCurrentUrl()));
+  }
+
+  /**
+   * @Then /^I should see the "([^"]*)" button in the "([^"]*)" region$/
+   */
+  public function assertRegionButton($label, $region) {
+    $regionObj = $this->getRegion($region);
+    $results = $regionObj->findAll('css', "input[type=submit],input[type=button],button");
+    if (!empty($results)) {
+      foreach ($results as $result) {
+        if ($result->getTagName() == 'input' && $result->getAttribute('value') == $label) {
+          return;
+        }
+        elseif ($result->getText() == $label) {
+          return;
+        }
+      }
+    }
+    throw new \Exception(sprintf('The "%s" button was not found in the "%s" region on the page %s', $label, $region, $this->getSession()->getCurrentUrl()));
+  }
+
+  /**
+   * @Then /^I should see the "([^"]*)" element in the "([^"]*)" region$/
+   */
+  public function assertRegionElement($tag, $region) {
+    $regionObj = $this->getRegion($region);
+    $elements = $regionObj->findAll('css', $tag);
+    if (!empty($elements)) {
+      return;
+    }
+    throw new \Exception(sprintf('The element "%s" was not found in the "%s" region on the page %s', $tag, $region, $this->getSession()->getCurrentUrl()));
+  }
+
+  /**
+   * @Then /^I should not see the "([^"]*)" element in the "([^"]*)" region$/
+   */
+  public function assertNotRegionElement($tag, $region) {
+    $regionObj = $this->getRegion($region);
+    $result = $regionObj->findAll('css', $tag);
+    if (!empty($result)) {
+      throw new \Exception(sprintf('Element "%s" was found in the "%s" region on the page %s', $tag, $region, $this->getSession()->getCurrentUrl()));
+    }
+  }
+
+  /**
+   * @Then /^I should see "([^"]*)" in the "([^"]*)" element in the "([^"]*)" region$/
+   */
+  public function assertRegionElementText($text, $tag, $region) {
+    $regionObj = $this->getRegion($region);
+    $results = $regionObj->findAll('css', $tag);
+    if (!empty($results)) {
+      foreach ($results as $result) {
+        if ($result->getText() == $text) {
+          return;
+        }
+      }
+    }
+    throw new \Exception(sprintf('The text "%s" was not found in the "%s" element in the "%s" region on the page %s', $text, $tag, $region, $this->getSession()->getCurrentUrl()));
+  }
+
+  /**
+   * @Then /^I should see "([^"]*)" in the "([^"]*)" element with the "([^"]*)" CSS property set to "([^"]*)" in the "([^"]*)" region$/
+   */
+  public function assertRegionElementTextCss($text, $tag, $property, $value, $region) {
+    $regionObj = $this->getRegion($region);
+    $elements = $regionObj->findAll('css', $tag);
+    if (empty($elements)) {
+      throw new \Exception(sprintf('The element "%s" was not found in the "%s" region on the page %s', $tag, $region, $this->getSession()->getCurrentUrl()));
+    }
+
+    $found = FALSE;
+    foreach ($elements as $element) {
+      if ($element->getText() == $text) {
+        $found = TRUE;
+        break;
+      }
+    }
+    if (!$found) {
+      throw new \Exception(sprintf('The text "%s" was not found in the "%s" element in the "%s" region on the page %s', $text, $tag, $region, $this->getSession()->getCurrentUrl()));
+    }
+
+    if (!empty($property)) {
+      $style = $element->getAttribute('style');
+      if (strpos($style, "$property: $value") === FALSE) {
+        throw new \Exception(sprintf('The "%s" property does not equal "%s" on the element "%s" in the "%s" region on the page %s', $property, $value, $tag, $region, $this->getSession()->getCurrentUrl()));
+      }
+    }
+  }
+
+  /**
+   * @Then /^I should not see "([^"]*)" in the "([^"]*)" element in the "([^"]*)" region$/
+   */
+  public function assertNotRegionElementText($text, $tag, $region) {
+    $regionObj = $this->getRegion($region);
+    $results = $regionObj->findAll('css', $tag);
+    if (!empty($results)) {
+      foreach ($results as $result) {
+        if ($result->getText() == $text) {
+          throw new \Exception(sprintf('The text "%s" was found in the "%s" element in the "%s" region on the page %s', $text, $tag, $region, $this->getSession()->getCurrentUrl()));
+        }
+      }
+    }
+  }
+
+  /**
+   * @Then /^I should see the image alt "(?P<link>[^"]*)" in the "(?P<region>[^"]*)"(?:| region)$/
+   */
+  public function assertAltRegion($alt, $region) {
+    $regionObj = $this->getRegion($region);
+    $element = $regionObj->find('css', 'img');
+    $tmp = $element->getAttribute('alt');
+    if ($alt == $tmp) {
+      $result = $alt;
+    }
+    if (empty($result)) {
+      throw new \Exception(sprintf('No alt text matching "%s" in the "%s" region on the page %s', $alt, $region, $this->getSession()->getCurrentUrl()));
+    }
+  }
+
+  /**
+   * @AfterStep @javascript
+   *
+   * After every step in a @javascript scenario, we want to wait for AJAX
+   * loading to finish.
+   */
+  public function afterStep(StepEvent $event) {
+    if ($event->getResult() === 0) {
+      $this->iWaitForAJAX();
+    }
+  }
+
+  /**
+   * @Given /^(?:|I )wait(?:| for) (\d+) seconds?$/
+   *
+   * Wait for the given number of seconds. ONLY USE FOR DEBUGGING!
+   */
+  public function iWaitForSeconds($arg1) {
+    sleep($arg1);
+  }
+
+  /**
+   * @Given /^(?:|I )wait for AJAX loading to finish$/
+   *
+   * Wait for the jQuery AJAX loading to finish. ONLY USE FOR DEBUGGING!
+   */
+  public function iWaitForAJAX() {
+    $this->getSession()->wait(5000, 'jQuery != undefined && jQuery.active === 0');
+  }
+
+  /**
+   * Override MinkContext::fixStepArgument().
+   *
+   * Make it possible to use [random].
+   * If you want to use the previous random value [random:1].
+   */
+  protected function fixStepArgument($argument) {
+    $argument = str_replace('\\"', '"', $argument);
+
+    // Token replace the argument.
+    static $random = array();
+    for ($start = 0; ($start = strpos($argument, '[', $start)) !== FALSE; ) {
+      $end = strpos($argument, ']', $start);
+      if ($end === FALSE) {
+        break;
+      }
+      $name = substr($argument, $start + 1, $end - $start - 1);
+      if ($name == 'random') {
+        $this->vars[$name] = Random::name(8);
+        $random[] = $this->vars[$name];
+      }
+      // In order to test previous random values stored in the form,
+      // suppport random:n, where n is the number or random's ago
+      // to use, i.e., random:1 is the previous random value.
+      elseif (substr($name, 0, 7) == 'random:') {
+        $num = substr($name, 7);
+        if (is_numeric($num) && $num <= count($random)) {
+          $this->vars[$name] = $random[count($random) - $num];
+        }
+      }
+      if (isset($this->vars[$name])) {
+        $argument = substr_replace($argument, $this->vars[$name], $start, $end - $start + 1);
+        $start += strlen($this->vars[$name]);
+      }
+      else {
+        $start = $end + 1;
+      }
+    }
+
+    return $argument;
+  }
+}
diff --git a/tests/behat/features/general.feature b/tests/behat/features/general.feature
new file mode 100644
index 0000000..2bfbeb1
--- /dev/null
+++ b/tests/behat/features/general.feature
@@ -0,0 +1,21 @@
+Feature: General functionality
+  Scenario: Anonymous users cannot create content
+    Given I am on "/node/add"
+    Then I should see "Access denied. You must log in to view this page."
+      And I should not see "Add content"
+
+  Scenario: Anonymous users cannot create groups
+    Given I am on "/groups"
+    Then I should not see "Create a group"
+
+  Scenario: Anonymous users cannot create events
+    Given I am on "/events"
+    Then I should not see "List an event"
+
+  Scenario: Anonymous users can view user profiles
+    Given I am on "/user/1"
+    Then I should see "admin"
+
+  Scenario: Anonymous users can see the Commons footer
+    Given I am on "/"
+    Then I should see "A Commons Community, powered by Acquia"
diff --git a/tests/behat/features/login.feature b/tests/behat/features/login.feature
new file mode 100644
index 0000000..e6b9461
--- /dev/null
+++ b/tests/behat/features/login.feature
@@ -0,0 +1,15 @@
+Feature: Anonymous user login
+  Scenario: Admin user is able to login
+    Given I am on "/user"
+    When I fill in "admin" for "edit-name"
+      And I fill in "admin" for "edit-pass"
+      And I press "Log in"
+    Then I should see "Logout"
+
+  Scenario: User can request a new password if it has been lost
+    Given I am on "/user/password"
+    Then I should see "Request new password"
+    When I fill in "admin" for "edit-name"
+      And press "E-mail new password"
+    Then I should see "Further instructions have been sent to your e-mail address."
+      And I should see "Log in"
diff --git a/tests/bin/behat b/tests/bin/behat
deleted file mode 120000
index ec35dd9..0000000
--- a/tests/bin/behat
+++ /dev/null
@@ -1 +0,0 @@
-../vendor/behat/behat/bin/behat
\ No newline at end of file
diff --git a/tests/composer.json b/tests/composer.json
deleted file mode 100644
index 6ec192b..0000000
--- a/tests/composer.json
+++ /dev/null
@@ -1,9 +0,0 @@
-{
-  "require": {
-    "drupal/drupal-extension": "*"
-  },
-  "minimum-stability": "dev",
-  "config": {
-    "bin-dir": "bin/"
-  }
-}
diff --git a/tests/composer.lock b/tests/composer.lock
deleted file mode 100644
index 594d406..0000000
--- a/tests/composer.lock
+++ /dev/null
@@ -1,1388 +0,0 @@
-{
-    "_readme": [
-        "This file locks the dependencies of your project to a known state",
-        "Read more about it at http://getcomposer.org/doc/01-basic-usage.md#composer-lock-the-lock-file"
-    ],
-    "hash": "18ee939ac7bfb3e86dbca8caf6ba65f8",
-    "packages": [
-        {
-            "name": "behat/behat",
-            "version": "dev-develop",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/Behat.git",
-                "reference": "64052d951cfb21d75b0d34f5ccf79d5ac0adfc92"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/Behat/zipball/64052d951cfb21d75b0d34f5ccf79d5ac0adfc92",
-                "reference": "64052d951cfb21d75b0d34f5ccf79d5ac0adfc92",
-                "shasum": ""
-            },
-            "require": {
-                "behat/gherkin": "~2.2.9",
-                "php": ">=5.3.1",
-                "symfony/config": "~2.0",
-                "symfony/console": "~2.0",
-                "symfony/dependency-injection": "~2.0",
-                "symfony/event-dispatcher": "~2.0",
-                "symfony/finder": "~2.0",
-                "symfony/translation": "~2.0",
-                "symfony/yaml": "~2.0"
-            },
-            "require-dev": {
-                "phpunit/phpunit": "~3.7.19"
-            },
-            "suggest": {
-                "behat/mink-extension": "for integration with Mink testing framework",
-                "behat/symfony2-extension": "for integration with Symfony2 web framework",
-                "behat/yii-extension": "for integration with Yii web framework"
-            },
-            "bin": [
-                "bin/behat"
-            ],
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-develop": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\Behat": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                }
-            ],
-            "description": "Scenario-oriented BDD framework for PHP 5.3",
-            "homepage": "http://behat.org/",
-            "keywords": [
-                "BDD",
-                "Behat",
-                "Symfony2"
-            ],
-            "time": "2013-07-01 09:38:54"
-        },
-        {
-            "name": "behat/gherkin",
-            "version": "dev-develop",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/Gherkin.git",
-                "reference": "c1f7d89e7e609e45fe40a8a8774f3e43cbe4ffcb"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/Gherkin/zipball/c1f7d89e7e609e45fe40a8a8774f3e43cbe4ffcb",
-                "reference": "c1f7d89e7e609e45fe40a8a8774f3e43cbe4ffcb",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.1",
-                "symfony/finder": "~2.0"
-            },
-            "require-dev": {
-                "symfony/config": "~2.0",
-                "symfony/translation": "~2.0",
-                "symfony/yaml": "~2.0"
-            },
-            "suggest": {
-                "symfony/config": "If you want to use Config component to manage resources",
-                "symfony/translation": "If you want to use Symfony2 translations adapter",
-                "symfony/yaml": "If you want to parse features, represented in YAML files"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-develop": "2.2-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\Gherkin": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                }
-            ],
-            "description": "Gherkin DSL parser for PHP 5.3",
-            "homepage": "http://behat.org/",
-            "keywords": [
-                "BDD",
-                "Behat",
-                "DSL",
-                "Symfony2",
-                "parser"
-            ],
-            "time": "2013-05-09 15:20:54"
-        },
-        {
-            "name": "behat/mink",
-            "version": "v1.4.3",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/Mink.git",
-                "reference": "v1.4.3"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/Mink/zipball/v1.4.3",
-                "reference": "v1.4.3",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.1",
-                "symfony/css-selector": ">=2.0,<2.4-dev"
-            },
-            "suggest": {
-                "behat/mink-browserkit-driver": "extremely fast headless driver for Symfony\\Kernel-based apps (Sf2, Silex)",
-                "behat/mink-goutte-driver": "fast headless driver for any app without JS emulation",
-                "behat/mink-selenium2-driver": "slow, but JS-enabled driver for any app (requires Selenium2)",
-                "behat/mink-zombie-driver": "fast and JS-enabled headless driver for any app (requires node.js)"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-develop": "1.4.x-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\Mink": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                }
-            ],
-            "description": "Web acceptance testing framework for PHP 5.3",
-            "homepage": "http://mink.behat.org/",
-            "keywords": [
-                "browser",
-                "testing",
-                "web"
-            ],
-            "time": "2013-03-02 15:53:18"
-        },
-        {
-            "name": "behat/mink-browserkit-driver",
-            "version": "v1.0.5",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/MinkBrowserKitDriver.git",
-                "reference": "v1.0.5"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/MinkBrowserKitDriver/zipball/v1.0.5",
-                "reference": "v1.0.5",
-                "shasum": ""
-            },
-            "require": {
-                "behat/mink": ">=1.4.3,<1.5",
-                "php": ">=5.3.1",
-                "symfony/browser-kit": ">=2.0,<3.0",
-                "symfony/dom-crawler": ">=2.0,<3.0"
-            },
-            "require-dev": {
-                "silex/silex": "@dev"
-            },
-            "type": "mink-driver",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "1.0.x-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\Mink\\Driver": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                }
-            ],
-            "description": "Symfony2 BrowserKit driver for Mink framework",
-            "homepage": "http://mink.behat.org/",
-            "keywords": [
-                "Mink",
-                "Symfony2",
-                "browser",
-                "testing"
-            ],
-            "time": "2013-04-13 12:17:15"
-        },
-        {
-            "name": "behat/mink-extension",
-            "version": "dev-master",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/MinkExtension.git",
-                "reference": "6ed67ce283cd5ee882fefefd9358a670a13d404c"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/MinkExtension/zipball/6ed67ce283cd5ee882fefefd9358a670a13d404c",
-                "reference": "6ed67ce283cd5ee882fefefd9358a670a13d404c",
-                "shasum": ""
-            },
-            "require": {
-                "behat/behat": "~2.4.5",
-                "behat/mink": ">=1.4.3,<1.6-dev",
-                "php": ">=5.3.2"
-            },
-            "require-dev": {
-                "behat/mink-goutte-driver": "~1.0"
-            },
-            "type": "behat-extension",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "1.1.x-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\MinkExtension": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                }
-            ],
-            "description": "Mink extension for Behat",
-            "homepage": "http://mink.behat.org",
-            "keywords": [
-                "browser",
-                "gui",
-                "test",
-                "web"
-            ],
-            "time": "2013-06-04 17:35:37"
-        },
-        {
-            "name": "behat/mink-goutte-driver",
-            "version": "dev-master",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/MinkGoutteDriver.git",
-                "reference": "fa1b073b48761464feb0b05e6825da44b20118d8"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/MinkGoutteDriver/zipball/fa1b073b48761464feb0b05e6825da44b20118d8",
-                "reference": "fa1b073b48761464feb0b05e6825da44b20118d8",
-                "shasum": ""
-            },
-            "require": {
-                "behat/mink-browserkit-driver": ">=1.0.5,<1.2.0",
-                "fabpot/goutte": "~1.0.1",
-                "php": ">=5.3.1"
-            },
-            "type": "mink-driver",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "1.0.x-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\Mink\\Driver": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                }
-            ],
-            "description": "Goutte driver for Mink framework",
-            "homepage": "http://mink.behat.org/",
-            "keywords": [
-                "browser",
-                "goutte",
-                "headless",
-                "testing"
-            ],
-            "time": "2013-07-03 18:43:54"
-        },
-        {
-            "name": "behat/mink-selenium2-driver",
-            "version": "v1.0.6",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/Behat/MinkSelenium2Driver.git",
-                "reference": "v1.0.6"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/Behat/MinkSelenium2Driver/zipball/v1.0.6",
-                "reference": "v1.0.6",
-                "shasum": ""
-            },
-            "require": {
-                "behat/mink": ">=1.4.3,<1.5",
-                "instaclick/php-webdriver": ">=1.0.12.0,<1.1",
-                "php": ">=5.3.1"
-            },
-            "type": "mink-driver",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "1.0.x-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Behat\\Mink\\Driver": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Konstantin Kudryashov",
-                    "email": "ever.zet@gmail.com",
-                    "homepage": "http://everzet.com"
-                },
-                {
-                    "name": "Pete Otaqui",
-                    "email": "pete@otaqui.com",
-                    "homepage": "https://github.com/pete-otaqui"
-                }
-            ],
-            "description": "Selenium2 (WebDriver) driver for Mink framework",
-            "homepage": "http://mink.behat.org/",
-            "keywords": [
-                "ajax",
-                "browser",
-                "javascript",
-                "selenium",
-                "testing",
-                "webdriver"
-            ],
-            "time": "2013-04-13 12:56:28"
-        },
-        {
-            "name": "drupal/drupal-extension",
-            "version": "dev-master",
-            "source": {
-                "type": "git",
-                "url": "http://git.drupal.org/project/drupalextension.git",
-                "reference": "d10ef64876174b80d1a9b8bae4c1be22c27a2312"
-            },
-            "require": {
-                "behat/behat": ">=2.4.3, <2.5.0",
-                "behat/mink": ">=1.4.0, <1.5.0",
-                "behat/mink-extension": "*",
-                "behat/mink-goutte-driver": "*",
-                "behat/mink-selenium2-driver": "*"
-            },
-            "require-dev": {
-                "phpunit/phpunit": "3.7.*"
-            },
-            "type": "behat-extension",
-            "autoload": {
-                "psr-0": {
-                    "Drupal\\Driver": "src/",
-                    "Drupal\\Drupal": "src/",
-                    "Drupal\\Exception": "src/",
-                    "Drupal\\DrupalExtension": "src/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "GPL-2.0+"
-            ],
-            "description": "Drupal extension for Behat",
-            "homepage": "http://drupal.org/project/drupalextension",
-            "keywords": [
-                "drupal",
-                "test",
-                "web"
-            ],
-            "time": "2013-06-28 23:20:02"
-        },
-        {
-            "name": "fabpot/goutte",
-            "version": "dev-master",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/fabpot/Goutte.git",
-                "reference": "2f5104765152d51b501de452a83153ac0b1492df"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/fabpot/Goutte/zipball/2f5104765152d51b501de452a83153ac0b1492df",
-                "reference": "2f5104765152d51b501de452a83153ac0b1492df",
-                "shasum": ""
-            },
-            "require": {
-                "ext-curl": "*",
-                "guzzle/http": ">=3.0.5,<3.7-dev",
-                "php": ">=5.3.0",
-                "symfony/browser-kit": "~2.1",
-                "symfony/css-selector": "~2.1",
-                "symfony/dom-crawler": "~2.1",
-                "symfony/finder": "~2.1",
-                "symfony/process": "~2.1"
-            },
-            "require-dev": {
-                "guzzle/plugin-history": ">=3.0.5,<3.7-dev",
-                "guzzle/plugin-mock": ">=3.0.5,<3.7-dev"
-            },
-            "type": "application",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "1.0-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Goutte": "."
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                }
-            ],
-            "description": "A simple PHP Web Scraper",
-            "homepage": "https://github.com/fabpot/Goutte",
-            "keywords": [
-                "scraper"
-            ],
-            "time": "2013-07-02 07:48:02"
-        },
-        {
-            "name": "guzzle/common",
-            "version": "v3.6.0",
-            "target-dir": "Guzzle/Common",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/guzzle/common.git",
-                "reference": "v3.6.0"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/guzzle/common/zipball/v3.6.0",
-                "reference": "v3.6.0",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.2",
-                "symfony/event-dispatcher": ">=2.1"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "3.6-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Guzzle\\Common": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "description": "Common libraries used by Guzzle",
-            "homepage": "http://guzzlephp.org/",
-            "keywords": [
-                "collection",
-                "common",
-                "event",
-                "exception"
-            ],
-            "time": "2013-05-30 07:01:25"
-        },
-        {
-            "name": "guzzle/http",
-            "version": "v3.6.0",
-            "target-dir": "Guzzle/Http",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/guzzle/http.git",
-                "reference": "v3.6.0"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/guzzle/http/zipball/v3.6.0",
-                "reference": "v3.6.0",
-                "shasum": ""
-            },
-            "require": {
-                "guzzle/common": "self.version",
-                "guzzle/parser": "self.version",
-                "guzzle/stream": "self.version",
-                "php": ">=5.3.2"
-            },
-            "suggest": {
-                "ext-curl": "*"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "3.6-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Guzzle\\Http": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Michael Dowling",
-                    "email": "mtdowling@gmail.com",
-                    "homepage": "https://github.com/mtdowling"
-                }
-            ],
-            "description": "HTTP libraries used by Guzzle",
-            "homepage": "http://guzzlephp.org/",
-            "keywords": [
-                "Guzzle",
-                "client",
-                "curl",
-                "http",
-                "http client"
-            ],
-            "time": "2013-05-30 07:01:25"
-        },
-        {
-            "name": "guzzle/parser",
-            "version": "v3.6.0",
-            "target-dir": "Guzzle/Parser",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/guzzle/parser.git",
-                "reference": "v3.6.0"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/guzzle/parser/zipball/v3.6.0",
-                "reference": "v3.6.0",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.2"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "3.6-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Guzzle\\Parser": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "description": "Interchangeable parsers used by Guzzle",
-            "homepage": "http://guzzlephp.org/",
-            "keywords": [
-                "URI Template",
-                "cookie",
-                "http",
-                "message",
-                "url"
-            ],
-            "time": "2013-05-30 07:01:25"
-        },
-        {
-            "name": "guzzle/stream",
-            "version": "v3.6.0",
-            "target-dir": "Guzzle/Stream",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/guzzle/stream.git",
-                "reference": "v3.6.0"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/guzzle/stream/zipball/v3.6.0",
-                "reference": "v3.6.0",
-                "shasum": ""
-            },
-            "require": {
-                "guzzle/common": "self.version",
-                "php": ">=5.3.2"
-            },
-            "suggest": {
-                "guzzle/http": "To convert Guzzle request objects to PHP streams"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "3.6-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Guzzle\\Stream": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Michael Dowling",
-                    "email": "mtdowling@gmail.com",
-                    "homepage": "https://github.com/mtdowling"
-                }
-            ],
-            "description": "Guzzle stream wrapper component",
-            "homepage": "http://guzzlephp.org/",
-            "keywords": [
-                "Guzzle",
-                "component",
-                "stream"
-            ],
-            "time": "2013-05-30 07:01:25"
-        },
-        {
-            "name": "instaclick/php-webdriver",
-            "version": "dev-master",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/instaclick/php-webdriver.git",
-                "reference": "3af07b82598506e765cffdf4cf1385b117cf0a41"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/instaclick/php-webdriver/zipball/3af07b82598506e765cffdf4cf1385b117cf0a41",
-                "reference": "3af07b82598506e765cffdf4cf1385b117cf0a41",
-                "shasum": ""
-            },
-            "require": {
-                "ext-curl": "*",
-                "php": ">=5.3.2"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "1.0.x-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "WebDriver": "lib/"
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "Apache-2.0"
-            ],
-            "authors": [
-                {
-                    "name": "Justin Bishop",
-                    "email": "jubishop@gmail.com",
-                    "role": "Developer"
-                },
-                {
-                    "name": "Anthon Pang",
-                    "email": "apang@softwaredevelopment.ca",
-                    "role": "Fork Maintainer"
-                }
-            ],
-            "description": "PHP WebDriver for Selenium 2",
-            "homepage": "http://instaclick.com/torontotechjobs/",
-            "keywords": [
-                "browser",
-                "selenium",
-                "webdriver",
-                "webtest"
-            ],
-            "time": "2013-06-19 13:54:29"
-        },
-        {
-            "name": "symfony/browser-kit",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/BrowserKit",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/BrowserKit.git",
-                "reference": "2d2343dac844a365bd28a7cefd56b47d09e62dda"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/BrowserKit/zipball/2d2343dac844a365bd28a7cefd56b47d09e62dda",
-                "reference": "2d2343dac844a365bd28a7cefd56b47d09e62dda",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3",
-                "symfony/dom-crawler": "~2.0"
-            },
-            "require-dev": {
-                "symfony/css-selector": "~2.0",
-                "symfony/process": "~2.0"
-            },
-            "suggest": {
-                "symfony/process": ""
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\BrowserKit\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony BrowserKit Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-05-16 07:54:39"
-        },
-        {
-            "name": "symfony/config",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Config",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Config.git",
-                "reference": "51fadec8a95b6b58a8512d5418c96de28dd78d1a"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Config/zipball/51fadec8a95b6b58a8512d5418c96de28dd78d1a",
-                "reference": "51fadec8a95b6b58a8512d5418c96de28dd78d1a",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3",
-                "symfony/filesystem": "~2.3"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Config\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Config Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-19 09:29:07"
-        },
-        {
-            "name": "symfony/console",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Console",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Console.git",
-                "reference": "b68fd0262ebae63f796d188f48eaa470044861fd"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Console/zipball/b68fd0262ebae63f796d188f48eaa470044861fd",
-                "reference": "b68fd0262ebae63f796d188f48eaa470044861fd",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "require-dev": {
-                "symfony/event-dispatcher": "~2.1"
-            },
-            "suggest": {
-                "symfony/event-dispatcher": ""
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Console\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Console Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-23 08:16:33"
-        },
-        {
-            "name": "symfony/css-selector",
-            "version": "2.3.x-dev",
-            "target-dir": "Symfony/Component/CssSelector",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/CssSelector.git",
-                "reference": "e3aa2495604a483b58f318ad6de845b88ec410d6"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/CssSelector/zipball/e3aa2495604a483b58f318ad6de845b88ec410d6",
-                "reference": "e3aa2495604a483b58f318ad6de845b88ec410d6",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.3-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\CssSelector\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                },
-                {
-                    "name": "Jean-FranÃ§ois Simon",
-                    "email": "jeanfrancois.simon@sensiolabs.com"
-                }
-            ],
-            "description": "Symfony CssSelector Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-07-01 12:24:43"
-        },
-        {
-            "name": "symfony/dependency-injection",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/DependencyInjection",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/DependencyInjection.git",
-                "reference": "141017197f2d97cbf91da91a9172b5b3c0eedb82"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/DependencyInjection/zipball/141017197f2d97cbf91da91a9172b5b3c0eedb82",
-                "reference": "141017197f2d97cbf91da91a9172b5b3c0eedb82",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "require-dev": {
-                "symfony/config": "~2.2",
-                "symfony/yaml": "~2.0"
-            },
-            "suggest": {
-                "symfony/config": "",
-                "symfony/proxy-manager-bridge": "Generate service proxies to lazy load them",
-                "symfony/yaml": ""
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\DependencyInjection\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony DependencyInjection Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-23 08:16:33"
-        },
-        {
-            "name": "symfony/dom-crawler",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/DomCrawler",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/DomCrawler.git",
-                "reference": "7689116a186acb47c5fa6f04096ca0cfaa39a7c2"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/DomCrawler/zipball/7689116a186acb47c5fa6f04096ca0cfaa39a7c2",
-                "reference": "7689116a186acb47c5fa6f04096ca0cfaa39a7c2",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "require-dev": {
-                "symfony/css-selector": "~2.0"
-            },
-            "suggest": {
-                "symfony/css-selector": ""
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\DomCrawler\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony DomCrawler Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-23 08:16:33"
-        },
-        {
-            "name": "symfony/event-dispatcher",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/EventDispatcher",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/EventDispatcher.git",
-                "reference": "4b34aad44d0a2d91f301ee967151ce0980f39930"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/EventDispatcher/zipball/4b34aad44d0a2d91f301ee967151ce0980f39930",
-                "reference": "4b34aad44d0a2d91f301ee967151ce0980f39930",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "require-dev": {
-                "symfony/dependency-injection": "~2.0"
-            },
-            "suggest": {
-                "symfony/dependency-injection": "",
-                "symfony/http-kernel": ""
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\EventDispatcher\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony EventDispatcher Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-05-16 07:54:39"
-        },
-        {
-            "name": "symfony/filesystem",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Filesystem",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Filesystem.git",
-                "reference": "7975f9df488adbc9cef2089bac2887f14085481f"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Filesystem/zipball/7975f9df488adbc9cef2089bac2887f14085481f",
-                "reference": "7975f9df488adbc9cef2089bac2887f14085481f",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Filesystem\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Filesystem Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-11 07:15:38"
-        },
-        {
-            "name": "symfony/finder",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Finder",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Finder.git",
-                "reference": "d8da924d4f7d9f325ebd72feefee40c17a3e9104"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Finder/zipball/d8da924d4f7d9f325ebd72feefee40c17a3e9104",
-                "reference": "d8da924d4f7d9f325ebd72feefee40c17a3e9104",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Finder\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Finder Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-23 08:16:33"
-        },
-        {
-            "name": "symfony/process",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Process",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Process.git",
-                "reference": "f3f84fec23ce3ff7d0510c308c7842729cb0ba8c"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Process/zipball/f3f84fec23ce3ff7d0510c308c7842729cb0ba8c",
-                "reference": "f3f84fec23ce3ff7d0510c308c7842729cb0ba8c",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Process\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Process Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-06-23 08:16:33"
-        },
-        {
-            "name": "symfony/translation",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Translation",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Translation.git",
-                "reference": "ed0c7257bfc533205dff78f9d247c2544c830ddc"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Translation/zipball/ed0c7257bfc533205dff78f9d247c2544c830ddc",
-                "reference": "ed0c7257bfc533205dff78f9d247c2544c830ddc",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "require-dev": {
-                "symfony/config": "~2.0",
-                "symfony/yaml": "~2.2"
-            },
-            "suggest": {
-                "symfony/config": "",
-                "symfony/yaml": ""
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Translation\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Translation Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-05-16 07:54:39"
-        },
-        {
-            "name": "symfony/yaml",
-            "version": "dev-master",
-            "target-dir": "Symfony/Component/Yaml",
-            "source": {
-                "type": "git",
-                "url": "https://github.com/symfony/Yaml.git",
-                "reference": "82100c7732c95452702d11433aad50988700d36c"
-            },
-            "dist": {
-                "type": "zip",
-                "url": "https://api.github.com/repos/symfony/Yaml/zipball/82100c7732c95452702d11433aad50988700d36c",
-                "reference": "82100c7732c95452702d11433aad50988700d36c",
-                "shasum": ""
-            },
-            "require": {
-                "php": ">=5.3.3"
-            },
-            "type": "library",
-            "extra": {
-                "branch-alias": {
-                    "dev-master": "2.4-dev"
-                }
-            },
-            "autoload": {
-                "psr-0": {
-                    "Symfony\\Component\\Yaml\\": ""
-                }
-            },
-            "notification-url": "https://packagist.org/downloads/",
-            "license": [
-                "MIT"
-            ],
-            "authors": [
-                {
-                    "name": "Fabien Potencier",
-                    "email": "fabien@symfony.com"
-                },
-                {
-                    "name": "Symfony Community",
-                    "homepage": "http://symfony.com/contributors"
-                }
-            ],
-            "description": "Symfony Yaml Component",
-            "homepage": "http://symfony.com",
-            "time": "2013-05-16 07:54:39"
-        }
-    ],
-    "packages-dev": [
-
-    ],
-    "aliases": [
-
-    ],
-    "minimum-stability": "dev",
-    "stability-flags": [
-
-    ],
-    "platform": [
-
-    ],
-    "platform-dev": [
-
-    ]
-}
diff --git a/tests/features/bootstrap/FeatureContext.php b/tests/features/bootstrap/FeatureContext.php
deleted file mode 100644
index c42c821..0000000
--- a/tests/features/bootstrap/FeatureContext.php
+++ /dev/null
@@ -1,44 +0,0 @@
-<?php
-
-use Behat\Behat\Context\ClosuredContextInterface,
-    Behat\Behat\Context\TranslatedContextInterface,
-    Behat\Behat\Context\BehatContext,
-    Behat\Behat\Exception\PendingException;
-use Behat\Gherkin\Node\PyStringNode,
-    Behat\Gherkin\Node\TableNode;
-
-//
-// Require 3rd-party libraries here:
-//
-//   require_once 'PHPUnit/Autoload.php';
-//   require_once 'PHPUnit/Framework/Assert/Functions.php';
-//
-
-/**
- * Features context.
- */
-class FeatureContext extends Drupal\DrupalExtension\Context\DrupalContext
-{
-    /**
-     * Initializes context.
-     * Every scenario gets its own context object.
-     *
-     * @param array $parameters context parameters (set them up through behat.yml)
-     */
-    public function __construct(array $parameters)
-    {
-        // Initialize your context here
-    }
-
-//
-// Place your definition and hook methods here:
-//
-//    /**
-//     * @Given /^I have done something with "([^"]*)"$/
-//     */
-//    public function iHaveDoneSomethingWith($argument)
-//    {
-//        doSomethingWith($argument);
-//    }
-//
-}
diff --git a/tests/features/installation.feature b/tests/features/installation.feature
deleted file mode 100644
index f7adaa9..0000000
--- a/tests/features/installation.feature
+++ /dev/null
@@ -1,9 +0,0 @@
-Feature: Site installation
-  Scenario: Installation succeeded
-    Given I am on "/"
-    Then I should see "Oh hai"
-  
-  @javascript
-  Scenario: Installation succeeded with js enabled
-    Given I am on "/"
-    Then I should see "Oh hai"
\ No newline at end of file
diff --git a/themes/commons/commons_origins/.gitignore b/themes/commons/commons_origins/.gitignore
new file mode 100644
index 0000000..8b86ab2
--- /dev/null
+++ b/themes/commons/commons_origins/.gitignore
@@ -0,0 +1,3 @@
+/.sass-cache/
+.bundle
+.DS_Store
diff --git a/themes/commons/commons_origins/Gemfile b/themes/commons/commons_origins/Gemfile
new file mode 100644
index 0000000..996b525
--- /dev/null
+++ b/themes/commons/commons_origins/Gemfile
@@ -0,0 +1,7 @@
+# A sample Gemfile
+source "https://rubygems.org"
+
+# gem "rails"
+gem 'sass'
+gem 'compass'
+gem 'oily_png'
diff --git a/themes/commons/commons_origins/Gemfile.lock b/themes/commons/commons_origins/Gemfile.lock
new file mode 100644
index 0000000..2f03b5a
--- /dev/null
+++ b/themes/commons/commons_origins/Gemfile.lock
@@ -0,0 +1,20 @@
+GEM
+  remote: https://rubygems.org/
+  specs:
+    chunky_png (1.2.9)
+    compass (0.12.2)
+      chunky_png (~> 1.2)
+      fssm (>= 0.2.7)
+      sass (~> 3.1)
+    fssm (0.2.10)
+    oily_png (1.1.0)
+      chunky_png (~> 1.2.7)
+    sass (3.2.13)
+
+PLATFORMS
+  ruby
+
+DEPENDENCIES
+  compass
+  oily_png
+  sass
diff --git a/themes/commons/commons_origins/_README.txt b/themes/commons/commons_origins/_README.txt
new file mode 100755
index 0000000..4cff74e
--- /dev/null
+++ b/themes/commons/commons_origins/_README.txt
@@ -0,0 +1,30 @@
+
+-- SUBTHEME SETUP --
+
+NOTE: if you use Drush you can generate a new subtheme with the adaptivetheme
+command: drush adaptivetheme "Foobar Theme" foobartheme
+
+1. Copy and paste adaptivetheme_subtheme, it doesn't matter where you place
+   the copied version as long as its in a theme directory. For example if you
+   are using sites/all/themes you can place it there - so you end up with:
+
+   sites/all/themes/foobartheme
+
+2. Rename the info file and edit the info file details. For example lets assume
+   you want your theme to be called "foobartheme", the name of the info file will
+   be "foobartheme.info". Once you have renamed the file open it up and change
+   the "name" to foobartheme and change the description to suit your taste.
+
+3. Edit the theme_settings.php and template.php files - here we will be replacing
+   "adaptivetheme_subtheme" with your themes name, in this case "foobartheme" -
+   this must match the name you gave to the info file. The easy way is to just
+   use search and replace.
+
+4. For additional information on using Adaptivetheme view the information in
+   adaptivetheme/at_core/_README.txt
+
+Any problems please post an issue in the Adaptivethemes issue queue on Drupal.org:
+http://drupal.org/project/issues/adaptivetheme
+
+Maintainer:
+* Jeff Burnz http://drupal.org/user/61393
diff --git a/themes/commons/commons_origins/commons-origins-notes.txt b/themes/commons/commons_origins/commons-origins-notes.txt
new file mode 100644
index 0000000..67a14f6
--- /dev/null
+++ b/themes/commons/commons_origins/commons-origins-notes.txt
@@ -0,0 +1,13 @@
+For now, you need to go into appearance and click settings for the Commons Origins theme and then just save the setting form. Until we come up with a way to set the theme settings progmatically, this is what needs to be done.
+
+- Main Menu
+  - Home link gets class .main-menu-home (using module Menu Attributes - http://drupal.org/project/menu_attributes/)
+  - Groups link gets class .main-menu-groups (using module Menu Attributes - http://drupal.org/project/menu_attributes/)
+  - Events link gets class .main-menu-events (using module Menu Attributes - http://drupal.org/project/menu_attributes/)
+  - Mennu is generated by menu_block and the block is assigned to the menu bar region
+
+- Search
+  - the search bar is assigned to the header region
+
+- Adding a new pane
+  If you want your new pane to have the white "pod" look as other areas of Commons, simply give it a class of .commons-pod in the pane creation/edit page and it will have the look consistant with the rest of the site.
\ No newline at end of file
diff --git a/themes/commons/commons_origins/commons_origins.info b/themes/commons/commons_origins/commons_origins.info
new file mode 100644
index 0000000..60b5fcd
--- /dev/null
+++ b/themes/commons/commons_origins/commons_origins.info
@@ -0,0 +1,430 @@
+
+;----------// Theme Information
+
+  name        = Commons Origins
+  description = The default theme for <a href="http://drupal.org/project/commons">Drupal Commons 3.x</a>.
+  core        = 7.x
+  base theme  = adaptivetheme
+  release     = 7.x-3.x
+  engine      = phptemplate
+  screenshot  = screenshot.png
+
+
+;----------// Stylesheets
+
+  ; See each stylesheet for extensive documentation and help.
+  stylesheets[screen][] = css/global.base.css
+  stylesheets[screen][] = css/global.styles.css
+
+  ; Print - uncomment to load basic print styles.
+  stylesheets[print][] = css/print.css
+
+
+  ; Internet Explorer Stylesheets
+  ;
+  ; AT can load stylesheets in conditional comments from the info file.
+  ;
+  ; Syntax: ie_stylesheets[media][condition][] = path/to/file (path must be
+  ; relative to your theme root)
+  ;
+  ; For example if you want to load a stylesheet just for IE7 use the
+  ; following (note: you need to create "ie7.css" in the /css/ directory):
+  ; ie_stylesheets[screen][IE 7][] = css/ie7.css
+  ;
+  ; By default the sub-theme has one IE stylesheet which loads for
+  ; "less than IE9" but "not IEMobile 7".
+  ; Uncomment the following to use the included IE styleseet:
+
+  ie_stylesheets[screen][(lt IE 9)&(!IEMobile 7)][] = css/lt-ie9.css
+
+
+  ; Unset Module CSS or other Stylesheets
+  ;
+  ; In your theme settings you can unset many stylesheets using the Unset CSS
+  ; Extension. If for some reason the file you want to unset is not showing,
+  ; you can explicitly declare it here. Once you have finished adding your
+  ; declarations you must clear the sites cache, then go to your theme settings
+  ; and check the checkbox for the file, then save the theme settings and the
+  ; file will be unset thereafter.
+  ;
+  ; Follow the syntax:
+  ;
+  ; unset_css[path/to/css/file.css] = 1
+  ;
+  ; For example to unset foobar_module.css you might use something like this:
+
+  ; unset_css[sites/all/modules/foobar_module/foobar_module.css] = 1
+
+
+;-----------// Breakpoints
+
+  breakpoints[Commons small portrait] = only screen and (max-width:320px)
+  breakpoints[Commons small landscape] = only screen and (min-width:321px) and (max-width:480px)
+  breakpoints[Commons medium portrait] = only screen and (min-width:481px) and (max-width:768px)
+  breakpoints[Commons medium landscape] = only screen and (min-width:769px) and (max-width:934px
+  breakpoints[Commons large] = only screen and (min-width:935px)
+
+
+;----------// Scripts
+
+  scripts[] = scripts/modernizr.js
+  scripts[] = scripts/syze.min.js
+  scripts[] = scripts/commons_origins.js
+
+  ; Internet Explorer Scripts
+  ;
+  ; AT can load scripts in conditional comments from the info file. If you are
+  ; planning to use a polyfill be sure to check the "Settings" tab in theme
+  ; settings for existing Polyfills.
+  ;
+  ; Syntax: ie_scripts[condition][] = path/to/file (path must be relative to your
+  ; theme root)
+  ;
+  ; For example if you want to load a script just for IE 8 and below use the
+  ; following as a guide:
+
+  ; ie_scripts[lte IE 8][] = js/my-script.js
+
+
+;----------// Regions
+
+  regions[sidebar_first]     = Sidebar first
+  regions[sidebar_second]    = Sidebar second
+  regions[content]           = Main Content
+  regions[highlighted]       = Highlighted
+  regions[content_aside]     = Aside
+  regions[secondary_content] = Secondary
+  regions[tertiary_content]  = Tertiary
+  regions[footer]            = Footer
+  regions[header]            = Header
+  regions[menu_bar]          = Menu Bar
+  regions[help]              = Help
+  regions[page_top]          = Page top
+  regions[page_bottom]       = Page bottom
+
+
+;----------// Gpanel Regions
+
+  ; If you are using Gpanels copy and paste the region definitions here. You
+  ; will find them in each layout PHP file in adaptivetheme/layouts/gpanels
+
+
+;----------// Custom Page Layout Plugins
+
+  ; Don't uncomment this unless you are actually developing a page layout
+  ; plugin, it will add a layout to all device groups that does little else
+  ; except provide and example page_layout plugin.
+
+  ; plugins[page_layout][layouts] = custom_layouts
+
+
+;----------// Site Features
+
+  features[] = logo
+  features[] = name
+  features[] = slogan
+  features[] = node_user_picture
+  features[] = comment_user_picture
+  features[] = comment_user_verification
+  features[] = favicon
+  features[] = main_menu
+  features[] = secondary_menu
+
+
+;----------// Theme Settings
+
+  ; Layout settings - Standard layout
+  settings[bigscreen_layout]         = 'three_col_grail'
+  settings[bigscreen_page_unit]      = 'px'
+  settings[bigscreen_sidebar_unit]   = 'px'
+  settings[bigscreen_max_width_unit] = 'px'
+  settings[bigscreen_page_width]     = 935
+  settings[bigscreen_sidebar_first]  = 285
+  settings[bigscreen_sidebar_second] = 285
+  settings[bigscreen_set_max_width]  = 1
+  settings[bigscreen_max_width]      = 935
+  settings[bigscreen_media_query]    = 'only screen and (min-width:935px)'
+
+
+  ; Layout settings - Tablet landscape
+  settings[tablet_landscape_layout]         = 'three_col_grail'
+  settings[tablet_landscape_page_unit]      = '%'
+  settings[tablet_landscape_sidebar_unit]   = '%'
+  settings[tablet_landscape_page_width]     = 100
+  settings[tablet_landscape_sidebar_first]  = 20
+  settings[tablet_landscape_sidebar_second] = 20
+  settings[tablet_landscape_media_query]    = 'only screen and (min-width:769px) and (max-width:934px)'
+
+
+  ; Layout settings - Tablet portrait
+  settings[tablet_portrait_layout]         = 'one_col_vert'
+  settings[tablet_portrait_page_unit]      = '%'
+  settings[tablet_portrait_sidebar_unit]   = '%'
+  settings[tablet_portrait_page_width]     = 100
+  settings[tablet_portrait_sidebar_first]  = 50
+  settings[tablet_portrait_sidebar_second] = 50
+  settings[tablet_portrait_media_query]    = 'only screen and (min-width:481px) and (max-width:768px)'
+
+
+  ; Layout settings - Smartphone landscape
+  settings[smartphone_landscape_layout]         = 'one_col_vert'
+  settings[smartphone_landscape_page_unit]      = '%'
+  settings[smartphone_landscape_sidebar_unit]   = '%'
+  settings[smartphone_landscape_page_width]     = 100
+  settings[smartphone_landscape_sidebar_first]  = 50
+  settings[smartphone_landscape_sidebar_second] = 50
+  settings[smartphone_landscape_media_query]    = 'only screen and (min-width:321px) and (max-width:480px)'
+
+
+  ; Layout settings - Smartphone portrait
+  settings[smartphone_portrait_layout]         = 'one_col_stack'
+  settings[smartphone_portrait_page_unit]      = '%'
+  settings[smartphone_portrait_sidebar_unit]   = '%'
+  settings[smartphone_portrait_page_width]     = 100
+  settings[smartphone_portrait_sidebar_first]  = 100
+  settings[smartphone_portrait_sidebar_second] = 100
+  settings[smartphone_portrait_media_query]    = 'only screen and (max-width:320px)'
+
+
+  ; Responsive Panels - Standard layout
+  settings[bigscreen_two_50]            = 'two-50'
+  settings[bigscreen_two_33_66]         = 'two-33-66'
+  settings[bigscreen_two_66_33]         = 'two-66-33'
+  settings[bigscreen_two_brick]         = 'two-brick'
+  settings[bigscreen_three_3x33]        = 'three-3x33'
+  settings[bigscreen_three_25_50_25]    = 'three-25-50-25'
+  settings[bigscreen_three_25_25_50]    = 'three-25-25-50'
+  settings[bigscreen_three_50_25_25]    = 'three-50-25-25'
+  settings[bigscreen_four_4x25]         = 'four-4x25'
+  settings[bigscreen_five_5x20]         = 'five-5x20-2x3-grid'
+  settings[bigscreen_six_6x16]          = 'six-6x16-3x2-grid'
+  settings[bigscreen_three_inset_left]  = 'three-inset-left'
+  settings[bigscreen_three_inset_right] = 'three-inset-right'
+
+
+  ; Responsive Panels - Tablet landscape
+  settings[tablet_landscape_two_50]            = 'two-50'
+  settings[tablet_landscape_two_33_66]         = 'two-33-66'
+  settings[tablet_landscape_two_66_33]         = 'two-66-33'
+  settings[tablet_landscape_two_brick]         = 'two-brick'
+  settings[tablet_landscape_three_3x33]        = 'three-3x33'
+  settings[tablet_landscape_three_25_50_25]    = 'three-25-50-25'
+  settings[tablet_landscape_three_25_25_50]    = 'three-25-25-50'
+  settings[tablet_landscape_three_50_25_25]    = 'three-50-25-25'
+  settings[tablet_landscape_four_4x25]         = 'four-4x25'
+  settings[tablet_landscape_five_5x20]         = 'five-5x20-2x3-grid'
+  settings[tablet_landscape_six_6x16]          = 'six-6x16-3x2-grid'
+  settings[tablet_landscape_three_inset_left]  = 'three-inset-left'
+  settings[tablet_landscape_three_inset_right] = 'three-inset-right'
+
+
+  ; Responsive Panels - Tablet portrait
+  settings[tablet_portrait_two_50]            = 'two-50'
+  settings[tablet_portrait_two_33_66]         = 'two-33-66'
+  settings[tablet_portrait_two_66_33]         = 'two-66-33'
+  settings[tablet_portrait_two_brick]         = 'two-brick'
+  settings[tablet_portrait_three_3x33]        = 'three-3x33-stack-top'
+  settings[tablet_portrait_three_25_50_25]    = 'three-25-50-25-stack-top'
+  settings[tablet_portrait_three_25_25_50]    = 'three-25-25-50-stack-top'
+  settings[tablet_portrait_three_50_25_25]    = 'three-50-25-25-stack-top'
+  settings[tablet_portrait_four_4x25]         = 'four-4x25-2x2-grid'
+  settings[tablet_portrait_five_5x20]         = 'five-5x20-1x2x2-grid'
+  settings[tablet_portrait_six_6x16]          = 'six-6x16-2x3-grid'
+  settings[tablet_portrait_three_inset_left]  = 'three-inset-left-wrap'
+  settings[tablet_portrait_three_inset_right] = 'three-inset-right-wrap'
+
+
+  ; Responsive Panels - Smartphone landscape
+  settings[smartphone_landscape_two_50]            = 'two-50-stack'
+  settings[smartphone_landscape_two_33_66]         = 'two-33-66-stack'
+  settings[smartphone_landscape_two_66_33]         = 'two-66-33-stack'
+  settings[smartphone_landscape_two_brick]         = 'two-brick-stack'
+  settings[smartphone_landscape_three_3x33]        = 'three-3x33-stack'
+  settings[smartphone_landscape_three_25_50_25]    = 'three-25-50-25-stack'
+  settings[smartphone_landscape_three_25_25_50]    = 'three-25-25-50-stack'
+  settings[smartphone_landscape_three_50_25_25]    = 'three-50-25-25-stack'
+  settings[smartphone_landscape_four_4x25]         = 'four-4x25-stack'
+  settings[smartphone_landscape_five_5x20]         = 'five-5x20-stack'
+  settings[smartphone_landscape_six_6x16]          = 'six-6x16-stack'
+  settings[smartphone_landscape_three_inset_left]  = 'three-inset-left-stack'
+  settings[smartphone_landscape_three_inset_right] = 'three-inset-right-stack'
+
+
+  ; CSS
+  settings[disable_responsive_styles]     = 0
+  settings[enable_custom_media_queries]   = 1
+  settings[global_default_layout]         = 'smartphone-portrait'
+  settings[global_default_layout_toggle]  = 0
+  settings[global_files_path]             = 'public_files'
+
+
+  ; Polyfills
+  settings[load_html5js]       = 1
+  settings[load_respondjs]     = 0
+  settings[load_ltie8css]      = 0
+  settings[load_scalefixjs]    = 0
+
+
+  ; Debug
+  settings[expose_regions]              = 0
+  settings[load_all_panels]             = 0
+  settings[load_all_panels_no_sidebars] = 0
+  settings[show_window_size]            = 0
+  settings[rebuild_theme_data]          = 0
+
+
+  ; Enable extensions
+  settings[enable_extensions]          = 0
+  settings[enable_font_settings]       = 0
+  settings[enable_heading_settings]    = 0
+  settings[enable_image_settings]      = 0
+  settings[enable_apple_touch_icons]   = 0
+  settings[enable_exclude_css]         = 0
+  settings[enable_custom_css]          = 0
+  settings[enable_context_regions]     = 0
+  settings[enable_float_region_blocks] = 0
+  settings[enable_markup_overides]     = 0
+
+
+  ; Font type
+  settings[base_font_type]           = '<none>'
+  settings[site_name_font_type]      = '<none>'
+  settings[site_slogan_font_type]    = '<none>'
+  settings[page_title_font_type]     = '<none>'
+  settings[node_title_font_type]     = '<none>'
+  settings[comment_title_font_type]  = '<none>'
+  settings[block_title_font_type]    = '<none>'
+  settings[main_menu_font_type]      = '<none>'
+  settings[secondary_menu_font_type] = '<none>'
+  settings[block_menu_font_type]     = '<none>'
+  settings[selectors_font_type]      = '<none>'
+  settings[content_headings_h1h4_font_type] = '<none>'
+  settings[content_headings_h5h6_font_type] = '<none>'
+
+
+  ; Font size
+  settings[base_font_size]           = '<none>'
+  settings[site_name_font_size]      = '<none>'
+  settings[site_slogan_font_size]    = '<none>'
+  settings[page_title_font_size]     = '<none>'
+  settings[node_title_font_size]     = '<none>'
+  settings[comment_title_font_size]  = '<none>'
+  settings[block_title_font_size]    = '<none>'
+  settings[main_menu_font_size]      = '<none>'
+  settings[secondary_menu_font_size] = '<none>'
+  settings[block_menu_font_size]     = '<none>'
+
+
+  ; Font size heading levels
+  settings[h1_font_size] = '2em'
+  settings[h2_font_size] = '1.6em'
+  settings[h3_font_size] = '1.4em'
+  settings[h4_font_size] = '1.2em'
+  settings[h5_font_size] = '1em'
+  settings[h6_font_size] = '1em'
+
+
+  ; Page title
+  settings[page_title_case]      = 'ptc-n'
+  settings[page_title_weight]    = 'ptw-b'
+  settings[page_title_alignment] = 'pta-l'
+  settings[page_title_shadow]    = 'pts-n'
+
+
+  ; Node title
+  settings[node_title_case]      = 'ntc-n'
+  settings[node_title_weight]    = 'ntw-b'
+  settings[node_title_alignment] = 'nta-l'
+  settings[node_title_shadow]    = 'nts-n'
+
+
+  ; Comment title
+  settings[comment_title_case]      = 'ctc-n'
+  settings[comment_title_weight]    = 'ctw-b'
+  settings[comment_title_alignment] = 'cta-l'
+  settings[comment_title_shadow]    = 'cts-n'
+
+
+  ; Block title
+  settings[block_title_case]      = 'btc-n'
+  settings[block_title_weight]    = 'btw-b'
+  settings[block_title_alignment] = 'bta-l'
+  settings[block_title_shadow]    = 'bts-n'
+
+
+  ; Images
+  settings[image_alignment]        = 'ia-n'
+  settings[image_alignment_teaser] = 'iat-n'
+  settings[image_caption_full]     = 0
+  settings[image_caption_teaser]   = 0
+  settings[image_teaser]           = 0
+
+
+  ; Breadcrumb
+  settings[breadcrumb_display]   = 1
+  settings[breadcrumb_home]      = 0
+  settings[breadcrumb_label]     = 0
+  settings[breadcrumb_title]     = 0
+  settings[breadcrumb_separator] = ' &#187; '
+
+
+  ; Login block options
+  settings[horizontal_login_block_enable] = 'on'
+  settings[horizontal_login_block]    = 0
+  settings[login_block_remove_links]  = 0
+  settings[login_block_remove_openid] = 0
+
+
+  ; Design
+  settings[global_gutter_width]           = ''
+  settings[page_full_width_wrappers]      = 0
+  settings[page_content_type_suggestions] = 0
+  settings[menu_item_span_elements]       = 0
+
+
+  ; Extra CSS classes
+  settings[extra_page_classes]      = 1
+  settings[extra_article_classes]   = 1
+  settings[extra_comment_classes]   = 1
+  settings[extra_block_classes]     = 1
+  settings[extra_menu_classes]      = 1
+  settings[extra_item_list_classes] = 1
+
+
+  ; Remove or Hide
+  settings[comments_hide_title]           = 0
+  settings[feed_icons]                    = 0
+  settings[unset_block_system_main_front] = 0
+  settings[unset_menu_titles]             = 0
+
+
+  ; Accessibility
+  settings[skip_link_target] = '#main-content'
+  settings[adv_search_extra_fieldsets] = 0
+
+
+  ; SEO
+  settings[rel_author] = 0
+
+
+  ; Mobile metatags
+  settings[mobile_friendly_metatags] = 1
+  settings[adaptivetheme_meta_viewport] = 'width=device-width, initial-scale=1'
+  settings[adaptivetheme_meta_mobileoptimized]  = 'width'
+  settings[adaptivetheme_meta_handheldfriendly] = 'true'
+  settings[adaptivetheme_meta_apple_mobile_web_app_capable] = 'yes'
+  settings[chrome_edge] = 1
+  settings[clear_type]  = 1
+
+
+  ; Touch icons
+  settings[apple_touch_icon_enable] = 0
+  settings[apple_touch_icon_path_l] = 'images/touch-icon-l.png'
+  settings[apple_touch_icon_path_m] = 'images/touch-icon-m.png'
+  settings[apple_touch_icon_path_h] = 'images/touch-icon-h.png'
+
+
+  ; Custom CSS
+  settings[custom_css] = ''
+
+  ;
diff --git a/themes/commons/commons_origins/commons_origins.palettes.inc b/themes/commons/commons_origins/commons_origins.palettes.inc
new file mode 100644
index 0000000..477f9f5
--- /dev/null
+++ b/themes/commons/commons_origins/commons_origins.palettes.inc
@@ -0,0 +1,51 @@
+<?php
+
+/**
+ * Returns an array of color palettes keyed on class name.
+ */
+function commons_origins_get_palettes() {
+  $palettes = array(
+    'default' => 'Default',
+    'palette-gray-lightgray-blue' => 'Grey/light grey/blue',
+    'palette-blue-blue' => 'Blue/blue',
+    'palette-magenta-blue' => 'Magenta/blue',
+    'palette-black-green' => 'Black/green',
+    'palette-brown-burnt-orange' => 'Brown/burnt orange',
+    'palette-brown-yellow' => 'Brown/yellow',
+    'palette-seafoam-orange' => 'Seafom orange',
+    'palette-orange-red' => 'Orange/red',
+    'palette-black-blue-yellow' => 'Black blue yellow',
+    'palette-black-white-red' => 'Black/white/red',
+    'palette-brick-brick' => 'Brick',
+  );
+
+  foreach ($palettes as $key => $name) {
+    $palettes[$key] = theme('image', array('alt' => t($name), 'title' => t($name), 'path' => drupal_get_path('theme', 'commons_origins') . "/images/palettes/$key.png"));
+  }
+  return $palettes;
+}
+
+/**
+ * Add a color palette selection to a form.
+ */
+function commons_origins_palettes_form(&$form) {
+  $form['commons_origins_palette_fieldset'] = array(
+    '#type' => 'fieldset',
+    '#title' => t('Color palette'),
+    '#collapsible' => TRUE,
+    '#collapsed' => FALSE,
+  );
+  $form['commons_origins_palette_fieldset']['commons_origins_palette'] = array(
+    '#type' => 'radios',
+    '#options' => commons_origins_get_palettes(),
+    '#default_value' => variable_get('commons_origins_palette', 'default'),
+  );
+  $form['#submit'][] = 'commons_origins_color_palettes_form_submit';
+}
+
+/**
+ * Submit handler for the Commons Origins palette selection form.
+ */
+function commons_origins_color_palettes_form_submit($form, &$form_state) {
+  variable_set('commons_origins_palette', $form_state['values']['commons_origins_palette']);
+}
\ No newline at end of file
diff --git a/themes/commons/commons_origins/config.rb b/themes/commons/commons_origins/config.rb
new file mode 100755
index 0000000..9041bac
--- /dev/null
+++ b/themes/commons/commons_origins/config.rb
@@ -0,0 +1,20 @@
+# Require any additional compass plugins here.
+
+http_path = "/"
+css_dir = "css"
+sass_dir = "sass"
+images_dir = "images"
+javascripts_dir = "scripts"
+
+# output_style = :expanded or :nested or :compact or :compressed
+output_style = :expanded
+
+relative_assets = true
+ 
+# line_comments and debug_info can be activated by setting the environment
+# flag to "development"
+line_comments = (environment == :development) ? true : false
+
+sass_options = {
+  :debug_info => (environment == :development) ? true : false
+}
diff --git a/themes/commons/commons_origins/css/_README.txt b/themes/commons/commons_origins/css/_README.txt
new file mode 100755
index 0000000..f20f5ed
--- /dev/null
+++ b/themes/commons/commons_origins/css/_README.txt
@@ -0,0 +1,232 @@
+
+
+First read this about SASS, its very important!
+-----------------------------------------------
+
+There is more information regarding working with SASS in the SASS CSS folder
+_README, however, you need to be aware that if you set Compass to watch the
+SASS folder or any SCSS file in this theme it will OVERWRITE the CSS file/s in
+your sub-themes CSS directory!
+
+To prevent this ever happening you can delete the config.rb file in the
+sub-theme root (unless you are actually planning on using SASS, in which case
+you will want to keep it).
+
+
+
+
+Working with Responsive Design in Adaptivetheme
+-----------------------------------------------
+
+The subtheme is designed to be "mobile first". In short this means to
+first load a set of global styles, the progressively add styles for larger
+devices using media queries.
+
+Its important to note that you do not have to follow a mobile first approach.
+Adaptivetheme can support Desktop first approach as well, which means you will
+progressively add styles to override things for mobile, rather than progressively
+adding style for larger devices.
+
+You can do both in Adaptivetheme - it's merely a matter of where you place
+the majority of your styles, and what theme settings you choose in the
+Appearance settings for your sub-theme.
+
+Lets examine the CSS file structure of Adaptivetheme and look at how each
+file is loaded. From this you will be able to deduce what approach might work
+for you, and where you should be placing your CSS.
+
+
+
+
+Moible First or Desktop First - that is the Question!
+-----------------------------------------------
+
+Depending on your approach AT will load the stylesheets in a different order,
+indeed it will load different stylesheets.  You MUST make a conscious decision
+which to use and set this in theme settings.
+
+Look under CSS settings. By default AT is set to Mobile first, if you want to do
+Desktop first you should change this setting.
+
+
+
+
+Global Styles
+-------------
+
+The global styles do not target any specific device - they always load for all
+devices.
+
+There are two main global stylesheets:
+
+  - global.base.css
+  - global.styles.css
+  
+global.base.css - this holds a few imoportant declarations that should probably
+not be removed, however you can modify them, such as gutter width and flexibile
+image/media styles.
+
+global.styles.css - includes a slighly modified normalize reset and many empty
+selectors for elements and drupal classes and id's. If you prefer you can delete
+everything in global.styles.css and start with a clean slate.
+
+The selectors are extensive and you should delete unused selectors before
+going live to reduce CSS weight. You can use cleancss.com or a better way is
+just use SASS, it does this for you.
+
+Each file includes a lot of comments and documentation, please review each of
+the global CSS files for more help.
+
+If you are doing mobile first then you will probably keep things to a minimum
+in these files. "Minimum" is relative, this might still be a lot of CSS,
+never-the-less its worth keeping in mind the mobile view of the site, and
+avoid writing CSS rules that are clearly for larger width devices.
+
+
+
+
+Responsive Styles
+-----------------
+
+Adaptivetheme 7.x-3.x has two "modes" - Development mode and Production mode.
+Depending on what mode you are in the stylesheets will load differently.
+
+Mode changes automatically depending on CSS aggregation settings. When CSS
+aggregation is ON, the its in Production mode.
+
+If you don't know what CSS aggregation is, look here:
+
+  ~/admin/config/development/performance
+
+
+## Responsive Styles - Development mode
+
+In Development mode (CSS aggregation OFF) the responsive stylesheets will load
+in individual link elements with the media query in media attribute.
+
+This allows them to load directly into the browser and you will see your CSS
+changes immediately, as per normal CSS development.
+
+There are five of these responsive stylesheets - one for each break point set
+in the theme settings:
+
+  - responsive.smartphone.landscape.css
+  - responsive.smartphone.portrait.css
+  - responsive.tablet.landscape.css
+  - responsive.tablet.portrait.css
+  - responsive.desktop.css
+
+Its important to know that these files DO NOT contain the media queries,
+instead they load in the <link> elements media attribute - remember, these
+files only load when in Development Mode.
+
+
+## Responsive Styles - Production mode
+
+When in production mode all the responsive stylesheets are aggregated into one
+file and use embedded @media queries. AT Core will automatically aggregate
+the CSS from each of the development mode stylesheets and wrap it in the right
+media query. This reduces the number of HTTP requests from 5 to 1.
+
+This file is always called:
+
+  - ThemeName.responsive.styles.css
+
+You will find this file at:
+
+  ~/[public files]/adaptivetheme/[ThemeName]/ThemeName.responsive.styles.css
+
+NOTE: please see the section below titled "Relative Paths in Responsive Styles".
+
+
+## Important Note about CSS Aggregation and Responsive Stylesheets
+
+Once you have CSS aggregation ON if you make changes to any responsive
+stylesheet, you MUST re-save the theme settings AND clear the sites cache. AT
+Core will re-write the saved files, then clearing the cache tells Drupal to
+use the new file.
+
+
+## Relative Paths in Responsive Stylesheets
+
+When CSS aggregation is ON AT Core will load the production version of your
+responsive styles (see above "Production mode"). this file is loading from
+Public Files and not from within your theme so special handling is required for
+relative assets - AT Core will do this for you.
+
+AT Core will automatically re-write the relative paths to the files so they
+are relative to the site root. This is the same functionality as Drupal core
+CSS aggregation feature, so paths are not broken.
+
+If you use absolute paths these will not be altered.
+
+
+
+
+Overlapping/Custom Media queries
+--------------------------------
+
+By default the media queries in Adaptivetheme are "stacked", meaning they do
+not overlap. This makes it very easy to target one set of device width and not
+have those styles "leak" over into others. However it can also mean you may
+need to duplicate CSS that you would rather have cascade.
+
+To use custom media queries the sub-theme includes a special file called:
+
+  responsive.custom.css
+
+To enable the use of this file in your theme see your theme settings:
+
+  Layout & General Settings > CSS > Custom Media Queries
+
+This file has embedded media queries which means you MUST set them yourself.
+Defaults are provided.
+
+Allowing styles to cascade can result in a huge saving on total CSS weight and
+speed up development.
+
+
+
+
+Internet Explorer Styles and Scripts
+------------------------------------
+
+AT can load conditional stylsheets and scripts from you sub-themes info file.
+
+Please see adaptivetheme_subtheme.info - there are good docs and examples of
+how to declare stylesheets and scripts for Internet Explorer.
+
+Adaptivetheme also includes special conditional classes on the HTML element
+which allow you to easily target styles at specific version of IE.
+
+These are the classes you can use:
+
+  .iem7 (IE7 Mobile)
+  .lt-ie7 (less than IE7)
+  .lt-ie8 (less than IE8)
+  .lt-ie9 (less than IE9)
+
+Use these if you only have a small number of overrides and do not want to load
+a dedicated conditional stylesheet.
+
+
+
+
+Support
+-------
+
+Ping me on Skype if you have life/death critical issues to report...
+
+  Skype: jmburnz
+
+Otherwise support my work by joining my theme club, it really does fund my
+contrib projects:
+
+  http://adaptivethemes.com
+
+Or, you could get radical and file a support issue, even post a patch (which
+makes me very happy):
+
+  http://drupal.org/project/issues/adaptivetheme
+
+
diff --git a/themes/commons/commons_origins/css/commons-media.css b/themes/commons/commons_origins/css/commons-media.css
new file mode 100644
index 0000000..07e1a8d
--- /dev/null
+++ b/themes/commons/commons_origins/css/commons-media.css
@@ -0,0 +1,172 @@
+/**
+ * @file
+ * Style overrides for the Commons Media feature.
+ */
+.field-name-field-media-form {
+  margin-bottom: 10px;
+}
+
+.field-name-field-media .field-add-more-submit, #quicktabs-container-commons_bw .quicktabs-tabpage .field-name-field-media .field-add-more-submit {
+  margin: 10px 0;
+}
+
+table[id^="field-media-values"],
+table[id^="field-media-values"] thead,
+table[id^="field-media-values"] tbody,
+table[id^="field-media-values"] tr,
+table[id^="field-media-values"] th,
+table[id^="field-media-values"] td {
+  background-color: transparent;
+  border: none;
+}
+table[id^="field-media-values"] th {
+  padding: 0;
+}
+table[id^="field-media-values"] th label {
+  margin: 0;
+}
+table[id^="field-media-values"] td.field-multiple-drag {
+  width: 20px;
+}
+table[id^="field-media-values"] a.tabledrag-handle .handle {
+  margin: 0;
+}
+table[id^="field-media-values"] .form-item {
+  padding-left: 6.875em;
+}
+table[id^="field-media-values"] .media-widget .button {
+  display: block;
+}
+@media only screen and (min-width: 769px) {
+  table[id^="field-media-values"] .media-widget .button {
+    max-width: 50%;
+  }
+}
+
+.form-type-media .preview {
+  background: url('../images/icons-sfd37165efe.png') 0 -789px no-repeat;
+  width: 26px;
+  height: 20px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  margin-right: 10px;
+}
+@media only screen and (max-width: 480px) {
+  .form-type-media .preview {
+    display: block;
+    float: none;
+    margin: 10px auto;
+  }
+  .form-type-media .button,
+  .form-type-media input[type="submit"] {
+    display: block;
+    float: none;
+    margin: 10px auto;
+    width: 100%;
+  }
+}
+
+.media-wrapper {
+  position: absolute;
+  overflow: hidden;
+  padding: 0;
+  border: 1px solid #555555;
+  min-width: 100%;
+  max-width: 100%;
+  -webkit-box-shadow: 0 0 0 0.5625em rgba(0, 0, 0, 0.2);
+  -moz-box-shadow: 0 0 0 0.5625em rgba(0, 0, 0, 0.2);
+  box-shadow: 0 0 0 0.5625em rgba(0, 0, 0, 0.2);
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+}
+.media-wrapper,
+.media-wrapper .ui-corner-all {
+  -webkit-border-radius: 0;
+  -moz-border-radius: 0;
+  -ms-border-radius: 0;
+  -o-border-radius: 0;
+  border-radius: 0;
+}
+.media-wrapper .ui-dialog-title {
+  display: block;
+  margin: 0;
+  line-height: 1.5em;
+  font-size: 2.25em;
+  font-family: "Helvetica Neue", helvetica, "Segoe UI", segoe, "Ubuntu", "Droid Sans", "Arial", sans-serif;
+  font-weight: 200;
+}
+.media-wrapper .ui-dialog-titlebar {
+  position: relative;
+  padding: 0.70711em 1em 0;
+  border: none;
+  color: #848484;
+  background: #303030;
+}
+.media-wrapper .ui-dialog-titlebar-close {
+  position: absolute;
+  float: none;
+  display: block;
+  top: 0.35355em;
+  right: 0.35355em;
+  width: 1em;
+  height: 1em;
+  overflow: hidden;
+  margin: 0;
+  padding: 0;
+  text-align: center;
+  line-height: 1em;
+  color: white;
+  background: none;
+  font-weight: normal;
+}
+.media-wrapper .ui-dialog-titlebar-close:hover {
+  text-decoration: none;
+  border: none;
+}
+.media-wrapper .ui-dialog-titlebar-close:before {
+  content: "\2715";
+}
+.media-wrapper .ui-dialog-content {
+  position: relative;
+  border: 0;
+  background: none;
+  overflow: auto;
+  zoom: 1;
+}
+.media-wrapper .ui-dialog-buttonpane {
+  text-align: left;
+  border-width: 1px 0 0 0;
+  background-image: none;
+  margin: .5em 0 0 0;
+  padding: .3em 1em .5em .4em;
+}
+.media-wrapper .ui-dialog-buttonpane .ui-dialog-buttonset {
+  float: right;
+}
+.media-wrapper .ui-dialog-buttonpane button {
+  margin: .5em .4em .5em 0;
+  cursor: pointer;
+}
+.media-wrapper .ui-resizable-se {
+  width: 14px;
+  height: 14px;
+  right: 3px;
+  bottom: 3px;
+}
+.media-wrapper .ui-draggable .ui-dialog-titlebar {
+  cursor: move;
+}
+@media (min-width: 22.85714em) {
+  .media-wrapper {
+    min-width: 0;
+  }
+}
+@media (min-width: 28.57143em) {
+  .media-wrapper .ui-dialog-titlebar {
+    padding-right: 2em;
+    padding-left: 2em;
+  }
+}
diff --git a/themes/commons/commons_origins/css/global.base.css b/themes/commons/commons_origins/css/global.base.css
new file mode 100644
index 0000000..a42375b
--- /dev/null
+++ b/themes/commons/commons_origins/css/global.base.css
@@ -0,0 +1,523 @@
+/*
+ * @file
+ * global.base
+ *
+ * - normalize with small modifications for Drupal and AT: http://necolas.github.com/normalize.css/
+ * - Gutter widths, see $gutter-width in _custom.scss
+ * - Default container alignment.
+ * - Flexible images and media declarations.
+ * - Copies of the SCSS mixins for reference, which includes an improved
+ *   element-invisible and focusable styles.
+ */
+/* =============================================================================
+    HTML5 display definitions
+   ========================================================================== */
+/*
+ * Corrects block display not defined in IE6/7/8/9 & FF3
+ */
+article,
+aside,
+details,
+figcaption,
+figure,
+footer,
+header,
+hgroup,
+nav,
+section,
+summary {
+  display: block;
+}
+
+/*
+ * Corrects inline-block display not defined in IE6/7/8/9 & FF3
+ */
+audio,
+canvas,
+video {
+  display: inline-block;
+  *display: inline;
+  *zoom: 1;
+}
+
+/*
+ * Prevents modern browsers from displaying 'audio' without controls
+ * Remove excess height in iOS5 devices
+ */
+audio:not([controls]) {
+  display: none;
+  height: 0;
+}
+
+/*
+ * Addresses styling for 'hidden' attribute not present in IE7/8/9, FF3, S4
+ * Known issue: no IE6 support
+ */
+[hidden] {
+  display: none;
+}
+
+/* =============================================================================
+    Base
+   ========================================================================== */
+/*
+ * If you are using the themes Responsive JS feature (media_queries.js) do not
+ * set a font-family on the html element, use body.
+ *
+ * 1. Corrects text resizing oddly in IE6/7 when body font-size is set using em units
+ *    http://clagnut.com/blog/348/#c790
+ * 2. Prevents iOS text size adjust after orientation change, without disabling user zoom
+ *    www.456bereastreet.com/archive/201012/controlling_text_size_in_safari_for_ios_without_disabling_user_zoom/
+ */
+html {
+  font-size: 100%;
+  -webkit-text-size-adjust: 100%;
+  line-height: 1.7;
+  overflow-y: scroll;
+}
+
+/*
+ * 1 . Addresses margins handled incorrectly in IE6/7
+ */
+body {
+  min-height: 100%;
+  margin: 0;
+  padding: 0;
+  -webkit-font-smoothing: antialiased;
+  font-smoothing: antialiased;
+  text-rendering: optimizeLegibility\9;
+  /* Only IE, can mess with Android */
+}
+
+/*
+ * Addresses font-family inconsistency between 'textarea' and other form elements.
+ */
+button,
+input,
+select,
+textarea {
+  font-family: sans-serif;
+}
+
+/* =============================================================================
+    Links
+   ========================================================================== */
+/*
+ * Addresses outline displayed oddly in Chrome
+ */
+a:focus {
+  outline: thin dotted;
+}
+
+/*
+ * Improves readability when focused and also mouse hovered in all browsers
+ * people.opera.com/patrickl/experiments/keyboard/test
+ */
+a:hover,
+a:active {
+  outline: 0;
+}
+
+/* =============================================================================
+    Typography
+   ========================================================================== */
+/*
+ * Headings
+ *
+ * Addresses font sizes and margins set differently in IE6/7
+ * Addresses font sizes within 'section' and 'article' in FF4+, Chrome, S5
+ */
+h1 {
+  font-size: 2em;
+  margin: 0.67em 0;
+}
+
+h2 {
+  font-size: 1.5em;
+  margin: 0.83em 0;
+}
+
+h3 {
+  font-size: 1.17em;
+  margin: 1em 0;
+}
+
+h4 {
+  font-size: 1em;
+  margin: 1.33em 0;
+}
+
+h5 {
+  font-size: 0.83em;
+  margin: 1.67em 0;
+}
+
+h6 {
+  font-size: 0.75em;
+  margin: 2.33em 0;
+}
+
+/*
+ * Addresses styling not present in IE7/8/9, S5, Chrome
+ */
+abbr[title] {
+  border-bottom: 1px dotted;
+}
+
+/*
+ * Addresses style set to 'bolder' in FF3+, S4/5, Chrome
+ */
+b,
+strong {
+  font-weight: bold;
+}
+
+blockquote {
+  margin: 1em 40px;
+}
+
+/*
+ * Addresses styling not present in S5, Chrome
+ */
+dfn {
+  font-style: italic;
+}
+
+/*
+ * Addresses styling not present in IE6/7/8/9
+ */
+mark {
+  background: #ff0;
+  color: #000;
+}
+
+/*
+ * Addresses margins set differently in IE6/7
+ */
+p,
+pre {
+  margin: 0 0 1.5em;
+}
+
+/*
+ * Corrects font family set oddly in IE6, S4/5, Chrome
+ * en.wikipedia.org/wiki/User:Davidgothberg/Test59
+ */
+pre,
+code,
+kbd,
+samp {
+  font-family: monospace, serif;
+  _font-family: 'courier new', monospace;
+  font-size: 1em;
+}
+
+/*
+ * Improves readability of pre-formatted text in all browsers
+ */
+pre {
+  white-space: pre;
+  white-space: pre-wrap;
+  word-wrap: break-word;
+}
+
+/*
+ * 1. Addresses CSS quotes not supported in IE6/7
+ * 2. Addresses quote property not supported in S4
+ */
+q {
+  quotes: none;
+}
+
+q:before,
+q:after {
+  content: '';
+  content: none;
+}
+
+small {
+  font-size: 75%;
+}
+
+/*
+ * Prevents sub and sup affecting line-height in all browsers
+ * gist.github.com/413930
+ */
+sub,
+sup {
+  font-size: 75%;
+  line-height: 0;
+  position: relative;
+  vertical-align: baseline;
+}
+
+sup {
+  top: -0.5em;
+}
+
+sub {
+  bottom: -0.25em;
+}
+
+/* =============================================================================
+    Lists
+   ========================================================================== */
+/*
+ * Addresses margins set differently in IE6/7
+ */
+dl,
+menu,
+ol,
+ul {
+  margin: 1em 0;
+}
+
+dd {
+  margin: 0 0 0 40px;
+}
+
+/*
+ * Addresses paddings set differently in IE6/7
+ */
+menu,
+ol,
+ul {
+  padding: 0 0 0 40px;
+}
+
+/*
+ * Corrects list images handled incorrectly in IE7
+ */
+nav ul,
+nav ol {
+  list-style: none;
+  list-style-image: none;
+}
+
+/* =============================================================================
+    Embedded content
+   ========================================================================== */
+/*
+ * 1. Remove border when inside 'a' element in IE6/7/8/9, FF3
+ * 2. Improves image quality when scaled in IE7
+ *    code.flickr.com/blog/2008/11/12/on-ui-quality-the-little-things-client-side-image-resizing/
+ */
+img {
+  /* border: 0; */
+  /* Drupal core already does this, uncomment if you need it */
+  -ms-interpolation-mode: bicubic;
+}
+
+/*
+ * Corrects overflow displayed oddly in IE9
+ */
+svg:not(:root) {
+  overflow: hidden;
+}
+
+/* =============================================================================
+    Figures
+   ========================================================================== */
+/*
+ * Addresses margin not present in IE6/7/8/9, S5, O11
+ */
+figure {
+  margin: 0;
+}
+
+/* =============================================================================
+    Forms
+   ========================================================================== */
+/*
+ * 1. Corrects font size not being inherited in all browsers
+ * 2. Addresses margins set differently in IE6/7, FF3+, S5, Chrome
+ * 3. Improves appearance and consistency in all browsers
+ */
+button,
+input,
+select,
+textarea {
+  font-size: 100%;
+  margin: 0;
+  vertical-align: baseline;
+  *vertical-align: middle;
+}
+
+/*
+ * 1. Addresses box sizing set to content-box in IE8/9
+ * 2. Removes excess padding in IE8/9
+ * 3. Removes excess padding in IE7
+ *    Known issue: excess padding remains in IE6
+ */
+input[type="checkbox"],
+input[type="radio"] {
+  box-sizing: border-box;
+  padding: 0;
+  *height: 13px;
+  *width: 13px;
+}
+
+/*
+ * 1. Addresses appearance set to searchfield in S5, Chrome
+ * 2. Addresses box-sizing set to border-box in S5, Chrome (include -moz to future-proof)
+ */
+input[type="search"] {
+  -webkit-appearance: textfield;
+  -moz-box-sizing: content-box;
+  -webkit-box-sizing: content-box;
+  box-sizing: content-box;
+}
+
+/*
+ * Removes inner padding and search cancel button in S5, Chrome on OS X
+ */
+input[type="search"]::-webkit-search-decoration,
+input[type="search"]::-webkit-search-cancel-button {
+  -webkit-appearance: none;
+}
+
+/*
+ * 1. Removes default vertical scrollbar in IE6/7/8/9
+ * 2. Improves readability and alignment in all browsers
+ */
+textarea {
+  overflow: auto;
+  vertical-align: top;
+}
+
+/* =============================================================================
+    Tables
+   ========================================================================== */
+/*
+ * 1. Remove most spacing between table cells
+ */
+table {
+  border: 1px solid;
+  border-spacing: 0;
+  border-collapse: collapse;
+  font-size: inherit;
+  font: 100%;
+}
+
+/* =============================================================================
+    Flexible Media and Cross browser improvements
+   ========================================================================== */
+/*
+ * - This can cause issues in table cells where no width is set on the column,
+ *   only in some versions of webkit and IE 7/8.
+ * - declaring the width attribute on image elements and using max-width causes
+ *   the "dissappering images" bug in IE8.
+ * - Mapping services such as Google Maps may break also, see below for fixes.
+ */
+img {
+  height: auto;
+  -ms-interpolation-mode: bicubic;
+}
+
+/* Ethan Marcotte - http://front.ie/l8rJaA */
+img,
+embed,
+object,
+video {
+  max-width: 100%;
+}
+
+/* Disable flexiblity for IE8 and below */
+.lt-ie9 img,
+.lt-ie9 object,
+.lt-ie9 embed,
+.lt-ie9 video {
+  max-width: none;
+}
+
+/* Override max-width 100% for map displays */
+#map img,
+.gmap img,
+.view-gmap img,
+.openlayers-map img,
+#getlocations_map_canvas img,
+#locationmap_map img,
+.geofieldMap img,
+.views_horizontal_slider img {
+  max-width: none !important;
+}
+
+/* =============================================================================
+    Misc helpers, Accessibility classes etc
+   ========================================================================== */
+/* Prevent overflowing content */
+header[role=banner],
+.content-inner,
+.nav,
+.region-sidebar-first,
+.region-sidebar-second,
+.region-secondary-content,
+.region-tertiary-content,
+.region-footer {
+  overflow: visible;
+  word-wrap: break-word;
+}
+
+/**
+ * General classes for hiding content. These are all included as SASS mixins.
+ * @SEE: sass/_custom.scss
+ */
+/**
+ * Image replacement
+ * Kellum Method: http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement
+ * Additional helpers from http://html5boilerplate.com/docs/css/
+ */
+.ir {
+  /* Kellum Method */
+  display: block !important;
+  text-indent: 100%;
+  white-space: nowrap;
+  overflow: hidden;
+  /* Remove the default border from elements like button */
+  border: 0;
+  /* Crush the text down to take up no space */
+  font: 0/0 a;
+  /* Remove any text shadows */
+  text-shadow: none;
+  /* Hide any residual text in Safari 4 and any mobile devices that may need it */
+  color: transparent;
+  /* Hide the default background color on elements like button */
+  background-color: transparent;
+}
+
+/* More robust element-invisible and element-focuable classes */
+.element-invisible {
+  border: 0;
+  clip: rect(1px 1px 1px 1px);
+  /* IE6, IE7 */
+  clip: rect(1px, 1px, 1px, 1px);
+  height: 1px;
+  overflow: hidden;
+  padding: 0;
+  position: absolute;
+  width: 1px;
+}
+
+.element-invisible.element-focusable:active,
+.element-invisible.element-focusable:focus {
+  clip: auto;
+  height: auto;
+  overflow: visible;
+  position: static;
+  width: auto;
+}
+
+/* Shift content offscreen, can be usefull when you reall need to do this */
+.offscreen {
+  position: absolute;
+  top: -99999em;
+  width: 1px;
+  height: 1px;
+  overflow: hidden;
+  outline: 0;
+}
+
+/* Hide content from all users */
+.element-hidden {
+  display: none;
+}
diff --git a/themes/commons/commons_origins/css/global.styles.css b/themes/commons/commons_origins/css/global.styles.css
new file mode 100644
index 0000000..1572621
--- /dev/null
+++ b/themes/commons/commons_origins/css/global.styles.css
@@ -0,0 +1,7406 @@
+#menu-bar.nav ul.menu li a {
+  border-left: 1px solid #247aac;
+  -webkit-box-shadow: #224567 -1px 0px 0px;
+  -moz-box-shadow: #224567 -1px 0px 0px;
+  box-shadow: #224567 -1px 0px 0px;
+}
+
+#menu-bar.nav {
+  border-right: 1px solid #224567;
+  -webkit-box-shadow: #247aac 1px 0px 0px;
+  -moz-box-shadow: #247aac 1px 0px 0px;
+  box-shadow: #247aac 1px 0px 0px;
+}
+
+.commons-pod, .page-user .pane-views-panes, .front.not-logged-in .pane-views-panes, .front.not-logged-in
+.pane-views, .front.not-logged-in
+body.page-node .pane-views-panes, .page-events .view-commons-events-upcoming .view-content, .pane-commons-bw-group, .view-display-id-commons_events_upcoming_page .views-row, .view-commons-groups-directory > .view-content > .views-row,
+.view-commons-homepage-content .node-teaser.node-group > .view-content > .views-row, body.front.logged-in .view-commons-homepage-content > .view-content, body.front.logged-in #views-exposed-form-commons-homepage-content-panel-pane-1 .views-exposed-widgets.widgets-active, .page-events .region-three-25-50-25-third .pane-views-panes, .pane-search-result .block-content .search-results, .page-search-user .user-results {
+  background-color: white;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  -webkit-box-shadow: #858585 1px 1px 4px;
+  -moz-box-shadow: #858585 1px 1px 4px;
+  box-shadow: #858585 1px 1px 4px;
+  margin: 10px 0;
+}
+
+.commons-pod, .page-user .pane-views-panes .block-inner, .front.not-logged-in .pane-views-panes > div, .front.not-logged-in
+.pane-views > div, .front.not-logged-in
+body.page-node .pane-views-panes > div, .page-events .view-commons-events-upcoming .view-content, .pane-commons-bw-group > .block-inner, .view-display-id-commons_events_upcoming_page .views-row article, .view-commons-groups-directory > .view-content > .views-row > .node-teaser,
+.view-commons-groups-directory > .view-content > .views-row form,
+.view-commons-homepage-content .node-teaser.node-group > .view-content > .views-row > .node-teaser,
+.view-commons-homepage-content .node-teaser.node-group > .view-content > .views-row form, body.front.logged-in #views-exposed-form-commons-homepage-content-panel-pane-1 .views-exposed-widgets.widgets-active, .page-events .region-three-25-50-25-third .pane-views-panes .block-inner, .pane-search-result .block-content .search-results, .page-search-user .user-results {
+  padding: 10px;
+}
+
+.node.node-event > .node-content, .node.node-poll > .node-content, .node.node-question > .node-content, .node-teaser.node-promoted.node-event > .node-content, .node-teaser.node-promoted.node-poll > .node-content, .node-teaser.node-promoted.node-question > .node-content {
+  margin-right: 10em;
+}
+@media only screen and (max-width: 768px) {
+  .node.node-event > .node-content, .node.node-poll > .node-content, .node.node-question > .node-content, .node-teaser.node-promoted.node-event > .node-content, .node-teaser.node-promoted.node-poll > .node-content, .node-teaser.node-promoted.node-question > .node-content {
+    margin-right: 0;
+  }
+}
+
+/**
+ * @file
+ * global.styles
+ *
+ * Styles you add here will load for all device sizes, they are "global", as
+ * opposed to "responsive" styles, which only load for a given breakpoint (media
+ * query) that you set in theme settings. See the README for more details.
+ *
+ *
+ * How to use this file:
+ * --------------------
+ *
+ * There are many empty selectors and some basic styles to act as a guide.
+ * Nothing is set in stone and you can change anything - even delete all of it
+ * and start with your own clean slate.
+ *
+ * To FORCE PRINT all selectors you can search and replace a single { (opening
+ * curly brace) and insert an empty comment. This is very useful in conjuction
+ * with FireSass: https://addons.mozilla.org/en-US/firefox/addon/firesass-for-firebug/
+ *
+ * See global.base also which includes normalize.css and some additional
+ * helper classes and base styles.
+ */
+/* =============================================================================
+ *   Base
+ * ========================================================================== */
+/**
+ * To preserve theme settings never apply font properties to the HTML element.
+ * This is critically important if you are using the Responsive JavaScript
+ * feature as this relies on being able to set a pseudo font family on the HTML
+ * element. If you need to set default font properties of any kind use the BODY
+ * element as these can be overridden using font theme settings.
+ */
+html {
+  background: #e6e6e6;
+  font-size: 87.5%;
+  min-height: 100%;
+}
+html .cke_editable {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  padding: 1em;
+  background: white;
+  min-height: 200px;
+}
+
+body {
+  font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
+  color: #333333;
+  min-width: 18em;
+}
+
+/* =============================================================================
+ *   HTML Elements
+ * ========================================================================== */
+h1 {
+  font-size: 30px;
+  line-height: 30px;
+  font-weight: normal;
+  color: white;
+}
+h1 a {
+  color: white;
+}
+h1 a :hover {
+  text-decoration: none;
+}
+.site-name-long h1 {
+  font-size: 20px;
+  line-height: 25px;
+}
+.site-name-long-2-lines h1 {
+  font-size: 20px;
+  line-height: 25px;
+}
+
+h2 {
+  color: #336699;
+  font-weight: lighter;
+  font-size: 3.8em;
+  font-family: Helvetica, "Helvetica Neue", Arial, sans-serif;
+}
+
+h3 {
+  color: #2783b9;
+  font-weight: normal;
+  font-size: 1.4em;
+}
+.sidebar h3 {
+  color: #666666;
+}
+
+pre,
+code,
+tt,
+samp,
+kbd,
+var {
+  font-family: Consolas, Monaco, "Courier New", Courier, monospace, sans-serif;
+}
+
+/* =============================================================================
+ *   Wrappers
+ * ========================================================================== */
+/**
+ * Page wrapper, includes the .container class which sets the overall page or section width
+ * Main wrapper in page.tpl.php, the .container class sets the width of the page, do not add width to it!
+ */
+/**
+ * Wraps all header elements - branding and .region-header
+ */
+.header-wrapper {
+  overflow: hidden;
+}
+
+#header {
+  position: relative;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  color: white;
+  text-align: left;
+  padding-right: 10px;
+  padding-left: 10px;
+  white-space: nowrap;
+}
+#header a {
+  color: white;
+}
+@media only screen and (max-width: 768px) {
+  #header {
+    padding: 0;
+  }
+}
+
+.header-color-row-one {
+  border-top: 1.5em solid black;
+  background-color: #336699;
+  -webkit-box-shadow: #336699 0px -1px 0px;
+  -moz-box-shadow: #336699 0px -1px 0px;
+  box-shadow: #336699 0px -1px 0px;
+}
+@media only screen and (min-width: 769px) {
+  .header-color-row-one {
+    border-top: none;
+  }
+}
+
+.header-color-row-two {
+  position: relative;
+  background-color: #2783b9;
+  min-height: 2.5em;
+  border-top: 1px solid #3d9dd6;
+  border-bottom: 1px solid #1e658f;
+  z-index: 2;
+}
+
+/**
+ * Wraps the sidebars the content column
+ */
+#columns {
+  margin-right: 10px;
+  margin-left: 10px;
+}
+
+/**
+ * Footer wrapper
+ */
+#footer {
+  border-top: 1px solid #cccccc;
+  -webkit-box-shadow: inset 0 1px 0 white;
+  -moz-box-shadow: inset 0 1px 0 white;
+  box-shadow: inset 0 1px 0 white;
+  margin: 0 10px;
+}
+
+/**
+ * Default credit block
+ */
+#block-block-1 .block-title,
+#block-block-1 .block-content {
+  color: #858585;
+}
+#block-block-1 .block-title {
+  margin: 10px 0 5px;
+}
+#block-block-1 .block-content {
+  font-size: .88em;
+}
+#footer #block-block-1 {
+  margin-bottom: 0;
+}
+
+/**
+ * Generic pod wrappers
+ */
+.commons-pod {
+  /* Prevent pod nesting. */
+}
+.commons-pod .commons-pod {
+  margin: 0;
+  padding: 0;
+  background: transparent;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+}
+
+/* =============================================================================
+ *   Branding
+ * ========================================================================== */
+/**
+ * Wraps all the branding elements, logo, name and slogan
+ */
+#branding {
+  float: left;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  width: 100%;
+  padding-left: 4.1875em;
+  text-align: left;
+  margin-right: -36.5em;
+}
+@media only screen and (max-width: 480px) {
+  #branding {
+    margin-right: -11.5em;
+  }
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  #branding {
+    margin-right: -19.5em;
+  }
+}
+.people-search-active #branding {
+  margin-right: -42em;
+}
+@media only screen and (max-width: 480px) {
+  .people-search-active #branding {
+    margin-right: -14em;
+  }
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  .people-search-active #branding {
+    margin-right: -24em;
+  }
+}
+
+/**
+ * Logo
+ */
+#logo {
+  position: relative;
+  display: block;
+  float: left;
+  position: relative;
+  margin-bottom: -3em;
+  margin-left: -4.1875em;
+  z-index: 3;
+}
+
+/**
+ * Wrapper for the site name and slogan (hgroup)
+ */
+#name-and-slogan {
+  display: block;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  width: 100%;
+  vertical-align: top;
+  min-height: 4em;
+  padding-right: 36.5em;
+}
+@media only screen and (max-width: 480px) {
+  #name-and-slogan {
+    padding-right: 11.5em;
+  }
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  #name-and-slogan {
+    padding-right: 19.5em;
+  }
+}
+@media only screen and (max-width: 480px) {
+  #name-and-slogan {
+    display: none;
+  }
+}
+.people-search-active #name-and-slogan {
+  padding-right: 42em;
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  .people-search-active #name-and-slogan {
+    padding-right: 24em;
+  }
+}
+
+/**
+ * Site name (h1)
+ */
+#site-name {
+  margin: .3em 0 0;
+  font-family: 'Trebuchet MS';
+  font-weight: 700;
+}
+#site-name a:link, #site-name a:visited {
+  text-decoration: none;
+}
+#site-name a:hover, #site-name a:focus {
+  text-decoration: none;
+}
+@media only screen and (min-width: 481px) {
+  #site-name {
+    font-size: 1.4em;
+  }
+}
+
+/**
+ * Site slogan (h2)
+ */
+#site-slogan {
+  margin: 0 0 .3em;
+  font-size: 1em;
+  color: white;
+}
+
+#site-name,
+#site-slogan {
+  display: block;
+  overflow: hidden;
+  padding-right: 10px;
+  line-height: 1.2em;
+  white-space: normal;
+}
+
+/* =============================================================================
+ *   Page content header
+ * ========================================================================== */
+/**
+ * The main page title (h1)
+ */
+#page-title,
+.search-results-title {
+  margin: 0 0 .2em;
+  font-weight: 300;
+  font-size: 3.85em;
+  line-height: 1.2em;
+}
+
+.page-messages-view #page-title,
+.page-flag-confirm #page-title {
+  /* Some pages require a smaller title to prevent the equivalent of
+     "yelling". */
+  font-size: 2.5em;
+}
+
+#page-top {
+  margin: 20px 0 0;
+}
+
+/* =============================================================================
+ *   Misc Global Styles
+ * ========================================================================== */
+/**
+ * Generic styles for nodes.
+ */
+.node-actions {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  float: right;
+  width: 10em;
+  list-style: none;
+  margin: .5em -10em 0 0;
+  padding-left: 1em;
+  text-align: center;
+}
+.node-actions [class*="action-item"], .node-actions [class*="action-item"][type="submit"] {
+  margin: 0;
+}
+@media only screen and (max-width: 768px) {
+  .node-actions {
+    float: none;
+    width: auto;
+    margin: 1.7em 0;
+    text-align: left;
+  }
+}
+
+.node-teaser.node-promoted {
+  background-image: url('../images/node-promoted-star.png?1395768501');
+  background-position: top right;
+  background-repeat: no-repeat;
+  background-color: #f7f7f7;
+  border: none;
+  padding: 10px;
+  position: relative;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+}
+.node-teaser.node-promoted.user-picture-available {
+  padding-left: 78px;
+}
+.node-teaser.node-promoted.user-picture-available .user-picture {
+  position: absolute;
+  float: left;
+  width: 50px;
+  margin-left: -68px;
+  top: 10px;
+}
+.node-teaser.node-promoted.user-picture-available .user-picture img {
+  width: 50px;
+}
+@media only screen and (max-width: 480px) {
+  .node-teaser.node-promoted.user-picture-available {
+    padding-left: 10px;
+  }
+  .node-teaser.node-promoted.user-picture-available .user-picture {
+    display: none;
+  }
+}
+
+.user-picture,
+.views-field-picture {
+  background: white;
+  display: inline-block;
+  padding: 4px;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  -webkit-box-shadow: #858585 1px 1px 4px;
+  -moz-box-shadow: #858585 1px 1px 4px;
+  box-shadow: #858585 1px 1px 4px;
+  line-height: 0;
+}
+.node .user-picture:after, .comment .user-picture:after, .privatemsg-message .user-picture:after, .node
+.views-field-picture:after, .comment
+.views-field-picture:after, .privatemsg-message
+.views-field-picture:after {
+  content: "";
+  width: 5px;
+  height: 8px;
+  position: absolute;
+  right: -5px;
+  top: 10px;
+  background: url('../images/user_img_arrow.png?1395768501');
+}
+.node .user-picture img, .comment .user-picture img, .privatemsg-message .user-picture img, .node
+.views-field-picture img, .comment
+.views-field-picture img, .privatemsg-message
+.views-field-picture img {
+  width: 50px;
+}
+
+/**
+ * Form styles
+ *
+ * These styles are extracted from the Formalize library by Nathan Smith. The
+ * specific support for IE below 8 is trimmed along with references to font
+ * families and the extra buttons styles.
+ */
+input:invalid,
+button:invalid,
+select:invalid,
+textarea:invalid,
+[class*=" action-item"]:invalid {
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+}
+input:focus,
+button:focus,
+select:focus,
+textarea:focus,
+[class*=" action-item"]:focus {
+  -webkit-box-shadow: #0066ff 0 0 5px 0;
+  -moz-box-shadow: #0066ff 0 0 5px 0;
+  box-shadow: #0066ff 0 0 5px 0;
+  z-index: 1;
+}
+
+label {
+  margin-top: .5em;
+  margin-bottom: .5em;
+}
+
+input[type="file"]:focus, input[type="file"]:active,
+input[type="radio"]:focus,
+input[type="radio"]:active,
+input[type="checkbox"]:focus,
+input[type="checkbox"]:active {
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+}
+
+textarea,
+select,
+input[type="date"],
+input[type="datetime"],
+input[type="datetime-local"],
+input[type="email"],
+input[type="month"],
+input[type="number"],
+input[type="password"],
+input[type="search"],
+input[type="tel"],
+input[type="text"],
+input[type="time"],
+input[type="url"],
+input[type="week"] {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  -webkit-background-clip: padding;
+  -moz-background-clip: padding;
+  background-clip: padding-box;
+  -webkit-border-radius: 2px;
+  -moz-border-radius: 2px;
+  -ms-border-radius: 2px;
+  -o-border-radius: 2px;
+  border-radius: 2px;
+  -webkit-appearance: none;
+  background-color: white;
+  border: 1px solid #cccccc;
+  color: black;
+  outline: 0;
+  margin: 0;
+  padding: .5em;
+  text-align: left;
+  vertical-align: top;
+  line-height: 1.2em;
+}
+textarea[disabled],
+select[disabled],
+input[type="date"][disabled],
+input[type="datetime"][disabled],
+input[type="datetime-local"][disabled],
+input[type="email"][disabled],
+input[type="month"][disabled],
+input[type="number"][disabled],
+input[type="password"][disabled],
+input[type="search"][disabled],
+input[type="tel"][disabled],
+input[type="text"][disabled],
+input[type="time"][disabled],
+input[type="url"][disabled],
+input[type="week"][disabled] {
+  background-color: #eeeeee;
+}
+
+input::-webkit-input-placeholder,
+textarea::-webkit-input-placeholder {
+  color: #888888;
+}
+
+input:-moz-placeholder,
+textarea:-moz-placeholder {
+  color: #888888;
+}
+
+textarea,
+input[type="date"],
+input[type="datetime"],
+input[type="datetime-local"],
+input[type="email"],
+input[type="month"],
+input[type="number"],
+input[type="password"],
+input[type="search"],
+input[type="tel"],
+input[type="text"],
+input[type="time"],
+input[type="url"],
+input[type="week"] {
+  width: 100%;
+  max-width: 100%;
+}
+
+textarea,
+select[size],
+select[multiple] {
+  height: auto;
+}
+
+@media (-webkit-min-device-pixel-ratio: 0) {
+  select[size],
+  select[multiple],
+  select[multiple][size] {
+    background-image: none;
+    padding-right: 3px;
+  }
+
+  select,
+  select[size="0"],
+  select[size="1"] {
+    -webkit-border-radius: 3px;
+    -moz-border-radius: 3px;
+    -ms-border-radius: 3px;
+    -o-border-radius: 3px;
+    border-radius: 3px;
+    background-image: url(data:image/png;base64,R0lGODlhDQAEAIAAAAAAAP8A/yH5BAEHAAEALAAAAAANAAQAAAILhA+hG5jMDpxvhgIAOw==);
+    background-repeat: no-repeat;
+    background-position: right center;
+    padding-right: 20px;
+  }
+
+  ::-webkit-validation-bubble-message {
+    -webkit-box-shadow: none;
+    box-shadow: none;
+    background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #666666), color-stop(1, black));
+    border: 1px solid;
+    border-color: #747474 #5e5e5e #4f4f4f;
+    color: white;
+    overflow: hidden;
+    padding: 15px 15px 17px;
+    text-shadow: black 0 0 1px;
+    height: 16px;
+  }
+
+  ::-webkit-validation-bubble-arrow,
+  ::-webkit-validation-bubble-top-outer-arrow,
+  ::-webkit-validation-bubble-top-inner-arrow {
+    -webkit-box-shadow: none;
+    box-shadow: none;
+    background: #666666;
+    border: 0;
+  }
+}
+textarea {
+  overflow: auto;
+  resize: vertical;
+  width: 100%;
+}
+
+optgroup {
+  color: black;
+  font-style: normal;
+  font-weight: normal;
+}
+optgroup::-moz-focus-inner {
+  border: 0;
+  padding: 0;
+}
+
+/* Simulate a chosen select form value as inline text. */
+.hidden-select-wrapper {
+  position: relative;
+  display: inline-block;
+  -webkit-transition: width 0.2s;
+  -moz-transition: width 0.2s;
+  -o-transition: width 0.2s;
+  transition: width 0.2s;
+}
+
+.select-status {
+  display: inline-block;
+  white-space: nowrap;
+  -webkit-transition: opacity 0.2s;
+  -moz-transition: opacity 0.2s;
+  -o-transition: opacity 0.2s;
+  transition: opacity 0.2s;
+}
+.select-status:after {
+  content: "";
+  position: relative;
+  top: .2em;
+  display: inline-block;
+  width: 0;
+  height: 0;
+  margin-left: .2em;
+  border: .4em solid transparent;
+  border-top-color: #2783b9;
+}
+
+.hidden-select {
+  position: absolute;
+  top: -.35em;
+  left: -.35em;
+  margin: 0;
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
+  opacity: 0;
+}
+.select-inactive .hidden-select {
+  width: 100%;
+}
+
+/* Replace the default Drupal throbber with a custom one. */
+html.js input.form-autocomplete {
+  background-image: none;
+  background-position: right center;
+  padding-right: 20px;
+}
+html.js input.form-autocomplete.throbbing {
+  background-image: url('../images/commons-throbber.gif?1395336282');
+  background-position: right center;
+}
+
+.general-settings {
+  padding-top: 0;
+  padding-bottom: 0;
+}
+
+.fieldset-outer-wrapper {
+  margin: 1.7em 0;
+  padding: 1.7em 0;
+  border-top: 1px solid #cccccc;
+  border-color: #cccccc;
+  border-style: solid;
+  border-width: 1px 0;
+  /* Some form items have nested fieldsets that mess with the sibling
+     selectors and need some extra love. */
+}
+.fieldset-outer-wrapper + .fieldset-outer-wrapper {
+  border-top-width: 0;
+}
+.general-settings .fieldset-outer-wrapper {
+  margin-top: 0;
+  margin-bottom: 0;
+  padding-left: 10px;
+  padding-right: 10px;
+}
+.general-settings > .fieldset-outer-wrapper {
+  margin-left: -10px;
+  margin-right: -10px;
+}
+.general-settings > .fieldset-outer-wrapper:first-child {
+  border-top: none;
+}
+.general-settings > .fieldset-outer-wrapper:last-child {
+  border-bottom-width: 0;
+}
+.field-name-og-group-ref .fieldset-outer-wrapper {
+  border-top: none;
+  margin-top: 0;
+  padding-top: 0;
+}
+.field-name-og-group-ref .fieldset-outer-wrapper, .field-type-datetime-form .fieldset-outer-wrapper {
+  border-bottom: none;
+  margin-bottom: 0;
+  padding-bottom: 0;
+}
+
+fieldset {
+  border: none;
+  margin: 0;
+  padding: .01em 0;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+}
+
+legend {
+  -webkit-padding-start: 0;
+  -webkit-padding-end: 0;
+  line-height: 1.2em;
+}
+legend + .fieldset-wrapper {
+  -webkit-margin-top-collapse: separate;
+  margin-top: 1.2em;
+}
+
+.fieldset-legend {
+  display: block;
+  font-size: 1.2em;
+  line-height: 1.2em;
+  font-weight: light;
+}
+html.js fieldset.collapsed .fieldset-legend, html.js fieldset.collapsible .fieldset-legend {
+  padding: 0;
+  background: none;
+}
+.fieldset-legend span.summary {
+  display: block;
+  margin: 0;
+  font-size: .76em;
+  font-weight: normal;
+}
+.collapsible > legend .fieldset-legend {
+  display: block;
+  text-indent: -.5em;
+  margin-left: .6em;
+}
+.collapsible > legend .fieldset-legend span.summary {
+  margin-left: .7em;
+}
+.collapsible > legend .fieldset-legend a:before {
+  display: inline-block;
+  position: relative;
+  margin-right: .2em;
+  width: 0;
+  height: 0;
+  overflow: hidden;
+  border: .2em solid transparent;
+  border-top-color: #333333;
+  content: "";
+  top: -.1em;
+  left: -.1em;
+}
+.collapsed > legend .fieldset-legend a:before {
+  border-top-color: transparent;
+  border-left-color: #333333;
+  top: -.2em;
+  left: auto;
+}
+
+.form-item:first-child {
+  margin-top: 0;
+}
+.form-item:last-child {
+  margin-bottom: 0;
+}
+
+.filter-wrapper {
+  margin: 0;
+  padding: 0;
+}
+
+/**
+ * Button styles
+ */
+/* Common styles for all buttons. */
+.button,
+button,
+[type="reset"],
+[type="submit"],
+[type="button"],
+[class*="action-item"], .pane-commons-groups-commons-groups-create-group a, .pane-commons-events-commons-events-create-event-link a, [class*="action-item-small"], .commons-sign-up,
+.commons-login, [class*="action-item-large"] {
+  -webkit-appearance: none;
+  display: inline-block;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  margin: .5em .3em .5em 0;
+  max-width: 100%;
+  overflow: visible;
+  line-height: 1.2em;
+  vertical-align: baseline;
+  border-style: solid;
+  border-width: 1px;
+  -webkit-border-radius: 2px;
+  -moz-border-radius: 2px;
+  -ms-border-radius: 2px;
+  -o-border-radius: 2px;
+  border-radius: 2px;
+  /* Reset all button fonts to a similar baseline in webkit. */
+  font: -webkit-small-control;
+  font-family: "Helvetica Neue", Arial, "Liberation Sans", FreeSans, sans-serif;
+  font-weight: light;
+  letter-spacing: .06em;
+  text-align: center;
+  text-decoration: none;
+  outline: 0;
+  cursor: pointer;
+}
+.button:focus,
+button:focus,
+[type="reset"]:focus,
+[type="submit"]:focus,
+[type="button"]:focus,
+[class*="action-item"]:focus, .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-events-commons-events-create-event-link a:focus, [class*="action-item-small"]:focus, .commons-sign-up:focus,
+.commons-login:focus, [class*="action-item-large"]:focus, .button:hover,
+button:hover,
+[type="reset"]:hover,
+[type="submit"]:hover,
+[type="button"]:hover,
+[class*="action-item"]:hover, .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-events-commons-events-create-event-link a:hover, [class*="action-item-small"]:hover, .commons-sign-up:hover,
+.commons-login:hover, [class*="action-item-large"]:hover {
+  text-decoration: none;
+}
+.button:active,
+button:active,
+[type="reset"]:active,
+[type="submit"]:active,
+[type="button"]:active,
+[class*="action-item"]:active, .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-events-commons-events-create-event-link a:active, [class*="action-item-small"]:active, .commons-sign-up:active,
+.commons-login:active, [class*="action-item-large"]:active {
+  -webkit-box-shadow: inset rgba(0, 0, 0, 0.25) 0 1px 2px 0;
+  -moz-box-shadow: inset rgba(0, 0, 0, 0.25) 0 1px 2px 0;
+  box-shadow: inset rgba(0, 0, 0, 0.25) 0 1px 2px 0;
+  text-decoration: none;
+}
+.button::-moz-focus-inner,
+button::-moz-focus-inner,
+[type="reset"]::-moz-focus-inner,
+[type="submit"]::-moz-focus-inner,
+[type="button"]::-moz-focus-inner,
+[class*="action-item"]::-moz-focus-inner, .pane-commons-groups-commons-groups-create-group a::-moz-focus-inner, .pane-commons-events-commons-events-create-event-link a::-moz-focus-inner, [class*="action-item-small"]::-moz-focus-inner, .commons-sign-up::-moz-focus-inner,
+.commons-login::-moz-focus-inner, [class*="action-item-large"]::-moz-focus-inner {
+  border: 0;
+  padding: 0;
+}
+
+/* Dimensions for the default button type. */
+.button,
+button,
+[type="reset"],
+[type="submit"],
+[type="button"],
+[class*="action-item"], .pane-commons-groups-commons-groups-create-group a, .pane-commons-events-commons-events-create-event-link a {
+  padding: 0.5em 1.5em;
+  font-size: 1em;
+}
+
+/* Dimensions for the small button type. */
+[class*="action-item-small"], .commons-sign-up,
+.commons-login {
+  padding: 0.3em 1em;
+  font-size: 0.88em;
+}
+
+/* Dimensions for the large button type. */
+[class*="action-item-large"] {
+  padding: 0.5em 1.5em;
+  font-size: 1.2em;
+}
+
+.button,
+button,
+[type="reset"],
+[type="submit"],
+[type="button"],
+[class*="action-item"], .commons-login {
+  background-color: #fefefe;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ffffff), color-stop(100%, #f1f1f1));
+  background: -webkit-linear-gradient(#ffffff, #f1f1f1);
+  background: -moz-linear-gradient(#ffffff, #f1f1f1);
+  background: -o-linear-gradient(#ffffff, #f1f1f1);
+  background: linear-gradient(#ffffff, #f1f1f1);
+  border-color: #cbcbcb;
+  text-shadow: -1px 1px 2px white, -1px -1px 2px white, 1px -1px 2px white, 1px 1px 2px white;
+}
+.button,
+button,
+[type="reset"],
+[type="submit"],
+[type="button"],
+[class*="action-item"], .commons-login, .button:link,
+button:link,
+[type="reset"]:link,
+[type="submit"]:link,
+[type="button"]:link,
+[class*="action-item"]:link, .commons-login:link, .button:visited,
+button:visited,
+[type="reset"]:visited,
+[type="submit"]:visited,
+[type="button"]:visited,
+[class*="action-item"]:visited, .commons-login:visited {
+  color: #323232;
+}
+.button:hover,
+button:hover,
+[type="reset"]:hover,
+[type="submit"]:hover,
+[type="button"]:hover,
+[class*="action-item"]:hover, .commons-login:hover {
+  color: #3f3f3f;
+  background-color: #f1f1f1;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #fefefe), color-stop(100%, #e5e5e5));
+  background: -webkit-linear-gradient(#fefefe, #e5e5e5);
+  background: -moz-linear-gradient(#fefefe, #e5e5e5);
+  background: -o-linear-gradient(#fefefe, #e5e5e5);
+  background: linear-gradient(#fefefe, #e5e5e5);
+  border-color: #b2b2b2;
+  text-shadow: -1px 1px 2px #fefefe, -1px -1px 2px #fefefe, 1px -1px 2px #fefefe, 1px 1px 2px #fefefe;
+}
+.button:focus,
+button:focus,
+[type="reset"]:focus,
+[type="submit"]:focus,
+[type="button"]:focus,
+[class*="action-item"]:focus, .commons-login:focus, .button:active,
+button:active,
+[type="reset"]:active,
+[type="submit"]:active,
+[type="button"]:active,
+[class*="action-item"]:active, .commons-login:active {
+  background: #fefefe;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #f1f1f1), color-stop(100%, #ffffff));
+  background: -webkit-linear-gradient(#f1f1f1, #ffffff);
+  background: -moz-linear-gradient(#f1f1f1, #ffffff);
+  background: -o-linear-gradient(#f1f1f1, #ffffff);
+  background: linear-gradient(#f1f1f1, #ffffff);
+  border-color: #cbcbcb;
+  text-shadow: -1px 1px 2px white, -1px -1px 2px white, 1px -1px 2px white, 1px 1px 2px white;
+}
+[disabled].button,
+button[disabled],
+[disabled][type="reset"],
+[disabled][type="submit"],
+[disabled][type="button"],
+[disabled][class*="action-item"], [disabled].commons-login {
+  color: #cbcbcb;
+  background: #fefefe;
+  border-color: #cbcbcb;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+
+.action-item-active, .action-item-active[type="reset"], .action-item-active[type="submit"], .action-item-active[type="button"],
+.action-item-small-active,
+.action-item-small-active[type="reset"],
+.action-item-small-active[type="submit"],
+.action-item-small-active[type="button"],
+.action-item-large-active,
+.action-item-large-active[type="reset"],
+.action-item-large-active[type="submit"],
+.action-item-large-active[type="button"], [class*="flag-commons-follow-"] a.unflag-action {
+  background-color: #f3f3f3;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.2em #a6a6a6;
+  -moz-box-shadow: inset 0.1em 0.1em 0.2em #a6a6a6;
+  box-shadow: inset 0.1em 0.1em 0.2em #a6a6a6;
+  border-color: silver;
+  text-shadow: -1px 1px 2px white, -1px -1px 2px white, 1px -1px 2px white, 1px 1px 2px white;
+}
+.action-item-active, .action-item-active[type="reset"], .action-item-active[type="submit"], .action-item-active[type="button"],
+.action-item-small-active,
+.action-item-small-active[type="reset"],
+.action-item-small-active[type="submit"],
+.action-item-small-active[type="button"],
+.action-item-large-active,
+.action-item-large-active[type="reset"],
+.action-item-large-active[type="submit"],
+.action-item-large-active[type="button"], [class*="flag-commons-follow-"] a.unflag-action, .action-item-active:link,
+.action-item-small-active:link,
+.action-item-large-active:link, [class*="flag-commons-follow-"] a.unflag-action:link, .action-item-active:visited,
+.action-item-small-active:visited,
+.action-item-large-active:visited, [class*="flag-commons-follow-"] a.unflag-action:visited {
+  color: #272727;
+}
+.action-item-active:hover,
+.action-item-small-active:hover,
+.action-item-large-active:hover, [class*="flag-commons-follow-"] a.unflag-action:hover {
+  color: #343434;
+  background-color: #e6e6e6;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.2em #9a9a9a;
+  -moz-box-shadow: inset 0.1em 0.1em 0.2em #9a9a9a;
+  box-shadow: inset 0.1em 0.1em 0.2em #9a9a9a;
+  border-color: #a6a6a6;
+  text-shadow: -1px 1px 2px #f3f3f3, -1px -1px 2px #f3f3f3, 1px -1px 2px #f3f3f3, 1px 1px 2px #f3f3f3;
+}
+.action-item-active:focus,
+.action-item-small-active:focus,
+.action-item-large-active:focus, [class*="flag-commons-follow-"] a.unflag-action:focus, .action-item-active:active,
+.action-item-small-active:active,
+.action-item-large-active:active, [class*="flag-commons-follow-"] a.unflag-action:active {
+  background: #f3f3f3;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.2em #a6a6a6;
+  -moz-box-shadow: inset 0.1em 0.1em 0.2em #a6a6a6;
+  box-shadow: inset 0.1em 0.1em 0.2em #a6a6a6;
+  border-color: silver;
+  text-shadow: -1px 1px 2px white, -1px -1px 2px white, 1px -1px 2px white, 1px 1px 2px white;
+}
+[disabled].action-item-active,
+[disabled].action-item-small-active,
+[disabled].action-item-large-active, [class*="flag-commons-follow-"] a[disabled].unflag-action {
+  color: silver;
+  background: #f3f3f3;
+  border-color: silver;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+
+.action-item-primary, .action-item-primary[type="reset"], .action-item-primary[type="submit"], .action-item-primary[type="button"],
+.action-item-small-primary,
+.action-item-small-primary[type="reset"],
+.action-item-small-primary[type="submit"],
+.action-item-small-primary[type="button"],
+.action-item-large-primary,
+.action-item-large-primary[type="reset"],
+.action-item-large-primary[type="submit"],
+.action-item-large-primary[type="button"], .commons-sign-up, .pane-commons-groups-commons-groups-create-group a, .pane-commons-events-commons-events-create-event-link a {
+  background-color: #46bb2e;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #4fcd35), color-stop(100%, #3ea729));
+  background: -webkit-linear-gradient(#4fcd35, #3ea729);
+  background: -moz-linear-gradient(#4fcd35, #3ea729);
+  background: -o-linear-gradient(#4fcd35, #3ea729);
+  background: linear-gradient(#4fcd35, #3ea729);
+  border-color: #27691a;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+.action-item-primary, .action-item-primary[type="reset"], .action-item-primary[type="submit"], .action-item-primary[type="button"],
+.action-item-small-primary,
+.action-item-small-primary[type="reset"],
+.action-item-small-primary[type="submit"],
+.action-item-small-primary[type="button"],
+.action-item-large-primary,
+.action-item-large-primary[type="reset"],
+.action-item-large-primary[type="submit"],
+.action-item-large-primary[type="button"], .commons-sign-up, .pane-commons-groups-commons-groups-create-group a, .pane-commons-events-commons-events-create-event-link a, .action-item-primary:link,
+.action-item-small-primary:link,
+.action-item-large-primary:link, .commons-sign-up:link, .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-events-commons-events-create-event-link a:link, .action-item-primary:visited,
+.action-item-small-primary:visited,
+.action-item-large-primary:visited, .commons-sign-up:visited, .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-events-commons-events-create-event-link a:visited {
+  color: white;
+}
+.action-item-primary:hover,
+.action-item-small-primary:hover,
+.action-item-large-primary:hover, .commons-sign-up:hover, .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-events-commons-events-create-event-link a:hover {
+  color: white;
+  background-color: #3ea729;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #46bb2e), color-stop(100%, #379224));
+  background: -webkit-linear-gradient(#46bb2e, #379224);
+  background: -moz-linear-gradient(#46bb2e, #379224);
+  background: -o-linear-gradient(#46bb2e, #379224);
+  background: linear-gradient(#46bb2e, #379224);
+  border-color: #184010;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+.action-item-primary:focus,
+.action-item-small-primary:focus,
+.action-item-large-primary:focus, .commons-sign-up:focus, .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-events-commons-events-create-event-link a:focus, .action-item-primary:active,
+.action-item-small-primary:active,
+.action-item-large-primary:active, .commons-sign-up:active, .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-events-commons-events-create-event-link a:active {
+  background: #46bb2e;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #3ea729), color-stop(100%, #4fcd35));
+  background: -webkit-linear-gradient(#3ea729, #4fcd35);
+  background: -moz-linear-gradient(#3ea729, #4fcd35);
+  background: -o-linear-gradient(#3ea729, #4fcd35);
+  background: linear-gradient(#3ea729, #4fcd35);
+  border-color: #27691a;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+[disabled].action-item-primary,
+[disabled].action-item-small-primary,
+[disabled].action-item-large-primary, [disabled].commons-sign-up, .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-events-commons-events-create-event-link a[disabled] {
+  color: #85dc73;
+  background: #46bb2e;
+  border-color: #27691a;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+
+.action-item-primary-active, .action-item-primary-active[type="reset"], .action-item-primary-active[type="submit"], .action-item-primary-active[type="button"],
+.action-item-small-primary-active,
+.action-item-small-primary-active[type="reset"],
+.action-item-small-primary-active[type="submit"],
+.action-item-small-primary-active[type="button"],
+.action-item-large-primary-active,
+.action-item-large-primary-active[type="reset"],
+.action-item-large-primary-active[type="submit"],
+.action-item-large-primary-active[type="button"] {
+  background-color: #46bb2e;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.2em #184010;
+  -moz-box-shadow: inset 0.1em 0.1em 0.2em #184010;
+  box-shadow: inset 0.1em 0.1em 0.2em #184010;
+  border-color: #27691a;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+.action-item-primary-active, .action-item-primary-active[type="reset"], .action-item-primary-active[type="submit"], .action-item-primary-active[type="button"],
+.action-item-small-primary-active,
+.action-item-small-primary-active[type="reset"],
+.action-item-small-primary-active[type="submit"],
+.action-item-small-primary-active[type="button"],
+.action-item-large-primary-active,
+.action-item-large-primary-active[type="reset"],
+.action-item-large-primary-active[type="submit"],
+.action-item-large-primary-active[type="button"], .action-item-primary-active:link,
+.action-item-small-primary-active:link,
+.action-item-large-primary-active:link, .action-item-primary-active:visited,
+.action-item-small-primary-active:visited,
+.action-item-large-primary-active:visited {
+  color: white;
+}
+.action-item-primary-active:hover,
+.action-item-small-primary-active:hover,
+.action-item-large-primary-active:hover {
+  color: white;
+  background-color: #3ea729;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.2em #102c0b;
+  -moz-box-shadow: inset 0.1em 0.1em 0.2em #102c0b;
+  box-shadow: inset 0.1em 0.1em 0.2em #102c0b;
+  border-color: #184010;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+.action-item-primary-active:focus,
+.action-item-small-primary-active:focus,
+.action-item-large-primary-active:focus, .action-item-primary-active:active,
+.action-item-small-primary-active:active,
+.action-item-large-primary-active:active {
+  background: #46bb2e;
+  -webkit-box-shadow: inset 0.1em 0.1em 0.2em #184010;
+  -moz-box-shadow: inset 0.1em 0.1em 0.2em #184010;
+  box-shadow: inset 0.1em 0.1em 0.2em #184010;
+  border-color: #27691a;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+[disabled].action-item-primary-active,
+[disabled].action-item-small-primary-active,
+[disabled].action-item-large-primary-active {
+  color: #85dc73;
+  background: #46bb2e;
+  border-color: #27691a;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+
+.button,
+button,
+[type="reset"],
+[type="submit"],
+[type="button"],
+[class*="action-item"] {
+  max-width: 100%;
+}
+@media only screen and (max-width: 480px) {
+  .button:not(.action-item-inline, .action-item-merge),
+  button:not(.action-item-inline, .action-item-merge),
+  [type="reset"]:not(.action-item-inline, .action-item-merge),
+  [type="submit"]:not(.action-item-inline, .action-item-merge),
+  [type="button"]:not(.action-item-inline, .action-item-merge),
+  [class*="action-item"]:not(.action-item-inline, .action-item-merge) {
+    display: block;
+    width: 100%;
+    margin: .5em 0;
+  }
+}
+#panels-ipe-control-container .button, #panels-ipe-control-container
+button, #panels-ipe-control-container
+[type="reset"], #panels-ipe-control-container
+[type="submit"], #panels-ipe-control-container
+[type="button"], #panels-ipe-control-container
+[class*="action-item"] {
+  text-shadow: none;
+}
+
+.action-item-merge + .action-item-merge {
+  -moz-border-radius-topleft: 0;
+  -webkit-border-top-left-radius: 0;
+  border-top-left-radius: 0;
+  -moz-border-radius-bottomleft: 0;
+  -webkit-border-bottom-left-radius: 0;
+  border-bottom-left-radius: 0;
+  margin-left: -.5em;
+}
+
+.action-item-append,
+.action-item-small-append,
+.action-item-large-append {
+  position: relative;
+  padding-right: .5em;
+  padding-left: .5em;
+}
+.action-item-append, .action-item-append:active, .action-item-append:focus, .action-item-append:hover,
+.action-item-small-append,
+.action-item-small-append:active,
+.action-item-small-append:focus,
+.action-item-small-append:hover,
+.action-item-large-append,
+.action-item-large-append:active,
+.action-item-large-append:focus,
+.action-item-large-append:hover {
+  background: #cccccc;
+  border-color: #858585;
+  color: #333333;
+  cursor: default;
+  text-shadow: none;
+}
+.action-item-append:before, .action-item-append:after,
+.action-item-small-append:before,
+.action-item-small-append:after,
+.action-item-large-append:before,
+.action-item-large-append:after {
+  content: "";
+  display: block;
+  position: absolute;
+  top: 50%;
+  border-color: transparent;
+  border-style: solid;
+}
+.action-item-append:before,
+.action-item-small-append:before,
+.action-item-large-append:before {
+  left: -10px;
+  margin-top: -5px;
+  border-width: 5px;
+  border-right-color: #858585;
+}
+.action-item-append:after,
+.action-item-small-append:after,
+.action-item-large-append:after {
+  left: -8px;
+  margin-top: -4px;
+  border-width: 4px;
+  border-right-color: #cccccc;
+}
+
+/* Reset some styles for the admin toolbar. */
+.drupal-navbar .icon.handle {
+  margin: 0;
+  padding: 0;
+}
+.drupal-navbar .icon.handle:hover {
+  background: none;
+}
+
+/* Make the disabled buttons subdued. */
+[disabled], [disabled] option, [disabled] optgroup {
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=60);
+  opacity: 0.6;
+  -moz-user-select: -moz-none;
+  -webkit-user-select: none;
+  -khtml-user-select: none;
+  user-select: none;
+  cursor: normal;
+}
+
+/**
+ * Specialty buttons
+ */
+/* Like widget */
+.rate-widget-commons_like {
+  white-space: nowrap;
+}
+
+.rate-commons-like-btn:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -563px no-repeat;
+  width: 10px;
+  height: 14px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  margin-top: -2px;
+  margin-bottom: -2px;
+}
+
+/* Follow buttons */
+[class*="flag-commons-follow-"] .flag-action {
+  white-space: nowrap;
+}
+[class*="flag-commons-follow-"] .flag-action:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -1050px no-repeat;
+  width: 13px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+[class*="flag-commons-follow-"] .flag-throbber {
+  display: none;
+}
+[class*="flag-commons-follow-"] .flag-message {
+  display: none !important;
+}
+
+/* Report as inappropriate */
+.flag-inappropriate-node,
+.flag-inappropriate-comment {
+  display: block;
+  clear: both;
+  margin: 1em 0 0;
+}
+.flag-inappropriate-node .flag-action:before,
+.flag-inappropriate-comment .flag-action:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -1081px no-repeat;
+  width: 12px;
+  height: 10px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+/* ShareThis */
+.sharethis-buttons {
+  position: relative;
+}
+.sharethis-buttons:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -958px no-repeat;
+  width: 12px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.sharethis-wrapper {
+  position: absolute;
+  left: 0;
+  bottom: 80%;
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
+  opacity: 0;
+  visibility: hidden;
+  white-space: nowrap;
+  background: white;
+  border: 1px solid #46ba31;
+  -webkit-border-radius: 2px;
+  -moz-border-radius: 2px;
+  -ms-border-radius: 2px;
+  -o-border-radius: 2px;
+  border-radius: 2px;
+  padding: 10px;
+  margin-bottom: 10px;
+  -webkit-transition: opacity 0.3s ease, bottom 0.3s ease, visibility 0.3s ease;
+  -webkit-transition-delay: 0.4s, 0.4s, 0.4s;
+  -moz-transition: opacity 0.3s ease 0.4s, bottom 0.3s ease 0.4s, visibility 0.3s ease 0.4s;
+  -o-transition: opacity 0.3s ease 0.4s, bottom 0.3s ease 0.4s, visibility 0.3s ease 0.4s;
+  transition: opacity 0.3s ease 0.4s, bottom 0.3s ease 0.4s, visibility 0.3s ease 0.4s;
+  z-index: 9;
+}
+.sharethis-wrapper:before, .sharethis-wrapper:after {
+  display: block;
+  content: "";
+  width: 0;
+  height: 0;
+  border-style: solid;
+  border-color: transparent;
+  position: absolute;
+  top: 100%;
+  z-index: 10;
+}
+.sharethis-wrapper:before {
+  border-width: 10px;
+  border-top-color: #46ba31;
+  left: 10px;
+}
+.sharethis-wrapper:after {
+  border-width: 9px;
+  border-top-color: white;
+  left: 11px;
+}
+.sharethis-wrapper > span {
+  display: inline-block;
+  margin-top: -5px;
+}
+.sharethis:hover .sharethis-wrapper, .sharethis-buttons:active .sharethis-wrapper {
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
+  opacity: 1;
+  visibility: visible;
+  bottom: 100%;
+}
+.sharethis-buttons:active .sharethis-wrapper {
+  -webkit-transition-delay: 0s;
+  -moz-transition-delay: 0s;
+  -o-transition-delay: 0s;
+  transition-delay: 0s;
+}
+
+/* Comments */
+.comment-comments {
+  white-space: nowrap;
+}
+.comment-comments .action-item-small {
+  padding-top: 0;
+  padding-right: 0;
+  padding-bottom: 0;
+}
+.comment-comments .action-item-small:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -1238px no-repeat;
+  width: 13px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+.comment-comments .action-item-small-append {
+  margin: -1px -1px -1px 1em;
+  font-size: 1em;
+  -moz-border-radius-topleft: 0;
+  -webkit-border-top-left-radius: 0;
+  border-top-left-radius: 0;
+  -moz-border-radius-bottomleft: 0;
+  -webkit-border-bottom-left-radius: 0;
+  border-bottom-left-radius: 0;
+}
+
+/* Drupal specific field styling. */
+.field-label-inline {
+  margin: 1.7em 0;
+}
+.field-label-inline .field-label,
+.field-label-inline .field-items,
+.field-label-inline .field-item {
+  display: inline;
+  float: none;
+}
+.field-label-inline .field-item {
+  margin: 0 .1em;
+}
+.field-label-inline .field-item:first-child {
+  margin-left: 0;
+}
+.field-label-inline .field-item:last-child {
+  margin-right: 0;
+}
+.field-label-inline .field-item:after {
+  content: ", ";
+}
+.field-label-inline .field-item:last-child:after {
+  content: "";
+}
+.field-label-inline .field-label {
+  font-weight: bold;
+  color: #333333;
+}
+
+/**
+ * User avatar
+ */
+.user-picture-available {
+  position: relative;
+  padding-left: 68px;
+}
+.user-picture-available .user-picture {
+  position: absolute;
+  float: left;
+  width: 50px;
+  margin-left: -68px;
+  top: 0;
+}
+.user-picture-available .user-picture img {
+  width: 50px;
+}
+@media only screen and (max-width: 480px) {
+  .user-picture-available {
+    padding-left: 0;
+  }
+  .user-picture-available .user-picture {
+    display: none;
+  }
+}
+
+/**
+ * Filter drawer accessories
+ */
+.filter-trigger {
+  display: none;
+  background: white;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  padding: 5px;
+  position: absolute;
+  top: 0;
+  left: -39px;
+  width: 40px;
+  border: 1px solid #cccccc;
+  border-right: none;
+  -webkit-border-radius: 3px 0 0 3px;
+  -moz-border-radius: 3px 0 0 3px;
+  -ms-border-radius: 3px 0 0 3px;
+  -o-border-radius: 3px 0 0 3px;
+  border-radius: 3px 0 0 3px;
+  text-align: center;
+  font: 0/0 a;
+  line-height: 0;
+  color: transparent;
+  -webkit-box-shadow: rgba(51, 51, 51, 0.4) -1px 1px 2px;
+  -moz-box-shadow: rgba(51, 51, 51, 0.4) -1px 1px 2px;
+  box-shadow: rgba(51, 51, 51, 0.4) -1px 1px 2px;
+  cursor: pointer;
+  z-index: 1;
+}
+.filter-trigger:after {
+  content: "\00ab";
+  display: block;
+  font-size: 38.4px;
+  line-height: .8em;
+  padding-bottom: .15em;
+  color: #336699;
+}
+.expanded .filter-trigger:after {
+  content: "\00bb";
+}
+.filter-trigger.following {
+  position: fixed;
+  right: 0;
+  left: auto;
+}
+
+.filters-processed.expanded .region-inner {
+  position: relative;
+  border: 1px solid #cccccc;
+  border-right: none;
+  z-index: 0;
+  -webkit-box-shadow: rgba(51, 51, 51, 0.4) -1px 1px 2px;
+  -moz-box-shadow: rgba(51, 51, 51, 0.4) -1px 1px 2px;
+  box-shadow: rgba(51, 51, 51, 0.4) -1px 1px 2px;
+}
+
+.filter-overlay {
+  position: fixed;
+  top: 0;
+  left: 0;
+  display: none;
+  width: 100%;
+  height: 100%;
+  overflow: hidden;
+  background: rgba(255, 255, 255, 0.8);
+}
+
+/**
+ * Aggregator feed source
+ */
+#aggregator .feed-source .feed-icon {
+  display: inline;
+  float: none;
+  margin-right: 10px;
+}
+
+.feed-details dt,
+.feed-details dd {
+  display: inline;
+  margin: 0;
+}
+
+/**
+ * Generic styles for the more link
+ */
+.more-link {
+  background-image: url('../images/icons/icon-more.png?1395768501');
+  background-repeat: no-repeat;
+  min-height: 14px;
+  padding: 0 0 0 1.7em;
+  float: right;
+  font-size: 0.85em;
+  line-height: 14px;
+  margin-top: 10px;
+}
+.more-link a {
+  color: #858585;
+}
+
+/**
+ * Generic styles for links. See the ul.links declaration in node and comment stylesheets
+ */
+ul.links {
+  margin: 0;
+  padding: 0;
+}
+ul.links.inline {
+  display: block;
+}
+ul.links li {
+  display: inline-block;
+  list-style: none;
+}
+
+.quicktabs-style-commons-pills ul.quicktabs-tabs,
+ul.primary.tabs {
+  border-bottom: none;
+  padding: 0;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li,
+ul.primary.tabs li {
+  margin-bottom: 5px;
+  margin-top: 5px;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+ul.primary.tabs li a {
+  background-color: rgba(153, 153, 153, 0.3);
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  padding: .3em .8em;
+  display: inline-block;
+  border: none;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+ul.primary.tabs li a,
+ul.primary.tabs li a span {
+  color: #2783b9;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+ul.primary.tabs li a:hover {
+  text-decoration: none;
+  background-color: rgba(153, 153, 153, 0.3);
+  color: #336699;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+ul.primary.tabs li.active a {
+  position: relative;
+  background-color: #999999;
+  border: none;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a, .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a:hover,
+ul.primary.tabs li.active a,
+ul.primary.tabs li.active a:hover {
+  background-color: #999999;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+ul.primary.tabs li.active a,
+ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.quicktabs-style-commons-pills ul.quicktabs-tabs li.active a:after,
+ul.primary.tabs li.active a:after {
+  position: absolute;
+  bottom: -.7em;
+  left: 50%;
+  display: block;
+  width: 0;
+  height: 0;
+  overflow: hidden;
+  margin-left: -.6em;
+  content: "";
+  border-width: .4em .6em;
+  border-style: solid;
+  border-color: #999999 transparent transparent;
+}
+
+.quicktabs-style-commons-pills ul.quicktabs-tabs li {
+  text-transform: uppercase;
+  font-size: .8em;
+}
+
+/**
+ * H1 Node title
+ */
+h1.node-title {
+  color: #336699;
+  font-size: 20px;
+}
+h1.node-title a {
+  text-decoration: none;
+  color: #336699;
+}
+h1.node-title a:hover {
+  text-decoration: underline;
+}
+
+/**
+ * Main wrapper for most blocks, block_system_main does not have it
+ */
+.block {
+  margin-bottom: 20px;
+}
+
+.block-title {
+  font-size: 20px;
+  line-height: 1.2em;
+  margin-top: 0;
+  margin-bottom: .4em;
+  color: #666666;
+}
+
+/**
+ * Match item list and block menu margin and padding
+ */
+.block-content ul,
+.block-content ol {
+  padding: 0 0 0 15px;
+}
+.block-content li {
+  margin: 0;
+  padding: 0;
+}
+
+/* Views exposed form */
+.views-exposed-form .views-exposed-widget {
+  float: none;
+  padding: 0;
+  margin: 1.7em 0;
+}
+.views-exposed-form .views-exposed-widget:first-child {
+  margin-top: 0;
+}
+.views-exposed-form .views-exposed-widget:last-child {
+  margin-bottom: 0;
+}
+.views-exposed-form .views-exposed-widget .form-submit {
+  margin-top: 0;
+}
+
+.keyword-filter .views-widget-filter-keys,
+.keyword-filter .views-submit-button {
+  float: left;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  margin-top: 0;
+}
+.keyword-filter .views-widget-filter-keys {
+  margin-right: -6.5em;
+  margin-bottom: 0;
+  padding-right: 6.75em;
+  width: 100%;
+}
+.keyword-filter .views-widget-filter-keys label {
+  margin-top: 0;
+}
+@media only screen and (max-width: 768px) {
+  .keyword-filter .views-widget-filter-keys {
+    margin-right: 0;
+    padding-right: 0;
+  }
+}
+.keyword-filter .views-submit-button {
+  padding-top: 2.15em;
+}
+@media only screen and (max-width: 768px) {
+  .keyword-filter .views-submit-button {
+    margin-top: .5em;
+    padding-top: 0;
+  }
+}
+
+/* Generic row styles */
+.views-row {
+  border-bottom: 1px solid #cccccc;
+  padding-bottom: .7em;
+  margin-bottom: .7em;
+  position: relative;
+}
+.views-row .views-row {
+  margin-top: .4em;
+  margin-bottom: .4em;
+  padding-bottom: 0;
+}
+.views-row .views-row, .views-row.views-row-last {
+  border-bottom: none;
+}
+.views-row.views-row-last {
+  padding-bottom: 0;
+  margin-bottom: 0;
+}
+.view-plain .views-row {
+  border-bottom: none;
+  padding-bottom: 0;
+  margin: .3em 0;
+}
+.view-plain .views-row:first-child {
+  margin-top: 0;
+}
+.view-plain .views-row:last-child {
+  margin-bottom: 0;
+}
+
+/* Apply icons to row row types. */
+[class*="row-type-"] {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  padding-left: 20px;
+}
+[class*="row-type-"]:before {
+  content: "";
+  float: left;
+  margin-top: .1em;
+  margin-left: -20px;
+}
+
+.node-content-type:before {
+  content: "";
+}
+
+.row-type-event:before,
+.node-content-type-event:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -661px no-repeat;
+  width: 12px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.row-type-page:before,
+.node-content-type-page:before,
+.row-type-document:before,
+.node-content-type-document:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -1302px no-repeat;
+  width: 9px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.row-type-poll:before,
+.node-content-type-poll:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -630px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.row-type-post:before,
+.node-content-type-post:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -1175px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.row-type-question:before,
+.row-type-answer:before,
+.node-content-type-question:before,
+.node-content-type-answer:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -597px no-repeat;
+  width: 13px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.row-type-wiki:before,
+.node-content-type-wiki:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -396px no-repeat;
+  width: 13px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+/* Titles fields */
+.views-field-title {
+  font-weight: 500;
+  line-height: 1.4em;
+}
+
+/* Meta data */
+.views-field-field-date,
+.views-field-timestamp,
+.views-field-field-location,
+.views-field-capacity-used,
+.views-field-comment-count {
+  font-size: 0.88em;
+}
+
+.views-field-timestamp,
+.views-field-field-location,
+.views-field-capacity-used,
+.views-field-comment-count {
+  color: #858585;
+}
+.views-field-timestamp strong,
+.views-field-field-location strong,
+.views-field-capacity-used strong,
+.views-field-comment-count strong {
+  color: #333333;
+}
+
+.views-field-timestamp,
+.views-field-field-location,
+.views-field-capacity-used,
+.views-field-comment-count {
+  display: inline-block;
+  margin-right: .3em;
+}
+
+/* User picture wrapping and shadow */
+.view-commons-homepage-content .content,
+.view-commons-homepage-content .message,
+.view-commons-homepage-content .views-field-timestamp,
+.view-commons-homepage-content .views-field-nothing,
+.view-commons-activity-streams-activity .content,
+.view-commons-activity-streams-activity .message,
+.view-commons-activity-streams-activity .views-field-timestamp,
+.view-commons-activity-streams-activity .views-field-nothing,
+.view-activity-group .content,
+.view-activity-group .message,
+.view-activity-group .views-field-timestamp,
+.view-activity-group .views-field-nothing,
+.view-commons-activity-streams-user-activity .content,
+.view-commons-activity-streams-user-activity .message,
+.view-commons-activity-streams-user-activity .views-field-timestamp,
+.view-commons-activity-streams-user-activity .views-field-nothing {
+  padding-left: 58px;
+}
+.view-commons-homepage-content .content .user-picture,
+.view-commons-homepage-content .message .user-picture,
+.view-commons-homepage-content .views-field-timestamp .user-picture,
+.view-commons-homepage-content .views-field-nothing .user-picture,
+.view-commons-activity-streams-activity .content .user-picture,
+.view-commons-activity-streams-activity .message .user-picture,
+.view-commons-activity-streams-activity .views-field-timestamp .user-picture,
+.view-commons-activity-streams-activity .views-field-nothing .user-picture,
+.view-activity-group .content .user-picture,
+.view-activity-group .message .user-picture,
+.view-activity-group .views-field-timestamp .user-picture,
+.view-activity-group .views-field-nothing .user-picture,
+.view-commons-activity-streams-user-activity .content .user-picture,
+.view-commons-activity-streams-user-activity .message .user-picture,
+.view-commons-activity-streams-user-activity .views-field-timestamp .user-picture,
+.view-commons-activity-streams-user-activity .views-field-nothing .user-picture {
+  position: absolute;
+  float: left;
+  width: 40px;
+  margin-left: -58px;
+  top: 0;
+}
+.view-commons-homepage-content .content .user-picture img,
+.view-commons-homepage-content .message .user-picture img,
+.view-commons-homepage-content .views-field-timestamp .user-picture img,
+.view-commons-homepage-content .views-field-nothing .user-picture img,
+.view-commons-activity-streams-activity .content .user-picture img,
+.view-commons-activity-streams-activity .message .user-picture img,
+.view-commons-activity-streams-activity .views-field-timestamp .user-picture img,
+.view-commons-activity-streams-activity .views-field-nothing .user-picture img,
+.view-activity-group .content .user-picture img,
+.view-activity-group .message .user-picture img,
+.view-activity-group .views-field-timestamp .user-picture img,
+.view-activity-group .views-field-nothing .user-picture img,
+.view-commons-activity-streams-user-activity .content .user-picture img,
+.view-commons-activity-streams-user-activity .message .user-picture img,
+.view-commons-activity-streams-user-activity .views-field-timestamp .user-picture img,
+.view-commons-activity-streams-user-activity .views-field-nothing .user-picture img {
+  width: 40px;
+}
+@media only screen and (max-width: 480px) {
+  .view-commons-homepage-content .content,
+  .view-commons-homepage-content .message,
+  .view-commons-homepage-content .views-field-timestamp,
+  .view-commons-homepage-content .views-field-nothing,
+  .view-commons-activity-streams-activity .content,
+  .view-commons-activity-streams-activity .message,
+  .view-commons-activity-streams-activity .views-field-timestamp,
+  .view-commons-activity-streams-activity .views-field-nothing,
+  .view-activity-group .content,
+  .view-activity-group .message,
+  .view-activity-group .views-field-timestamp,
+  .view-activity-group .views-field-nothing,
+  .view-commons-activity-streams-user-activity .content,
+  .view-commons-activity-streams-user-activity .message,
+  .view-commons-activity-streams-user-activity .views-field-timestamp,
+  .view-commons-activity-streams-user-activity .views-field-nothing {
+    padding-left: 0;
+  }
+  .view-commons-homepage-content .content .user-picture,
+  .view-commons-homepage-content .message .user-picture,
+  .view-commons-homepage-content .views-field-timestamp .user-picture,
+  .view-commons-homepage-content .views-field-nothing .user-picture,
+  .view-commons-activity-streams-activity .content .user-picture,
+  .view-commons-activity-streams-activity .message .user-picture,
+  .view-commons-activity-streams-activity .views-field-timestamp .user-picture,
+  .view-commons-activity-streams-activity .views-field-nothing .user-picture,
+  .view-activity-group .content .user-picture,
+  .view-activity-group .message .user-picture,
+  .view-activity-group .views-field-timestamp .user-picture,
+  .view-activity-group .views-field-nothing .user-picture,
+  .view-commons-activity-streams-user-activity .content .user-picture,
+  .view-commons-activity-streams-user-activity .message .user-picture,
+  .view-commons-activity-streams-user-activity .views-field-timestamp .user-picture,
+  .view-commons-activity-streams-user-activity .views-field-nothing .user-picture {
+    display: none;
+  }
+}
+
+.view-activity-group .views-row h2,
+.view-commons-activity-streams-activity .views-row h2,
+.view-commons-activity-streams-user-activity .views-row h2 {
+  display: none;
+}
+.view-activity-group .views-row .user-picture,
+.view-commons-activity-streams-activity .views-row .user-picture,
+.view-commons-activity-streams-user-activity .views-row .user-picture {
+  top: 5px;
+}
+.view-activity-group .views-row .user-picture img,
+.view-commons-activity-streams-activity .views-row .user-picture img,
+.view-commons-activity-streams-user-activity .views-row .user-picture img {
+  width: 40px;
+}
+
+.page-node .field-label {
+  color: #369;
+}
+.page-node .field-name-field-topics,
+.page-node .field-name-og-group-ref {
+  margin: 0;
+}
+.page-node .field-name-field-topics .field-label,
+.page-node .field-name-og-group-ref .field-label {
+  display: block;
+}
+.page-node .field-name-field-topics.view-mode-full,
+.page-node .field-name-og-group-ref.view-mode-full {
+  float: left;
+  width: 50%;
+}
+.page-node .field-name-field-topics.view-mode-full .field-items,
+.page-node .field-name-og-group-ref.view-mode-full .field-items {
+  margin: 0;
+  list-style: none;
+  padding: 0;
+}
+.page-node .field-name-field-topics.view-mode-full .field-items .field-item,
+.page-node .field-name-og-group-ref.view-mode-full .field-items .field-item {
+  display: inline-block;
+  margin: 0 .3em;
+  padding: 0;
+}
+.page-node .field-name-field-topics.view-mode-full .field-items .field-item:first-child,
+.page-node .field-name-og-group-ref.view-mode-full .field-items .field-item:first-child {
+  margin-left: 0;
+}
+.page-node .field-name-field-topics.view-mode-full .field-items .field-item:last-child,
+.page-node .field-name-og-group-ref.view-mode-full .field-items .field-item:last-child {
+  margin-right: 0;
+}
+.page-node .field-name-field-topics.view-mode-full .field-items .field-item:after,
+.page-node .field-name-og-group-ref.view-mode-full .field-items .field-item:after {
+  content: "";
+}
+@media only screen and (max-width: 480px) {
+  .page-node .field-name-field-topics.view-mode-full,
+  .page-node .field-name-og-group-ref.view-mode-full {
+    float: none;
+    width: auto;
+    margin: 1.7em 0;
+  }
+}
+.page-node .field-name-field-topics .field-item:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -1364px no-repeat;
+  width: 8px;
+  height: 8px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  top: -1px;
+}
+.page-node .field-name-og-group-ref .field-item:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -990px no-repeat;
+  width: 8px;
+  height: 8px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  top: -1px;
+}
+.page-node .node nav {
+  clear: both;
+  margin-top: 20px;
+  position: relative;
+}
+
+#comments {
+  margin: 0;
+}
+#comments .form-item-subject input {
+  width: 100%;
+}
+#comments .rate-widget-commons_like {
+  position: absolute;
+  right: 5px;
+  top: 15px;
+}
+
+.comments-title,
+.comment-form-title {
+  margin-top: 0;
+  font-size: 2.2em;
+  line-height: 1.2em;
+  color: #333333;
+}
+
+.comments-title:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -46px no-repeat;
+  width: 31px;
+  height: 24px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.comment-form {
+  margin-bottom: 0;
+}
+.comment-form:before {
+  display: none;
+}
+
+.comment {
+  padding-left: 68px;
+  border-bottom: 1px solid #eeeeee;
+  padding-bottom: 20px;
+  position: relative;
+}
+.comment .user-picture {
+  position: absolute;
+  float: left;
+  width: 50px;
+  margin-left: -68px;
+  top: 0;
+}
+.comment .user-picture img {
+  width: 50px;
+}
+@media only screen and (max-width: 480px) {
+  .comment {
+    padding-left: 0;
+  }
+  .comment .user-picture {
+    display: none;
+  }
+}
+.comment .author-datetime {
+  margin-bottom: 1.4em;
+}
+
+.comment-title,
+.comment .author-datetime {
+  margin-right: 90px;
+}
+
+.comment-title {
+  margin-bottom: .2em;
+}
+
+ul.comment-links {
+  margin: .7em 0;
+}
+ul.comment-links li {
+  padding-left: 0;
+}
+
+.comment-reply {
+  float: right;
+}
+.comment-reply:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -1206px no-repeat;
+  width: 13px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  margin-right: 8px;
+  top: 3px;
+}
+
+.comment-form .form-actions {
+  margin-bottom: 0;
+}
+
+.primary-fields,
+.supplementary-fields {
+  display: -moz-inline-stack;
+  display: inline-block;
+  vertical-align: middle;
+  *vertical-align: auto;
+  zoom: 1;
+  *display: inline;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  float: left;
+}
+.view-commons-question-answers .primary-fields, .view-commons-question-answers
+.supplementary-fields {
+  display: block;
+  float: none;
+  width: auto;
+  padding: 0;
+}
+
+.primary-fields {
+  padding-right: 10px;
+  width: 66.666%;
+}
+
+.supplementary-fields {
+  padding-left: 10px;
+  width: 33.333%;
+}
+
+.form-actions {
+  clear: both;
+}
+
+/* Format the date range form items. */
+.start-date-wrapper,
+.end-date-wrapper {
+  clear: none;
+  width: auto;
+  max-width: 49%;
+}
+.start-date-wrapper,
+.start-date-wrapper input,
+.start-date-wrapper .form-item .form-type-textfield,
+.start-date-wrapper .date-padding,
+.start-date-wrapper .form-type-textfield,
+.end-date-wrapper,
+.end-date-wrapper input,
+.end-date-wrapper .form-item .form-type-textfield,
+.end-date-wrapper .date-padding,
+.end-date-wrapper .form-type-textfield {
+  float: none;
+  display: inline-block;
+  min-width: inherit;
+}
+.start-date-wrapper .form-item input,
+.end-date-wrapper .form-item input {
+  margin-right: auto;
+}
+.start-date-wrapper .form-type-textfield,
+.end-date-wrapper .form-type-textfield {
+  max-width: 60%;
+}
+.start-date-wrapper .form-type-textfield:last-child,
+.end-date-wrapper .form-type-textfield:last-child {
+  max-width: 30%;
+}
+.start-date-wrapper .form-type-date-popup,
+.end-date-wrapper .form-type-date-popup {
+  margin: 0;
+}
+@media only screen and (max-width: 768px) {
+  .start-date-wrapper,
+  .end-date-wrapper {
+    display: block;
+    max-width: inherit;
+    margin: 10px auto;
+  }
+}
+
+.addressfield-container-inline > div.form-item {
+  display: inline-block;
+  float: none;
+}
+.addressfield-container-inline input[type="text"] {
+  width: auto;
+}
+.addressfield-container-inline:after {
+  content: "";
+  clear: none;
+  display: none;
+}
+
+.logo-available .field-name-field-date,
+.logo-available .field-name-field-address,
+.logo-available .field-name-field-offsite-url {
+  margin-left: 65px;
+}
+@media only screen and (max-width: 480px) {
+  .logo-available .field-name-field-date,
+  .logo-available .field-name-field-address,
+  .logo-available .field-name-field-offsite-url {
+    margin-left: 0;
+  }
+}
+
+.field-name-field-logo {
+  float: left;
+  width: 70px;
+  margin: .5em 0 0 -70px;
+  position: relative;
+  left: 70px;
+}
+.field-name-field-logo img {
+  display: block;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  margin-bottom: 1.7em;
+  padding: 4px;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  -webkit-box-shadow: #858585 1px 1px 4px;
+  -moz-box-shadow: #858585 1px 1px 4px;
+  box-shadow: #858585 1px 1px 4px;
+  background: white;
+}
+@media only screen and (max-width: 480px) {
+  .field-name-field-logo {
+    display: none;
+  }
+}
+
+.field-name-body {
+  margin-top: 1.7em;
+}
+.node-event .field-name-body {
+  clear: both;
+}
+
+.field-name-field-date {
+  font-weight: bold;
+}
+
+.adr .region, .node-type-event .adr .region, .panel-display .region .adr .region {
+  float: none;
+  padding: 0;
+}
+
+ul.node-action-links {
+  display: inline-block;
+  margin-top: 1.4em;
+}
+ul.node-action-links li {
+  padding: 0;
+  vertical-align: baseline;
+}
+ul.node-action-links li,
+ul.node-action-links a {
+  margin: 0;
+}
+
+.view-commons-contributors-group .views-field-picture {
+  margin: 0 0 10px;
+  position: static;
+  line-height: 0;
+}
+.view-commons-contributors-group .views-field-picture img {
+  width: 40px;
+}
+.view-commons-contributors-group td {
+  padding: 0;
+}
+.view-commons-contributors-group tbody tr {
+  background-color: transparent;
+}
+
+/**
+ * Author/Submit line
+ */
+.author-datetime {
+  color: #858585;
+  font-size: 0.88em;
+}
+
+.node-content-type {
+  color: #333333;
+}
+
+/**
+ * Featured/New Tags
+ */
+.tag.featured {
+  width: 58px;
+  height: 22px;
+  display: inline-block;
+  background-image: url('../images/tag-featured.png?1395768501');
+  background-repeat: no-repeat;
+  margin: 6px 0 0 5px;
+}
+
+.tag.new {
+  width: 27px;
+  height: 22px;
+  display: inline-block;
+  background-image: url('../images/tag-new.png?1395768501');
+  background-repeat: no-repeat;
+  margin: 4px 0 0 5px;
+}
+
+/**
+ * User profile
+ */
+.page-user .panel-display .region-three-33-top {
+  padding-left: 150px;
+  /* This feels hackish, but it is only for administrating the layout of the
+     page. It is still not ideal as it is inflexible and only works with the
+     current core functionality of commons. */
+}
+@media only screen and (max-width: 480px) {
+  .page-user .panel-display .region-three-33-top {
+    padding-left: 10px;
+  }
+}
+.page-user .panel-display .region-three-33-top .panels-ipe-portlet-wrapper:nth-last-child(-n+5) {
+  display: inline-block;
+}
+.page-user .pane-user-picture {
+  float: left;
+  margin-left: -140px;
+}
+.page-user .pane-user-picture .user-picture {
+  background: white;
+  margin-left: 0;
+  padding: 10px;
+  position: static;
+  -webkit-border-radius: 6px;
+  -moz-border-radius: 6px;
+  -ms-border-radius: 6px;
+  -o-border-radius: 6px;
+  border-radius: 6px;
+  -webkit-box-shadow: #858585 1px 1px 4px;
+  -moz-box-shadow: #858585 1px 1px 4px;
+  box-shadow: #858585 1px 1px 4px;
+}
+.page-user .pane-user-picture .user-picture img {
+  display: block;
+}
+@media only screen and (max-width: 480px) {
+  .page-user .pane-user-picture {
+    float: none;
+    margin-left: 0;
+    text-align: center;
+  }
+}
+.page-user .pane-user-field-facebook-url,
+.page-user .pane-user-field-facebook-url a,
+.page-user .pane-user-field-linkedin-url,
+.page-user .pane-user-field-linkedin-url a,
+.page-user .pane-user-field-twitter-url,
+.page-user .pane-user-field-twitter-url a,
+.page-user .pane-user-group-group,
+.page-user .pane-user-group-group a,
+.page-user .pane-user-flag-commons-follow-user-link,
+.page-user .pane-user-flag-commons-follow-user-link a {
+  display: inline-block;
+}
+.page-user .pane-user-field-facebook-url a,
+.page-user .pane-user-field-linkedin-url a,
+.page-user .pane-user-field-twitter-url a {
+  margin-right: 1em;
+}
+.page-user .pane-user-field-facebook-url a:before,
+.page-user .pane-user-field-linkedin-url a:before,
+.page-user .pane-user-field-twitter-url a:before {
+  content: "";
+  display: inline-block;
+  vertical-align: middle;
+}
+@media only screen and (max-width: 480px) {
+  .page-user .pane-user-field-facebook-url a,
+  .page-user .pane-user-field-linkedin-url a,
+  .page-user .pane-user-field-twitter-url a {
+    text-indent: 100%;
+    white-space: nowrap;
+    overflow: hidden;
+  }
+  .page-user .pane-user-field-facebook-url a:before,
+  .page-user .pane-user-field-linkedin-url a:before,
+  .page-user .pane-user-field-twitter-url a:before {
+    content: normal;
+  }
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  .page-user .pane-user-field-facebook-url,
+  .page-user .pane-user-field-linkedin-url,
+  .page-user .pane-user-field-twitter-url {
+    display: block;
+  }
+}
+.page-user .pane-user-field-facebook-url a:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -136px no-repeat;
+  width: 26px;
+  height: 26px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+@media only screen and (max-width: 480px) {
+  .page-user .pane-user-field-facebook-url a {
+    background: url('../images/icons-sfd37165efe.png') 0 -136px no-repeat;
+    width: 26px;
+    height: 26px;
+    display: inline-block;
+    margin-right: 3px;
+    position: relative;
+    top: 1px;
+  }
+}
+.page-user .pane-user-field-linkedin-url a:before {
+  background: url('../images/icons-sfd37165efe.png') 0 0 no-repeat;
+  width: 26px;
+  height: 26px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+@media only screen and (max-width: 480px) {
+  .page-user .pane-user-field-linkedin-url a {
+    background: url('../images/icons-sfd37165efe.png') 0 0 no-repeat;
+    width: 26px;
+    height: 26px;
+    display: inline-block;
+    margin-right: 3px;
+    position: relative;
+    top: 1px;
+  }
+}
+.page-user .pane-user-field-twitter-url a:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -90px no-repeat;
+  width: 26px;
+  height: 26px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+@media only screen and (max-width: 480px) {
+  .page-user .pane-user-field-twitter-url a {
+    background: url('../images/icons-sfd37165efe.png') 0 -90px no-repeat;
+    width: 26px;
+    height: 26px;
+    display: inline-block;
+    margin-right: 3px;
+    position: relative;
+    top: 1px;
+  }
+}
+.page-user .pane-user-flag-commons-follow-user-link {
+  clear: both;
+}
+
+/**
+ * Group nodes
+ */
+.pane-node-commons-groups-group-contributors-count-topics {
+  display: inline-block;
+  margin: 0;
+}
+
+.node-group .field-name-body {
+  margin-top: 1.4em;
+}
+.node-group .pane-node-flag-commons-follow-group-link {
+  display: inline-block;
+  position: absolute;
+  top: .5em;
+  right: 0;
+  margin: 0;
+}
+@media only screen and (max-width: 768px) {
+  .node-group .pane-node-flag-commons-follow-group-link {
+    position: static;
+    top: auto;
+    right: auto;
+  }
+}
+
+.group-recent-data {
+  display: inlline-block;
+  float: left;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  width: 48%;
+  margin-bottom: 0;
+  margin-right: 4%;
+}
+@media only screen and (max-width: 768px) {
+  .group-recent-data {
+    float: none;
+    width: auto;
+    margin-bottom: 1.7em;
+  }
+  .group-recent-data:last-child {
+    margin-bottom: 0;
+  }
+}
+
+.group-recent-data-odd {
+  margin-right: 0;
+}
+
+/* =============================================================================
+ *   Regions
+ * ========================================================================== */
+/**
+ * Header region, embedded in the #header
+ */
+.region-header {
+  display: inline-block;
+  text-align: left;
+  width: 19.3em;
+}
+@media only screen and (max-width: 768px) {
+  .region-header {
+    width: auto;
+    position: absolute;
+    right: 10px;
+    top: -1.5em;
+  }
+}
+
+/* =============================================================================
+ *   Links
+ * ========================================================================== */
+a {
+  text-decoration: none;
+  color: #2783b9;
+}
+a:hover, a:focus {
+  text-decoration: underline;
+}
+
+/* =============================================================================
+ *   Primary, Secondary and Menu Bar region menus
+ * ========================================================================== */
+#primary-menu-bar {
+  display: inline-block;
+}
+
+/**
+ * Use one of the following id's for granular control:
+ *  - #menu-bar (menu bar region)
+ *  - #primary-menu (main menu)
+ *  - #secondary-menu (secondary/user menu)
+ * You can target all of these with .nav or div[id$="menu-bar"]
+ */
+#menu-bar.nav {
+  display: inline-block;
+  vertical-align: top;
+  margin: 0 0 -9999em;
+  padding-bottom: 9999em;
+}
+#menu-bar.nav h3.block-title {
+  display: none;
+}
+#menu-bar.nav ul.menu {
+  margin: 0;
+  padding: 0;
+}
+#menu-bar.nav ul.menu li {
+  display: inline-block;
+  float: left;
+  list-style: none;
+  margin: 0;
+  padding: 0;
+}
+#menu-bar.nav ul.menu li:hover, #menu-bar.nav ul.menu li.active-trail {
+  background: url('../images/main-nav-hover.png?1395768501') repeat-x left top;
+}
+#menu-bar.nav ul.menu li:hover .arrow:before, #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  content: "";
+  display: block;
+  position: absolute;
+  bottom: 0px;
+  left: 0px;
+  width: 0px;
+  height: 0px;
+  border-style: solid;
+  border-width: 0 7px 8px 7px;
+  border-color: transparent transparent #3d9dd6 transparent;
+}
+#menu-bar.nav ul.menu li:hover .arrow:after, #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  content: "";
+  display: block;
+  position: absolute;
+  bottom: 0px;
+  left: 1px;
+  width: 0px;
+  height: 0px;
+  border-style: solid;
+  border-width: 0 6px 6px 6px;
+  border-color: transparent transparent #2783b9 transparent;
+}
+#menu-bar.nav ul.menu li a {
+  position: relative;
+  z-index: 1;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  display: block;
+  white-space: nowrap;
+  margin-bottom: -9998em;
+  padding: 1.9375em 0.8125em 9999em;
+  height: 4em;
+  text-transform: uppercase;
+  text-shadow: black 1px 1px 4px;
+  background-position: center 10px;
+  background-repeat: no-repeat;
+  position: relative;
+}
+#menu-bar.nav ul.menu li a:hover, #menu-bar.nav ul.menu li a:focus {
+  text-decoration: none;
+}
+#menu-bar.nav ul.menu li a .arrow {
+  width: 17px;
+  height: 9px;
+  position: absolute;
+  left: 50%;
+  bottom: -1px;
+  margin: 0 0 0 -8px;
+}
+#menu-bar.nav .block {
+  margin: 0;
+}
+@media only screen and (max-width: 480px) {
+  #menu-bar.nav {
+    border-right: 0;
+    -webkit-box-shadow: #4082a7 0px 0px 0px;
+    -moz-box-shadow: #4082a7 0px 0px 0px;
+    box-shadow: #4082a7 0px 0px 0px;
+  }
+  #menu-bar.nav ul.menu li a {
+    font: 0/0 a;
+    width: 40px;
+    height: 50px;
+  }
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  #menu-bar.nav {
+    border-right: none;
+  }
+  #menu-bar.nav ul.menu li a {
+    padding-right: 0.4375em;
+    padding-left: 0.4375em;
+  }
+}
+
+.main-menu-home a {
+  background: url('../images/icons/icon-home.png?1395768501') no-repeat center 10px;
+}
+
+.main-menu-groups a {
+  background: url('../images/icons/icon-groups.png?1395768501') no-repeat center 10px;
+}
+
+.main-menu-events a {
+  background: url('../images/icons/icon-events.png?1395768501') no-repeat center 10px;
+}
+
+.main-menu-people a {
+  background: url('../images/icons/icon-people.png?1395768501') no-repeat center 10px;
+}
+
+#menu-bar.nav ul.menu li.main-menu-search {
+  display: none;
+}
+#menu-bar.nav ul.menu li.main-menu-search a {
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat center 10px;
+}
+@media only screen and (max-width: 768px) {
+  #menu-bar.nav ul.menu li.main-menu-search {
+    display: inline-block;
+  }
+}
+
+#block-commons-utility-links-commons-utility-links {
+  margin: 0;
+}
+#block-commons-utility-links-commons-utility-links .block-inner {
+  margin: 0;
+}
+
+ul.commons-utility-links {
+  list-style: none;
+  text-align: right;
+  margin: .2em 0;
+  padding: 0;
+  font-size: .875em;
+  line-height: 1;
+}
+.block-content ul.commons-utility-links {
+  padding: 0;
+}
+ul.commons-utility-links li {
+  display: inline-block;
+}
+.logged-in ul.commons-utility-links li.first {
+  margin-right: 17px;
+  font-weight: bold;
+}
+ul.commons-utility-links li.last {
+  border-left: 1px solid #2783b9;
+  margin-left: 9px;
+}
+ul.commons-utility-links li.last a {
+  margin-left: 9px;
+}
+
+.unread-invitations a {
+  background: url('../images/icons-sfd37165efe.png') 0 -890px no-repeat;
+  width: 14px;
+  height: 14px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.unread-messages a,
+.no-unread-messages a {
+  background: url('../images/icons-sfd37165efe.png') 0 -924px no-repeat;
+  width: 18px;
+  height: 14px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+.unread-invitations a,
+.unread-messages a,
+.no-unread-messages a {
+  position: relative;
+  top: .3em;
+  display: inline-block;
+  margin-top: -.2em;
+  margin-right: .8em;
+}
+
+.no-unread-messages a {
+  top: -.1em;
+  margin-top: 0;
+  text-indent: 100%;
+  white-space: nowrap;
+  overflow: hidden;
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=40);
+  opacity: 0.4;
+}
+
+.notification-count {
+  position: absolute;
+  top: -.2em;
+  right: -.6em;
+  display: inline-block;
+  padding: 0 .2em;
+  font-size: .88em;
+  -webkit-border-radius: 0.4em;
+  -moz-border-radius: 0.4em;
+  -ms-border-radius: 0.4em;
+  -o-border-radius: 0.4em;
+  border-radius: 0.4em;
+  -webkit-box-shadow: 0 0 2px #2783b9;
+  -moz-box-shadow: 0 0 2px #2783b9;
+  box-shadow: 0 0 2px #2783b9;
+  background: #46ba31;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #46ba31), color-stop(100%, #28691c));
+  background: -webkit-linear-gradient(#46ba31, #28691c);
+  background: -moz-linear-gradient(#46ba31, #28691c);
+  background: -o-linear-gradient(#46ba31, #28691c);
+  background: linear-gradient(#46ba31, #28691c);
+}
+
+/* =============================================================================
+ *   Superfish
+ * ========================================================================== */
+ul.sf-menu {
+  margin-bottom: 0;
+}
+ul.sf-menu a {
+  border-left: 0;
+  border-top: 0;
+  padding: 0 10px;
+  text-decoration: none;
+  height: 2.5em;
+  line-height: 2.5em;
+}
+ul.sf-menu li:hover, ul.sf-menu li.sfHover {
+  outline: 0;
+}
+ul.sf-menu a:focus, ul.sf-menu a:hover, ul.sf-menu a:active {
+  outline: 0;
+}
+
+/**
+ * Superfish blocks
+ */
+.block-superfish ul {
+  margin: 0 !important;
+  padding: 0 !important;
+}
+.block-superfish li {
+  margin: 0 !important;
+  padding: 0 !important;
+}
+
+/**
+ * Vertical style
+ */
+.sf-vertical {
+  width: 100%;
+}
+.sf-vertical li {
+  width: 100%;
+}
+.sf-vertical li:hover ul, .sf-vertical li.sfHover ul {
+  left: 100%;
+  top: 0;
+  margin: 0;
+  padding: 0;
+}
+.sf-vertical li a {
+  padding: 0 10px;
+}
+
+/**
+ * Navbar style
+ */
+.sf-navbar {
+  padding-bottom: 0 !important;
+}
+
+/**
+ * Sensible padding for the default style
+ */
+.sf-menu.sf-style-default a {
+  padding: 0 10px;
+}
+
+/* =============================================================================
+ *   Menus, usually blocks
+ * ========================================================================== */
+ul.menu {
+  padding-left: 15px;
+}
+ul.menu ul {
+  padding-left: 15px;
+}
+ul.menu ul li {
+  margin: 0;
+}
+
+/* If li.content exists it's a problem, so reset the padding */
+.block .menu li.content {
+  padding: 0;
+}
+
+/* =============================================================================
+ *   Book navigation menu
+ * ========================================================================== */
+.book-navigation .page-up {
+  /* Prevent text wrapping to a new line, assumes English "up" is used (two characters) */
+  min-width: 2em;
+  white-space: nowrap;
+}
+.book-navigation .menu {
+  margin-left: 0;
+}
+
+/* =============================================================================
+ *   Breadcrumbs
+ * ========================================================================== */
+#breadcrumb {
+  margin: 10px 0;
+  /* If the label is set to show in theme settings the label class is added */
+}
+#breadcrumb .breadcrumb-label {
+  font-size: 1em;
+  display: inline;
+  padding-right: 10px;
+}
+#breadcrumb .breadcrumb-label:after {
+  content: ":";
+}
+#breadcrumb ol {
+  margin: 0;
+  padding: 0;
+}
+#breadcrumb .with-breadcrumb-label ol {
+  display: inline;
+}
+#breadcrumb li {
+  list-style: none;
+  display: inline;
+}
+
+/* =============================================================================
+ *   Pagers
+ * ========================================================================== */
+ul.pager {
+  clear: both;
+  margin: 0;
+  text-align: center;
+}
+
+.item-list ul.pager li {
+  margin: 0;
+}
+
+ul.pager li {
+  background-image: none;
+  display: inline;
+  list-style-type: none;
+  padding: .5em;
+}
+ul.pager li.pager-current {
+  font-weight: 700;
+}
+
+.block ul.pager li {
+  margin: 0;
+}
+
+/* =============================================================================
+ *   Skip Navigation
+ * ========================================================================== */
+#skip-link {
+  left: 50%;
+  margin-left: -6.5em;
+  margin-top: 0;
+  padding: 0 0.5em;
+  position: absolute;
+  width: 12em;
+  z-index: 50;
+}
+#skip-link a {
+  background: #444;
+  background: rgba(0, 0, 0, 0.6);
+  color: #e6e6e6;
+  display: block;
+  line-height: 2;
+  padding: 0;
+  text-align: center;
+  text-decoration: none;
+}
+#skip-link a:link, #skip-link a:visited {
+  background: #444;
+  background: rgba(0, 0, 0, 0.6);
+  color: #e6e6e6;
+  display: block;
+  line-height: 2;
+  padding: 0;
+  text-align: center;
+  text-decoration: none;
+}
+#skip-link a:hover, #skip-link a:focus, #skip-link a:active {
+  outline: 0;
+}
+
+/* =============================================================================
+ *   Tabs (local tasks)
+ * ========================================================================== */
+#tasks {
+  margin-bottom: 15px;
+}
+
+ul.primary {
+  border-bottom-color: #cccccc;
+  margin: 20px 0;
+  padding: 0 0 0 5px;
+}
+ul.primary li {
+  display: block;
+  float: left;
+  margin: 0 1px -1px;
+}
+ul.primary li a {
+  background-color: whitesmoke;
+  border-color: #cccccc;
+  margin-right: 1px;
+  padding: 0 10px;
+  display: block;
+  float: left;
+  height: 1.5em;
+  line-height: 1.5em;
+}
+ul.primary li a:hover, ul.primary li a:focus {
+  background-color: #eeeeee;
+  border-color: #cccccc;
+}
+ul.primary li.active a,
+ul.primary li.active a:hover,
+ul.primary li.active a:focus {
+  background-color: #e6e6e6;
+  border-bottom-color: #e6e6e6;
+}
+
+ul.secondary {
+  border-bottom: 1px solid #cccccc;
+  margin: 1em 0 0;
+  padding: 0 .3em 1em;
+}
+ul.secondary li {
+  border-right: 0;
+  list-style: none;
+  padding: 0 10px 0 0;
+}
+ul.secondary li a:hover, ul.secondary li a.active {
+  border-bottom: none;
+  text-decoration: underline;
+}
+
+/* =============================================================================
+ *   Action links
+ * ========================================================================== */
+ul.action-links {
+  margin: 20px 0 0;
+  list-style: none;
+}
+
+/* =============================================================================
+ *  Field Styling
+ * ========================================================================== */
+/**
+ * Labels are h2 in Adaptivetheme. Use a strong selector to mitigate unwanted ineritance issues
+ */
+.field-label {
+  font-size: 1em;
+  font-weight: 700;
+  font-family: inherit;
+  line-height: inherit;
+  margin-bottom: 0;
+}
+
+/**
+ * Taxonomy
+ */
+.field-type-taxonomy-term-reference {
+  /* The same bottom margin as p, blockquote, ul, ol and dl */
+  margin-bottom: 1.5em;
+}
+.field-type-taxonomy-term-reference.field-label-inline .field-items {
+  margin: 0;
+  padding: 0;
+}
+.field-type-taxonomy-term-reference.field-label-inline .field-item {
+  display: inline;
+  list-style: none;
+  padding: 0 10px 0 0;
+}
+
+/**
+ * Float left setting
+ */
+.ia-l .field-type-image figure,
+.iat-l .field-type-image figure {
+  margin: 5px 20px 15px 0;
+}
+
+/**
+ * Centered setting
+ */
+.ia-c .field-type-image figure,
+.iat-c .field-type-image figure {
+  margin: 5px auto 15px;
+}
+
+/**
+ * Float right setting
+ */
+.ia-r .field-type-image figure,
+.iat-r .field-type-image figure {
+  margin: 5px 0 15px 20px;
+}
+
+/* =============================================================================
+ *   Panels Styling
+ * ========================================================================== */
+.node-title,
+.pane-title {
+  font-weight: normal;
+  font-size: 1.6em;
+}
+
+.panel-display {
+  min-width: 100%;
+  margin-right: -10px;
+  margin-left: -10px;
+}
+.panel-display .region {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  padding-right: 10px;
+  padding-left: 10px;
+}
+
+.nodes {
+  margin-top: 1em;
+}
+
+.pane-commons-featured-panel-pane-1 .block-inner,
+.pane-commons-events-upcoming .block-inner {
+  margin: 0;
+}
+.pane-commons-featured-panel-pane-1 .block-inner .views-row-last,
+.pane-commons-events-upcoming .block-inner .views-row-last {
+  border-bottom: none;
+}
+
+.node-type-group .node-teaser {
+  position: relative;
+}
+.node-type-group.page-node .pane-node-content > .block-inner {
+  padding: 0;
+  margin: 0;
+}
+.node-type-group.page-node .pane-node-content figure {
+  float: left;
+  margin: 3px 10px 5px 0;
+  background: white;
+  padding: 4px;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  -webkit-box-shadow: #858585 1px 1px 4px;
+  -moz-box-shadow: #858585 1px 1px 4px;
+  box-shadow: #858585 1px 1px 4px;
+  position: relative;
+  display: block;
+  line-height: 0;
+}
+.node-type-group.page-node .node-content {
+  margin-left: 0;
+}
+
+.pane-commons-groups-directory-panel-pane-1 {
+  background-color: transparent;
+  -webkit-border-radius: 0px;
+  -moz-border-radius: 0px;
+  -ms-border-radius: 0px;
+  -o-border-radius: 0px;
+  border-radius: 0px;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  margin-right: 0;
+  margin-bottom: 0;
+}
+
+.page-groups .region-two-66-33-top {
+  position: relative;
+}
+
+.pane-commons-groups-commons-groups-create-group {
+  position: absolute;
+  top: -4em;
+  right: 10px;
+  text-align: right;
+}
+@media only screen and (max-width: 480px) {
+  .pane-commons-groups-commons-groups-create-group {
+    position: static;
+    top: auto;
+    right: auto;
+  }
+}
+.pane-commons-groups-commons-groups-create-group a {
+  margin: 0;
+}
+.pane-commons-groups-commons-groups-create-group a:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -324px no-repeat;
+  width: 15px;
+  height: 15px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  top: 3px;
+}
+@media only screen and (max-width: 480px) {
+  .pane-commons-groups-commons-groups-create-group a {
+    float: none;
+    display: block;
+  }
+}
+
+/* =============================================================================
+ *   Views Styling
+ * ========================================================================== */
+.view-display-id-commons_events_upcoming_page .views-row article .commons-events-form-float {
+  float: right;
+  margin: -40px 0 0 0;
+}
+
+.views-view-grid {
+  border: none;
+  margin: 0;
+}
+.views-view-grid tbody tr {
+  border-top: none;
+  background: none;
+}
+.views-view-grid td {
+  padding: 5px;
+}
+
+.grid-grouping-title {
+  font-size: 1em;
+  color: #858585;
+  margin-bottom: 10px;
+}
+
+.pager a {
+  margin: 0;
+  padding-right: .75em;
+  padding-left: .75em;
+}
+
+.view-commons-groups-directory > .view-content > .views-row,
+.view-commons-homepage-content .node-teaser.node-group > .view-content > .views-row {
+  position: relative;
+}
+.view-commons-groups-directory .pane-node-body,
+.view-commons-homepage-content .node-teaser.node-group .pane-node-body {
+  margin-bottom: 0;
+}
+
+.pane-node-field-group-logo {
+  float: left;
+  margin: 0 10px 10px 0;
+}
+.pane-node-field-group-logo .field-name-field-group-logo a {
+  display: block;
+  border: 3px solid white;
+  -webkit-border-radius: 2px;
+  -moz-border-radius: 2px;
+  -ms-border-radius: 2px;
+  -o-border-radius: 2px;
+  border-radius: 2px;
+  box-shadow: 1px 1px 3px #666666;
+}
+.pane-node-field-group-logo .field-name-field-group-logo a img {
+  display: block;
+}
+
+.pane-commons-contributors-group-panel-pane-1 table, .pane-commons-contributors-group-panel-pane-1 tbody {
+  margin: 0;
+  border: none;
+}
+.pane-commons-contributors-group-panel-pane-1 tbody tr {
+  background-color: transparent;
+  border: none;
+}
+.pane-commons-contributors-group-panel-pane-1 td {
+  padding: 0;
+  margin: 0 1px 1px 0;
+  float: left;
+  line-height: 0;
+}
+.pane-commons-contributors-group-panel-pane-1 td a {
+  position: relative;
+  display: block;
+}
+.pane-commons-contributors-group-panel-pane-1 td a img {
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=50);
+  opacity: 0.5;
+}
+.pane-commons-contributors-group-panel-pane-1 td a span {
+  display: none;
+  position: absolute;
+  top: -100%;
+  background-color: rgba(0, 0, 0, 0.85);
+  white-space: nowrap;
+  font-size: 14px;
+  line-height: 14px;
+  font-weight: bold;
+  padding: 5px 8px;
+  color: white;
+  -webkit-border-radius: 4px;
+  -moz-border-radius: 4px;
+  -ms-border-radius: 4px;
+  -o-border-radius: 4px;
+  border-radius: 4px;
+  z-index: 15;
+}
+.pane-commons-contributors-group-panel-pane-1 td a span:after {
+  content: "";
+  display: block;
+  width: 0px;
+  height: 0px;
+  border-style: solid;
+  border-width: 5px 5px 0 5px;
+  border-color: rgba(0, 0, 0, 0.85) transparent transparent transparent;
+  position: absolute;
+  left: 10px;
+  top: 100%;
+}
+.pane-commons-contributors-group-panel-pane-1 td a:hover img {
+  filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=100);
+  opacity: 1;
+}
+.pane-commons-contributors-group-panel-pane-1 td a:hover span {
+  display: block;
+}
+
+.region-two-66-33-second .view-commons-contributors-group table,
+.region-two-66-33-second .view-commons-contributors-group tbody {
+  margin: 0;
+  border: none;
+}
+.region-two-66-33-second .view-commons-contributors-group tbody tr {
+  background-color: transparent;
+  border: none;
+}
+.region-two-66-33-second .view-commons-contributors-group td {
+  padding: 0;
+  line-height: 0;
+}
+.region-two-66-33-second .view-commons-contributors-group td.col-last a {
+  margin-right: 0;
+}
+.region-two-66-33-second .view-commons-contributors-group td .user-picture {
+  margin-bottom: 10px;
+}
+.region-two-66-33-second .view-commons-contributors-group td .user-picture img {
+  width: 40px;
+}
+
+#views-exposed-form-commons-bw-all-page-1 .views-submit-button {
+  margin-left: 20px;
+}
+#views-exposed-form-commons-bw-all-page-1 .views-exposed-widget {
+  padding: 0;
+}
+#views-exposed-form-commons-bw-all-page-1 .views-exposed-widget .form-submit {
+  margin-top: 0;
+}
+
+.pane-node-commons-groups-group-contributors-count-topics {
+  font-size: 11px;
+}
+
+.dynamic-filter-lists .views-exposed-widget,
+.dynamic-filter-lists .views-widget,
+.dynamic-filter-lists label,
+.dynamic-filter-lists .form-select-wrapper {
+  display: inline-block;
+  line-height: 1.7em;
+  vertical-align: baseline;
+  white-space: nowrap;
+}
+.dynamic-filter-lists .views-exposed-widget {
+  margin-top: 0;
+  margin-bottom: 0;
+  padding: 0;
+}
+.dynamic-filter-lists .views-exposed-widget label {
+  font-weight: normal;
+  color: #858585;
+  margin: 0;
+}
+.dynamic-filter-lists .views-submit-button {
+  position: absolute;
+  visibility: hidden;
+  padding: 0;
+  height: auto;
+}
+.dynamic-filter-lists .views-submit-button .form-submit {
+  margin-top: 0;
+}
+
+.widget-changed .views-submit-button {
+  position: static;
+  visibility: visible;
+}
+
+.commons-bw-create-choose {
+  cursor: pointer;
+}
+.commons-bw-create-choose span {
+  background: url('../images/icons-sfd37165efe.png') 0 -1334px no-repeat;
+  width: 8px;
+  height: 10px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  margin-right: 0;
+}
+
+.commons-bw-create-choose-bg {
+  position: fixed;
+  display: none;
+  top: 0;
+  left: 0;
+  width: 100%;
+  height: 100%;
+  background: rgba(255, 255, 255, 0.7);
+  z-index: 10;
+}
+.create-choose-open .commons-bw-create-choose-bg {
+  display: block;
+}
+
+.commons-bw-create-choose-holder {
+  position: relative;
+}
+
+.commons-bw-create-all-widget-types {
+  position: absolute;
+  display: none;
+  left: -50px;
+  top: -50px;
+  z-index: 11;
+  width: 210px;
+  background: white;
+  border: 1px solid #46ba31;
+  -webkit-border-radius: 6px;
+  -moz-border-radius: 6px;
+  -ms-border-radius: 6px;
+  -o-border-radius: 6px;
+  border-radius: 6px;
+  list-style: none;
+}
+.block-content .commons-bw-create-all-widget-types, .item-list .commons-bw-create-all-widget-types {
+  margin: 0;
+  padding: 0;
+}
+.commons-bw-create-all-widget-types li {
+  border-bottom: 1px solid #b8b8b8;
+  position: relative;
+  font-size: 0.85em;
+  color: #858585;
+}
+.commons-bw-create-all-widget-types li .last {
+  border-bottom: none;
+}
+.item-list .commons-bw-create-all-widget-types li {
+  margin: 0;
+  padding: 10px 10px 10px 27px;
+}
+.commons-bw-create-all-widget-types li .commons-polls-create:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -630px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  position: absolute;
+  left: 10px;
+  top: 13px;
+}
+.commons-bw-create-all-widget-types li .commons-posts-create:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -1175px no-repeat;
+  width: 11px;
+  height: 11px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  position: absolute;
+  left: 10px;
+  top: 13px;
+}
+.commons-bw-create-all-widget-types li .commons-wikis-create:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -396px no-repeat;
+  width: 13px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  position: absolute;
+  left: 10px;
+  top: 13px;
+}
+.commons-bw-create-all-widget-types li .commons-events-create:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -661px no-repeat;
+  width: 12px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  position: absolute;
+  left: 10px;
+  top: 13px;
+}
+.commons-bw-create-all-widget-types li .commons-q-a-create:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -597px no-repeat;
+  width: 13px;
+  height: 13px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  position: absolute;
+  left: 10px;
+  top: 13px;
+}
+.commons-bw-create-all-widget-types li a {
+  display: block;
+  color: #46ba31;
+  font-size: 1.3em;
+}
+.create-choose-open .commons-bw-create-all-widget-types {
+  display: block;
+}
+
+#quicktabs-container-commons_bw .quicktabs-tabpage .view-filters,
+#quicktabs-container-commons_bw .quicktabs-tabpage .attachment-before {
+  display: block;
+  clear: both;
+  vertical-align: top;
+  margin-bottom: 1.7em;
+  padding: .5em .6em;
+  font-size: .88em;
+  -webkit-border-radius: 2px;
+  -moz-border-radius: 2px;
+  -ms-border-radius: 2px;
+  -o-border-radius: 2px;
+  border-radius: 2px;
+  background: whitesmoke;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .views-exposed-widgets {
+  margin-bottom: 0;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .views-exposed-widget {
+  margin-right: 1.7em;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .views-widget-sort-order {
+  display: none;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .view-content,
+#quicktabs-container-commons_bw .quicktabs-tabpage .view-empty {
+  clear: both;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .views-submit-button {
+  margin-right: 0;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .form-submit {
+  margin-top: 0;
+  margin-bottom: .1em;
+}
+#quicktabs-container-commons_bw .quicktabs-tabpage .hidden {
+  display: none;
+}
+
+.quicktabs-style-commons-pills ul.quicktabs-tabs {
+  margin-bottom: 1.7em;
+}
+
+.commons-bw-partial-node-form {
+  margin-bottom: 1.7em;
+  padding-left: 68px;
+}
+.commons-bw-partial-node-form.compact-form .form-item {
+  margin: 0;
+}
+.commons-bw-partial-node-form.compact-form textarea {
+  resize: none;
+}
+.commons-bw-partial-node-form .user-picture {
+  margin-top: 2.6em;
+}
+@media only screen and (max-width: 480px) {
+  .commons-bw-partial-node-form {
+    padding-left: 0;
+  }
+  .commons-bw-partial-node-form .user-picture {
+    display: none;
+  }
+}
+.commons-bw-partial-node-form .field-type-image {
+  margin-top: 1.7em;
+}
+.commons-bw-partial-node-form .field-name-og-group-ref .fieldset-outer-wrapper {
+  margin-top: 1.7em;
+  margin-bottom: 1.7em;
+  padding-top: 1.7em;
+  border-top: 1px solid #cccccc;
+}
+
+.partial-node-form-title {
+  margin-top: 0;
+  margin-bottom: .2em;
+  margin-left: -68px;
+  color: #46bb2e;
+}
+@media only screen and (max-width: 480px) {
+  .partial-node-form-title {
+    margin-left: 0;
+  }
+}
+
+.trigger-field,
+.trigger-field .form-item {
+  margin-top: 0;
+}
+.compact-form .trigger-field input, .compact-form
+.trigger-field textarea {
+  height: 2.2em;
+  overflow: hidden;
+}
+
+.expandable-form-toggle {
+  float: right;
+  position: absolute;
+  top: 0;
+  right: 0;
+  margin-top: .6em;
+  overflow: hidden;
+}
+.expandable-form-toggle, .expandable-form-toggle:before {
+  width: 1.4em;
+  height: 1.4em;
+  text-align: center;
+}
+.expanded-form .expandable-form-toggle {
+  display: block;
+}
+.expanded-form .expandable-form-toggle:before {
+  content: 'x';
+  display: block;
+}
+.expandable-form-toggle:hover {
+  text-decoration: none;
+}
+
+.compact-form .full-form {
+  float: right;
+  margin-top: .5em;
+}
+.compact-form .full-form:after {
+  content: '\2192';
+  display: inline-block;
+  margin-left: .2em;
+}
+
+/* =============================================================================
+ *   Block Styling
+ * ========================================================================== */
+/**
+ * "Search form" block
+ */
+.block-search {
+  display: block;
+  background-color: #24476b;
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #24476b), color-stop(100%, #2b5782));
+  background-image: -webkit-linear-gradient(top, #24476b 0%, #2b5782 100%);
+  background-image: -moz-linear-gradient(top, #24476b 0%, #2b5782 100%);
+  background-image: -o-linear-gradient(top, #24476b 0%, #2b5782 100%);
+  background-image: linear-gradient(top, #24476b 0%, #2b5782 100%);
+  -webkit-border-radius: 4px;
+  -moz-border-radius: 4px;
+  -ms-border-radius: 4px;
+  -o-border-radius: 4px;
+  border-radius: 4px;
+  box-shadow: 1px 1px 2px black inset, 2px 3px 3px rgba(255, 255, 255, 0.09);
+  height: 30px;
+  margin: 0 0 0 10px;
+  position: relative;
+}
+.block-search .container-inline label,
+.block-search .container-inline div {
+  float: left;
+  display: block;
+  margin-top: 0;
+  margin-bottom: 0;
+}
+.block-search .container-inline .form-item-custom-search-types {
+  position: relative;
+  z-index: 2;
+  display: inline-block;
+  width: 5.5em;
+  margin: .3em 0 .3em -5.8em;
+  padding-left: .3em;
+  left: 5.8em;
+}
+.block-search .container-inline .form-item-custom-search-types .select-status:after {
+  border-top-color: white;
+}
+.block-search .block-inner {
+  margin-left: 0;
+  margin-right: 0;
+}
+.block-search .form-item-search-block-form {
+  position: relative;
+  z-index: 1;
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  width: 100%;
+  padding-right: 1.5em;
+  padding-left: 5.8em;
+}
+.block-search .form-text {
+  width: 12em;
+  max-width: 100%;
+  color: white;
+  background: transparent;
+  border: none;
+}
+.block-search .form-text:focus {
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+}
+.block-search .form-actions {
+  position: absolute;
+  right: 1em;
+}
+.block-search .form-actions,
+.block-search .form-submit {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  width: 1.4em;
+  height: 1.4em;
+}
+.block-search .form-submit {
+  text-indent: -9999em;
+}
+.block-search .form-submit, .block-search .form-submit:hover {
+  background: transparent url('../images/icons/ico_search_wht.png?1395768501') no-repeat center center;
+  border: none;
+}
+@media only screen and (max-width: 768px) {
+  .block-search {
+    display: none;
+  }
+}
+
+/* =============================================================================
+ *   Node Styling
+ * ========================================================================== */
+.featured-node-tooltip {
+  position: absolute;
+  left: 100%;
+  top: 1px;
+  background-color: rgba(0, 0, 0, 0.85);
+  white-space: nowrap;
+  padding: 3px 5px;
+  color: white;
+  -webkit-border-radius: 3px;
+  -moz-border-radius: 3px;
+  -ms-border-radius: 3px;
+  -o-border-radius: 3px;
+  border-radius: 3px;
+  display: none;
+  margin-left: 5px;
+  z-index: 1;
+}
+.featured-node-tooltip:before {
+  content: "";
+  display: block;
+  width: 0px;
+  height: 0px;
+  border-style: solid;
+  border-width: 5px 5px 5px 0;
+  border-color: transparent rgba(0, 0, 0, 0.85) transparent transparent;
+  position: absolute;
+  left: -5px;
+  top: 50%;
+  margin-top: -5px;
+}
+.node-teaser.node-promoted:hover .featured-node-tooltip {
+  display: block;
+}
+
+.node .node-title {
+  margin: 0;
+}
+
+/**
+ * Node forms
+ */
+.node-form {
+  /* Polls have some bad, over specific, styles so this is what needs to be
+     done. */
+}
+.node-form #poll-choice-table .form-text {
+  width: 100%;
+}
+
+/* =============================================================================
+ *   Comment Styling - Comments, comment wrapper, comment form
+ * ========================================================================== */
+/**
+ * Wrapper for a single comment
+ */
+.comment {
+  margin-bottom: 20px;
+}
+
+/**
+ * "New" marker for comments that are new for the current user
+ */
+.new {
+  color: #cc0000;
+}
+
+/**
+ * Nested comments are indented
+ */
+.indented {
+  margin-left: 40px;
+}
+
+.has-rate-widget {
+  min-height: 4em;
+  margin-right: 6em;
+  position: relative;
+}
+@media only screen and (max-width: 768px) {
+  .has-rate-widget {
+    min-height: 0;
+    margin-right: 0;
+  }
+}
+
+.rate-widget-commons_thumbs_up_down {
+  float: right;
+  position: absolute;
+  top: 0;
+  right: -6em;
+  margin-top: 0;
+}
+@media only screen and (max-width: 768px) {
+  .rate-widget-commons_thumbs_up_down {
+    position: static;
+    float: left;
+    margin: 20px auto;
+  }
+}
+
+.related-information {
+  clear: both;
+  margin: 20px 0;
+}
+.related-information .field {
+  float: left;
+}
+
+/* =============================================================================
+ *   Forms
+ * ========================================================================== */
+html.js input.form-autocomplete {
+  background-position: 100% 5px;
+}
+
+html.js input.throbbing {
+  background-position: 100% -15px;
+  /* LTR */
+}
+
+/**
+ * Forms in tables.
+ */
+tr.odd .form-item, tr.even .form-item {
+  white-space: normal;
+}
+
+/**
+ * Wrapper for a form element (or group of form elements) and its label
+ */
+.form-item input.error,
+.form-item textarea.error,
+.form-item select.error {
+  border: 1px solid #cc0000;
+}
+.form-item label {
+  font-weight: 700;
+}
+.form-item .description {
+  font-size: 0.85em;
+}
+
+/**
+ * Highlight marks and form required mark
+ */
+.marker,
+.form-required {
+  color: #cc0000;
+}
+
+/**
+ * Password confirmation
+ */
+.password-parent,
+.confirm-parent {
+  margin: 0;
+}
+
+form.commons-events-form-float {
+  background-color: none;
+  padding: 0;
+  border: none;
+  border-radius: 0;
+}
+form.commons-events-form-float input {
+  margin: 0;
+}
+
+#edit-field-topics-und {
+  border-top: 2px groove #8A8A8A;
+  border-left: 2px groove #8A8A8A;
+}
+
+form.commons-events-form-float {
+  background: none;
+  padding: 0;
+  border: none;
+  max-width: 10em;
+  margin-right: -10em;
+  text-align: center;
+}
+form.commons-events-form-float .commons-event-status {
+  font-size: .88em;
+  line-height: 1.2em;
+  margin-top: .3em;
+  text-align: center;
+}
+@media only screen and (min-width: 481px) and (max-width: 768px) {
+  form.commons-events-form-float .commons-event-status {
+    display: inline-block;
+    margin-left: 1em;
+  }
+}
+@media only screen and (max-width: 768px) {
+  form.commons-events-form-float {
+    float: none;
+    margin: 1em 0;
+    max-width: inherit;
+    text-align: left;
+  }
+}
+
+/* =============================================================================
+ *   Tables
+ * ========================================================================== */
+table {
+  margin: 10px 0;
+  padding: 0;
+  width: 100%;
+}
+table.sticky-header {
+  z-index: 10;
+}
+
+table,
+thead,
+tbody,
+tr,
+th,
+td {
+  border-color: #cccccc;
+}
+
+table,
+td,
+th {
+  vertical-align: middle;
+}
+
+caption,
+th,
+td {
+  text-align: left;
+}
+
+thead tr {
+  font-weight: 700;
+  background-color: #e5e5e5;
+}
+
+td,
+th {
+  border-bottom: 0;
+  margin: 0;
+  padding: 5px 7px;
+}
+
+tbody tr {
+  border-top: 1px solid #cccccc;
+}
+
+tr {
+  /* Table row striping */
+}
+tr.odd {
+  background: #e6e6e6;
+}
+tr.info, tr.even, tr:nth-child(2n+2) {
+  border-bottom: 0;
+  background-color: whitesmoke;
+}
+tr.odd td.active {
+  background-color: #eeeeee;
+}
+tr.even td.active {
+  background-color: #ebebeb;
+}
+
+/**
+ * Forum tables
+ * Core sets white-space to nowrap, which makes no sense
+ */
+#forum td .created,
+#forum td .posts,
+#forum td .topics,
+#forum td .last-reply,
+#forum td .replies,
+#forum td .pager {
+  white-space: normal;
+}
+
+/* =============================================================================
+ *   Messages
+ * ========================================================================== */
+div.messages {
+  margin-bottom: 10px;
+  margin-top: 10px;
+}
+div.messages ul {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+
+/**
+ * Unpublished nodes
+ */
+.node-unpublished p.unpublished,
+.comment-unpublished p.unpublished {
+  color: pink;
+  color: rgba(239, 170, 170, 0.4);
+  font-family: Impact, Haettenschweiler, "Franklin Gothic Bold", Charcoal, "Helvetica Inserat", "Bitstream Vera Sans Bold", "Arial Black", sans-serif;
+  font-size: 50px;
+  font-weight: 700;
+  line-height: 1.2;
+  height: 0;
+  margin: 0;
+  padding: 0;
+  overflow: visible;
+  text-align: center;
+  text-transform: uppercase;
+  word-wrap: break-word;
+}
+
+/* =============================================================================
+ *    Maintenance pages
+ * ========================================================================== */
+.maintenance-page .container {
+  padding: 40px 0;
+}
+
+.db-offline .container {
+  margin: 0 auto;
+  padding: 40px 0;
+  width: 100%;
+  max-width: 960px;
+}
+.db-offline div.messages {
+  margin: 20px 0 0;
+}
+.db-offline #content {
+  padding: 20px 0;
+}
+
+/* =============================================================================
+ *   Misc overrides for contrib modules
+ * ========================================================================== */
+/**
+ * Admin menu overrides
+ */
+#admin-menu {
+  margin: 0;
+  padding: 0;
+}
+
+/**
+ * Devel Module
+ */
+.dev-query {
+  background: #eeeeee;
+  padding: 30px;
+}
+
+/**
+ * Styleguide module tweaks
+ */
+#styleguide-header {
+  padding: 0 10px;
+}
+#styleguide-header .item-list {
+  font-family: inherit;
+  margin: 0 20px 20px 0;
+  min-height: 260px;
+  width: auto;
+}
+
+/* =============================================================================
+ *   Front Page specific
+ * ========================================================================== */
+body.front .region-three-33-top {
+  font-size: 24px;
+  font-weight: 300;
+}
+body.front .region-three-33-top h1 {
+  color: #333333;
+  font-size: 40px;
+  font-weight: 700;
+  line-height: 50px;
+}
+body.front .region-three-33-top .commons_home-welcome-image {
+  float: right;
+}
+body.front.not-logged-in #block-system-main .pane-1 .pane-title {
+  font-weight: 700;
+  font-size: 38px;
+  color: #333333;
+}
+
+.commons-events-form-float {
+  float: right;
+  margin-left: 15px;
+}
+.commons-events-form-float input {
+  margin: 0;
+}
+
+.commons-event-count {
+  font-size: 1.2em;
+  font-weight: bold;
+}
+
+body.front.logged-in .view-commons-homepage-content > .view-content {
+  padding: 10px;
+}
+body.front.logged-in .view-commons-homepage-content > .view-content > .views-row {
+  position: relative;
+}
+body.front.logged-in .view-commons-homepage-content .article.node .author-datetime, body.front.logged-in .view-commons-homepage-content .node-teaser.node-group .author-datetime {
+  margin-bottom: 1.5em;
+  clear: both;
+}
+body.front.logged-in .view-commons-homepage-content .views-row-first {
+  border-top: none;
+}
+body.front.logged-in .view-commons-homepage-content .item-list {
+  padding: 10px 0 0 0;
+}
+body.front.logged-in #views-exposed-form-commons-homepage-content-panel-pane-1 .views-exposed-widgets {
+  padding: 10px 0;
+  margin-bottom: 0;
+}
+
+body.front.logged-in .view-commons-homepage-content .article.node.no-user-picture .node-header,
+body.front.logged-in .view-commons-homepage-content .article.node.no-user-picture .node-content,
+body.front.logged-in .view-commons-homepage-content .article.node.no-user-picture .author-datetime,
+body.front.logged-in .view-commons-homepage-content .article.node.no-user-picture .links, body.front.logged-in .view-commons-homepage-content .article.node.node-page .node-header,
+body.front.logged-in .view-commons-homepage-content .article.node.node-page .node-content,
+body.front.logged-in .view-commons-homepage-content .article.node.node-page .author-datetime,
+body.front.logged-in .view-commons-homepage-content .article.node.node-page .links {
+  margin-left: 0;
+}
+
+#quicktabs-commons_follow_ui .flag-email-group a,
+#quicktabs-commons_follow_ui .flag-email-node a,
+#quicktabs-commons_follow_ui .flag-email-user a,
+#quicktabs-commons_follow_ui .flag-email-term a {
+  cursor: default;
+}
+#quicktabs-commons_follow_ui .flag-email-group a input,
+#quicktabs-commons_follow_ui .flag-email-node a input,
+#quicktabs-commons_follow_ui .flag-email-user a input,
+#quicktabs-commons_follow_ui .flag-email-term a input {
+  cursor: default;
+}
+#quicktabs-commons_follow_ui .flag-email-group a span,
+#quicktabs-commons_follow_ui .flag-email-group span span,
+#quicktabs-commons_follow_ui .flag-email-node a span,
+#quicktabs-commons_follow_ui .flag-email-node span span,
+#quicktabs-commons_follow_ui .flag-email-user a span,
+#quicktabs-commons_follow_ui .flag-email-user span span,
+#quicktabs-commons_follow_ui .flag-email-term a span,
+#quicktabs-commons_follow_ui .flag-email-term span span {
+  display: none;
+}
+
+/**
+ *  Placeholder styles
+ */
+#menu-bar.nav .menu-item-193 a {
+  background-image: url('../images/icons/icon-home.png?1395768501');
+}
+#menu-bar.nav .menu-item-194 a {
+  background-image: url('../images/icons/icon-groups.png?1395768501');
+}
+#menu-bar.nav .menu-item-195 a {
+  background-image: url('../images/icons/icon-events.png?1395768501');
+}
+
+/**
+ * Events Page
+ */
+.page-events .region-three-25-50-25-third .pane-views-panes {
+  margin-right: 0;
+}
+.page-events div.search-result-wrapper h3.title {
+  text-decoration: none;
+}
+.page-events div.search-result-wrapper h3.title a {
+  color: #2783b9;
+}
+@media only screen and (max-width: 768px) {
+  .page-events .three-25-50-25 > .filters-processed {
+    clear: none;
+    position: absolute;
+    right: 0;
+    float: right;
+    width: 0;
+    height: 0;
+    margin: 0;
+    padding: 0;
+    font-size: .88em;
+    background: white;
+    border: 1px solid #eeeeee;
+    z-index: 1;
+  }
+  .page-events .three-25-50-25 > .filters-processed .commons-pod {
+    margin: 0;
+    padding: 10px 0;
+    -webkit-border-radius: 0 0 0 3px;
+    -moz-border-radius: 0 0 0 3px;
+    -ms-border-radius: 0 0 0 3px;
+    -o-border-radius: 0 0 0 3px;
+    border-radius: 0 0 0 3px;
+  }
+  .page-events .three-25-50-25 > .filters-processed .panel-pane {
+    display: none;
+  }
+  .page-events .three-25-50-25 > .filters-processed .filter-trigger {
+    display: block;
+  }
+  .page-events .three-25-50-25 > .expanded {
+    margin-right: 0;
+    width: 75%;
+    height: auto;
+    opacity: 1;
+  }
+  .page-events .three-25-50-25 > .expanded .commons-pod {
+    padding: 10px;
+  }
+  .page-events .three-25-50-25 > .expanded .panel-pane {
+    display: block;
+  }
+}
+@media only screen and (max-width: 768px) {
+  .page-events .filter-overlay.expanded {
+    display: block;
+  }
+}
+
+.pane-commons-events-commons-events-create-event-link {
+  text-align: right;
+}
+.pane-commons-events-commons-events-create-event-link .block-inner {
+  margin: 0;
+}
+.pane-commons-events-commons-events-create-event-link a:before {
+  background: url('../images/icons-sfd37165efe.png') 0 -429px no-repeat;
+  width: 15px;
+  height: 15px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+  content: "";
+  top: 2px;
+  margin-right: 6px;
+}
+
+/**
+ * Search
+ */
+.search-form-page .form-type-textfield label {
+  white-space: nowrap;
+}
+.search-form-page .form-type-textfield input {
+  width: auto;
+}
+@media only screen and (max-width: 480px) {
+  .search-form-page .form-type-textfield,
+  .search-form-page .form-type-textfield input {
+    display: block;
+    width: 100%;
+  }
+}
+@media only screen and (min-width: 481px) {
+  .search-form-page .form-item {
+    margin-bottom: 0;
+  }
+}
+
+.action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #46bb2e url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #4fcd35), color-stop(100%, #3ea729));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#4fcd35, #3ea729);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#4fcd35, #3ea729);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#4fcd35, #3ea729);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#4fcd35, #3ea729);
+  border-color: #27691a;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+.action-item-search[type="submit"], .action-item-search[type="submit"]:link, .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.action-item-search[type="submit"]:hover {
+  color: white;
+  background: #3ea729 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #46bb2e), color-stop(100%, #379224));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#46bb2e, #379224);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#46bb2e, #379224);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#46bb2e, #379224);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#46bb2e, #379224);
+  border-color: #184010;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+.action-item-search[type="submit"]:focus, .action-item-search[type="submit"]:active {
+  background: #46bb2e url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #3ea729), color-stop(100%, #4fcd35));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#3ea729, #4fcd35);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#3ea729, #4fcd35);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#3ea729, #4fcd35);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#3ea729, #4fcd35);
+  border-color: #27691a;
+  text-shadow: -1px 1px 2px #379224, -1px -1px 2px #379224, 1px -1px 2px #379224, 1px 1px 2px #379224;
+}
+[disabled].action-item-search[type="submit"] {
+  color: #85dc73;
+  background: #46bb2e;
+  border-color: #27691a;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+
+.action-item-search[type="submit"], .action-item-search[type="submit"]:hover, .action-item-search[type="submit"]:active, .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+
+.action-item-search {
+  float: right;
+  margin-right: 0;
+  margin-bottom: 0;
+}
+.action-item-search, .action-item-search[type="submit"] {
+  padding-left: 3em;
+}
+@media only screen and (max-width: 480px) {
+  .action-item-search {
+    float: none;
+    clear: both;
+    display: block;
+  }
+}
+@media only screen and (min-width: 481px) {
+  .action-item-search {
+    margin-top: 0;
+  }
+}
+
+.block-facetapi {
+  margin-bottom: .7em;
+  padding-bottom: .7em;
+  border-bottom: 1px solid #cccccc;
+}
+.block-facetapi:last-child {
+  margin-bottom: 0;
+  padding-bottom: 0;
+  border-bottom: none;
+}
+.block-facetapi .block-title {
+  margin-bottom: 10px;
+  color: #666666;
+  font-size: 1.2em;
+}
+
+.facetapi-facetapi-links,
+.facetapi-date-range {
+  margin: 0;
+  padding: 0;
+}
+.facetapi-facetapi-links li.leaf,
+.facetapi-date-range li.leaf {
+  margin-left: 0;
+  list-style-type: none;
+  list-style-image: none;
+}
+
+@media only screen and (max-width: 480px) {
+  .page-search .two-33-66 > .filters-processed {
+    clear: none;
+    position: absolute;
+    right: 0;
+    float: right;
+    width: 0;
+    height: 0;
+    margin: 0;
+    padding: 0;
+    font-size: .88em;
+    background: white;
+    border: 1px solid #eeeeee;
+    z-index: 1;
+  }
+  .page-search .two-33-66 > .filters-processed .commons-pod {
+    margin: 0;
+    padding: 10px 0;
+    -webkit-border-radius: 0 0 0 3px;
+    -moz-border-radius: 0 0 0 3px;
+    -ms-border-radius: 0 0 0 3px;
+    -o-border-radius: 0 0 0 3px;
+    border-radius: 0 0 0 3px;
+  }
+  .page-search .two-33-66 > .filters-processed .panel-pane {
+    display: none;
+  }
+  .page-search .two-33-66 > .filters-processed .filter-trigger {
+    display: block;
+  }
+  .page-search .two-33-66 > .expanded {
+    margin-right: 0;
+    width: 75%;
+    height: auto;
+    opacity: 1;
+  }
+  .page-search .two-33-66 > .expanded .commons-pod {
+    padding: 10px;
+  }
+  .page-search .two-33-66 > .expanded .panel-pane {
+    display: block;
+  }
+}
+@media only screen and (max-width: 480px) {
+  .page-search .filter-overlay.expanded {
+    display: block;
+  }
+}
+
+.facetapi-processed, .block-content .facetapi-processed {
+  margin-bottom: 0;
+  padding-left: 0;
+}
+.facetapi-processed li.last, .block-content .facetapi-processed li.last {
+  margin-bottom: 0;
+}
+
+.search-results-title,
+.search-results-wrapper > h2 {
+  margin-top: .2em;
+}
+
+.search-results {
+  margin-top: 0;
+}
+.search-results, .block-content .search-results {
+  margin-bottom: 0;
+  padding: 0;
+}
+
+.search-result {
+  border-bottom: 1px solid #cccccc;
+  list-style-type: none;
+}
+.search-result, .block-content .search-result {
+  padding-bottom: .7em;
+  margin-bottom: .7em;
+}
+.search-result:last-child, .block-content .search-result:last-child {
+  border-bottom: none;
+  padding-bottom: 0;
+  margin-bottom: 0;
+}
+.search-result h2 {
+  font-size: 1.429em;
+  line-height: 1.2em;
+  margin: .5em 0 0;
+}
+.search-result .title {
+  margin-top: 0;
+  margin-bottom: .2em;
+}
+.search-result .search-result-url {
+  color: #666666;
+  font-size: .85em;
+  margin-bottom: 1em;
+}
+.apachesolr_search-results .search-result .title,
+.apachesolr_search-results .search-result .search-result-url,
+.apachesolr_search-results .search-result .search-result-date,
+.apachesolr_search-results .search-result .search-result-snippet-info {
+  display: none;
+}
+.apachesolr_search-results .search-result .pane-node-flag-commons-follow-group-link {
+  position: static;
+  right: auto;
+  top: auto;
+  float: right;
+}
+
+/* Search profiles */
+.profile-search-result {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  display: inline-block;
+  padding-bottom: 0;
+  vertical-align: top;
+  width: 48.5%;
+  margin-right: 2%;
+}
+.profile-search-result:nth-child(even) {
+  margin-right: 0;
+}
+@media only screen and (max-width: 480px) {
+  .profile-search-result {
+    width: 100%;
+    margin-right: 0;
+  }
+}
+@media only screen and (min-width: 769px) {
+  .profile-search-result {
+    width: 31.5%;
+  }
+  .profile-search-result:nth-child(even) {
+    margin-right: 2%;
+  }
+  .profile-search-result:nth-child(3n) {
+    margin-right: 0;
+  }
+}
+.commons-pod .profile-search-result {
+  width: 100%;
+  margin-right: 0;
+}
+.commons-pod .profile-search-result .profile-actions {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  margin-right: 0;
+  margin-left: 0;
+  border: 1px solid #cccccc;
+  -webkit-border-radius: 0;
+  -moz-border-radius: 0;
+  -ms-border-radius: 0;
+  -o-border-radius: 0;
+  border-radius: 0;
+}
+.profile-search-result h4 {
+  margin: 0;
+}
+
+.profile-header,
+.profile-content {
+  margin-left: 72px;
+}
+
+.profile-header {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+}
+.profile-header .user-picture {
+  position: relative;
+  top: -1.2em;
+  float: left;
+  margin-bottom: 0;
+  margin-left: -72px;
+}
+
+.profile-content {
+  overflow: hidden;
+  height: 2.8em;
+  line-height: 1.4em;
+}
+.profile-content:before {
+  content: "";
+  float: left;
+  width: 5px;
+  height: 2.8em;
+}
+.profile-content > *:first-child {
+  float: right;
+  width: 100%;
+  margin-left: -5px;
+}
+.profile-content:after {
+  content: "\02026";
+  float: right;
+  position: relative;
+  top: -1.4em;
+  left: 100%;
+  width: 3em;
+  margin-left: -3em;
+  padding-right: 5px;
+  text-align: right;
+  background: #fff;
+  background: -webkit-gradient(linear, 0% 50%, 100% 50%, color-stop(0%, rgba(255, 255, 255, 0)), color-stop(50%, #ffffff), color-stop(100%, #ffffff));
+  background: -webkit-linear-gradient(left, rgba(255, 255, 255, 0), #ffffff 50%, #ffffff);
+  background: -moz-linear-gradient(left, rgba(255, 255, 255, 0), #ffffff 50%, #ffffff);
+  background: -o-linear-gradient(left, rgba(255, 255, 255, 0), #ffffff 50%, #ffffff);
+  background: linear-gradient(left, rgba(255, 255, 255, 0), #ffffff 50%, #ffffff);
+}
+
+.associated-groups-title,
+.associated-groups,
+.group-item {
+  display: inline;
+  margin: 0;
+  color: #858585;
+  white-space: normal;
+}
+
+.associated-groups-title {
+  font-weight: normal;
+}
+
+.associated-groups, .block-content .associated-groups {
+  padding-left: 0;
+}
+
+.associated-groups-title,
+.group-item {
+  margin-right: .2em;
+  font-size: .88em;
+}
+
+.group-item:after {
+  content: ",";
+}
+.group-item:last-child {
+  margin-right: 0;
+}
+.group-item:last-child:after {
+  content: ".";
+}
+
+.profile-actions {
+  clear: both;
+  width: 100%;
+  margin-top: 10px;
+  margin-left: -10px;
+  margin-right: -10px;
+  padding: 5px 10px;
+  background: whitesmoke;
+  border-top: 1px solid #cccccc;
+  -moz-border-radius-bottomright: 0.4em;
+  -webkit-border-bottom-right-radius: 0.4em;
+  border-bottom-right-radius: 0.4em;
+  -moz-border-radius-bottomleft: 0.4em;
+  -webkit-border-bottom-left-radius: 0.4em;
+  border-bottom-left-radius: 0.4em;
+}
+.profile-actions .field {
+  /* Make fields in the wrapper inline. */
+  display: inline-block;
+}
+
+/**
+ * Notification settings
+ */
+.view-commons-follow-node .views-field-ops,
+.view-commons-follow-node .views-field-ops-1,
+.view-commons-follow-user .views-field-ops,
+.view-commons-follow-user .views-field-ops-1,
+.view-commons-follow-taxonomy-term .views-field-ops,
+.view-commons-follow-taxonomy-term .views-field-ops-1 {
+  width: 20%;
+}
+.view-commons-follow-node .views-field-ops,
+.view-commons-follow-user .views-field-ops,
+.view-commons-follow-taxonomy-term .views-field-ops {
+  text-align: right;
+}
+.view-commons-follow-node .views-field-ops-1,
+.view-commons-follow-user .views-field-ops-1,
+.view-commons-follow-taxonomy-term .views-field-ops-1 {
+  text-align: center;
+}
+
+/**
+ * Trusted contacts
+ */
+.views-field-field-membership-token a:first-child:after {
+  content: "|";
+  display: inline-block;
+  padding: 0 .3em 0 .5em;
+  color: #333333;
+}
+
+.trusted-status-request:before {
+  content: "\271a";
+  position: relative;
+  top: .1em;
+  display: inline-block;
+  margin-right: .2em;
+  font-size: 1.4em;
+  line-height: .6em;
+}
+
+.message-contact:before {
+  content: "";
+  background: url('../images/icons-sfd37165efe.png') 0 -531px no-repeat;
+  width: 11px;
+  height: 12px;
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
+
+/**
+ * Private message
+ */
+.privatemsg-conversation .form-actions,
+.privatemsg-conversation .form-actions [class*="action-item"] {
+  margin-bottom: 0;
+}
+
+.privatemsg-message-participants {
+  margin-bottom: 10px;
+  padding-bottom: 10px;
+  border-bottom: 1px solid #cccccc;
+}
+
+.privatemsg-message {
+  -webkit-box-sizing: border-box;
+  -moz-box-sizing: border-box;
+  box-sizing: border-box;
+  width: 100%;
+  margin-bottom: 10px;
+  padding-bottom: 10px;
+  padding-left: 72px;
+  border-bottom: 1px solid #cccccc;
+}
+.privatemsg-message .user-picture {
+  position: relative;
+  float: left;
+  width: 50px;
+  margin-left: -72px;
+}
+
+.privatemsg-message-links {
+  font-size: .88em;
+  text-align: right;
+}
+
+.message-delete:before {
+  content: "\2715";
+  display: inline-block;
+  margin-right: .3em;
+  color: #a3a3a3;
+  font-weight: bold;
+}
+
+/**
+ * Commons Origins Pallete Choices
+ */
+#edit-commons-origins-palette .form-item-commons-origins-palette {
+  clear: both;
+  margin-bottom: 10px;
+}
+#edit-commons-origins-palette .form-item-commons-origins-palette input[type="radio"] {
+  float: left;
+}
+#edit-commons-origins-palette .form-item-commons-origins-palette label {
+  margin-left: 20px;
+}
+
+/**
+ * Login and signup form
+ */
+#user-login input[type="text"], #user-login input[type="password"], #user-register-form input[type="text"], #user-register-form input[type="password"] {
+  width: 20em;
+  max-width: 100%;
+}
+
+/**
+ * Add the color palettes
+ */
+.palette-orange-red h2 {
+  color: #830c00;
+}
+.palette-orange-red .header-color-row-one {
+  background-color: #830c00;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-orange-red .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-orange-red .header-color-row-one {
+  -webkit-box-shadow: #830c00 0px -1px 0px;
+  -moz-box-shadow: #830c00 0px -1px 0px;
+  box-shadow: #830c00 0px -1px 0px;
+}
+.palette-orange-red .header-color-row-two {
+  background-color: #d54f1a;
+  border-top: 1px solid #e76c3b;
+  border-bottom: 1px solid #a83e14;
+}
+.palette-orange-red h1.node-title {
+  color: #d54f1a;
+}
+.palette-orange-red h1.node-title a {
+  color: #d54f1a;
+}
+.palette-orange-red a, .palette-orange-red .commons-bw-create-all-widget-types li a {
+  color: #d54f1a;
+}
+.palette-orange-red .select-status:after {
+  border-top-color: #d54f1a;
+}
+.palette-orange-red #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-orange-red #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #e76c3b transparent;
+}
+.palette-orange-red #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-orange-red #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #d54f1a transparent;
+}
+.palette-orange-red ul.commons-utility-links li.last {
+  border-left-color: #d54f1a;
+}
+.palette-orange-red .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-orange-red .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-orange-red ul.primary.tabs li a,
+.palette-orange-red ul.primary.tabs li a span {
+  color: #d54f1a;
+}
+.palette-orange-red .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-orange-red ul.primary.tabs li a:hover {
+  color: #a83e14;
+}
+.palette-orange-red .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-orange-red .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-orange-red ul.primary.tabs li.active a,
+.palette-orange-red ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-orange-red .partial-node-form-title {
+  color: #ff9126;
+}
+.palette-orange-red .block-search {
+  background-color: #9e3b13;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF9E3B13', endColorstr='#FFBA4517');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #9e3b13), color-stop(100%, #ba4517));
+  background-image: -webkit-linear-gradient(top, #9e3b13 0%, #ba4517 100%);
+  background-image: -moz-linear-gradient(top, #9e3b13 0%, #ba4517 100%);
+  background-image: -o-linear-gradient(top, #9e3b13 0%, #ba4517 100%);
+  background-image: linear-gradient(top, #9e3b13 0%, #ba4517 100%);
+}
+.palette-orange-red .commons-bw-create-all-widget-types, .palette-orange-red li.sharethis .sharethis-wrapper {
+  border-color: #d54f1a;
+}
+.palette-orange-red li.sharethis .sharethis-wrapper:before {
+  border-color: #d54f1a transparent transparent transparent;
+}
+.palette-orange-red #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-orange-red a {
+  border-left: 1px solid #a20f00;
+  -webkit-box-shadow: #410600 -1px 0px 0px;
+  -moz-box-shadow: #410600 -1px 0px 0px;
+  box-shadow: #410600 -1px 0px 0px;
+}
+.palette-orange-red #menu-bar.nav {
+  border-right: 1px solid #410600;
+  -webkit-box-shadow: #a20f00 1px 0px 0px;
+  -moz-box-shadow: #a20f00 1px 0px 0px;
+  box-shadow: #a20f00 1px 0px 0px;
+}
+.palette-orange-red .action-item-primary,
+.palette-orange-red .action-item-small-primary,
+.palette-orange-red .action-item-large-primary, .palette-orange-red .commons-sign-up, .palette-orange-red .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-orange-red a, .palette-orange-red .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-orange-red a {
+  background-color: #ff9126;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ff9e40), color-stop(100%, #ff840c));
+  background: -webkit-linear-gradient(#ff9e40, #ff840c);
+  background: -moz-linear-gradient(#ff9e40, #ff840c);
+  background: -o-linear-gradient(#ff9e40, #ff840c);
+  background: linear-gradient(#ff9e40, #ff840c);
+  border-color: #bf5e00;
+  text-shadow: -1px 1px 2px #f27700, -1px -1px 2px #f27700, 1px -1px 2px #f27700, 1px 1px 2px #f27700;
+}
+.palette-orange-red .action-item-primary,
+.palette-orange-red .action-item-small-primary,
+.palette-orange-red .action-item-large-primary, .palette-orange-red .commons-sign-up, .palette-orange-red .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-orange-red a, .palette-orange-red .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-orange-red a, .palette-orange-red .action-item-primary:link,
+.palette-orange-red .action-item-small-primary:link,
+.palette-orange-red .action-item-large-primary:link, .palette-orange-red .commons-sign-up:link, .palette-orange-red .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-orange-red a:link, .palette-orange-red .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-orange-red a:link, .palette-orange-red .action-item-primary:visited,
+.palette-orange-red .action-item-small-primary:visited,
+.palette-orange-red .action-item-large-primary:visited, .palette-orange-red .commons-sign-up:visited, .palette-orange-red .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-orange-red a:visited, .palette-orange-red .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-orange-red a:visited {
+  color: white;
+}
+.palette-orange-red .action-item-primary:hover,
+.palette-orange-red .action-item-small-primary:hover,
+.palette-orange-red .action-item-large-primary:hover, .palette-orange-red .commons-sign-up:hover, .palette-orange-red .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-orange-red a:hover, .palette-orange-red .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-orange-red a:hover {
+  color: white;
+  background-color: #ff840c;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ff9126), color-stop(100%, #f27700));
+  background: -webkit-linear-gradient(#ff9126, #f27700);
+  background: -moz-linear-gradient(#ff9126, #f27700);
+  background: -o-linear-gradient(#ff9126, #f27700);
+  background: linear-gradient(#ff9126, #f27700);
+  border-color: #8c4500;
+  text-shadow: -1px 1px 2px #f27700, -1px -1px 2px #f27700, 1px -1px 2px #f27700, 1px 1px 2px #f27700;
+}
+.palette-orange-red .action-item-primary:focus,
+.palette-orange-red .action-item-small-primary:focus,
+.palette-orange-red .action-item-large-primary:focus, .palette-orange-red .commons-sign-up:focus, .palette-orange-red .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-orange-red a:focus, .palette-orange-red .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-orange-red a:focus, .palette-orange-red .action-item-primary:active,
+.palette-orange-red .action-item-small-primary:active,
+.palette-orange-red .action-item-large-primary:active, .palette-orange-red .commons-sign-up:active, .palette-orange-red .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-orange-red a:active, .palette-orange-red .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-orange-red a:active {
+  background: #ff9126;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ff840c), color-stop(100%, #ff9e40));
+  background: -webkit-linear-gradient(#ff840c, #ff9e40);
+  background: -moz-linear-gradient(#ff840c, #ff9e40);
+  background: -o-linear-gradient(#ff840c, #ff9e40);
+  background: linear-gradient(#ff840c, #ff9e40);
+  border-color: #bf5e00;
+  text-shadow: -1px 1px 2px #f27700, -1px -1px 2px #f27700, 1px -1px 2px #f27700, 1px 1px 2px #f27700;
+}
+.palette-orange-red [disabled].action-item-primary,
+.palette-orange-red [disabled].action-item-small-primary,
+.palette-orange-red [disabled].action-item-large-primary, .palette-orange-red [disabled].commons-sign-up, .palette-orange-red .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-orange-red a[disabled], .palette-orange-red .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-orange-red a[disabled] {
+  color: #ffc58c;
+  background: #ff9126;
+  border-color: #bf5e00;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-orange-red .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #ff9126 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ff9e40), color-stop(100%, #ff840c));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#ff9e40, #ff840c);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#ff9e40, #ff840c);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#ff9e40, #ff840c);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#ff9e40, #ff840c);
+  border-color: #bf5e00;
+  text-shadow: -1px 1px 2px #f27700, -1px -1px 2px #f27700, 1px -1px 2px #f27700, 1px 1px 2px #f27700;
+}
+.palette-orange-red .action-item-search[type="submit"], .palette-orange-red .action-item-search[type="submit"]:link, .palette-orange-red .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-orange-red .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #ff840c url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ff9126), color-stop(100%, #f27700));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#ff9126, #f27700);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#ff9126, #f27700);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#ff9126, #f27700);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#ff9126, #f27700);
+  border-color: #8c4500;
+  text-shadow: -1px 1px 2px #f27700, -1px -1px 2px #f27700, 1px -1px 2px #f27700, 1px 1px 2px #f27700;
+}
+.palette-orange-red .action-item-search[type="submit"]:focus, .palette-orange-red .action-item-search[type="submit"]:active {
+  background: #ff9126 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #ff840c), color-stop(100%, #ff9e40));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#ff840c, #ff9e40);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#ff840c, #ff9e40);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#ff840c, #ff9e40);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#ff840c, #ff9e40);
+  border-color: #bf5e00;
+  text-shadow: -1px 1px 2px #f27700, -1px -1px 2px #f27700, 1px -1px 2px #f27700, 1px 1px 2px #f27700;
+}
+.palette-orange-red [disabled].action-item-search[type="submit"] {
+  color: #ffc58c;
+  background: #ff9126;
+  border-color: #bf5e00;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-orange-red .action-item-search[type="submit"], .palette-orange-red .action-item-search[type="submit"]:hover, .palette-orange-red .action-item-search[type="submit"]:active, .palette-orange-red .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-orange-red .notification-count {
+  background: #feb431;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #feb431), color-stop(100%, #c88001));
+  background: -webkit-linear-gradient(#feb431, #c88001);
+  background: -moz-linear-gradient(#feb431, #c88001);
+  background: -o-linear-gradient(#feb431, #c88001);
+  background: linear-gradient(#feb431, #c88001);
+  -webkit-box-shadow: 0 0 2px #830c00;
+  -moz-box-shadow: 0 0 2px #830c00;
+  box-shadow: 0 0 2px #830c00;
+}
+
+.palette-magenta-blue h2 {
+  color: #891746;
+}
+.palette-magenta-blue .header-color-row-one {
+  background-color: #891746;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-magenta-blue .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-magenta-blue .header-color-row-one {
+  -webkit-box-shadow: #891746 0px -1px 0px;
+  -moz-box-shadow: #891746 0px -1px 0px;
+  box-shadow: #891746 0px -1px 0px;
+}
+.palette-magenta-blue .header-color-row-two {
+  background-color: #e60074;
+  border-top: 1px solid #ff1a8d;
+  border-bottom: 1px solid #b3005a;
+}
+.palette-magenta-blue h1.node-title {
+  color: #e60074;
+}
+.palette-magenta-blue h1.node-title a {
+  color: #e60074;
+}
+.palette-magenta-blue a, .palette-magenta-blue .commons-bw-create-all-widget-types li a {
+  color: #e60074;
+}
+.palette-magenta-blue .select-status:after {
+  border-top-color: #e60074;
+}
+.palette-magenta-blue #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-magenta-blue #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #ff1a8d transparent;
+}
+.palette-magenta-blue #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-magenta-blue #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #e60074 transparent;
+}
+.palette-magenta-blue ul.commons-utility-links li.last {
+  border-left-color: #e60074;
+}
+.palette-magenta-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-magenta-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-magenta-blue ul.primary.tabs li a,
+.palette-magenta-blue ul.primary.tabs li a span {
+  color: #e60074;
+}
+.palette-magenta-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-magenta-blue ul.primary.tabs li a:hover {
+  color: #b3005a;
+}
+.palette-magenta-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-magenta-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-magenta-blue ul.primary.tabs li.active a,
+.palette-magenta-blue ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-magenta-blue .partial-node-form-title {
+  color: #0097bf;
+}
+.palette-magenta-blue .block-search {
+  background-color: #a90055;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FFA90055', endColorstr='#FFC70065');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #a90055), color-stop(100%, #c70065));
+  background-image: -webkit-linear-gradient(top, #a90055 0%, #c70065 100%);
+  background-image: -moz-linear-gradient(top, #a90055 0%, #c70065 100%);
+  background-image: -o-linear-gradient(top, #a90055 0%, #c70065 100%);
+  background-image: linear-gradient(top, #a90055 0%, #c70065 100%);
+}
+.palette-magenta-blue .commons-bw-create-all-widget-types, .palette-magenta-blue li.sharethis .sharethis-wrapper {
+  border-color: #e60074;
+}
+.palette-magenta-blue li.sharethis .sharethis-wrapper:before {
+  border-color: #e60074 transparent transparent transparent;
+}
+.palette-magenta-blue #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-magenta-blue a {
+  border-left: 1px solid #a31b53;
+  -webkit-box-shadow: #500d29 -1px 0px 0px;
+  -moz-box-shadow: #500d29 -1px 0px 0px;
+  box-shadow: #500d29 -1px 0px 0px;
+}
+.palette-magenta-blue #menu-bar.nav {
+  border-right: 1px solid #500d29;
+  -webkit-box-shadow: #a31b53 1px 0px 0px;
+  -moz-box-shadow: #a31b53 1px 0px 0px;
+  box-shadow: #a31b53 1px 0px 0px;
+}
+.palette-magenta-blue .action-item-primary,
+.palette-magenta-blue .action-item-small-primary,
+.palette-magenta-blue .action-item-large-primary, .palette-magenta-blue .commons-sign-up, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a {
+  background-color: #0097bf;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #00abd9), color-stop(100%, #0083a6));
+  background: -webkit-linear-gradient(#00abd9, #0083a6);
+  background: -moz-linear-gradient(#00abd9, #0083a6);
+  background: -o-linear-gradient(#00abd9, #0083a6);
+  background: linear-gradient(#00abd9, #0083a6);
+  border-color: #004659;
+  text-shadow: -1px 1px 2px #006f8c, -1px -1px 2px #006f8c, 1px -1px 2px #006f8c, 1px 1px 2px #006f8c;
+}
+.palette-magenta-blue .action-item-primary,
+.palette-magenta-blue .action-item-small-primary,
+.palette-magenta-blue .action-item-large-primary, .palette-magenta-blue .commons-sign-up, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a, .palette-magenta-blue .action-item-primary:link,
+.palette-magenta-blue .action-item-small-primary:link,
+.palette-magenta-blue .action-item-large-primary:link, .palette-magenta-blue .commons-sign-up:link, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a:link, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a:link, .palette-magenta-blue .action-item-primary:visited,
+.palette-magenta-blue .action-item-small-primary:visited,
+.palette-magenta-blue .action-item-large-primary:visited, .palette-magenta-blue .commons-sign-up:visited, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a:visited, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a:visited {
+  color: white;
+}
+.palette-magenta-blue .action-item-primary:hover,
+.palette-magenta-blue .action-item-small-primary:hover,
+.palette-magenta-blue .action-item-large-primary:hover, .palette-magenta-blue .commons-sign-up:hover, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a:hover, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a:hover {
+  color: white;
+  background-color: #0083a6;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0097bf), color-stop(100%, #006f8c));
+  background: -webkit-linear-gradient(#0097bf, #006f8c);
+  background: -moz-linear-gradient(#0097bf, #006f8c);
+  background: -o-linear-gradient(#0097bf, #006f8c);
+  background: linear-gradient(#0097bf, #006f8c);
+  border-color: #001e26;
+  text-shadow: -1px 1px 2px #006f8c, -1px -1px 2px #006f8c, 1px -1px 2px #006f8c, 1px 1px 2px #006f8c;
+}
+.palette-magenta-blue .action-item-primary:focus,
+.palette-magenta-blue .action-item-small-primary:focus,
+.palette-magenta-blue .action-item-large-primary:focus, .palette-magenta-blue .commons-sign-up:focus, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a:focus, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a:focus, .palette-magenta-blue .action-item-primary:active,
+.palette-magenta-blue .action-item-small-primary:active,
+.palette-magenta-blue .action-item-large-primary:active, .palette-magenta-blue .commons-sign-up:active, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a:active, .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a:active {
+  background: #0097bf;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0083a6), color-stop(100%, #00abd9));
+  background: -webkit-linear-gradient(#0083a6, #00abd9);
+  background: -moz-linear-gradient(#0083a6, #00abd9);
+  background: -o-linear-gradient(#0083a6, #00abd9);
+  background: linear-gradient(#0083a6, #00abd9);
+  border-color: #004659;
+  text-shadow: -1px 1px 2px #006f8c, -1px -1px 2px #006f8c, 1px -1px 2px #006f8c, 1px 1px 2px #006f8c;
+}
+.palette-magenta-blue [disabled].action-item-primary,
+.palette-magenta-blue [disabled].action-item-small-primary,
+.palette-magenta-blue [disabled].action-item-large-primary, .palette-magenta-blue [disabled].commons-sign-up, .palette-magenta-blue .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-magenta-blue a[disabled], .palette-magenta-blue .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-magenta-blue a[disabled] {
+  color: #26d2ff;
+  background: #0097bf;
+  border-color: #004659;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-magenta-blue .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #0097bf url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #00abd9), color-stop(100%, #0083a6));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#00abd9, #0083a6);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#00abd9, #0083a6);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#00abd9, #0083a6);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#00abd9, #0083a6);
+  border-color: #004659;
+  text-shadow: -1px 1px 2px #006f8c, -1px -1px 2px #006f8c, 1px -1px 2px #006f8c, 1px 1px 2px #006f8c;
+}
+.palette-magenta-blue .action-item-search[type="submit"], .palette-magenta-blue .action-item-search[type="submit"]:link, .palette-magenta-blue .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-magenta-blue .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #0083a6 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0097bf), color-stop(100%, #006f8c));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#0097bf, #006f8c);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#0097bf, #006f8c);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#0097bf, #006f8c);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#0097bf, #006f8c);
+  border-color: #001e26;
+  text-shadow: -1px 1px 2px #006f8c, -1px -1px 2px #006f8c, 1px -1px 2px #006f8c, 1px 1px 2px #006f8c;
+}
+.palette-magenta-blue .action-item-search[type="submit"]:focus, .palette-magenta-blue .action-item-search[type="submit"]:active {
+  background: #0097bf url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0083a6), color-stop(100%, #00abd9));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#0083a6, #00abd9);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#0083a6, #00abd9);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#0083a6, #00abd9);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#0083a6, #00abd9);
+  border-color: #004659;
+  text-shadow: -1px 1px 2px #006f8c, -1px -1px 2px #006f8c, 1px -1px 2px #006f8c, 1px 1px 2px #006f8c;
+}
+.palette-magenta-blue [disabled].action-item-search[type="submit"] {
+  color: #26d2ff;
+  background: #0097bf;
+  border-color: #004659;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-magenta-blue .action-item-search[type="submit"], .palette-magenta-blue .action-item-search[type="submit"]:hover, .palette-magenta-blue .action-item-search[type="submit"]:active, .palette-magenta-blue .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-magenta-blue .notification-count {
+  background: #69c5ec;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #69c5ec), color-stop(100%, #1b9dd4));
+  background: -webkit-linear-gradient(#69c5ec, #1b9dd4);
+  background: -moz-linear-gradient(#69c5ec, #1b9dd4);
+  background: -o-linear-gradient(#69c5ec, #1b9dd4);
+  background: linear-gradient(#69c5ec, #1b9dd4);
+  -webkit-box-shadow: 0 0 2px #891746;
+  -moz-box-shadow: 0 0 2px #891746;
+  box-shadow: 0 0 2px #891746;
+}
+
+.palette-blue-blue h2 {
+  color: #197bb1;
+}
+.palette-blue-blue .header-color-row-one {
+  background-color: #197bb1;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-blue-blue .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-blue-blue .header-color-row-one {
+  -webkit-box-shadow: #197bb1 0px -1px 0px;
+  -moz-box-shadow: #197bb1 0px -1px 0px;
+  box-shadow: #197bb1 0px -1px 0px;
+}
+.palette-blue-blue .header-color-row-two {
+  background-color: #0d8bb9;
+  border-top: 1px solid #10afe9;
+  border-bottom: 1px solid #0a6789;
+}
+.palette-blue-blue h1.node-title {
+  color: #0d8bb9;
+}
+.palette-blue-blue h1.node-title a {
+  color: #0d8bb9;
+}
+.palette-blue-blue a, .palette-blue-blue .commons-bw-create-all-widget-types li a {
+  color: #0d8bb9;
+}
+.palette-blue-blue .select-status:after {
+  border-top-color: #0d8bb9;
+}
+.palette-blue-blue #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-blue-blue #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #10afe9 transparent;
+}
+.palette-blue-blue #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-blue-blue #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #0d8bb9 transparent;
+}
+.palette-blue-blue ul.commons-utility-links li.last {
+  border-left-color: #0d8bb9;
+}
+.palette-blue-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-blue-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-blue-blue ul.primary.tabs li a,
+.palette-blue-blue ul.primary.tabs li a span {
+  color: #0d8bb9;
+}
+.palette-blue-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-blue-blue ul.primary.tabs li a:hover {
+  color: #0a6789;
+}
+.palette-blue-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-blue-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-blue-blue ul.primary.tabs li.active a,
+.palette-blue-blue ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-blue-blue .partial-node-form-title {
+  color: #7ebd26;
+}
+.palette-blue-blue .block-search {
+  background-color: #096080;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF096080', endColorstr='#FF0B769C');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #096080), color-stop(100%, #0b769c));
+  background-image: -webkit-linear-gradient(top, #096080 0%, #0b769c 100%);
+  background-image: -moz-linear-gradient(top, #096080 0%, #0b769c 100%);
+  background-image: -o-linear-gradient(top, #096080 0%, #0b769c 100%);
+  background-image: linear-gradient(top, #096080 0%, #0b769c 100%);
+}
+.palette-blue-blue .commons-bw-create-all-widget-types, .palette-blue-blue li.sharethis .sharethis-wrapper {
+  border-color: #0d8bb9;
+}
+.palette-blue-blue li.sharethis .sharethis-wrapper:before {
+  border-color: #0d8bb9 transparent transparent transparent;
+}
+.palette-blue-blue #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-blue-blue a {
+  border-left: 1px solid #1d8ecc;
+  -webkit-box-shadow: #115377 -1px 0px 0px;
+  -moz-box-shadow: #115377 -1px 0px 0px;
+  box-shadow: #115377 -1px 0px 0px;
+}
+.palette-blue-blue #menu-bar.nav {
+  border-right: 1px solid #115377;
+  -webkit-box-shadow: #1d8ecc 1px 0px 0px;
+  -moz-box-shadow: #1d8ecc 1px 0px 0px;
+  box-shadow: #1d8ecc 1px 0px 0px;
+}
+.palette-blue-blue .action-item-primary,
+.palette-blue-blue .action-item-small-primary,
+.palette-blue-blue .action-item-large-primary, .palette-blue-blue .commons-sign-up, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a {
+  background-color: #7ebd26;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #8cd22a), color-stop(100%, #70a822));
+  background: -webkit-linear-gradient(#8cd22a, #70a822);
+  background: -moz-linear-gradient(#8cd22a, #70a822);
+  background: -o-linear-gradient(#8cd22a, #70a822);
+  background: linear-gradient(#8cd22a, #70a822);
+  border-color: #456815;
+  text-shadow: -1px 1px 2px #62931d, -1px -1px 2px #62931d, 1px -1px 2px #62931d, 1px 1px 2px #62931d;
+}
+.palette-blue-blue .action-item-primary,
+.palette-blue-blue .action-item-small-primary,
+.palette-blue-blue .action-item-large-primary, .palette-blue-blue .commons-sign-up, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a, .palette-blue-blue .action-item-primary:link,
+.palette-blue-blue .action-item-small-primary:link,
+.palette-blue-blue .action-item-large-primary:link, .palette-blue-blue .commons-sign-up:link, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a:link, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a:link, .palette-blue-blue .action-item-primary:visited,
+.palette-blue-blue .action-item-small-primary:visited,
+.palette-blue-blue .action-item-large-primary:visited, .palette-blue-blue .commons-sign-up:visited, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a:visited, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a:visited {
+  color: white;
+}
+.palette-blue-blue .action-item-primary:hover,
+.palette-blue-blue .action-item-small-primary:hover,
+.palette-blue-blue .action-item-large-primary:hover, .palette-blue-blue .commons-sign-up:hover, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a:hover, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a:hover {
+  color: white;
+  background-color: #70a822;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #7ebd26), color-stop(100%, #62931d));
+  background: -webkit-linear-gradient(#7ebd26, #62931d);
+  background: -moz-linear-gradient(#7ebd26, #62931d);
+  background: -o-linear-gradient(#7ebd26, #62931d);
+  background: linear-gradient(#7ebd26, #62931d);
+  border-color: #293e0c;
+  text-shadow: -1px 1px 2px #62931d, -1px -1px 2px #62931d, 1px -1px 2px #62931d, 1px 1px 2px #62931d;
+}
+.palette-blue-blue .action-item-primary:focus,
+.palette-blue-blue .action-item-small-primary:focus,
+.palette-blue-blue .action-item-large-primary:focus, .palette-blue-blue .commons-sign-up:focus, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a:focus, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a:focus, .palette-blue-blue .action-item-primary:active,
+.palette-blue-blue .action-item-small-primary:active,
+.palette-blue-blue .action-item-large-primary:active, .palette-blue-blue .commons-sign-up:active, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-blue-blue a:active, .palette-blue-blue .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-blue-blue a:active {
+  background: #7ebd26;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #70a822), color-stop(100%, #8cd22a));
+  background: -webkit-linear-gradient(#70a822, #8cd22a);
+  background: -moz-linear-gradient(#70a822, #8cd22a);
+  background: -o-linear-gradient(#70a822, #8cd22a);
+  background: linear-gradient(#70a822, #8cd22a);
+  border-color: #456815;
+  text-shadow: -1px 1px 2px #62931d, -1px -1px 2px #62931d, 1px -1px 2px #62931d, 1px 1px 2px #62931d;
+}
+.palette-blue-blue [disabled].action-item-primary,
+.palette-blue-blue [disabled].action-item-small-primary,
+.palette-blue-blue [disabled].action-item-large-primary, .palette-blue-blue [disabled].commons-sign-up, .palette-blue-blue .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-blue-blue a[disabled], .palette-blue-blue .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-blue-blue a[disabled] {
+  color: #aee168;
+  background: #7ebd26;
+  border-color: #456815;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-blue-blue .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #7ebd26 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #8cd22a), color-stop(100%, #70a822));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#8cd22a, #70a822);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#8cd22a, #70a822);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#8cd22a, #70a822);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#8cd22a, #70a822);
+  border-color: #456815;
+  text-shadow: -1px 1px 2px #62931d, -1px -1px 2px #62931d, 1px -1px 2px #62931d, 1px 1px 2px #62931d;
+}
+.palette-blue-blue .action-item-search[type="submit"], .palette-blue-blue .action-item-search[type="submit"]:link, .palette-blue-blue .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-blue-blue .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #70a822 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #7ebd26), color-stop(100%, #62931d));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#7ebd26, #62931d);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#7ebd26, #62931d);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#7ebd26, #62931d);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#7ebd26, #62931d);
+  border-color: #293e0c;
+  text-shadow: -1px 1px 2px #62931d, -1px -1px 2px #62931d, 1px -1px 2px #62931d, 1px 1px 2px #62931d;
+}
+.palette-blue-blue .action-item-search[type="submit"]:focus, .palette-blue-blue .action-item-search[type="submit"]:active {
+  background: #7ebd26 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #70a822), color-stop(100%, #8cd22a));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#70a822, #8cd22a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#70a822, #8cd22a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#70a822, #8cd22a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#70a822, #8cd22a);
+  border-color: #456815;
+  text-shadow: -1px 1px 2px #62931d, -1px -1px 2px #62931d, 1px -1px 2px #62931d, 1px 1px 2px #62931d;
+}
+.palette-blue-blue [disabled].action-item-search[type="submit"] {
+  color: #aee168;
+  background: #7ebd26;
+  border-color: #456815;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-blue-blue .action-item-search[type="submit"], .palette-blue-blue .action-item-search[type="submit"]:hover, .palette-blue-blue .action-item-search[type="submit"]:active, .palette-blue-blue .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-blue-blue .notification-count {
+  background: #7ebd26;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #7ebd26), color-stop(100%, #456815));
+  background: -webkit-linear-gradient(#7ebd26, #456815);
+  background: -moz-linear-gradient(#7ebd26, #456815);
+  background: -o-linear-gradient(#7ebd26, #456815);
+  background: linear-gradient(#7ebd26, #456815);
+  -webkit-box-shadow: 0 0 2px #197bb1;
+  -moz-box-shadow: 0 0 2px #197bb1;
+  box-shadow: 0 0 2px #197bb1;
+}
+
+.palette-black-green h2 {
+  color: #2d3538;
+}
+.palette-black-green .header-color-row-one {
+  background-color: #2d3538;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-black-green .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-black-green .header-color-row-one {
+  -webkit-box-shadow: #2d3538 0px -1px 0px;
+  -moz-box-shadow: #2d3538 0px -1px 0px;
+  box-shadow: #2d3538 0px -1px 0px;
+}
+.palette-black-green .header-color-row-two {
+  background-color: #81b453;
+  border-top: 1px solid #9bc377;
+  border-bottom: 1px solid #689440;
+}
+.palette-black-green h1.node-title {
+  color: #81b453;
+}
+.palette-black-green h1.node-title a {
+  color: #81b453;
+}
+.palette-black-green a, .palette-black-green .commons-bw-create-all-widget-types li a {
+  color: #81b453;
+}
+.palette-black-green .select-status:after {
+  border-top-color: #81b453;
+}
+.palette-black-green #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-black-green #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #9bc377 transparent;
+}
+.palette-black-green #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-black-green #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #81b453 transparent;
+}
+.palette-black-green ul.commons-utility-links li.last {
+  border-left-color: #81b453;
+}
+.palette-black-green .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-black-green .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-black-green ul.primary.tabs li a,
+.palette-black-green ul.primary.tabs li a span {
+  color: #81b453;
+}
+.palette-black-green .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-black-green ul.primary.tabs li a:hover {
+  color: #689440;
+}
+.palette-black-green .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-black-green .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-black-green ul.primary.tabs li.active a,
+.palette-black-green ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-black-green .partial-node-form-title {
+  color: #4090ba;
+}
+.palette-black-green .block-search {
+  background-color: #638d3d;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF638D3D', endColorstr='#FF72A247');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #638d3d), color-stop(100%, #72a247));
+  background-image: -webkit-linear-gradient(top, #638d3d 0%, #72a247 100%);
+  background-image: -moz-linear-gradient(top, #638d3d 0%, #72a247 100%);
+  background-image: -o-linear-gradient(top, #638d3d 0%, #72a247 100%);
+  background-image: linear-gradient(top, #638d3d 0%, #72a247 100%);
+}
+.palette-black-green .commons-bw-create-all-widget-types, .palette-black-green li.sharethis .sharethis-wrapper {
+  border-color: #81b453;
+}
+.palette-black-green li.sharethis .sharethis-wrapper:before {
+  border-color: #81b453 transparent transparent transparent;
+}
+.palette-black-green #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-black-green a {
+  border-left: 1px solid #3b4549;
+  -webkit-box-shadow: #0f1213 -1px 0px 0px;
+  -moz-box-shadow: #0f1213 -1px 0px 0px;
+  box-shadow: #0f1213 -1px 0px 0px;
+}
+.palette-black-green #menu-bar.nav {
+  border-right: 1px solid #0f1213;
+  -webkit-box-shadow: #3b4549 1px 0px 0px;
+  -moz-box-shadow: #3b4549 1px 0px 0px;
+  box-shadow: #3b4549 1px 0px 0px;
+}
+.palette-black-green .action-item-primary,
+.palette-black-green .action-item-small-primary,
+.palette-black-green .action-item-large-primary, .palette-black-green .commons-sign-up, .palette-black-green .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-black-green a, .palette-black-green .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-black-green a {
+  background-color: #4090ba;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #519cc3), color-stop(100%, #3981a7));
+  background: -webkit-linear-gradient(#519cc3, #3981a7);
+  background: -moz-linear-gradient(#519cc3, #3981a7);
+  background: -o-linear-gradient(#519cc3, #3981a7);
+  background: linear-gradient(#519cc3, #3981a7);
+  border-color: #26556e;
+  text-shadow: -1px 1px 2px #337394, -1px -1px 2px #337394, 1px -1px 2px #337394, 1px 1px 2px #337394;
+}
+.palette-black-green .action-item-primary,
+.palette-black-green .action-item-small-primary,
+.palette-black-green .action-item-large-primary, .palette-black-green .commons-sign-up, .palette-black-green .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-black-green a, .palette-black-green .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-black-green a, .palette-black-green .action-item-primary:link,
+.palette-black-green .action-item-small-primary:link,
+.palette-black-green .action-item-large-primary:link, .palette-black-green .commons-sign-up:link, .palette-black-green .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-black-green a:link, .palette-black-green .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-black-green a:link, .palette-black-green .action-item-primary:visited,
+.palette-black-green .action-item-small-primary:visited,
+.palette-black-green .action-item-large-primary:visited, .palette-black-green .commons-sign-up:visited, .palette-black-green .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-black-green a:visited, .palette-black-green .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-black-green a:visited {
+  color: white;
+}
+.palette-black-green .action-item-primary:hover,
+.palette-black-green .action-item-small-primary:hover,
+.palette-black-green .action-item-large-primary:hover, .palette-black-green .commons-sign-up:hover, .palette-black-green .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-black-green a:hover, .palette-black-green .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-black-green a:hover {
+  color: white;
+  background-color: #3981a7;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #4090ba), color-stop(100%, #337394));
+  background: -webkit-linear-gradient(#4090ba, #337394);
+  background: -moz-linear-gradient(#4090ba, #337394);
+  background: -o-linear-gradient(#4090ba, #337394);
+  background: linear-gradient(#4090ba, #337394);
+  border-color: #193848;
+  text-shadow: -1px 1px 2px #337394, -1px -1px 2px #337394, 1px -1px 2px #337394, 1px 1px 2px #337394;
+}
+.palette-black-green .action-item-primary:focus,
+.palette-black-green .action-item-small-primary:focus,
+.palette-black-green .action-item-large-primary:focus, .palette-black-green .commons-sign-up:focus, .palette-black-green .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-black-green a:focus, .palette-black-green .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-black-green a:focus, .palette-black-green .action-item-primary:active,
+.palette-black-green .action-item-small-primary:active,
+.palette-black-green .action-item-large-primary:active, .palette-black-green .commons-sign-up:active, .palette-black-green .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-black-green a:active, .palette-black-green .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-black-green a:active {
+  background: #4090ba;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #3981a7), color-stop(100%, #519cc3));
+  background: -webkit-linear-gradient(#3981a7, #519cc3);
+  background: -moz-linear-gradient(#3981a7, #519cc3);
+  background: -o-linear-gradient(#3981a7, #519cc3);
+  background: linear-gradient(#3981a7, #519cc3);
+  border-color: #26556e;
+  text-shadow: -1px 1px 2px #337394, -1px -1px 2px #337394, 1px -1px 2px #337394, 1px 1px 2px #337394;
+}
+.palette-black-green [disabled].action-item-primary,
+.palette-black-green [disabled].action-item-small-primary,
+.palette-black-green [disabled].action-item-large-primary, .palette-black-green [disabled].commons-sign-up, .palette-black-green .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-black-green a[disabled], .palette-black-green .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-black-green a[disabled] {
+  color: #89bcd7;
+  background: #4090ba;
+  border-color: #26556e;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-black-green .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #4090ba url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #519cc3), color-stop(100%, #3981a7));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#519cc3, #3981a7);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#519cc3, #3981a7);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#519cc3, #3981a7);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#519cc3, #3981a7);
+  border-color: #26556e;
+  text-shadow: -1px 1px 2px #337394, -1px -1px 2px #337394, 1px -1px 2px #337394, 1px 1px 2px #337394;
+}
+.palette-black-green .action-item-search[type="submit"], .palette-black-green .action-item-search[type="submit"]:link, .palette-black-green .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-black-green .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #3981a7 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #4090ba), color-stop(100%, #337394));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#4090ba, #337394);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#4090ba, #337394);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#4090ba, #337394);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#4090ba, #337394);
+  border-color: #193848;
+  text-shadow: -1px 1px 2px #337394, -1px -1px 2px #337394, 1px -1px 2px #337394, 1px 1px 2px #337394;
+}
+.palette-black-green .action-item-search[type="submit"]:focus, .palette-black-green .action-item-search[type="submit"]:active {
+  background: #4090ba url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #3981a7), color-stop(100%, #519cc3));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#3981a7, #519cc3);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#3981a7, #519cc3);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#3981a7, #519cc3);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#3981a7, #519cc3);
+  border-color: #26556e;
+  text-shadow: -1px 1px 2px #337394, -1px -1px 2px #337394, 1px -1px 2px #337394, 1px 1px 2px #337394;
+}
+.palette-black-green [disabled].action-item-search[type="submit"] {
+  color: #89bcd7;
+  background: #4090ba;
+  border-color: #26556e;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-black-green .action-item-search[type="submit"], .palette-black-green .action-item-search[type="submit"]:hover, .palette-black-green .action-item-search[type="submit"]:active, .palette-black-green .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-black-green .notification-count {
+  background: #4090ba;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #4090ba), color-stop(100%, #26556e));
+  background: -webkit-linear-gradient(#4090ba, #26556e);
+  background: -moz-linear-gradient(#4090ba, #26556e);
+  background: -o-linear-gradient(#4090ba, #26556e);
+  background: linear-gradient(#4090ba, #26556e);
+  -webkit-box-shadow: 0 0 2px #2d3538;
+  -moz-box-shadow: 0 0 2px #2d3538;
+  box-shadow: 0 0 2px #2d3538;
+}
+
+.palette-brown-yellow h2 {
+  color: #6a513b;
+}
+.palette-brown-yellow .header-color-row-one {
+  background-color: #6a513b;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-brown-yellow .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-brown-yellow .header-color-row-one {
+  -webkit-box-shadow: #6a513b 0px -1px 0px;
+  -moz-box-shadow: #6a513b 0px -1px 0px;
+  box-shadow: #6a513b 0px -1px 0px;
+}
+.palette-brown-yellow .header-color-row-two {
+  background-color: #9c773d;
+  border-top: 1px solid #bb9251;
+  border-bottom: 1px solid #775b2f;
+}
+.palette-brown-yellow h1.node-title {
+  color: #9c773d;
+}
+.palette-brown-yellow h1.node-title a {
+  color: #9c773d;
+}
+.palette-brown-yellow a, .palette-brown-yellow .commons-bw-create-all-widget-types li a {
+  color: #9c773d;
+}
+.palette-brown-yellow .select-status:after {
+  border-top-color: #9c773d;
+}
+.palette-brown-yellow #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-brown-yellow #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #bb9251 transparent;
+}
+.palette-brown-yellow #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-brown-yellow #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #9c773d transparent;
+}
+.palette-brown-yellow ul.commons-utility-links li.last {
+  border-left-color: #9c773d;
+}
+.palette-brown-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-brown-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-brown-yellow ul.primary.tabs li a,
+.palette-brown-yellow ul.primary.tabs li a span {
+  color: #9c773d;
+}
+.palette-brown-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-brown-yellow ul.primary.tabs li a:hover {
+  color: #775b2f;
+}
+.palette-brown-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-brown-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-brown-yellow ul.primary.tabs li.active a,
+.palette-brown-yellow ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-brown-yellow .partial-node-form-title {
+  color: #e3ad40;
+}
+.palette-brown-yellow .block-search {
+  background-color: #70552c;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF70552C', endColorstr='#FF866634');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #70552c), color-stop(100%, #866634));
+  background-image: -webkit-linear-gradient(top, #70552c 0%, #866634 100%);
+  background-image: -moz-linear-gradient(top, #70552c 0%, #866634 100%);
+  background-image: -o-linear-gradient(top, #70552c 0%, #866634 100%);
+  background-image: linear-gradient(top, #70552c 0%, #866634 100%);
+}
+.palette-brown-yellow .commons-bw-create-all-widget-types, .palette-brown-yellow li.sharethis .sharethis-wrapper {
+  border-color: #9c773d;
+}
+.palette-brown-yellow li.sharethis .sharethis-wrapper:before {
+  border-color: #9c773d transparent transparent transparent;
+}
+.palette-brown-yellow #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-brown-yellow a {
+  border-left: 1px solid #7e6046;
+  -webkit-box-shadow: #3f3023 -1px 0px 0px;
+  -moz-box-shadow: #3f3023 -1px 0px 0px;
+  box-shadow: #3f3023 -1px 0px 0px;
+}
+.palette-brown-yellow #menu-bar.nav {
+  border-right: 1px solid #3f3023;
+  -webkit-box-shadow: #7e6046 1px 0px 0px;
+  -moz-box-shadow: #7e6046 1px 0px 0px;
+  box-shadow: #7e6046 1px 0px 0px;
+}
+.palette-brown-yellow .action-item-primary,
+.palette-brown-yellow .action-item-small-primary,
+.palette-brown-yellow .action-item-large-primary, .palette-brown-yellow .commons-sign-up, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a {
+  background-color: #e3ad40;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e6b756), color-stop(100%, #e0a32a));
+  background: -webkit-linear-gradient(#e6b756, #e0a32a);
+  background: -moz-linear-gradient(#e6b756, #e0a32a);
+  background: -o-linear-gradient(#e6b756, #e0a32a);
+  background: linear-gradient(#e6b756, #e0a32a);
+  border-color: #a57618;
+  text-shadow: -1px 1px 2px #d1961f, -1px -1px 2px #d1961f, 1px -1px 2px #d1961f, 1px 1px 2px #d1961f;
+}
+.palette-brown-yellow .action-item-primary,
+.palette-brown-yellow .action-item-small-primary,
+.palette-brown-yellow .action-item-large-primary, .palette-brown-yellow .commons-sign-up, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a, .palette-brown-yellow .action-item-primary:link,
+.palette-brown-yellow .action-item-small-primary:link,
+.palette-brown-yellow .action-item-large-primary:link, .palette-brown-yellow .commons-sign-up:link, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a:link, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a:link, .palette-brown-yellow .action-item-primary:visited,
+.palette-brown-yellow .action-item-small-primary:visited,
+.palette-brown-yellow .action-item-large-primary:visited, .palette-brown-yellow .commons-sign-up:visited, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a:visited, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a:visited {
+  color: white;
+}
+.palette-brown-yellow .action-item-primary:hover,
+.palette-brown-yellow .action-item-small-primary:hover,
+.palette-brown-yellow .action-item-large-primary:hover, .palette-brown-yellow .commons-sign-up:hover, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a:hover, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a:hover {
+  color: white;
+  background-color: #e0a32a;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e3ad40), color-stop(100%, #d1961f));
+  background: -webkit-linear-gradient(#e3ad40, #d1961f);
+  background: -moz-linear-gradient(#e3ad40, #d1961f);
+  background: -o-linear-gradient(#e3ad40, #d1961f);
+  background: linear-gradient(#e3ad40, #d1961f);
+  border-color: #785612;
+  text-shadow: -1px 1px 2px #d1961f, -1px -1px 2px #d1961f, 1px -1px 2px #d1961f, 1px 1px 2px #d1961f;
+}
+.palette-brown-yellow .action-item-primary:focus,
+.palette-brown-yellow .action-item-small-primary:focus,
+.palette-brown-yellow .action-item-large-primary:focus, .palette-brown-yellow .commons-sign-up:focus, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a:focus, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a:focus, .palette-brown-yellow .action-item-primary:active,
+.palette-brown-yellow .action-item-small-primary:active,
+.palette-brown-yellow .action-item-large-primary:active, .palette-brown-yellow .commons-sign-up:active, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a:active, .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a:active {
+  background: #e3ad40;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e0a32a), color-stop(100%, #e6b756));
+  background: -webkit-linear-gradient(#e0a32a, #e6b756);
+  background: -moz-linear-gradient(#e0a32a, #e6b756);
+  background: -o-linear-gradient(#e0a32a, #e6b756);
+  background: linear-gradient(#e0a32a, #e6b756);
+  border-color: #a57618;
+  text-shadow: -1px 1px 2px #d1961f, -1px -1px 2px #d1961f, 1px -1px 2px #d1961f, 1px 1px 2px #d1961f;
+}
+.palette-brown-yellow [disabled].action-item-primary,
+.palette-brown-yellow [disabled].action-item-small-primary,
+.palette-brown-yellow [disabled].action-item-large-primary, .palette-brown-yellow [disabled].commons-sign-up, .palette-brown-yellow .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-brown-yellow a[disabled], .palette-brown-yellow .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-brown-yellow a[disabled] {
+  color: #f0d399;
+  background: #e3ad40;
+  border-color: #a57618;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-brown-yellow .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #e3ad40 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e6b756), color-stop(100%, #e0a32a));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#e6b756, #e0a32a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#e6b756, #e0a32a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#e6b756, #e0a32a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#e6b756, #e0a32a);
+  border-color: #a57618;
+  text-shadow: -1px 1px 2px #d1961f, -1px -1px 2px #d1961f, 1px -1px 2px #d1961f, 1px 1px 2px #d1961f;
+}
+.palette-brown-yellow .action-item-search[type="submit"], .palette-brown-yellow .action-item-search[type="submit"]:link, .palette-brown-yellow .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-brown-yellow .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #e0a32a url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e3ad40), color-stop(100%, #d1961f));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#e3ad40, #d1961f);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#e3ad40, #d1961f);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#e3ad40, #d1961f);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#e3ad40, #d1961f);
+  border-color: #785612;
+  text-shadow: -1px 1px 2px #d1961f, -1px -1px 2px #d1961f, 1px -1px 2px #d1961f, 1px 1px 2px #d1961f;
+}
+.palette-brown-yellow .action-item-search[type="submit"]:focus, .palette-brown-yellow .action-item-search[type="submit"]:active {
+  background: #e3ad40 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e0a32a), color-stop(100%, #e6b756));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#e0a32a, #e6b756);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#e0a32a, #e6b756);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#e0a32a, #e6b756);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#e0a32a, #e6b756);
+  border-color: #a57618;
+  text-shadow: -1px 1px 2px #d1961f, -1px -1px 2px #d1961f, 1px -1px 2px #d1961f, 1px 1px 2px #d1961f;
+}
+.palette-brown-yellow [disabled].action-item-search[type="submit"] {
+  color: #f0d399;
+  background: #e3ad40;
+  border-color: #a57618;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-brown-yellow .action-item-search[type="submit"], .palette-brown-yellow .action-item-search[type="submit"]:hover, .palette-brown-yellow .action-item-search[type="submit"]:active, .palette-brown-yellow .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-brown-yellow .notification-count {
+  background: #fcd036;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #fcd036), color-stop(100%, #c99d03));
+  background: -webkit-linear-gradient(#fcd036, #c99d03);
+  background: -moz-linear-gradient(#fcd036, #c99d03);
+  background: -o-linear-gradient(#fcd036, #c99d03);
+  background: linear-gradient(#fcd036, #c99d03);
+  -webkit-box-shadow: 0 0 2px #6a513b;
+  -moz-box-shadow: 0 0 2px #6a513b;
+  box-shadow: 0 0 2px #6a513b;
+}
+
+.palette-seafoam-orange h2 {
+  color: #668284;
+}
+.palette-seafoam-orange .header-color-row-one {
+  background-color: #668284;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-seafoam-orange .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-seafoam-orange .header-color-row-one {
+  -webkit-box-shadow: #668284 0px -1px 0px;
+  -moz-box-shadow: #668284 0px -1px 0px;
+  box-shadow: #668284 0px -1px 0px;
+}
+.palette-seafoam-orange .header-color-row-two {
+  background-color: #73a5a5;
+  border-top: 1px solid #92b9b9;
+  border-bottom: 1px solid #5a8b8b;
+}
+.palette-seafoam-orange h1.node-title {
+  color: #73a5a5;
+}
+.palette-seafoam-orange h1.node-title a {
+  color: #73a5a5;
+}
+.palette-seafoam-orange a, .palette-seafoam-orange .commons-bw-create-all-widget-types li a {
+  color: #73a5a5;
+}
+.palette-seafoam-orange .select-status:after {
+  border-top-color: #73a5a5;
+}
+.palette-seafoam-orange #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-seafoam-orange #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #92b9b9 transparent;
+}
+.palette-seafoam-orange #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-seafoam-orange #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #73a5a5 transparent;
+}
+.palette-seafoam-orange ul.commons-utility-links li.last {
+  border-left-color: #73a5a5;
+}
+.palette-seafoam-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-seafoam-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-seafoam-orange ul.primary.tabs li a,
+.palette-seafoam-orange ul.primary.tabs li a span {
+  color: #73a5a5;
+}
+.palette-seafoam-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-seafoam-orange ul.primary.tabs li a:hover {
+  color: #5a8b8b;
+}
+.palette-seafoam-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-seafoam-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-seafoam-orange ul.primary.tabs li.active a,
+.palette-seafoam-orange ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-seafoam-orange .partial-node-form-title {
+  color: #b68800;
+}
+.palette-seafoam-orange .block-search {
+  background-color: #568585;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF568585', endColorstr='#FF629898');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #568585), color-stop(100%, #629898));
+  background-image: -webkit-linear-gradient(top, #568585 0%, #629898 100%);
+  background-image: -moz-linear-gradient(top, #568585 0%, #629898 100%);
+  background-image: -o-linear-gradient(top, #568585 0%, #629898 100%);
+  background-image: linear-gradient(top, #568585 0%, #629898 100%);
+}
+.palette-seafoam-orange .commons-bw-create-all-widget-types, .palette-seafoam-orange li.sharethis .sharethis-wrapper {
+  border-color: #73a5a5;
+}
+.palette-seafoam-orange li.sharethis .sharethis-wrapper:before {
+  border-color: #73a5a5 transparent transparent transparent;
+}
+.palette-seafoam-orange #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-seafoam-orange a {
+  border-left: 1px solid #759294;
+  -webkit-box-shadow: #495d5f -1px 0px 0px;
+  -moz-box-shadow: #495d5f -1px 0px 0px;
+  box-shadow: #495d5f -1px 0px 0px;
+}
+.palette-seafoam-orange #menu-bar.nav {
+  border-right: 1px solid #495d5f;
+  -webkit-box-shadow: #759294 1px 0px 0px;
+  -moz-box-shadow: #759294 1px 0px 0px;
+  box-shadow: #759294 1px 0px 0px;
+}
+.palette-seafoam-orange .action-item-primary,
+.palette-seafoam-orange .action-item-small-primary,
+.palette-seafoam-orange .action-item-large-primary, .palette-seafoam-orange .commons-sign-up, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a {
+  background-color: #b68800;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d09b00), color-stop(100%, #9d7500));
+  background: -webkit-linear-gradient(#d09b00, #9d7500);
+  background: -moz-linear-gradient(#d09b00, #9d7500);
+  background: -o-linear-gradient(#d09b00, #9d7500);
+  background: linear-gradient(#d09b00, #9d7500);
+  border-color: #503c00;
+  text-shadow: -1px 1px 2px #836200, -1px -1px 2px #836200, 1px -1px 2px #836200, 1px 1px 2px #836200;
+}
+.palette-seafoam-orange .action-item-primary,
+.palette-seafoam-orange .action-item-small-primary,
+.palette-seafoam-orange .action-item-large-primary, .palette-seafoam-orange .commons-sign-up, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a, .palette-seafoam-orange .action-item-primary:link,
+.palette-seafoam-orange .action-item-small-primary:link,
+.palette-seafoam-orange .action-item-large-primary:link, .palette-seafoam-orange .commons-sign-up:link, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a:link, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a:link, .palette-seafoam-orange .action-item-primary:visited,
+.palette-seafoam-orange .action-item-small-primary:visited,
+.palette-seafoam-orange .action-item-large-primary:visited, .palette-seafoam-orange .commons-sign-up:visited, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a:visited, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a:visited {
+  color: white;
+}
+.palette-seafoam-orange .action-item-primary:hover,
+.palette-seafoam-orange .action-item-small-primary:hover,
+.palette-seafoam-orange .action-item-large-primary:hover, .palette-seafoam-orange .commons-sign-up:hover, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a:hover, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a:hover {
+  color: white;
+  background-color: #9d7500;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b68800), color-stop(100%, #836200));
+  background: -webkit-linear-gradient(#b68800, #836200);
+  background: -moz-linear-gradient(#b68800, #836200);
+  background: -o-linear-gradient(#b68800, #836200);
+  background: linear-gradient(#b68800, #836200);
+  border-color: #1d1600;
+  text-shadow: -1px 1px 2px #836200, -1px -1px 2px #836200, 1px -1px 2px #836200, 1px 1px 2px #836200;
+}
+.palette-seafoam-orange .action-item-primary:focus,
+.palette-seafoam-orange .action-item-small-primary:focus,
+.palette-seafoam-orange .action-item-large-primary:focus, .palette-seafoam-orange .commons-sign-up:focus, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a:focus, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a:focus, .palette-seafoam-orange .action-item-primary:active,
+.palette-seafoam-orange .action-item-small-primary:active,
+.palette-seafoam-orange .action-item-large-primary:active, .palette-seafoam-orange .commons-sign-up:active, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a:active, .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a:active {
+  background: #b68800;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #9d7500), color-stop(100%, #d09b00));
+  background: -webkit-linear-gradient(#9d7500, #d09b00);
+  background: -moz-linear-gradient(#9d7500, #d09b00);
+  background: -o-linear-gradient(#9d7500, #d09b00);
+  background: linear-gradient(#9d7500, #d09b00);
+  border-color: #503c00;
+  text-shadow: -1px 1px 2px #836200, -1px -1px 2px #836200, 1px -1px 2px #836200, 1px 1px 2px #836200;
+}
+.palette-seafoam-orange [disabled].action-item-primary,
+.palette-seafoam-orange [disabled].action-item-small-primary,
+.palette-seafoam-orange [disabled].action-item-large-primary, .palette-seafoam-orange [disabled].commons-sign-up, .palette-seafoam-orange .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-seafoam-orange a[disabled], .palette-seafoam-orange .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-seafoam-orange a[disabled] {
+  color: #ffc61d;
+  background: #b68800;
+  border-color: #503c00;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-seafoam-orange .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #b68800 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d09b00), color-stop(100%, #9d7500));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#d09b00, #9d7500);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#d09b00, #9d7500);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#d09b00, #9d7500);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#d09b00, #9d7500);
+  border-color: #503c00;
+  text-shadow: -1px 1px 2px #836200, -1px -1px 2px #836200, 1px -1px 2px #836200, 1px 1px 2px #836200;
+}
+.palette-seafoam-orange .action-item-search[type="submit"], .palette-seafoam-orange .action-item-search[type="submit"]:link, .palette-seafoam-orange .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-seafoam-orange .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #9d7500 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b68800), color-stop(100%, #836200));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#b68800, #836200);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#b68800, #836200);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#b68800, #836200);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#b68800, #836200);
+  border-color: #1d1600;
+  text-shadow: -1px 1px 2px #836200, -1px -1px 2px #836200, 1px -1px 2px #836200, 1px 1px 2px #836200;
+}
+.palette-seafoam-orange .action-item-search[type="submit"]:focus, .palette-seafoam-orange .action-item-search[type="submit"]:active {
+  background: #b68800 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #9d7500), color-stop(100%, #d09b00));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#9d7500, #d09b00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#9d7500, #d09b00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#9d7500, #d09b00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#9d7500, #d09b00);
+  border-color: #503c00;
+  text-shadow: -1px 1px 2px #836200, -1px -1px 2px #836200, 1px -1px 2px #836200, 1px 1px 2px #836200;
+}
+.palette-seafoam-orange [disabled].action-item-search[type="submit"] {
+  color: #ffc61d;
+  background: #b68800;
+  border-color: #503c00;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-seafoam-orange .action-item-search[type="submit"], .palette-seafoam-orange .action-item-search[type="submit"]:hover, .palette-seafoam-orange .action-item-search[type="submit"]:active, .palette-seafoam-orange .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-seafoam-orange .notification-count {
+  background: #d9a300;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d9a300), color-stop(100%, #735600));
+  background: -webkit-linear-gradient(#d9a300, #735600);
+  background: -moz-linear-gradient(#d9a300, #735600);
+  background: -o-linear-gradient(#d9a300, #735600);
+  background: linear-gradient(#d9a300, #735600);
+  -webkit-box-shadow: 0 0 2px #668284;
+  -moz-box-shadow: 0 0 2px #668284;
+  box-shadow: 0 0 2px #668284;
+}
+
+.palette-black-blue-yellow h2 {
+  color: #353535;
+}
+.palette-black-blue-yellow .header-color-row-one {
+  background-color: #353535;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-black-blue-yellow .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-black-blue-yellow .header-color-row-one {
+  -webkit-box-shadow: #353535 0px -1px 0px;
+  -moz-box-shadow: #353535 0px -1px 0px;
+  box-shadow: #353535 0px -1px 0px;
+}
+.palette-black-blue-yellow .header-color-row-two {
+  background-color: #0072ab;
+  border-top: 1px solid #0094de;
+  border-bottom: 1px solid #005078;
+}
+.palette-black-blue-yellow h1.node-title {
+  color: #0072ab;
+}
+.palette-black-blue-yellow h1.node-title a {
+  color: #0072ab;
+}
+.palette-black-blue-yellow a, .palette-black-blue-yellow .commons-bw-create-all-widget-types li a {
+  color: #0072ab;
+}
+.palette-black-blue-yellow .select-status:after {
+  border-top-color: #0072ab;
+}
+.palette-black-blue-yellow #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-black-blue-yellow #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #0094de transparent;
+}
+.palette-black-blue-yellow #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-black-blue-yellow #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #0072ab transparent;
+}
+.palette-black-blue-yellow ul.commons-utility-links li.last {
+  border-left-color: #0072ab;
+}
+.palette-black-blue-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-black-blue-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-black-blue-yellow ul.primary.tabs li a,
+.palette-black-blue-yellow ul.primary.tabs li a span {
+  color: #0072ab;
+}
+.palette-black-blue-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-black-blue-yellow ul.primary.tabs li a:hover {
+  color: #005078;
+}
+.palette-black-blue-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-black-blue-yellow .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-black-blue-yellow ul.primary.tabs li.active a,
+.palette-black-blue-yellow ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-black-blue-yellow .partial-node-form-title {
+  color: #d0a600;
+}
+.palette-black-blue-yellow .block-search {
+  background-color: #00496e;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF00496E', endColorstr='#FF005E8C');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #00496e), color-stop(100%, #005e8c));
+  background-image: -webkit-linear-gradient(top, #00496e 0%, #005e8c 100%);
+  background-image: -moz-linear-gradient(top, #00496e 0%, #005e8c 100%);
+  background-image: -o-linear-gradient(top, #00496e 0%, #005e8c 100%);
+  background-image: linear-gradient(top, #00496e 0%, #005e8c 100%);
+}
+.palette-black-blue-yellow .commons-bw-create-all-widget-types, .palette-black-blue-yellow li.sharethis .sharethis-wrapper {
+  border-color: #0072ab;
+}
+.palette-black-blue-yellow li.sharethis .sharethis-wrapper:before {
+  border-color: #0072ab transparent transparent transparent;
+}
+.palette-black-blue-yellow #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-black-blue-yellow a {
+  border-left: 1px solid #444444;
+  -webkit-box-shadow: #141414 -1px 0px 0px;
+  -moz-box-shadow: #141414 -1px 0px 0px;
+  box-shadow: #141414 -1px 0px 0px;
+}
+.palette-black-blue-yellow #menu-bar.nav {
+  border-right: 1px solid #141414;
+  -webkit-box-shadow: #444444 1px 0px 0px;
+  -moz-box-shadow: #444444 1px 0px 0px;
+  box-shadow: #444444 1px 0px 0px;
+}
+.palette-black-blue-yellow .action-item-primary,
+.palette-black-blue-yellow .action-item-small-primary,
+.palette-black-blue-yellow .action-item-large-primary, .palette-black-blue-yellow .commons-sign-up, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a {
+  background-color: #d0a600;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #eaba00), color-stop(100%, #b69200));
+  background: -webkit-linear-gradient(#eaba00, #b69200);
+  background: -moz-linear-gradient(#eaba00, #b69200);
+  background: -o-linear-gradient(#eaba00, #b69200);
+  background: linear-gradient(#eaba00, #b69200);
+  border-color: #6a5500;
+  text-shadow: -1px 1px 2px #9d7d00, -1px -1px 2px #9d7d00, 1px -1px 2px #9d7d00, 1px 1px 2px #9d7d00;
+}
+.palette-black-blue-yellow .action-item-primary,
+.palette-black-blue-yellow .action-item-small-primary,
+.palette-black-blue-yellow .action-item-large-primary, .palette-black-blue-yellow .commons-sign-up, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a, .palette-black-blue-yellow .action-item-primary:link,
+.palette-black-blue-yellow .action-item-small-primary:link,
+.palette-black-blue-yellow .action-item-large-primary:link, .palette-black-blue-yellow .commons-sign-up:link, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a:link, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a:link, .palette-black-blue-yellow .action-item-primary:visited,
+.palette-black-blue-yellow .action-item-small-primary:visited,
+.palette-black-blue-yellow .action-item-large-primary:visited, .palette-black-blue-yellow .commons-sign-up:visited, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a:visited, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a:visited {
+  color: white;
+}
+.palette-black-blue-yellow .action-item-primary:hover,
+.palette-black-blue-yellow .action-item-small-primary:hover,
+.palette-black-blue-yellow .action-item-large-primary:hover, .palette-black-blue-yellow .commons-sign-up:hover, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a:hover, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a:hover {
+  color: white;
+  background-color: #b69200;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d0a600), color-stop(100%, #9d7d00));
+  background: -webkit-linear-gradient(#d0a600, #9d7d00);
+  background: -moz-linear-gradient(#d0a600, #9d7d00);
+  background: -o-linear-gradient(#d0a600, #9d7d00);
+  background: linear-gradient(#d0a600, #9d7d00);
+  border-color: #372c00;
+  text-shadow: -1px 1px 2px #9d7d00, -1px -1px 2px #9d7d00, 1px -1px 2px #9d7d00, 1px 1px 2px #9d7d00;
+}
+.palette-black-blue-yellow .action-item-primary:focus,
+.palette-black-blue-yellow .action-item-small-primary:focus,
+.palette-black-blue-yellow .action-item-large-primary:focus, .palette-black-blue-yellow .commons-sign-up:focus, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a:focus, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a:focus, .palette-black-blue-yellow .action-item-primary:active,
+.palette-black-blue-yellow .action-item-small-primary:active,
+.palette-black-blue-yellow .action-item-large-primary:active, .palette-black-blue-yellow .commons-sign-up:active, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a:active, .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a:active {
+  background: #d0a600;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b69200), color-stop(100%, #eaba00));
+  background: -webkit-linear-gradient(#b69200, #eaba00);
+  background: -moz-linear-gradient(#b69200, #eaba00);
+  background: -o-linear-gradient(#b69200, #eaba00);
+  background: linear-gradient(#b69200, #eaba00);
+  border-color: #6a5500;
+  text-shadow: -1px 1px 2px #9d7d00, -1px -1px 2px #9d7d00, 1px -1px 2px #9d7d00, 1px 1px 2px #9d7d00;
+}
+.palette-black-blue-yellow [disabled].action-item-primary,
+.palette-black-blue-yellow [disabled].action-item-small-primary,
+.palette-black-blue-yellow [disabled].action-item-large-primary, .palette-black-blue-yellow [disabled].commons-sign-up, .palette-black-blue-yellow .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-black-blue-yellow a[disabled], .palette-black-blue-yellow .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-black-blue-yellow a[disabled] {
+  color: #ffd737;
+  background: #d0a600;
+  border-color: #6a5500;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-black-blue-yellow .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #d0a600 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #eaba00), color-stop(100%, #b69200));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#eaba00, #b69200);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#eaba00, #b69200);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#eaba00, #b69200);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#eaba00, #b69200);
+  border-color: #6a5500;
+  text-shadow: -1px 1px 2px #9d7d00, -1px -1px 2px #9d7d00, 1px -1px 2px #9d7d00, 1px 1px 2px #9d7d00;
+}
+.palette-black-blue-yellow .action-item-search[type="submit"], .palette-black-blue-yellow .action-item-search[type="submit"]:link, .palette-black-blue-yellow .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-black-blue-yellow .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #b69200 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d0a600), color-stop(100%, #9d7d00));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#d0a600, #9d7d00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#d0a600, #9d7d00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#d0a600, #9d7d00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#d0a600, #9d7d00);
+  border-color: #372c00;
+  text-shadow: -1px 1px 2px #9d7d00, -1px -1px 2px #9d7d00, 1px -1px 2px #9d7d00, 1px 1px 2px #9d7d00;
+}
+.palette-black-blue-yellow .action-item-search[type="submit"]:focus, .palette-black-blue-yellow .action-item-search[type="submit"]:active {
+  background: #d0a600 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b69200), color-stop(100%, #eaba00));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#b69200, #eaba00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#b69200, #eaba00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#b69200, #eaba00);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#b69200, #eaba00);
+  border-color: #6a5500;
+  text-shadow: -1px 1px 2px #9d7d00, -1px -1px 2px #9d7d00, 1px -1px 2px #9d7d00, 1px 1px 2px #9d7d00;
+}
+.palette-black-blue-yellow [disabled].action-item-search[type="submit"] {
+  color: #ffd737;
+  background: #d0a600;
+  border-color: #6a5500;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-black-blue-yellow .action-item-search[type="submit"], .palette-black-blue-yellow .action-item-search[type="submit"]:hover, .palette-black-blue-yellow .action-item-search[type="submit"]:active, .palette-black-blue-yellow .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-black-blue-yellow .notification-count {
+  background: #e5b700;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e5b700), color-stop(100%, #7f6500));
+  background: -webkit-linear-gradient(#e5b700, #7f6500);
+  background: -moz-linear-gradient(#e5b700, #7f6500);
+  background: -o-linear-gradient(#e5b700, #7f6500);
+  background: linear-gradient(#e5b700, #7f6500);
+  -webkit-box-shadow: 0 0 2px #353535;
+  -moz-box-shadow: 0 0 2px #353535;
+  box-shadow: 0 0 2px #353535;
+}
+
+.palette-brick-brick h2 {
+  color: #432a26;
+}
+.palette-brick-brick .header-color-row-one {
+  background-color: #432a26;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-brick-brick .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-brick-brick .header-color-row-one {
+  -webkit-box-shadow: #432a26 0px -1px 0px;
+  -moz-box-shadow: #432a26 0px -1px 0px;
+  box-shadow: #432a26 0px -1px 0px;
+}
+.palette-brick-brick .header-color-row-two {
+  background-color: #723729;
+  border-top: 1px solid #984936;
+  border-bottom: 1px solid #4c251c;
+}
+.palette-brick-brick h1.node-title {
+  color: #723729;
+}
+.palette-brick-brick h1.node-title a {
+  color: #723729;
+}
+.palette-brick-brick a, .palette-brick-brick .commons-bw-create-all-widget-types li a {
+  color: #723729;
+}
+.palette-brick-brick .select-status:after {
+  border-top-color: #723729;
+}
+.palette-brick-brick #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-brick-brick #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #984936 transparent;
+}
+.palette-brick-brick #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-brick-brick #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #723729 transparent;
+}
+.palette-brick-brick ul.commons-utility-links li.last {
+  border-left-color: #723729;
+}
+.palette-brick-brick .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-brick-brick .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-brick-brick ul.primary.tabs li a,
+.palette-brick-brick ul.primary.tabs li a span {
+  color: #723729;
+}
+.palette-brick-brick .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-brick-brick ul.primary.tabs li a:hover {
+  color: #4c251c;
+}
+.palette-brick-brick .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-brick-brick .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-brick-brick ul.primary.tabs li.active a,
+.palette-brick-brick ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-brick-brick .partial-node-form-title {
+  color: #a12e1e;
+}
+.palette-brick-brick .block-search {
+  background-color: #452119;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF452119', endColorstr='#FF5B2C21');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #452119), color-stop(100%, #5b2c21));
+  background-image: -webkit-linear-gradient(top, #452119 0%, #5b2c21 100%);
+  background-image: -moz-linear-gradient(top, #452119 0%, #5b2c21 100%);
+  background-image: -o-linear-gradient(top, #452119 0%, #5b2c21 100%);
+  background-image: linear-gradient(top, #452119 0%, #5b2c21 100%);
+}
+.palette-brick-brick .commons-bw-create-all-widget-types, .palette-brick-brick li.sharethis .sharethis-wrapper {
+  border-color: #723729;
+}
+.palette-brick-brick li.sharethis .sharethis-wrapper:before {
+  border-color: #723729 transparent transparent transparent;
+}
+.palette-brick-brick #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-brick-brick a {
+  border-left: 1px solid #573631;
+  -webkit-box-shadow: #190f0e -1px 0px 0px;
+  -moz-box-shadow: #190f0e -1px 0px 0px;
+  box-shadow: #190f0e -1px 0px 0px;
+}
+.palette-brick-brick #menu-bar.nav {
+  border-right: 1px solid #190f0e;
+  -webkit-box-shadow: #573631 1px 0px 0px;
+  -moz-box-shadow: #573631 1px 0px 0px;
+  box-shadow: #573631 1px 0px 0px;
+}
+.palette-brick-brick .action-item-primary,
+.palette-brick-brick .action-item-small-primary,
+.palette-brick-brick .action-item-large-primary, .palette-brick-brick .commons-sign-up, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a {
+  background-color: #a12e1e;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b63422), color-stop(100%, #8c281a));
+  background: -webkit-linear-gradient(#b63422, #8c281a);
+  background: -moz-linear-gradient(#b63422, #8c281a);
+  background: -o-linear-gradient(#b63422, #8c281a);
+  background: linear-gradient(#b63422, #8c281a);
+  border-color: #4b150e;
+  text-shadow: -1px 1px 2px #762216, -1px -1px 2px #762216, 1px -1px 2px #762216, 1px 1px 2px #762216;
+}
+.palette-brick-brick .action-item-primary,
+.palette-brick-brick .action-item-small-primary,
+.palette-brick-brick .action-item-large-primary, .palette-brick-brick .commons-sign-up, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a, .palette-brick-brick .action-item-primary:link,
+.palette-brick-brick .action-item-small-primary:link,
+.palette-brick-brick .action-item-large-primary:link, .palette-brick-brick .commons-sign-up:link, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a:link, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a:link, .palette-brick-brick .action-item-primary:visited,
+.palette-brick-brick .action-item-small-primary:visited,
+.palette-brick-brick .action-item-large-primary:visited, .palette-brick-brick .commons-sign-up:visited, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a:visited, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a:visited {
+  color: white;
+}
+.palette-brick-brick .action-item-primary:hover,
+.palette-brick-brick .action-item-small-primary:hover,
+.palette-brick-brick .action-item-large-primary:hover, .palette-brick-brick .commons-sign-up:hover, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a:hover, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a:hover {
+  color: white;
+  background-color: #8c281a;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #a12e1e), color-stop(100%, #762216));
+  background: -webkit-linear-gradient(#a12e1e, #762216);
+  background: -moz-linear-gradient(#a12e1e, #762216);
+  background: -o-linear-gradient(#a12e1e, #762216);
+  background: linear-gradient(#a12e1e, #762216);
+  border-color: #200906;
+  text-shadow: -1px 1px 2px #762216, -1px -1px 2px #762216, 1px -1px 2px #762216, 1px 1px 2px #762216;
+}
+.palette-brick-brick .action-item-primary:focus,
+.palette-brick-brick .action-item-small-primary:focus,
+.palette-brick-brick .action-item-large-primary:focus, .palette-brick-brick .commons-sign-up:focus, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a:focus, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a:focus, .palette-brick-brick .action-item-primary:active,
+.palette-brick-brick .action-item-small-primary:active,
+.palette-brick-brick .action-item-large-primary:active, .palette-brick-brick .commons-sign-up:active, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-brick-brick a:active, .palette-brick-brick .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-brick-brick a:active {
+  background: #a12e1e;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #8c281a), color-stop(100%, #b63422));
+  background: -webkit-linear-gradient(#8c281a, #b63422);
+  background: -moz-linear-gradient(#8c281a, #b63422);
+  background: -o-linear-gradient(#8c281a, #b63422);
+  background: linear-gradient(#8c281a, #b63422);
+  border-color: #4b150e;
+  text-shadow: -1px 1px 2px #762216, -1px -1px 2px #762216, 1px -1px 2px #762216, 1px 1px 2px #762216;
+}
+.palette-brick-brick [disabled].action-item-primary,
+.palette-brick-brick [disabled].action-item-small-primary,
+.palette-brick-brick [disabled].action-item-large-primary, .palette-brick-brick [disabled].commons-sign-up, .palette-brick-brick .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-brick-brick a[disabled], .palette-brick-brick .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-brick-brick a[disabled] {
+  color: #dd5a48;
+  background: #a12e1e;
+  border-color: #4b150e;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-brick-brick .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #a12e1e url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b63422), color-stop(100%, #8c281a));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#b63422, #8c281a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#b63422, #8c281a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#b63422, #8c281a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#b63422, #8c281a);
+  border-color: #4b150e;
+  text-shadow: -1px 1px 2px #762216, -1px -1px 2px #762216, 1px -1px 2px #762216, 1px 1px 2px #762216;
+}
+.palette-brick-brick .action-item-search[type="submit"], .palette-brick-brick .action-item-search[type="submit"]:link, .palette-brick-brick .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-brick-brick .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #8c281a url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #a12e1e), color-stop(100%, #762216));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#a12e1e, #762216);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#a12e1e, #762216);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#a12e1e, #762216);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#a12e1e, #762216);
+  border-color: #200906;
+  text-shadow: -1px 1px 2px #762216, -1px -1px 2px #762216, 1px -1px 2px #762216, 1px 1px 2px #762216;
+}
+.palette-brick-brick .action-item-search[type="submit"]:focus, .palette-brick-brick .action-item-search[type="submit"]:active {
+  background: #a12e1e url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #8c281a), color-stop(100%, #b63422));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#8c281a, #b63422);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#8c281a, #b63422);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#8c281a, #b63422);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#8c281a, #b63422);
+  border-color: #4b150e;
+  text-shadow: -1px 1px 2px #762216, -1px -1px 2px #762216, 1px -1px 2px #762216, 1px 1px 2px #762216;
+}
+.palette-brick-brick [disabled].action-item-search[type="submit"] {
+  color: #dd5a48;
+  background: #a12e1e;
+  border-color: #4b150e;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-brick-brick .action-item-search[type="submit"], .palette-brick-brick .action-item-search[type="submit"]:hover, .palette-brick-brick .action-item-search[type="submit"]:active, .palette-brick-brick .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-brick-brick .notification-count {
+  background: #c2594c;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #c2594c), color-stop(100%, #7d342b));
+  background: -webkit-linear-gradient(#c2594c, #7d342b);
+  background: -moz-linear-gradient(#c2594c, #7d342b);
+  background: -o-linear-gradient(#c2594c, #7d342b);
+  background: linear-gradient(#c2594c, #7d342b);
+  -webkit-box-shadow: 0 0 2px #432a26;
+  -moz-box-shadow: 0 0 2px #432a26;
+  box-shadow: 0 0 2px #432a26;
+}
+
+.palette-gray-lightgray-blue h2 {
+  color: #868686;
+}
+.palette-gray-lightgray-blue .header-color-row-one {
+  background-color: #868686;
+  border-top: 1.5em solid #070707;
+}
+@media only screen and (min-width: 769px) {
+  .palette-gray-lightgray-blue .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-gray-lightgray-blue .header-color-row-one {
+  -webkit-box-shadow: #868686 0px -1px 0px;
+  -moz-box-shadow: #868686 0px -1px 0px;
+  box-shadow: #868686 0px -1px 0px;
+}
+.palette-gray-lightgray-blue .header-color-row-two {
+  background-color: #dbdbdb;
+  border-top: 1px solid #f4f4f4;
+  border-bottom: 1px solid #c2c2c2;
+}
+.palette-gray-lightgray-blue h1.node-title {
+  color: #dbdbdb;
+}
+.palette-gray-lightgray-blue h1.node-title a {
+  color: #dbdbdb;
+}
+.palette-gray-lightgray-blue a, .palette-gray-lightgray-blue .commons-bw-create-all-widget-types li a {
+  color: #dbdbdb;
+}
+.palette-gray-lightgray-blue .select-status:after {
+  border-top-color: #dbdbdb;
+}
+.palette-gray-lightgray-blue #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-gray-lightgray-blue #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #f4f4f4 transparent;
+}
+.palette-gray-lightgray-blue #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-gray-lightgray-blue #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #dbdbdb transparent;
+}
+.palette-gray-lightgray-blue ul.commons-utility-links li.last {
+  border-left-color: #dbdbdb;
+}
+.palette-gray-lightgray-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-gray-lightgray-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-gray-lightgray-blue ul.primary.tabs li a,
+.palette-gray-lightgray-blue ul.primary.tabs li a span {
+  color: #dbdbdb;
+}
+.palette-gray-lightgray-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-gray-lightgray-blue ul.primary.tabs li a:hover {
+  color: #c2c2c2;
+}
+.palette-gray-lightgray-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-gray-lightgray-blue .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-gray-lightgray-blue ul.primary.tabs li.active a,
+.palette-gray-lightgray-blue ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-gray-lightgray-blue .partial-node-form-title {
+  color: #04b6e7;
+}
+.palette-gray-lightgray-blue .block-search {
+  background-color: #bcbcbc;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FFBCBCBC', endColorstr='#FFCCCCCC');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #bcbcbc), color-stop(100%, #cccccc));
+  background-image: -webkit-linear-gradient(top, #bcbcbc 0%, #cccccc 100%);
+  background-image: -moz-linear-gradient(top, #bcbcbc 0%, #cccccc 100%);
+  background-image: -o-linear-gradient(top, #bcbcbc 0%, #cccccc 100%);
+  background-image: linear-gradient(top, #bcbcbc 0%, #cccccc 100%);
+}
+.palette-gray-lightgray-blue .commons-bw-create-all-widget-types, .palette-gray-lightgray-blue li.sharethis .sharethis-wrapper {
+  border-color: #dbdbdb;
+}
+.palette-gray-lightgray-blue li.sharethis .sharethis-wrapper:before {
+  border-color: #dbdbdb transparent transparent transparent;
+}
+.palette-gray-lightgray-blue #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-gray-lightgray-blue a {
+  border-left: 1px solid #959595;
+  -webkit-box-shadow: #656565 -1px 0px 0px;
+  -moz-box-shadow: #656565 -1px 0px 0px;
+  box-shadow: #656565 -1px 0px 0px;
+}
+.palette-gray-lightgray-blue #menu-bar.nav {
+  border-right: 1px solid #656565;
+  -webkit-box-shadow: #959595 1px 0px 0px;
+  -moz-box-shadow: #959595 1px 0px 0px;
+  box-shadow: #959595 1px 0px 0px;
+}
+.palette-gray-lightgray-blue .action-item-primary,
+.palette-gray-lightgray-blue .action-item-small-primary,
+.palette-gray-lightgray-blue .action-item-large-primary, .palette-gray-lightgray-blue .commons-sign-up, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a {
+  background-color: #04b6e7;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0ac7fb), color-stop(100%, #04a2ce));
+  background: -webkit-linear-gradient(#0ac7fb, #04a2ce);
+  background: -moz-linear-gradient(#0ac7fb, #04a2ce);
+  background: -o-linear-gradient(#0ac7fb, #04a2ce);
+  background: linear-gradient(#0ac7fb, #04a2ce);
+  border-color: #026783;
+  text-shadow: -1px 1px 2px #038fb5, -1px -1px 2px #038fb5, 1px -1px 2px #038fb5, 1px 1px 2px #038fb5;
+}
+.palette-gray-lightgray-blue .action-item-primary,
+.palette-gray-lightgray-blue .action-item-small-primary,
+.palette-gray-lightgray-blue .action-item-large-primary, .palette-gray-lightgray-blue .commons-sign-up, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a, .palette-gray-lightgray-blue .action-item-primary:link,
+.palette-gray-lightgray-blue .action-item-small-primary:link,
+.palette-gray-lightgray-blue .action-item-large-primary:link, .palette-gray-lightgray-blue .commons-sign-up:link, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a:link, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a:link, .palette-gray-lightgray-blue .action-item-primary:visited,
+.palette-gray-lightgray-blue .action-item-small-primary:visited,
+.palette-gray-lightgray-blue .action-item-large-primary:visited, .palette-gray-lightgray-blue .commons-sign-up:visited, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a:visited, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a:visited {
+  color: white;
+}
+.palette-gray-lightgray-blue .action-item-primary:hover,
+.palette-gray-lightgray-blue .action-item-small-primary:hover,
+.palette-gray-lightgray-blue .action-item-large-primary:hover, .palette-gray-lightgray-blue .commons-sign-up:hover, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a:hover, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a:hover {
+  color: white;
+  background-color: #04a2ce;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #04b6e7), color-stop(100%, #038fb5));
+  background: -webkit-linear-gradient(#04b6e7, #038fb5);
+  background: -moz-linear-gradient(#04b6e7, #038fb5);
+  background: -o-linear-gradient(#04b6e7, #038fb5);
+  background: linear-gradient(#04b6e7, #038fb5);
+  border-color: #014051;
+  text-shadow: -1px 1px 2px #038fb5, -1px -1px 2px #038fb5, 1px -1px 2px #038fb5, 1px 1px 2px #038fb5;
+}
+.palette-gray-lightgray-blue .action-item-primary:focus,
+.palette-gray-lightgray-blue .action-item-small-primary:focus,
+.palette-gray-lightgray-blue .action-item-large-primary:focus, .palette-gray-lightgray-blue .commons-sign-up:focus, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a:focus, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a:focus, .palette-gray-lightgray-blue .action-item-primary:active,
+.palette-gray-lightgray-blue .action-item-small-primary:active,
+.palette-gray-lightgray-blue .action-item-large-primary:active, .palette-gray-lightgray-blue .commons-sign-up:active, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a:active, .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a:active {
+  background: #04b6e7;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #04a2ce), color-stop(100%, #0ac7fb));
+  background: -webkit-linear-gradient(#04a2ce, #0ac7fb);
+  background: -moz-linear-gradient(#04a2ce, #0ac7fb);
+  background: -o-linear-gradient(#04a2ce, #0ac7fb);
+  background: linear-gradient(#04a2ce, #0ac7fb);
+  border-color: #026783;
+  text-shadow: -1px 1px 2px #038fb5, -1px -1px 2px #038fb5, 1px -1px 2px #038fb5, 1px 1px 2px #038fb5;
+}
+.palette-gray-lightgray-blue [disabled].action-item-primary,
+.palette-gray-lightgray-blue [disabled].action-item-small-primary,
+.palette-gray-lightgray-blue [disabled].action-item-large-primary, .palette-gray-lightgray-blue [disabled].commons-sign-up, .palette-gray-lightgray-blue .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-gray-lightgray-blue a[disabled], .palette-gray-lightgray-blue .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-gray-lightgray-blue a[disabled] {
+  color: #55d8fc;
+  background: #04b6e7;
+  border-color: #026783;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-gray-lightgray-blue .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #04b6e7 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0ac7fb), color-stop(100%, #04a2ce));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#0ac7fb, #04a2ce);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#0ac7fb, #04a2ce);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#0ac7fb, #04a2ce);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#0ac7fb, #04a2ce);
+  border-color: #026783;
+  text-shadow: -1px 1px 2px #038fb5, -1px -1px 2px #038fb5, 1px -1px 2px #038fb5, 1px 1px 2px #038fb5;
+}
+.palette-gray-lightgray-blue .action-item-search[type="submit"], .palette-gray-lightgray-blue .action-item-search[type="submit"]:link, .palette-gray-lightgray-blue .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-gray-lightgray-blue .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #04a2ce url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #04b6e7), color-stop(100%, #038fb5));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#04b6e7, #038fb5);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#04b6e7, #038fb5);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#04b6e7, #038fb5);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#04b6e7, #038fb5);
+  border-color: #014051;
+  text-shadow: -1px 1px 2px #038fb5, -1px -1px 2px #038fb5, 1px -1px 2px #038fb5, 1px 1px 2px #038fb5;
+}
+.palette-gray-lightgray-blue .action-item-search[type="submit"]:focus, .palette-gray-lightgray-blue .action-item-search[type="submit"]:active {
+  background: #04b6e7 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #04a2ce), color-stop(100%, #0ac7fb));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#04a2ce, #0ac7fb);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#04a2ce, #0ac7fb);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#04a2ce, #0ac7fb);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#04a2ce, #0ac7fb);
+  border-color: #026783;
+  text-shadow: -1px 1px 2px #038fb5, -1px -1px 2px #038fb5, 1px -1px 2px #038fb5, 1px 1px 2px #038fb5;
+}
+.palette-gray-lightgray-blue [disabled].action-item-search[type="submit"] {
+  color: #55d8fc;
+  background: #04b6e7;
+  border-color: #026783;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-gray-lightgray-blue .action-item-search[type="submit"], .palette-gray-lightgray-blue .action-item-search[type="submit"]:hover, .palette-gray-lightgray-blue .action-item-search[type="submit"]:active, .palette-gray-lightgray-blue .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-gray-lightgray-blue .notification-count {
+  background: #00ccff;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #00ccff), color-stop(100%, #007a99));
+  background: -webkit-linear-gradient(#00ccff, #007a99);
+  background: -moz-linear-gradient(#00ccff, #007a99);
+  background: -o-linear-gradient(#00ccff, #007a99);
+  background: linear-gradient(#00ccff, #007a99);
+  -webkit-box-shadow: 0 0 2px #868686;
+  -moz-box-shadow: 0 0 2px #868686;
+  box-shadow: 0 0 2px #868686;
+}
+
+.palette-black-white-red h2 {
+  color: #262626;
+}
+.palette-black-white-red .header-color-row-one {
+  background-color: #262626;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-black-white-red .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-black-white-red .header-color-row-one {
+  -webkit-box-shadow: #262626 0px -1px 0px;
+  -moz-box-shadow: #262626 0px -1px 0px;
+  box-shadow: #262626 0px -1px 0px;
+}
+.palette-black-white-red .header-color-row-two {
+  background-color: #383838;
+  border-top: 1px solid #525252;
+  border-bottom: 1px solid #1f1f1f;
+}
+.palette-black-white-red h1.node-title {
+  color: #383838;
+}
+.palette-black-white-red h1.node-title a {
+  color: #383838;
+}
+.palette-black-white-red a, .palette-black-white-red .commons-bw-create-all-widget-types li a {
+  color: #383838;
+}
+.palette-black-white-red .select-status:after {
+  border-top-color: #383838;
+}
+.palette-black-white-red #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-black-white-red #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #525252 transparent;
+}
+.palette-black-white-red #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-black-white-red #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #383838 transparent;
+}
+.palette-black-white-red ul.commons-utility-links li.last {
+  border-left-color: #383838;
+}
+.palette-black-white-red .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-black-white-red .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-black-white-red ul.primary.tabs li a,
+.palette-black-white-red ul.primary.tabs li a span {
+  color: #383838;
+}
+.palette-black-white-red .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-black-white-red ul.primary.tabs li a:hover {
+  color: #1f1f1f;
+}
+.palette-black-white-red .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-black-white-red .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-black-white-red ul.primary.tabs li.active a,
+.palette-black-white-red ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-black-white-red .partial-node-form-title {
+  color: #cc0000;
+}
+.palette-black-white-red .block-search {
+  background-color: #191919;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF191919', endColorstr='#FF292929');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #191919), color-stop(100%, #292929));
+  background-image: -webkit-linear-gradient(top, #191919 0%, #292929 100%);
+  background-image: -moz-linear-gradient(top, #191919 0%, #292929 100%);
+  background-image: -o-linear-gradient(top, #191919 0%, #292929 100%);
+  background-image: linear-gradient(top, #191919 0%, #292929 100%);
+}
+.palette-black-white-red .commons-bw-create-all-widget-types, .palette-black-white-red li.sharethis .sharethis-wrapper {
+  border-color: #383838;
+}
+.palette-black-white-red li.sharethis .sharethis-wrapper:before {
+  border-color: #383838 transparent transparent transparent;
+}
+.palette-black-white-red #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-black-white-red a {
+  border-left: 1px solid #353535;
+  -webkit-box-shadow: #050505 -1px 0px 0px;
+  -moz-box-shadow: #050505 -1px 0px 0px;
+  box-shadow: #050505 -1px 0px 0px;
+}
+.palette-black-white-red #menu-bar.nav {
+  border-right: 1px solid #050505;
+  -webkit-box-shadow: #353535 1px 0px 0px;
+  -moz-box-shadow: #353535 1px 0px 0px;
+  box-shadow: #353535 1px 0px 0px;
+}
+.palette-black-white-red .action-item-primary,
+.palette-black-white-red .action-item-small-primary,
+.palette-black-white-red .action-item-large-primary, .palette-black-white-red .commons-sign-up, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a {
+  background-color: #cc0000;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e60000), color-stop(100%, #b30000));
+  background: -webkit-linear-gradient(#e60000, #b30000);
+  background: -moz-linear-gradient(#e60000, #b30000);
+  background: -o-linear-gradient(#e60000, #b30000);
+  background: linear-gradient(#e60000, #b30000);
+  border-color: #660000;
+  text-shadow: -1px 1px 2px #990000, -1px -1px 2px #990000, 1px -1px 2px #990000, 1px 1px 2px #990000;
+}
+.palette-black-white-red .action-item-primary,
+.palette-black-white-red .action-item-small-primary,
+.palette-black-white-red .action-item-large-primary, .palette-black-white-red .commons-sign-up, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a, .palette-black-white-red .action-item-primary:link,
+.palette-black-white-red .action-item-small-primary:link,
+.palette-black-white-red .action-item-large-primary:link, .palette-black-white-red .commons-sign-up:link, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a:link, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a:link, .palette-black-white-red .action-item-primary:visited,
+.palette-black-white-red .action-item-small-primary:visited,
+.palette-black-white-red .action-item-large-primary:visited, .palette-black-white-red .commons-sign-up:visited, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a:visited, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a:visited {
+  color: white;
+}
+.palette-black-white-red .action-item-primary:hover,
+.palette-black-white-red .action-item-small-primary:hover,
+.palette-black-white-red .action-item-large-primary:hover, .palette-black-white-red .commons-sign-up:hover, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a:hover, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a:hover {
+  color: white;
+  background-color: #b30000;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #cc0000), color-stop(100%, #990000));
+  background: -webkit-linear-gradient(#cc0000, #990000);
+  background: -moz-linear-gradient(#cc0000, #990000);
+  background: -o-linear-gradient(#cc0000, #990000);
+  background: linear-gradient(#cc0000, #990000);
+  border-color: #330000;
+  text-shadow: -1px 1px 2px #990000, -1px -1px 2px #990000, 1px -1px 2px #990000, 1px 1px 2px #990000;
+}
+.palette-black-white-red .action-item-primary:focus,
+.palette-black-white-red .action-item-small-primary:focus,
+.palette-black-white-red .action-item-large-primary:focus, .palette-black-white-red .commons-sign-up:focus, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a:focus, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a:focus, .palette-black-white-red .action-item-primary:active,
+.palette-black-white-red .action-item-small-primary:active,
+.palette-black-white-red .action-item-large-primary:active, .palette-black-white-red .commons-sign-up:active, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-black-white-red a:active, .palette-black-white-red .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-black-white-red a:active {
+  background: #cc0000;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b30000), color-stop(100%, #e60000));
+  background: -webkit-linear-gradient(#b30000, #e60000);
+  background: -moz-linear-gradient(#b30000, #e60000);
+  background: -o-linear-gradient(#b30000, #e60000);
+  background: linear-gradient(#b30000, #e60000);
+  border-color: #660000;
+  text-shadow: -1px 1px 2px #990000, -1px -1px 2px #990000, 1px -1px 2px #990000, 1px 1px 2px #990000;
+}
+.palette-black-white-red [disabled].action-item-primary,
+.palette-black-white-red [disabled].action-item-small-primary,
+.palette-black-white-red [disabled].action-item-large-primary, .palette-black-white-red [disabled].commons-sign-up, .palette-black-white-red .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-black-white-red a[disabled], .palette-black-white-red .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-black-white-red a[disabled] {
+  color: #ff3333;
+  background: #cc0000;
+  border-color: #660000;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-black-white-red .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #cc0000 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e60000), color-stop(100%, #b30000));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#e60000, #b30000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#e60000, #b30000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#e60000, #b30000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#e60000, #b30000);
+  border-color: #660000;
+  text-shadow: -1px 1px 2px #990000, -1px -1px 2px #990000, 1px -1px 2px #990000, 1px 1px 2px #990000;
+}
+.palette-black-white-red .action-item-search[type="submit"], .palette-black-white-red .action-item-search[type="submit"]:link, .palette-black-white-red .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-black-white-red .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #b30000 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #cc0000), color-stop(100%, #990000));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#cc0000, #990000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#cc0000, #990000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#cc0000, #990000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#cc0000, #990000);
+  border-color: #330000;
+  text-shadow: -1px 1px 2px #990000, -1px -1px 2px #990000, 1px -1px 2px #990000, 1px 1px 2px #990000;
+}
+.palette-black-white-red .action-item-search[type="submit"]:focus, .palette-black-white-red .action-item-search[type="submit"]:active {
+  background: #cc0000 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #b30000), color-stop(100%, #e60000));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#b30000, #e60000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#b30000, #e60000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#b30000, #e60000);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#b30000, #e60000);
+  border-color: #660000;
+  text-shadow: -1px 1px 2px #990000, -1px -1px 2px #990000, 1px -1px 2px #990000, 1px 1px 2px #990000;
+}
+.palette-black-white-red [disabled].action-item-search[type="submit"] {
+  color: #ff3333;
+  background: #cc0000;
+  border-color: #660000;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-black-white-red .action-item-search[type="submit"], .palette-black-white-red .action-item-search[type="submit"]:hover, .palette-black-white-red .action-item-search[type="submit"]:active, .palette-black-white-red .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-black-white-red .notification-count {
+  background: #e45553;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e45553), color-stop(100%, #b51e1c));
+  background: -webkit-linear-gradient(#e45553, #b51e1c);
+  background: -moz-linear-gradient(#e45553, #b51e1c);
+  background: -o-linear-gradient(#e45553, #b51e1c);
+  background: linear-gradient(#e45553, #b51e1c);
+  -webkit-box-shadow: 0 0 2px #262626;
+  -moz-box-shadow: 0 0 2px #262626;
+  box-shadow: 0 0 2px #262626;
+}
+
+.palette-brown-burnt-orange h2 {
+  color: #62390e;
+}
+.palette-brown-burnt-orange .header-color-row-one {
+  background-color: #62390e;
+  border-top: 1.5em solid black;
+}
+@media only screen and (min-width: 769px) {
+  .palette-brown-burnt-orange .header-color-row-one {
+    border-top: none;
+  }
+}
+.boxshadow .palette-brown-burnt-orange .header-color-row-one {
+  -webkit-box-shadow: #62390e 0px -1px 0px;
+  -moz-box-shadow: #62390e 0px -1px 0px;
+  box-shadow: #62390e 0px -1px 0px;
+}
+.palette-brown-burnt-orange .header-color-row-two {
+  background-color: #7c4811;
+  border-top: 1px solid #a96217;
+  border-bottom: 1px solid #4f2e0b;
+}
+.palette-brown-burnt-orange h1.node-title {
+  color: #7c4811;
+}
+.palette-brown-burnt-orange h1.node-title a {
+  color: #7c4811;
+}
+.palette-brown-burnt-orange a, .palette-brown-burnt-orange .commons-bw-create-all-widget-types li a {
+  color: #7c4811;
+}
+.palette-brown-burnt-orange .select-status:after {
+  border-top-color: #7c4811;
+}
+.palette-brown-burnt-orange #menu-bar.nav ul.menu li:hover .arrow:before,
+.palette-brown-burnt-orange #menu-bar.nav ul.menu li.active-trail .arrow:before {
+  border-color: transparent transparent #a96217 transparent;
+}
+.palette-brown-burnt-orange #menu-bar.nav ul.menu li:hover .arrow:after,
+.palette-brown-burnt-orange #menu-bar.nav ul.menu li.active-trail .arrow:after {
+  border-color: transparent transparent #7c4811 transparent;
+}
+.palette-brown-burnt-orange ul.commons-utility-links li.last {
+  border-left-color: #7c4811;
+}
+.palette-brown-burnt-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li a,
+.palette-brown-burnt-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li a span,
+.palette-brown-burnt-orange ul.primary.tabs li a,
+.palette-brown-burnt-orange ul.primary.tabs li a span {
+  color: #7c4811;
+}
+.palette-brown-burnt-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li a:hover,
+.palette-brown-burnt-orange ul.primary.tabs li a:hover {
+  color: #4f2e0b;
+}
+.palette-brown-burnt-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a,
+.palette-brown-burnt-orange .quicktabs-style-commons-pills ul.quicktabs-tabs li.active a span,
+.palette-brown-burnt-orange ul.primary.tabs li.active a,
+.palette-brown-burnt-orange ul.primary.tabs li.active a span {
+  color: #333333;
+}
+.palette-brown-burnt-orange .partial-node-form-title {
+  color: #e18728;
+}
+.palette-brown-burnt-orange .block-search {
+  background-color: #46290a;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF46290A', endColorstr='#FF61380D');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #46290a), color-stop(100%, #61380d));
+  background-image: -webkit-linear-gradient(top, #46290a 0%, #61380d 100%);
+  background-image: -moz-linear-gradient(top, #46290a 0%, #61380d 100%);
+  background-image: -o-linear-gradient(top, #46290a 0%, #61380d 100%);
+  background-image: linear-gradient(top, #46290a 0%, #61380d 100%);
+}
+.palette-brown-burnt-orange .commons-bw-create-all-widget-types, .palette-brown-burnt-orange li.sharethis .sharethis-wrapper {
+  border-color: #7c4811;
+}
+.palette-brown-burnt-orange li.sharethis .sharethis-wrapper:before {
+  border-color: #7c4811 transparent transparent transparent;
+}
+.palette-brown-burnt-orange #menu-bar.nav ul.menu li a, #menu-bar.nav ul.menu li .palette-brown-burnt-orange a {
+  border-left: 1px solid #7d4912;
+  -webkit-box-shadow: #281706 -1px 0px 0px;
+  -moz-box-shadow: #281706 -1px 0px 0px;
+  box-shadow: #281706 -1px 0px 0px;
+}
+.palette-brown-burnt-orange #menu-bar.nav {
+  border-right: 1px solid #281706;
+  -webkit-box-shadow: #7d4912 1px 0px 0px;
+  -moz-box-shadow: #7d4912 1px 0px 0px;
+  box-shadow: #7d4912 1px 0px 0px;
+}
+.palette-brown-burnt-orange .action-item-primary,
+.palette-brown-burnt-orange .action-item-small-primary,
+.palette-brown-burnt-orange .action-item-large-primary, .palette-brown-burnt-orange .commons-sign-up, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a {
+  background-color: #e18728;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e4933e), color-stop(100%, #d27a1d));
+  background: -webkit-linear-gradient(#e4933e, #d27a1d);
+  background: -moz-linear-gradient(#e4933e, #d27a1d);
+  background: -o-linear-gradient(#e4933e, #d27a1d);
+  background: linear-gradient(#e4933e, #d27a1d);
+  border-color: #8f5314;
+  text-shadow: -1px 1px 2px #bc6d1a, -1px -1px 2px #bc6d1a, 1px -1px 2px #bc6d1a, 1px 1px 2px #bc6d1a;
+}
+.palette-brown-burnt-orange .action-item-primary,
+.palette-brown-burnt-orange .action-item-small-primary,
+.palette-brown-burnt-orange .action-item-large-primary, .palette-brown-burnt-orange .commons-sign-up, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a, .palette-brown-burnt-orange .action-item-primary:link,
+.palette-brown-burnt-orange .action-item-small-primary:link,
+.palette-brown-burnt-orange .action-item-large-primary:link, .palette-brown-burnt-orange .commons-sign-up:link, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a:link, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a:link, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a:link, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a:link, .palette-brown-burnt-orange .action-item-primary:visited,
+.palette-brown-burnt-orange .action-item-small-primary:visited,
+.palette-brown-burnt-orange .action-item-large-primary:visited, .palette-brown-burnt-orange .commons-sign-up:visited, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a:visited, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a:visited, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a:visited, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a:visited {
+  color: white;
+}
+.palette-brown-burnt-orange .action-item-primary:hover,
+.palette-brown-burnt-orange .action-item-small-primary:hover,
+.palette-brown-burnt-orange .action-item-large-primary:hover, .palette-brown-burnt-orange .commons-sign-up:hover, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a:hover, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a:hover, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a:hover, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a:hover {
+  color: white;
+  background-color: #d27a1d;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e18728), color-stop(100%, #bc6d1a));
+  background: -webkit-linear-gradient(#e18728, #bc6d1a);
+  background: -moz-linear-gradient(#e18728, #bc6d1a);
+  background: -o-linear-gradient(#e18728, #bc6d1a);
+  background: linear-gradient(#e18728, #bc6d1a);
+  border-color: #62390e;
+  text-shadow: -1px 1px 2px #bc6d1a, -1px -1px 2px #bc6d1a, 1px -1px 2px #bc6d1a, 1px 1px 2px #bc6d1a;
+}
+.palette-brown-burnt-orange .action-item-primary:focus,
+.palette-brown-burnt-orange .action-item-small-primary:focus,
+.palette-brown-burnt-orange .action-item-large-primary:focus, .palette-brown-burnt-orange .commons-sign-up:focus, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a:focus, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a:focus, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a:focus, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a:focus, .palette-brown-burnt-orange .action-item-primary:active,
+.palette-brown-burnt-orange .action-item-small-primary:active,
+.palette-brown-burnt-orange .action-item-large-primary:active, .palette-brown-burnt-orange .commons-sign-up:active, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a:active, .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a:active, .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a:active, .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a:active {
+  background: #e18728;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d27a1d), color-stop(100%, #e4933e));
+  background: -webkit-linear-gradient(#d27a1d, #e4933e);
+  background: -moz-linear-gradient(#d27a1d, #e4933e);
+  background: -o-linear-gradient(#d27a1d, #e4933e);
+  background: linear-gradient(#d27a1d, #e4933e);
+  border-color: #8f5314;
+  text-shadow: -1px 1px 2px #bc6d1a, -1px -1px 2px #bc6d1a, 1px -1px 2px #bc6d1a, 1px 1px 2px #bc6d1a;
+}
+.palette-brown-burnt-orange [disabled].action-item-primary,
+.palette-brown-burnt-orange [disabled].action-item-small-primary,
+.palette-brown-burnt-orange [disabled].action-item-large-primary, .palette-brown-burnt-orange [disabled].commons-sign-up, .palette-brown-burnt-orange .pane-commons-groups-commons-groups-create-group a[disabled], .pane-commons-groups-commons-groups-create-group .palette-brown-burnt-orange a[disabled], .palette-brown-burnt-orange .pane-commons-events-commons-events-create-event-link a[disabled], .pane-commons-events-commons-events-create-event-link .palette-brown-burnt-orange a[disabled] {
+  color: #edb982;
+  background: #e18728;
+  border-color: #8f5314;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-brown-burnt-orange .action-item-search[type="submit"] {
+  min-width: 15px;
+  background: #e18728 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e4933e), color-stop(100%, #d27a1d));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#e4933e, #d27a1d);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#e4933e, #d27a1d);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#e4933e, #d27a1d);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#e4933e, #d27a1d);
+  border-color: #8f5314;
+  text-shadow: -1px 1px 2px #bc6d1a, -1px -1px 2px #bc6d1a, 1px -1px 2px #bc6d1a, 1px 1px 2px #bc6d1a;
+}
+.palette-brown-burnt-orange .action-item-search[type="submit"], .palette-brown-burnt-orange .action-item-search[type="submit"]:link, .palette-brown-burnt-orange .action-item-search[type="submit"]:visited {
+  color: white;
+}
+.palette-brown-burnt-orange .action-item-search[type="submit"]:hover {
+  color: white;
+  background: #d27a1d url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #e18728), color-stop(100%, #bc6d1a));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#e18728, #bc6d1a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#e18728, #bc6d1a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#e18728, #bc6d1a);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#e18728, #bc6d1a);
+  border-color: #62390e;
+  text-shadow: -1px 1px 2px #bc6d1a, -1px -1px 2px #bc6d1a, 1px -1px 2px #bc6d1a, 1px 1px 2px #bc6d1a;
+}
+.palette-brown-burnt-orange .action-item-search[type="submit"]:focus, .palette-brown-burnt-orange .action-item-search[type="submit"]:active {
+  background: #e18728 url('../images/icons/icon-search.png?1395768501') no-repeat;
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #d27a1d), color-stop(100%, #e4933e));
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -webkit-linear-gradient(#d27a1d, #e4933e);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -moz-linear-gradient(#d27a1d, #e4933e);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, -o-linear-gradient(#d27a1d, #e4933e);
+  background: url('../images/icons/icon-search.png?1395768501') no-repeat, linear-gradient(#d27a1d, #e4933e);
+  border-color: #8f5314;
+  text-shadow: -1px 1px 2px #bc6d1a, -1px -1px 2px #bc6d1a, 1px -1px 2px #bc6d1a, 1px 1px 2px #bc6d1a;
+}
+.palette-brown-burnt-orange [disabled].action-item-search[type="submit"] {
+  color: #edb982;
+  background: #e18728;
+  border-color: #8f5314;
+  -webkit-box-shadow: none;
+  -moz-box-shadow: none;
+  box-shadow: none;
+  text-shadow: none;
+}
+.palette-brown-burnt-orange .action-item-search[type="submit"], .palette-brown-burnt-orange .action-item-search[type="submit"]:hover, .palette-brown-burnt-orange .action-item-search[type="submit"]:active, .palette-brown-burnt-orange .action-item-search[type="submit"]:focus {
+  background-position: 1.5em center;
+}
+.palette-brown-burnt-orange .notification-count {
+  background: #eb9039;
+  background: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #eb9039), color-stop(100%, #ad5d11));
+  background: -webkit-linear-gradient(#eb9039, #ad5d11);
+  background: -moz-linear-gradient(#eb9039, #ad5d11);
+  background: -o-linear-gradient(#eb9039, #ad5d11);
+  background: linear-gradient(#eb9039, #ad5d11);
+  -webkit-box-shadow: 0 0 2px #62390e;
+  -moz-box-shadow: 0 0 2px #62390e;
+  box-shadow: 0 0 2px #62390e;
+}
+
+.palette-black-blue-yellow .block-search {
+  background-color: #161616;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF161616', endColorstr='#FF2B2B2B');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #161616), color-stop(100%, #3f3f3f));
+  background-image: -webkit-linear-gradient(top, #161616 0%, #3f3f3f 100%);
+  background-image: -moz-linear-gradient(top, #161616 0%, #3f3f3f 100%);
+  background-image: -o-linear-gradient(top, #161616 0%, #3f3f3f 100%);
+  background-image: linear-gradient(top, #161616 0%, #3f3f3f 100%);
+}
+
+.palette-gray-lightgray-blue h2 {
+  color: #262626;
+}
+.palette-gray-lightgray-blue h1.node-title {
+  color: #262626;
+}
+.palette-gray-lightgray-blue h1.node-title a {
+  color: #262626;
+}
+.palette-gray-lightgray-blue a, .palette-gray-lightgray-blue .commons-bw-create-all-widget-types li a {
+  color: #04b6e7;
+}
+.palette-gray-lightgray-blue .block-search {
+  background-color: #838383;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF838383', endColorstr='#FF6D6D6D');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #838383), color-stop(100%, #a0a0a0));
+  background-image: -webkit-linear-gradient(top, #838383 0%, #a0a0a0 100%);
+  background-image: -moz-linear-gradient(top, #838383 0%, #a0a0a0 100%);
+  background-image: -o-linear-gradient(top, #838383 0%, #a0a0a0 100%);
+  background-image: linear-gradient(top, #838383 0%, #a0a0a0 100%);
+}
+
+.palette-black-white-red h2 {
+  color: #cc0000;
+}
+.palette-black-white-red a, .palette-black-white-red .commons-bw-create-all-widget-types li a {
+  color: #cc0000;
+}
+
+.palette-brown-burnt-orange a, .palette-brown-burnt-orange .commons-bw-create-all-widget-types li a {
+  color: #e18728;
+}
+
+.palette-blue-blue .block-search {
+  background-color: #0b769c;
+  *zoom: 1;
+  filter: progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr='#FF0B769C', endColorstr='#FF0C80AB');
+  background-image: -webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #0b769c), color-stop(100%, #0c80ab));
+  background-image: -webkit-linear-gradient(top, #0b769c 0%, #0c80ab 100%);
+  background-image: -moz-linear-gradient(top, #0b769c 0%, #0c80ab 100%);
+  background-image: -o-linear-gradient(top, #0b769c 0%, #0c80ab 100%);
+  background-image: linear-gradient(top, #0b769c 0%, #0c80ab 100%);
+}
diff --git a/themes/commons/commons_origins/css/images/dark/arrow-down.png b/themes/commons/commons_origins/css/images/dark/arrow-down.png
new file mode 100755
index 0000000..0418810
Binary files /dev/null and b/themes/commons/commons_origins/css/images/dark/arrow-down.png differ
diff --git a/themes/commons/commons_origins/css/images/dark/arrow-right.png b/themes/commons/commons_origins/css/images/dark/arrow-right.png
new file mode 100755
index 0000000..5002853
Binary files /dev/null and b/themes/commons/commons_origins/css/images/dark/arrow-right.png differ
diff --git a/themes/commons/commons_origins/css/images/help.png b/themes/commons/commons_origins/css/images/help.png
new file mode 100755
index 0000000..34857b7
Binary files /dev/null and b/themes/commons/commons_origins/css/images/help.png differ
diff --git a/themes/commons/commons_origins/css/images/warning.png b/themes/commons/commons_origins/css/images/warning.png
new file mode 100755
index 0000000..919e00d
Binary files /dev/null and b/themes/commons/commons_origins/css/images/warning.png differ
diff --git a/themes/commons/commons_origins/css/lt-ie9.css b/themes/commons/commons_origins/css/lt-ie9.css
new file mode 100644
index 0000000..d53f039
--- /dev/null
+++ b/themes/commons/commons_origins/css/lt-ie9.css
@@ -0,0 +1,41 @@
+/*
+ * Target IE 6, 7 and 8 (less than IE9)
+ */
+/*
+ * Assuming a mobile first approach with respond.js OFF, we must reset the font
+ * size for lt IE9
+ */
+html {
+  font-size: 81.3%;
+}
+
+body.front.not-logged-in #content {
+  background: url('../images/commons-drop.png?1395768501') right top no-repeat;
+}
+body.front.not-logged-in .region-three-33-top {
+  margin-bottom: 24px;
+  min-height: 300px;
+}
+body.front.not-logged-in #block-system-main .pane-1 {
+  float: left;
+  width: 56%;
+}
+body.front.not-logged-in #block-system-main .pane-2 {
+  float: right;
+  width: 40%;
+}
+
+.profile-search-result {
+  width: 47%;
+  margin-right: 1%;
+  margin-left: 1%;
+}
+
+/* IE8 and lower do not support :before, So remove them and the margin so that
+   the container touches the button. */
+.sharethis-wrapper {
+  margin-bottom: 0;
+}
+.sharethis-wrapper:before, .sharethis-wrapper:after {
+  border: none;
+}
diff --git a/themes/commons/commons_origins/css/print.css b/themes/commons/commons_origins/css/print.css
new file mode 100644
index 0000000..a857289
--- /dev/null
+++ b/themes/commons/commons_origins/css/print.css
@@ -0,0 +1,293 @@
+/*
+ * @file
+ * Print Styles
+ * This probably needs work, but it's a good starting point.
+ */
+/*
+ * Body
+ */
+body {
+  width: 100% !important;
+  margin: 0 !important;
+  padding: 0 !important;
+  line-height: 1.4;
+  word-spacing: 1.1pt;
+  letter-spacing: 0.2pt;
+  font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
+  color: black;
+  background: none;
+  font-size: 11pt;
+}
+
+/*
+ * Links
+ */
+a {
+  background: transparent;
+  font-weight: 700;
+  text-decoration: underline;
+  color: #0000ee;
+}
+a[href^="http://"]:after, a[href^="http://"]:visited:after {
+  content: "(" attr(href) ")";
+  font-size: 10pt;
+}
+
+/*
+ * Strip background from likely candidates
+ */
+div[id*="wrapper"],
+[class*="title"],
+[class*="inner"],
+header,
+footer,
+#branding,
+#container,
+#columns,
+.columns-inner,
+#content-column,
+.content-inner,
+.region,
+.region-header,
+.region-content,
+.article,
+.article-title,
+.article-content,
+.comment,
+.comment-title,
+.comment-content,
+.block,
+.block-inner,
+.block-title,
+.block-content,
+table,
+table * {
+  background: none !important;
+}
+
+/*
+ * Hide various bits of the page
+ */
+.sidebar,
+#breadcrumb,
+.nav,
+.field-type-taxonomy-term-reference,
+ul.links,
+.feed-icon,
+.poll .bar,
+.poll .foreground,
+.comment-form,
+#comment-form,
+.book-navigation,
+.tabs,
+.action-links,
+.pager,
+.messages,
+.help {
+  display: none;
+}
+
+/*
+ * Ensure the display the main content region
+ */
+#content {
+  display: block !important;
+}
+
+/*
+ * Layout
+ */
+#header {
+  margin-bottom: 20px;
+}
+
+.content-inner {
+  margin: 0 !important;
+  padding: 0 !important;
+}
+
+/*
+ * HTML elements
+ */
+h1,
+h2,
+h3,
+h4,
+h5,
+h6 {
+  color: #333333;
+  margin: 0;
+  padding: 0;
+  line-height: 1;
+}
+
+h1 {
+  font-size: 14pt;
+}
+
+h2 {
+  font-size: 13pt;
+}
+
+h3 {
+  font-size: 12pt;
+}
+
+h4,
+h5,
+h6 {
+  font-size: 11pt;
+}
+
+h1 a,
+h2 a,
+h3 a,
+h4 a,
+h5 a,
+h6 a,
+#site-name a,
+#site-slogan {
+  text-decoration: none !important;
+  color: #333333;
+}
+
+hgroup a:link, hgroup a:visited {
+  text-decoration: none;
+}
+
+#page-title {
+  margin-top: 20px;
+}
+
+pre,
+code,
+tt,
+samp,
+kbd,
+var {
+  font-size: 10pt;
+  font-family: Consolas, "Lucida Console", Menlo, Monaco, "DejaVu Sans Mono", monospace, sans-serif;
+}
+
+blockquote {
+  margin: 20px;
+  padding: 10px;
+  font-size: 10pt;
+  font-style: italic;
+  background: #eeeeee;
+}
+
+hr {
+  background-color: #666666;
+}
+
+/*
+ * Header, Logo, Site name
+ */
+#header {
+  padding-bottom: 20px;
+}
+
+#logo img {
+  padding: 0 10px 0 0;
+  margin: 0 !important;
+  float: none !important;
+}
+
+/*
+ * Images
+ */
+img {
+  float: left;
+  margin: 4px 20px 10px 0;
+  page-break-inside: avoid;
+}
+
+a img {
+  border: none;
+}
+
+/*
+ * Tables
+ */
+table {
+  margin: 1px;
+  text-align: left;
+}
+
+th {
+  border-bottom: 1px solid #333333;
+  font-weight: 700;
+}
+
+td {
+  border-bottom: 1px solid #333333;
+}
+
+th,
+td {
+  padding: 4px 10px 4px 0;
+}
+
+tfoot {
+  font-style: italic;
+}
+
+caption {
+  margin-bottom: 10px;
+  text-align: left;
+}
+
+thead {
+  display: table-header-group;
+}
+
+tr {
+  page-break-inside: avoid;
+}
+
+/*
+ * Forms
+ */
+form {
+  margin-bottom: 10px;
+}
+
+/*
+ * Poll module
+ */
+.poll .text,
+.poll .percent,
+.poll .total {
+  text-align: left;
+}
+.poll form {
+  margin-bottom: 0;
+}
+
+/*
+ * Articles
+ */
+.node,
+.comment {
+  margin-bottom: 20px;
+  overflow: hidden;
+  page-break-inside: avoid;
+}
+
+.submitted {
+  color: #666666;
+  text-decoration: none;
+  font-size: 9pt;
+  font-weight: 400;
+  margin: 0;
+  padding: 0;
+}
+.submitted a {
+  color: #666666;
+  text-decoration: none;
+  font-size: 9pt;
+  font-weight: 400;
+  margin: 0;
+  padding: 0;
+}
diff --git a/themes/commons/commons_origins/css/responsive.custom.css b/themes/commons/commons_origins/css/responsive.custom.css
new file mode 100644
index 0000000..fa8baef
--- /dev/null
+++ b/themes/commons/commons_origins/css/responsive.custom.css
@@ -0,0 +1,146 @@
+/*
+ * responsive.custom.css is for custom media queries that are not set via the
+ * theme settings, such as cascading media queries.
+ *
+ * By default all the other responsive stylesheets used in Adaptivetheme use a
+ * "stacking method", however cascading media queries use a waterfall method so
+ * you can leverage the cascade and inheritance for all browsers that support
+ * media queries, regardless of screen size.
+ *
+ * @SEE http://zomigi.com/blog/essential-considerations-for-crafting-quality-media-queries/#mq-overlap-stack
+ *
+ * NOTE: this file loads by default, to disable got to your theme settings and
+ * look under the "CSS" settings tab.
+ */
+/*
+ * Really small screens and up
+ */
+/* @media only screen and (min-width: 220px) {} */
+/*
+ * Smartphone sizes and up
+ */
+/* @media only screen and (min-width: 320px) {} */
+/*
+ * Smartphone sizes and down
+ */
+@media only screen and (max-width: 480px) {
+  body.toolbar {
+    padding-top: 0 !important;
+  }
+
+  /*
+   * Float Region blocks example:
+   * In smaller screen sizes we can remove the float and widths so all blocks
+   * stack instead of displaying horizonally. The selector used here is an
+   * "attribute selector" which will match on any float block class. Use your
+   * inspector or Firebug to get the classes from the page output if you need
+   * more granular control over block alignment and stacking.
+   *
+   * "Float Region blocks" is an extension for floating blocks in regions, see
+   * your themes appearance settings, under the Extensions tab.
+   */
+  .region[class*="float-blocks"] .block {
+    float: none;
+    width: 100%;
+  }
+
+  .commons-bw-create-all-widget-types {
+    left: auto;
+  }
+
+  .page-node-add #edit-additional-settings {
+    width: 100%;
+    position: static;
+  }
+
+  .page-node-add .field-type-taxonomy-term-reference-form {
+    width: 100%;
+    position: static;
+  }
+
+  #toolbar {
+    position: static;
+    margin: 0;
+    padding: 0;
+  }
+
+  #toolbar-user {
+    position: absolute;
+    height: 1px;
+    overflow: hidden;
+    clip: rect(1px 1px 1px 1px);
+    /* IE6, IE7 */
+    clip: rect(1px, 1px, 1px, 1px);
+  }
+
+  div#panels-ipe-control-container {
+    display: none !important;
+  }
+
+  #quicktabs-container-commons_bw .quicktabs-tabpage .view-filters,
+  #quicktabs-container-commons_bw .quicktabs-tabpage .attachment-before {
+    float: none;
+    display: block;
+  }
+
+  #quicktabs-commons_follow_ui .quicktabs-style-commons-tabs li {
+    display: block;
+  }
+
+  .view-commons-follow-node .views-field-ops,
+  .view-commons-follow-node .views-field-ops-1,
+  .view-commons-follow-user .views-field-ops,
+  .view-commons-follow-user .views-field-ops-1,
+  .view-commons-follow-taxonomy-term .views-field-ops,
+  .view-commons-follow-taxonomy-term .views-field-ops-1 {
+    width: 33.333%;
+  }
+
+  .primary-fields,
+  .supplementary-fields {
+    display: block;
+    float: none;
+    width: auto;
+    padding: 0;
+  }
+}
+/*
+ * Tablet sizes and down
+ */
+@media only screen and (max-width: 768px) {
+  .quicktabs-style-commons-pills ul.quicktabs-tabs li a {
+    font: 0/30px a;
+    color: transparent;
+    text-align: center;
+    -webkit-box-sizing: border-box;
+    -moz-box-sizing: border-box;
+    box-sizing: border-box;
+    width: 30px;
+    height: 30px;
+    padding: 0;
+  }
+  .quicktabs-style-commons-pills ul.quicktabs-tabs li a:before {
+    margin-right: 0;
+    vertical-align: middle;
+  }
+}
+/*
+ * Tablet sizes and up
+ */
+@media only screen and (min-width: 768px) {
+  body.front.not-logged-in #content {
+    background: url('../images/commons-drop.png?1395768501') right top no-repeat;
+  }
+  body.front.not-logged-in .region-three-33-top {
+    margin-bottom: 24px;
+    min-height: 300px;
+  }
+  body.front.not-logged-in #block-system-main .pane-1 {
+    float: left;
+    width: 56%;
+  }
+  body.front.not-logged-in #block-system-main .pane-2 {
+    float: right;
+    width: 40%;
+  }
+}
diff --git a/themes/commons/commons_origins/css/responsive.desktop.css b/themes/commons/commons_origins/css/responsive.desktop.css
new file mode 100644
index 0000000..3c4eb6a
--- /dev/null
+++ b/themes/commons/commons_origins/css/responsive.desktop.css
@@ -0,0 +1,9 @@
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/css/responsive.smartphone.landscape.css b/themes/commons/commons_origins/css/responsive.smartphone.landscape.css
new file mode 100644
index 0000000..7e2fb29
--- /dev/null
+++ b/themes/commons/commons_origins/css/responsive.smartphone.landscape.css
@@ -0,0 +1,12 @@
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
+body.front.logged-in .view-commons-homepage-content .article.node .node-content .field-name-body, body.front.logged-in .view-commons-homepage-content .node-teaser.node-group .node-content .field-name-body {
+  margin-right: 0;
+}
diff --git a/themes/commons/commons_origins/css/responsive.smartphone.portrait.css b/themes/commons/commons_origins/css/responsive.smartphone.portrait.css
new file mode 100644
index 0000000..3c4eb6a
--- /dev/null
+++ b/themes/commons/commons_origins/css/responsive.smartphone.portrait.css
@@ -0,0 +1,9 @@
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/css/responsive.tablet.landscape.css b/themes/commons/commons_origins/css/responsive.tablet.landscape.css
new file mode 100644
index 0000000..78d4826
--- /dev/null
+++ b/themes/commons/commons_origins/css/responsive.tablet.landscape.css
@@ -0,0 +1,9 @@
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete 
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/css/responsive.tablet.portrait.css b/themes/commons/commons_origins/css/responsive.tablet.portrait.css
new file mode 100644
index 0000000..3c4eb6a
--- /dev/null
+++ b/themes/commons/commons_origins/css/responsive.tablet.portrait.css
@@ -0,0 +1,9 @@
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/custom_layouts/_README.txt b/themes/commons/commons_origins/custom_layouts/_README.txt
new file mode 100755
index 0000000..624220b
--- /dev/null
+++ b/themes/commons/commons_origins/custom_layouts/_README.txt
@@ -0,0 +1,17 @@
+
+
+Example Page Layout Plugin
+--------------------------
+
+If you are NOT developing a page layout plugin you can safely delete this
+entire directory from your sub-theme.
+
+If you are developing a page layout plugin see the developer notes in
+AT Core /layouts/core/_README.txt, there are many code comments in the
+three_col_grail inc file also.
+
+You can enable the "naked" example layout plugin by uncommenting the
+info file entry in your subthemes info file. Look for:
+
+Custom Page Layout Plugins:
+plugins[page_layout][layouts] = custom_layouts
diff --git a/themes/commons/commons_origins/custom_layouts/naked/naked.admin.css b/themes/commons/commons_origins/custom_layouts/naked/naked.admin.css
new file mode 100755
index 0000000..9a70a84
--- /dev/null
+++ b/themes/commons/commons_origins/custom_layouts/naked/naked.admin.css
@@ -0,0 +1,4 @@
+/* Set the icon for the layout in the theme settings form */
+fieldset.at-layout-form .form-type-radio label[for$=naked] {
+  background: transparent url(naked.png) no-repeat 0 0;
+}
diff --git a/themes/commons/commons_origins/custom_layouts/naked/naked.inc b/themes/commons/commons_origins/custom_layouts/naked/naked.inc
new file mode 100755
index 0000000..4af24b2
--- /dev/null
+++ b/themes/commons/commons_origins/custom_layouts/naked/naked.inc
@@ -0,0 +1,68 @@
+<?php
+
+/**
+ * @file
+ * Implimentation of an Adaptivetheme Page Layout plugin
+ *
+ * This is an example of a Page Layout plugin for Adaptivetheme. If enabled this
+ * will be picked up by the Plugin system and added as a page layout option for
+ * the specified 'device_groups'.
+ *
+ * You can enable the "naked" example layout plugin by uncommenting the
+ * info file entry in your subthemes info file. Look for:
+ * Custom Page Layout Plugins:
+ * plugins[page_layout][layouts] = custom_layouts
+ *
+ * Where "custom_layouts" is the directory holding this file. Remember to clear
+ * the cache after you make changes to your info file.
+ *
+ * The three_col_grail.inc AT Core layout holds extensive documentation on Page
+ * Layout plugins, its well worth reviewing that file.
+ *
+ * NOTE: when making changes to layout plugins you must clear cache all - plugin
+ * data is cached in the database!
+ *
+ * @SEE adaptivetheme/at_core/layouts/core/three_col_grail/three_col_grail.inc
+ * @SEE at_subtheme.info (Custom Page Layout Plugins).
+ */
+function naked() {
+  $page_layout['naked'] = array(
+    'title' => t('Naked'),
+    'category' => t('AT Subtheme Custom Page Layout'),
+    'method' => 'naked',
+    'type' => 'page_layout',
+    'admin css' => 'naked.admin.css',
+    'device_groups' => array(
+      'bigscreen',
+      'tablet_landscape',
+      'tablet_portrait',
+      'smartphone_landscape',
+    ),
+  );
+
+  return $page_layout;
+}
+
+/**
+ * CSS Builder for the naked layout.
+ *
+ * Page layout functions are called during theme settings submit to process and
+ * return CSS to be written to file. Sidebar width and unit values are set in
+ * theme settings and passed to this function as parameters.
+ *
+ * In essense you just write CSS here using the parameters as placeholders for
+ * inserting the values. You might do some logic with those values first
+ * depending on the complexity and nature of your layout. Its worth taking some
+ * time to review AT Cores Page layouts for examples.
+ *
+ * @param $sidebar_first, an arbitary numeric value.
+ * @param $sidebar_second, an arbitary numeric value.
+ * @param $sidebar_unit, a value unit, one of px, em or %.
+ */
+function naked_layout($sidebar_first, $sidebar_second, $sidebar_unit) {
+  $styles = <<<EOF
+/* Nothing to output, this style is naked! */
+EOF;
+
+  return $styles;
+}
diff --git a/themes/commons/commons_origins/custom_layouts/naked/naked.png b/themes/commons/commons_origins/custom_layouts/naked/naked.png
new file mode 100755
index 0000000..be88973
Binary files /dev/null and b/themes/commons/commons_origins/custom_layouts/naked/naked.png differ
diff --git a/themes/commons/commons_origins/favicon.ico b/themes/commons/commons_origins/favicon.ico
new file mode 100755
index 0000000..17a8fa8
Binary files /dev/null and b/themes/commons/commons_origins/favicon.ico differ
diff --git a/themes/commons/commons_origins/images/_README.txt b/themes/commons/commons_origins/images/_README.txt
new file mode 100755
index 0000000..b08ed17
--- /dev/null
+++ b/themes/commons/commons_origins/images/_README.txt
@@ -0,0 +1,11 @@
+
+
+Non CSS Images
+--------------
+
+This directory is for images that at are not used in CSS. By default
+only the touch icons are included here. In short, if your image is 
+loaded using an img or link element the image should be stored here.
+
+Included by default are three Apple touch icon files, which you can edit or
+replace if using touch icons (see your theme settings, under Extensions).
diff --git a/themes/commons/commons_origins/images/bkg.png b/themes/commons/commons_origins/images/bkg.png
new file mode 100644
index 0000000..e81d5eb
Binary files /dev/null and b/themes/commons/commons_origins/images/bkg.png differ
diff --git a/themes/commons/commons_origins/images/bkg_search.png b/themes/commons/commons_origins/images/bkg_search.png
new file mode 100644
index 0000000..da57115
Binary files /dev/null and b/themes/commons/commons_origins/images/bkg_search.png differ
diff --git a/themes/commons/commons_origins/images/button.png b/themes/commons/commons_origins/images/button.png
new file mode 100755
index 0000000..e064884
Binary files /dev/null and b/themes/commons/commons_origins/images/button.png differ
diff --git a/themes/commons/commons_origins/images/commons-drop.png b/themes/commons/commons_origins/images/commons-drop.png
new file mode 100644
index 0000000..8cfe679
Binary files /dev/null and b/themes/commons/commons_origins/images/commons-drop.png differ
diff --git a/themes/commons/commons_origins/images/commons-logo.png b/themes/commons/commons_origins/images/commons-logo.png
new file mode 100644
index 0000000..0285803
Binary files /dev/null and b/themes/commons/commons_origins/images/commons-logo.png differ
diff --git a/themes/commons/commons_origins/images/commons-throbber.gif b/themes/commons/commons_origins/images/commons-throbber.gif
new file mode 100644
index 0000000..f88bfde
Binary files /dev/null and b/themes/commons/commons_origins/images/commons-throbber.gif differ
diff --git a/themes/commons/commons_origins/images/footer-logo.png b/themes/commons/commons_origins/images/footer-logo.png
new file mode 100644
index 0000000..20fe355
Binary files /dev/null and b/themes/commons/commons_origins/images/footer-logo.png differ
diff --git a/themes/commons/commons_origins/images/icons-sfd37165efe.png b/themes/commons/commons_origins/images/icons-sfd37165efe.png
new file mode 100644
index 0000000..2c5d73f
Binary files /dev/null and b/themes/commons/commons_origins/images/icons-sfd37165efe.png differ
diff --git a/themes/commons/commons_origins/images/icons/all.png b/themes/commons/commons_origins/images/icons/all.png
new file mode 100644
index 0000000..250416e
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/all.png differ
diff --git a/themes/commons/commons_origins/images/icons/comments-dark.png b/themes/commons/commons_origins/images/icons/comments-dark.png
new file mode 100644
index 0000000..5e079ed
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/comments-dark.png differ
diff --git a/themes/commons/commons_origins/images/icons/comments-large.png b/themes/commons/commons_origins/images/icons/comments-large.png
new file mode 100644
index 0000000..826cfde
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/comments-large.png differ
diff --git a/themes/commons/commons_origins/images/icons/comments.png b/themes/commons/commons_origins/images/icons/comments.png
new file mode 100644
index 0000000..f6f3d5c
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/comments.png differ
diff --git a/themes/commons/commons_origins/images/icons/docs.png b/themes/commons/commons_origins/images/icons/docs.png
new file mode 100644
index 0000000..9cd6875
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/docs.png differ
diff --git a/themes/commons/commons_origins/images/icons/events.png b/themes/commons/commons_origins/images/icons/events.png
new file mode 100644
index 0000000..bba62a9
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/events.png differ
diff --git a/themes/commons/commons_origins/images/icons/facebook.png b/themes/commons/commons_origins/images/icons/facebook.png
new file mode 100644
index 0000000..c5a51b9
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/facebook.png differ
diff --git a/themes/commons/commons_origins/images/icons/follow-large.png b/themes/commons/commons_origins/images/icons/follow-large.png
new file mode 100644
index 0000000..30578a1
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/follow-large.png differ
diff --git a/themes/commons/commons_origins/images/icons/groups.png b/themes/commons/commons_origins/images/icons/groups.png
new file mode 100644
index 0000000..35472c9
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/groups.png differ
diff --git a/themes/commons/commons_origins/images/icons/ico_arrow_wht.png b/themes/commons/commons_origins/images/icons/ico_arrow_wht.png
new file mode 100644
index 0000000..abc00fc
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/ico_arrow_wht.png differ
diff --git a/themes/commons/commons_origins/images/icons/ico_search_wht.png b/themes/commons/commons_origins/images/icons/ico_search_wht.png
new file mode 100644
index 0000000..bea84f1
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/ico_search_wht.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-envelope.png b/themes/commons/commons_origins/images/icons/icon-envelope.png
new file mode 100644
index 0000000..a00cab9
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-envelope.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-events.png b/themes/commons/commons_origins/images/icons/icon-events.png
new file mode 100644
index 0000000..f1751b7
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-events.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-alert.png b/themes/commons/commons_origins/images/icons/icon-gray-alert.png
new file mode 100644
index 0000000..ad56b42
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-alert.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-docs.png b/themes/commons/commons_origins/images/icons/icon-gray-docs.png
new file mode 100644
index 0000000..e63668c
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-docs.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-event.png b/themes/commons/commons_origins/images/icons/icon-gray-event.png
new file mode 100644
index 0000000..bba62a9
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-event.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-follow.png b/themes/commons/commons_origins/images/icons/icon-gray-follow.png
new file mode 100644
index 0000000..9bfdb91
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-follow.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-idea.png b/themes/commons/commons_origins/images/icons/icon-gray-idea.png
new file mode 100644
index 0000000..c60cd27
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-idea.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-poll.png b/themes/commons/commons_origins/images/icons/icon-gray-poll.png
new file mode 100644
index 0000000..fe2a38d
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-poll.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-post.png b/themes/commons/commons_origins/images/icons/icon-gray-post.png
new file mode 100644
index 0000000..b0585a8
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-post.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-gray-question.png b/themes/commons/commons_origins/images/icons/icon-gray-question.png
new file mode 100644
index 0000000..47a66ac
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-gray-question.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-groups-small.png b/themes/commons/commons_origins/images/icons/icon-groups-small.png
new file mode 100644
index 0000000..8138129
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-groups-small.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-groups.png b/themes/commons/commons_origins/images/icons/icon-groups.png
new file mode 100644
index 0000000..6b5ba7d
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-groups.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-home.png b/themes/commons/commons_origins/images/icons/icon-home.png
new file mode 100644
index 0000000..445995b
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-home.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-more.png b/themes/commons/commons_origins/images/icons/icon-more.png
new file mode 100644
index 0000000..dd24abb
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-more.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-people.png b/themes/commons/commons_origins/images/icons/icon-people.png
new file mode 100644
index 0000000..e4684dd
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-people.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-person.png b/themes/commons/commons_origins/images/icons/icon-person.png
new file mode 100644
index 0000000..ba254a9
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-person.png differ
diff --git a/themes/commons/commons_origins/images/icons/icon-search.png b/themes/commons/commons_origins/images/icons/icon-search.png
new file mode 100644
index 0000000..1177d54
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/icon-search.png differ
diff --git a/themes/commons/commons_origins/images/icons/ideas.png b/themes/commons/commons_origins/images/icons/ideas.png
new file mode 100644
index 0000000..1f1bc10
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/ideas.png differ
diff --git a/themes/commons/commons_origins/images/icons/like.png b/themes/commons/commons_origins/images/icons/like.png
new file mode 100644
index 0000000..ea015ca
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/like.png differ
diff --git a/themes/commons/commons_origins/images/icons/linkedin.png b/themes/commons/commons_origins/images/icons/linkedin.png
new file mode 100644
index 0000000..1619f7d
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/linkedin.png differ
diff --git a/themes/commons/commons_origins/images/icons/message.png b/themes/commons/commons_origins/images/icons/message.png
new file mode 100644
index 0000000..c6625f4
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/message.png differ
diff --git a/themes/commons/commons_origins/images/icons/picture.png b/themes/commons/commons_origins/images/icons/picture.png
new file mode 100644
index 0000000..b487cc3
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/picture.png differ
diff --git a/themes/commons/commons_origins/images/icons/polls.png b/themes/commons/commons_origins/images/icons/polls.png
new file mode 100644
index 0000000..30351d8
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/polls.png differ
diff --git a/themes/commons/commons_origins/images/icons/posts.png b/themes/commons/commons_origins/images/icons/posts.png
new file mode 100644
index 0000000..c124f00
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/posts.png differ
diff --git a/themes/commons/commons_origins/images/icons/qa.png b/themes/commons/commons_origins/images/icons/qa.png
new file mode 100644
index 0000000..91d3c80
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/qa.png differ
diff --git a/themes/commons/commons_origins/images/icons/share.png b/themes/commons/commons_origins/images/icons/share.png
new file mode 100644
index 0000000..7eb7174
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/share.png differ
diff --git a/themes/commons/commons_origins/images/icons/spam.png b/themes/commons/commons_origins/images/icons/spam.png
new file mode 100644
index 0000000..018bfd0
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/spam.png differ
diff --git a/themes/commons/commons_origins/images/icons/tags.png b/themes/commons/commons_origins/images/icons/tags.png
new file mode 100644
index 0000000..869c5af
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/tags.png differ
diff --git a/themes/commons/commons_origins/images/icons/twitter.png b/themes/commons/commons_origins/images/icons/twitter.png
new file mode 100644
index 0000000..a9852ea
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/twitter.png differ
diff --git a/themes/commons/commons_origins/images/icons/wikis.png b/themes/commons/commons_origins/images/icons/wikis.png
new file mode 100644
index 0000000..ba3eb30
Binary files /dev/null and b/themes/commons/commons_origins/images/icons/wikis.png differ
diff --git a/themes/commons/commons_origins/images/jquery.selectBox-arrow.gif b/themes/commons/commons_origins/images/jquery.selectBox-arrow.gif
new file mode 100755
index 0000000..d8b7993
Binary files /dev/null and b/themes/commons/commons_origins/images/jquery.selectBox-arrow.gif differ
diff --git a/themes/commons/commons_origins/images/logo-general.png b/themes/commons/commons_origins/images/logo-general.png
new file mode 100644
index 0000000..aa00b0a
Binary files /dev/null and b/themes/commons/commons_origins/images/logo-general.png differ
diff --git a/themes/commons/commons_origins/images/main-nav-arrow.png b/themes/commons/commons_origins/images/main-nav-arrow.png
new file mode 100644
index 0000000..0c78233
Binary files /dev/null and b/themes/commons/commons_origins/images/main-nav-arrow.png differ
diff --git a/themes/commons/commons_origins/images/main-nav-hover.png b/themes/commons/commons_origins/images/main-nav-hover.png
new file mode 100644
index 0000000..347b9cc
Binary files /dev/null and b/themes/commons/commons_origins/images/main-nav-hover.png differ
diff --git a/themes/commons/commons_origins/images/node-promoted-star.png b/themes/commons/commons_origins/images/node-promoted-star.png
new file mode 100644
index 0000000..787d5f5
Binary files /dev/null and b/themes/commons/commons_origins/images/node-promoted-star.png differ
diff --git a/themes/commons/commons_origins/images/palettes/default.png b/themes/commons/commons_origins/images/palettes/default.png
new file mode 100644
index 0000000..4034a02
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/default.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-black-blue-yellow.png b/themes/commons/commons_origins/images/palettes/palette-black-blue-yellow.png
new file mode 100755
index 0000000..a305b9f
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-black-blue-yellow.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-black-green.png b/themes/commons/commons_origins/images/palettes/palette-black-green.png
new file mode 100755
index 0000000..a09ddbb
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-black-green.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-black-white-red.png b/themes/commons/commons_origins/images/palettes/palette-black-white-red.png
new file mode 100755
index 0000000..9813fc9
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-black-white-red.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-blue-blue.png b/themes/commons/commons_origins/images/palettes/palette-blue-blue.png
new file mode 100755
index 0000000..dc27585
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-blue-blue.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-brick-brick.png b/themes/commons/commons_origins/images/palettes/palette-brick-brick.png
new file mode 100755
index 0000000..a96c53b
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-brick-brick.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-brown-burnt-orange.png b/themes/commons/commons_origins/images/palettes/palette-brown-burnt-orange.png
new file mode 100755
index 0000000..56416be
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-brown-burnt-orange.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-brown-yellow.png b/themes/commons/commons_origins/images/palettes/palette-brown-yellow.png
new file mode 100755
index 0000000..908b9ba
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-brown-yellow.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-gray-lightgray-blue.png b/themes/commons/commons_origins/images/palettes/palette-gray-lightgray-blue.png
new file mode 100755
index 0000000..8100c07
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-gray-lightgray-blue.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-magenta-blue.png b/themes/commons/commons_origins/images/palettes/palette-magenta-blue.png
new file mode 100755
index 0000000..6ba09a3
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-magenta-blue.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-orange-red.png b/themes/commons/commons_origins/images/palettes/palette-orange-red.png
new file mode 100755
index 0000000..d1ca678
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-orange-red.png differ
diff --git a/themes/commons/commons_origins/images/palettes/palette-seafoam-orange.png b/themes/commons/commons_origins/images/palettes/palette-seafoam-orange.png
new file mode 100755
index 0000000..230ada9
Binary files /dev/null and b/themes/commons/commons_origins/images/palettes/palette-seafoam-orange.png differ
diff --git a/themes/commons/commons_origins/images/select_arrow.gif b/themes/commons/commons_origins/images/select_arrow.gif
new file mode 100755
index 0000000..004c3bf
Binary files /dev/null and b/themes/commons/commons_origins/images/select_arrow.gif differ
diff --git a/themes/commons/commons_origins/images/tag-featured.png b/themes/commons/commons_origins/images/tag-featured.png
new file mode 100644
index 0000000..01f2a1f
Binary files /dev/null and b/themes/commons/commons_origins/images/tag-featured.png differ
diff --git a/themes/commons/commons_origins/images/tag-new.png b/themes/commons/commons_origins/images/tag-new.png
new file mode 100644
index 0000000..8e389f7
Binary files /dev/null and b/themes/commons/commons_origins/images/tag-new.png differ
diff --git a/themes/commons/commons_origins/images/touch-icon-h.png b/themes/commons/commons_origins/images/touch-icon-h.png
new file mode 100755
index 0000000..313206c
Binary files /dev/null and b/themes/commons/commons_origins/images/touch-icon-h.png differ
diff --git a/themes/commons/commons_origins/images/touch-icon-l.png b/themes/commons/commons_origins/images/touch-icon-l.png
new file mode 100755
index 0000000..313206c
Binary files /dev/null and b/themes/commons/commons_origins/images/touch-icon-l.png differ
diff --git a/themes/commons/commons_origins/images/touch-icon-m.png b/themes/commons/commons_origins/images/touch-icon-m.png
new file mode 100755
index 0000000..313206c
Binary files /dev/null and b/themes/commons/commons_origins/images/touch-icon-m.png differ
diff --git a/themes/commons/commons_origins/images/user_img_arrow.png b/themes/commons/commons_origins/images/user_img_arrow.png
new file mode 100644
index 0000000..570b31d
Binary files /dev/null and b/themes/commons/commons_origins/images/user_img_arrow.png differ
diff --git a/themes/commons/commons_origins/logo.png b/themes/commons/commons_origins/logo.png
new file mode 100755
index 0000000..2ffe075
Binary files /dev/null and b/themes/commons/commons_origins/logo.png differ
diff --git a/themes/commons/commons_origins/sass/_README.txt b/themes/commons/commons_origins/sass/_README.txt
new file mode 100755
index 0000000..dc46a5e
--- /dev/null
+++ b/themes/commons/commons_origins/sass/_README.txt
@@ -0,0 +1,67 @@
+
+
+About SASS and Compass
+----------------------
+
+This directory includes Sass versions of AT's CSS files. All files use the SCSS
+syntax.
+
+Sass is a language that is just normal CSS plus some extra features, like
+variables, nested rules, math, mixins, etc. If your stylesheets are written in
+Sass, helper applications can convert them to standard CSS so that you can
+include the CSS in the normal ways with your theme.
+
+To learn more about Sass, visit: http://sass-lang.com
+
+Compass is a helper library for Sass. It includes libraries of shared mixins, a
+package manager to add additional extension libraries, and an executable that
+can easily convert Sass files into CSS.
+
+To learn more about Compass, visit: http://compass-style.org
+
+
+
+Developing with SASS and Compass
+--------------------------------
+
+To automatically generate the CSS versions of the scss while you are doing theme
+development, you'll need to tell Compass to "watch" the sass directory so that
+any time a .scss file is changed it will automatically place a generated CSS
+file into your sub-theme's css directory:
+
+  compass watch <path to your sub-theme's directory>
+
+  If you are already in the root of your sub-theme's directory, you can simply
+  type:  compass watch
+
+While using generated CSS with Firebug, the line numbers it reports will be
+wrong since it will be showing the generated CSS file's line numbers and not the
+line numbers of the source Sass files. To correct this problem, you can install
+the FireSass plug-in into Firefox.
+  https://addons.mozilla.org/en-US/firefox/addon/firesass-for-firebug/
+
+If you do not want to use Ruby and the command line you can check out the Sassy
+project for Drupal: http://drupal.org/project/sassy
+
+
+
+Moving to Production
+--------------------
+
+Once you have finished your sub-theme development and are ready to move your CSS
+files to your production server, you'll need to tell sass to update all your CSS
+files and to compress them (to improve performance). Note: the Compass command
+will only generate CSS for .scss files that have recently changed; in order to
+force it to regenerate all the CSS files, you can use the Compass' clean command
+to delete all the generated CSS files.
+
+- Delete all CSS files by running: compass clean
+- Edit the config.rb file in your theme's directory and uncomment this line by
+  deleting the "#" from the beginnning:
+    #environment = :production
+- Regenerate all the CSS files by running: compass compile
+
+And don't forget to turn on Drupal's CSS aggregation. :-)
+
+
+
diff --git a/themes/commons/commons_origins/sass/_base.scss b/themes/commons/commons_origins/sass/_base.scss
new file mode 100755
index 0000000..a022a42
--- /dev/null
+++ b/themes/commons/commons_origins/sass/_base.scss
@@ -0,0 +1,23 @@
+//
+// AdaptiveTheme does not require special handling for IE8 or later. But Compass
+// defines more Legacy IE variables that you might find useful for your theme.
+// See the documentation at http://compass-style.org/reference/compass/support/
+//
+
+//
+// Partials to be shared with all .scss files.
+//
+
+@import 'compass';
+
+//
+// Import custom partial - mixins and variables defined for your theme
+//
+@import 'custom';
+@import 'mixins/functions';
+@import 'mixins/respond';
+@import 'mixins/icons';
+@import 'extend-styles';
+@import 'mixins/mixins';
+@import 'mixins/buttons';
+@import 'mixins/multiline-ellipsis';
diff --git a/themes/commons/commons_origins/sass/_custom.scss b/themes/commons/commons_origins/sass/_custom.scss
new file mode 100755
index 0000000..f81d190
--- /dev/null
+++ b/themes/commons/commons_origins/sass/_custom.scss
@@ -0,0 +1,178 @@
+//
+// Custom sass variables and mixins
+//
+// Variables
+// -----------------------------------------------------------------------------
+// The variables set here serve only as example of how you can use SASS variables
+// to centralize and control frequently used styles more easily. Here you will
+// find variables for colors, fonts and the global gutter width.
+//
+// Mixins
+// -----------------------------------------------------------------------------
+// To use a mixin in this file, add this line to the top of your .scss file:
+//
+// Then to use a mixin for a particular rule, add this inside the ruleset's
+// curly brackets:
+//   @include mix-in-name;
+//
+
+//
+// Color Variables
+// Colors used in the sample global.styles. You can use these to recolor many
+// elements such as forms, tables, tabs etc.
+//
+
+$page:         #e6e6e6; // to match the page background, default is white
+$border:       #ccc;    // all borders set in global.styles - tables, fieldset, primary links
+$highlight:    #c00;    // required mark, form error highlight, "new" label on comments
+$ultralight:   #f5f5f5; // table row even, primary link inactive tabs
+$light:        #eee;    // table row odd active, primary link inactive hover
+$medium_light: #ebebeb; // table row even active
+$medium_dark:  #e5e5e5; // table thead
+$icon_gray:    #a3a3a3; // The color of a monotone icon.
+$debug:        rgba(255, 192, 203, 0.5); // Full width wrapper test
+
+$thead:          $medium_dark;
+$tr_odd:         $page;
+$tr_even:        $ultralight;
+$tr_odd_active:  $light;
+$tr_even_active: $medium_light;
+
+$primary_task:        $ultralight;
+$primary_task_hover:  $light;
+$primary_task_active: $page;
+
+$white: #fff;
+$dark_gray: rgb(51,51,51);
+$gray: rgb(102,102,102);
+$light_gray: rgb(133, 133, 133);
+$green: rgb(70,186,49);
+$dark_blue: rgb(51,102,153);
+$light_blue: rgb(39,131,185);
+$orange: rgb(255,153,0);
+$lighter_gray: #eee;
+
+$tab_background: rgba(153, 153, 153, .3);
+$tab_text: $light_blue;
+$tab_text_hover: $dark_blue;
+$tab_active_background: rgb(153, 153, 153);
+$tab_active_text: $dark_gray;
+
+// Colors for other palettes
+
+// Orange and Red
+$palette_orange_red_orange: #D54F1A;
+$palette_orange_red_red: #830C00;
+$palette_orange_red_btn_top: #FEB431;
+$palette_orange_red_btn_bottom: #FF9126;
+
+// Magenta and Blue
+$palette_magenta_blue_light: #E60074;
+$palette_magenta_blue_dark: #891746;
+$palette_magenta_blue_btn_top: #69C5EC;
+$palette_magenta_blue_btn_bottom: #0097BF;
+
+// Blue and Blue
+$palette_blue_blue_light: #0D8BB9;
+$palette_blue_blue_dark: #197BB1;
+$palette_blue_blue_btn_top: #7EBD26;
+$palette_blue_blue_btn_bottom: #7EBD26;
+
+// Black and Green
+$palette_black_green_black: #2D3538;
+$palette_black_green_green: #81B453;
+$palette_black_green_btn_top: #4090BA;
+$palette_black_green_btn_bottom: #4090BA;
+
+// Brown and Yellow
+$palette_brown_yellow_light: #9C773D;
+$palette_brown_yellow_dark: #6A513B;
+$palette_brown_yellow_btn_top: #FCD036;
+$palette_brown_yellow_btn_bottom: #E3AD40;
+
+// Seafoam and Orange
+$palette_seafoam_orange_light: #73A5A5;
+$palette_seafoam_orange_dark: #668284;
+$palette_seafoam_orange_btn_top: #D9A300;
+$palette_seafoam_orange_btn_bottom: #B68800;
+
+// Black, Blue and Yellow
+$palette_black_blue_yellow_light: #0072AB;
+$palette_black_blue_yellow_dark: #353535;
+$palette_black_blue_yellow_btn_top: #E5B700;
+$palette_black_blue_yellow_btn_bottom: #D0A600;
+
+// Brick and Brick
+$palette_brick_brick_light: #723729;
+$palette_brick_brick_dark: #432A26;
+$palette_brick_brick_btn_top: #C2594C;
+$palette_brick_brick_btn_bottom: #A12E1E;
+
+// Gray, Light Gray and blue
+$palette_gray_light_gray_blue_light: #DBDBDB;
+$palette_gray_light_gray_blue_dark: #868686;
+$palette_gray_light_gray_blue_btn_top: #00CCFF;
+$palette_gray_light_gray_blue_btn_bottom: #04B6E7;
+
+// Black, White and Red
+$palette_black_white_red_light: #383838;
+$palette_black_white_red_dark: #262626;
+$palette_black_white_red_btn_top: #E45553;
+$palette_black_white_red_btn_bottom: #CC0000;
+
+// Brown and Burnt Orange
+$palette_brown_burnt_orange_light: #7C4811;
+$palette_brown_burnt_orange_dark: #62390E;
+$palette_brown_burnt_orange_btn_top: #EB9039;
+$palette_brown_burnt_orange_btn_bottom: #E18728;
+
+// List of palettes and options that will be looped through to build the differnt color palettes.
+// This variable gets called by an @each function in the partial /sass/_palettes.scss
+// The format is:
+// (<class name to trigger> <light color var> <dark color var> <button top color var> <button bottom color var>)
+$palettes: (palette-orange-red $palette_orange_red_orange $palette_orange_red_red $palette_orange_red_btn_top $palette_orange_red_btn_bottom)
+(palette-magenta-blue $palette_magenta_blue_light $palette_magenta_blue_dark $palette_magenta_blue_btn_top $palette_magenta_blue_btn_bottom)
+(palette-blue-blue $palette_blue_blue_light $palette_blue_blue_dark $palette_blue_blue_btn_top $palette_blue_blue_btn_bottom)
+(palette-black-green $palette_black_green_green $palette_black_green_black $palette_black_green_btn_top $palette_black_green_btn_bottom)
+(palette-brown-yellow $palette_brown_yellow_light $palette_brown_yellow_dark $palette_brown_yellow_btn_top $palette_brown_yellow_btn_bottom)
+(palette-seafoam-orange $palette_seafoam_orange_light $palette_seafoam_orange_dark $palette_seafoam_orange_btn_top $palette_seafoam_orange_btn_bottom)
+(palette-black-blue-yellow $palette_black_blue_yellow_light $palette_black_blue_yellow_dark $palette_black_blue_yellow_btn_top $palette_black_blue_yellow_btn_bottom)
+(palette-brick-brick $palette_brick_brick_light $palette_brick_brick_dark $palette_brick_brick_btn_top $palette_brick_brick_btn_bottom)
+(palette-gray-lightgray-blue $palette_gray_light_gray_blue_light $palette_gray_light_gray_blue_dark $palette_gray_light_gray_blue_btn_top $palette_gray_light_gray_blue_btn_bottom)
+(palette-black-white-red $palette_black_white_red_light $palette_black_white_red_dark $palette_black_white_red_btn_top $palette_black_white_red_btn_bottom)
+(palette-brown-burnt-orange $palette_brown_burnt_orange_light $palette_brown_burnt_orange_dark $palette_brown_burnt_orange_btn_top $palette_brown_burnt_orange_btn_bottom);
+
+
+//
+// Font Variables
+// These font stacks are an exact copy of the stacks found in AT Cores
+// theme settings for web safe fonts.
+//
+
+$sans-serif-small:            'Helvetica Neue', Arial, Helvetica, sans-serif;
+$sans-serif-large:            Verdana, Geneva, 'DejaVu Sans', Arial, Helvetica, sans-serif;
+$sans-serif-arial-helvetica:  Arial, Helvetica, sans-serif;
+$calibri-candara:             Calibri, Candara, Arial, Helvetica, sans-serif;
+$serif-small:                 Garamond, Perpetua, 'Times New Roman', serif;
+$serif-large:                 Georgia, Baskerville, Palatino, 'Palatino Linotype', 'Book Antiqua', 'Times New Roman', serif;
+$modern-myriad:               'Segoe UI', 'Myriad Pro', Myriad, Arial, Helvetica, sans-serif;
+$lucida:                      'Lucida Sans Unicode', 'Lucida Sans', 'Lucida Grande', Verdana, Geneva, sans-serif;
+$impact:                      Impact, Haettenschweiler, 'Franklin Gothic Bold', Charcoal, 'Helvetica Inserat', 'Bitstream Vera Sans Bold', 'Arial Black', sans-serif;
+$mono:                        Consolas, Monaco, 'Courier New', Courier, monospace, sans-serif;
+
+$base-font: 'Helvetica Neue', Arial, Helvetica, sans-serif;
+$alt-font: Helvetica, 'Helvetica Neue', Arial, sans-serif;
+
+//
+// Gutters
+//
+// Set a variable for the gutters. Adaptivetheme allows you to easly modify the
+// global gutter width for precise control over the design. Panel pages need
+// special gutter wrangling when a Panel is inside #content wrapper, so to ease
+// setting this we use a variable.
+//
+$gutter-width: 10px;
+
+// global chunk of code for importing
+
+$icons: sprite-map('icons/*.png', $spacing: 20px);
diff --git a/themes/commons/commons_origins/sass/_extend-styles.scss b/themes/commons/commons_origins/sass/_extend-styles.scss
new file mode 100644
index 0000000..69b2fff
--- /dev/null
+++ b/themes/commons/commons_origins/sass/_extend-styles.scss
@@ -0,0 +1,30 @@
+%divider-left {
+  border-left: 1px solid darken($light_blue, 3%);
+  @include box-shadow(darken($dark_blue, 13%) -1px 0px 0px);
+}
+
+%divider-right {
+  border-right: 1px solid darken($dark_blue, 13%);
+  @include box-shadow(darken($light_blue, 3%) 1px 0px 0px);
+}
+
+%pod {
+  background-color: $white;
+  @include border-radius(3px);
+  @include box-shadow($light_gray 1px 1px 4px);
+  margin: $gutter-width 0;
+}
+
+%pod-content {
+  padding: $gutter-width;
+}
+
+%node-space-right {
+  > .node-content {
+    margin-right: 10em;
+
+    @include respond(small-medium) {
+      margin-right: 0;
+    }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/_palettes.scss b/themes/commons/commons_origins/sass/_palettes.scss
new file mode 100644
index 0000000..7bd3f59
--- /dev/null
+++ b/themes/commons/commons_origins/sass/_palettes.scss
@@ -0,0 +1,207 @@
+@each $palette in $palettes {
+
+  $palette_color_class: nth($palette, 1);
+  $palette_color_light: nth($palette, 2);
+  $palette_color_dark: nth($palette, 3);
+  $palette_btn_top: nth($palette, 4);
+  $palette_btn_bottom: nth($palette, 5);
+
+  .#{$palette_color_class} {
+
+    h2 {
+      color: $palette_color_dark;
+    }
+
+    .header-color-row-one {
+      background-color: $palette_color_dark;
+      border-top: 1.5em solid darken($palette_color_dark, 50%);
+
+      @include respond(large) {
+        border-top: none;
+      }
+
+      .boxshadow & {
+        @include box-shadow($palette_color_dark 0px -1px 0px);
+      }
+    }
+
+    .header-color-row-two {
+      background-color: $palette_color_light;
+      border-top: 1px solid lighten($palette_color_light, 10%);
+      border-bottom: 1px solid darken($palette_color_light, 10%);
+    }
+
+    h1.node-title {
+      color: $palette_color_light;
+
+      a {
+        color: $palette_color_light;
+      }
+    }
+
+    a, .commons-bw-create-all-widget-types li a {
+      color: $palette_color_light;
+    }
+
+    .select-status {
+      &:after {
+        border-top-color: $palette_color_light;
+      }
+    }
+
+    #menu-bar.nav ul.menu li:hover .arrow:before,
+    #menu-bar.nav ul.menu li.active-trail .arrow:before {
+      border-color: transparent transparent lighten($palette_color_light, 10%) transparent;
+    }
+
+    #menu-bar.nav ul.menu li:hover .arrow:after,
+    #menu-bar.nav ul.menu li.active-trail .arrow:after {
+      border-color: transparent transparent $palette_color_light transparent;
+    }
+
+    ul.commons-utility-links li.last {
+      border-left-color: $palette_color_light;
+    }
+
+    // Quicktabs buttons styles
+
+    .quicktabs-style-commons-pills ul.quicktabs-tabs,
+    ul.primary.tabs {
+      li {
+        a {
+          &,
+          span {
+            color: $palette_color_light;
+          }
+
+          &:hover {
+            color: darken($palette_color_light, 10%)
+          }
+        }
+
+        &.active {
+          a {
+            &,
+            span {
+              color: $dark_gray;
+            }
+          }
+        }
+      }
+    }
+
+    .partial-node-form-title {
+      color: $palette_btn_bottom;
+    }
+
+    .block-search {
+      background-color: darken($palette_color_light, 12%); // Old browsers
+      @include filter-gradient(darken($palette_color_light, 12%), darken($palette_color_light, 6%), vertical); // IE6-9
+      @include background-image(linear-gradient(top,  darken($palette_color_light, 12%) 0%,darken($palette_color_light, 6%)100%));
+    }
+
+    .commons-bw-create-all-widget-types, li.sharethis .sharethis-wrapper {
+      border-color: $palette_color_light;
+    }
+
+    li.sharethis .sharethis-wrapper:before {
+      border-color: $palette_color_light transparent transparent transparent;
+    }
+
+    %divider-left {
+      border-left: 1px solid lighten($palette_color_dark, 6%);
+      @include box-shadow(darken($palette_color_dark, 13%) -1px 0px 0px);
+    }
+
+    %divider-right {
+      border-right: 1px solid darken($palette_color_dark, 13%);
+      @include box-shadow(lighten($palette_color_dark, 6%) 1px 0px 0px);
+    }
+
+    // Generate a new invisible class and extend the default with the color
+    // scheme of the skin.
+    @include button($palette_color_class, $palette_btn_bottom);
+
+    %button-primary {
+      @extend %button-#{$palette_color_class};
+    }
+
+    @include button_with_icon((#{$palette_color_class}, $palette_btn_bottom), icon-search);
+
+    %button-#{$palette_color_class}-icon-search {
+      &,
+      &:hover,
+      &:active,
+      &:focus {
+        background-position: 1.5em center;
+      }
+    }
+
+    %button-primary-icon-search {
+      @extend %button-#{$palette_color_class}-icon-search;
+    }
+
+    .notification-count {
+      background: $palette_btn_top;
+      @include background(linear-gradient($palette_btn_top darken($palette_btn_top, 20)));
+      @include box-shadow(0 0 2px $palette_color_dark);
+    }
+  }
+}
+
+//Specific overrides
+.palette-black-blue-yellow {
+  .block-search {
+    background-color: darken($palette_black_blue_yellow_dark, 12%); // Old browsers
+    @include filter-gradient(darken($palette_black_blue_yellow_dark, 12%), darken($palette_black_blue_yellow_dark, 4%), vertical); // IE6-9
+    @include background-image(linear-gradient(top,  darken($palette_black_blue_yellow_dark, 12%) 0%,lighten($palette_black_blue_yellow_dark, 4%)100%));
+  }
+}
+
+.palette-gray-lightgray-blue {
+  h2 {
+    color: #262626;
+  }
+
+  h1.node-title {
+    color: #262626;
+
+    a {
+      color: #262626;
+    }
+  }
+
+  a, .commons-bw-create-all-widget-types li a {
+    color: $palette_gray_light_gray_blue_btn_bottom;
+  }
+
+  .block-search {
+    background-color: darken($palette_gray_light_gray_blue_dark, 1%); // Old browsers
+    @include filter-gradient(darken($palette_gray_light_gray_blue_dark, 1%), darken($palette_gray_light_gray_blue_dark, 10%), vertical); // IE6-9
+    @include background-image(linear-gradient(top,  darken($palette_gray_light_gray_blue_dark, 1%) 0%,lighten($palette_gray_light_gray_blue_dark, 10%)100%));
+  }
+}
+
+.palette-black-white-red {
+  h2 {
+    color: $palette_black_white_red_btn_bottom;
+  }
+
+  a, .commons-bw-create-all-widget-types li a {
+    color: $palette_black_white_red_btn_bottom;
+  }
+}
+
+.palette-brown-burnt-orange {
+  a, .commons-bw-create-all-widget-types li a {
+    color: $palette_brown_burnt_orange_btn_bottom;
+  }
+}
+
+.palette-blue-blue {
+  .block-search {
+    background-color: darken($palette_blue_blue_light, 6%); // Old browsers
+    @include filter-gradient(darken($palette_blue_blue_light, 6%), darken($palette_blue_blue_light, 3%), vertical); // IE6-9
+    @include background-image(linear-gradient(top,  darken($palette_blue_blue_light, 6%) 0%,darken($palette_blue_blue_light, 3%)100%));
+  }
+}
diff --git a/themes/commons/commons_origins/sass/_post-icons.scss b/themes/commons/commons_origins/sass/_post-icons.scss
new file mode 100644
index 0000000..589f40f
--- /dev/null
+++ b/themes/commons/commons_origins/sass/_post-icons.scss
@@ -0,0 +1,73 @@
+//
+// @file
+// Apply icons for various post types.
+//
+// Any new content types should be added to this file if it has a special icon.
+// Any new content types will have .row-type-[type] and
+// .node-content-type-[type] associated with them. New icons can be added to
+// the images/icons directory. The the name of the file sans the .png extension
+// is the name to feed to the sprite_url_height_width() mixin.
+//
+
+/* Apply icons to row row types. */
+[class*="row-type-"] {
+  @include box-sizing(border-box);
+  padding-left: 20px;
+
+  &:before {
+    content: "";
+    float: left;
+    margin-top: .1em;
+    margin-left: -20px;
+  }
+}
+
+.node-content-type:before {
+  content: "";
+}
+
+.row-type-event,
+.node-content-type-event {
+  &:before {
+    @include sprite_url_height_width($icons, events);
+  }
+}
+
+.row-type-page,
+.node-content-type-page,
+.row-type-document,
+.node-content-type-document {
+  &:before {
+    @include sprite_url_height_width($icons, icon-gray-docs);
+  }
+}
+
+.row-type-poll,
+.node-content-type-poll {
+  &:before {
+    @include sprite_url_height_width($icons, polls);
+  }
+}
+
+.row-type-post,
+.node-content-type-post {
+  &:before {
+    @include sprite_url_height_width($icons, posts);
+  }
+}
+
+.row-type-question,
+.row-type-answer,
+.node-content-type-question,
+.node-content-type-answer {
+  &:before {
+    @include sprite_url_height_width($icons, qa);
+  }
+}
+
+.row-type-wiki,
+.node-content-type-wiki {
+  &:before {
+    @include sprite_url_height_width($icons, wikis);
+  }
+}
diff --git a/themes/commons/commons_origins/sass/commons-media.scss b/themes/commons/commons_origins/sass/commons-media.scss
new file mode 100644
index 0000000..4ce99dc
--- /dev/null
+++ b/themes/commons/commons_origins/sass/commons-media.scss
@@ -0,0 +1,194 @@
+/**
+ * @file
+ * Style overrides for the Commons Media feature.
+ */
+
+@import "base";
+
+.field-name-field-media-form {
+  margin-bottom: $gutter-width;
+}
+
+.field-name-field-media .field-add-more-submit {
+  &,
+  #quicktabs-container-commons_bw .quicktabs-tabpage & {
+    margin: $gutter-width 0;
+  }
+}
+
+table[id^="field-media-values"] {
+  &,
+  thead,
+  tbody,
+  tr,
+  th,
+  td {
+    background-color: transparent;
+    border: none;
+  }
+
+  th {
+    padding: 0;
+
+    label {
+      margin: 0;
+    }
+  }
+
+  td {
+    &.field-multiple-drag {
+      width: 20px;
+    }
+  }
+
+  a.tabledrag-handle .handle {
+    margin: 0;
+  }
+
+  .form-item {
+    padding-left: px-to-em(100px + $gutter-width);
+  }
+
+  .media-widget {
+    .button {
+      display: block;
+
+      @include respond(large) {
+        max-width: 50%;
+      }
+    }
+  }
+}
+
+.form-type-media {
+  .preview {
+    @include sprite_url_height_width($icons, picture);
+    margin-right: $gutter-width;
+  }
+
+  @include respond(only-small) {
+    .preview {
+      display: block;
+      float: none;
+      margin: 10px auto;
+    }
+
+    .button,
+    input[type="submit"] {
+      display: block;
+      float: none;
+      margin: 10px auto;
+      width: 100%;
+    }
+  }
+}
+
+// Override the default jQuery Dialog to match styles of Ember admin theme.
+// Once commons has a native style built and the module is set to use Commons
+// Origins, this can be removed.
+.media-wrapper {
+  position: absolute;
+  overflow: hidden;
+  padding: 0;
+  border: 1px solid #555555;
+  min-width: 100%;
+  max-width: 100%;
+  @include box-shadow(0 0 0 0.5625em rgba(0, 0, 0, 0.2));
+  @include box-sizing(border-box);
+
+  &,
+  .ui-corner-all {
+    @include border-radius(0);
+  }
+
+  .ui-dialog-title {
+    display: block;
+    margin: 0;
+    line-height: 1.5em;
+    font-size: 2.25em;
+    font-family: "Helvetica Neue", helvetica, "Segoe UI", segoe, "Ubuntu", "Droid Sans", "Arial", sans-serif;
+    font-weight: 200;
+  }
+
+  .ui-dialog-titlebar {
+    position: relative;
+    padding: 0.70711em 1em 0;
+    border: none;
+    color: #848484;
+    background: #303030;
+  }
+
+  .ui-dialog-titlebar-close {
+    position: absolute;
+    float: none;
+    display: block;
+    top: 0.35355em;
+    right: 0.35355em;
+    width: 1em;
+    height: 1em;
+    overflow: hidden;
+    margin: 0;
+    padding: 0;
+    text-align: center;
+    line-height: 1em;
+    color: white;
+    background: none;
+    font-weight: normal;
+
+    &:hover {
+      text-decoration: none;
+      border: none;
+    }
+
+    &:before {
+      content: "\2715";
+    }
+  }
+
+  .ui-dialog-content {
+    position: relative;
+    border: 0;
+    background: none;
+    overflow: auto;
+    zoom: 1;
+  }
+
+  .ui-dialog-buttonpane {
+    text-align: left;
+    border-width: 1px 0 0 0;
+    background-image: none;
+    margin: .5em 0 0 0;
+    padding: .3em 1em .5em .4em;
+
+    .ui-dialog-buttonset {
+      float: right;
+    }
+
+    button {
+      margin: .5em .4em .5em 0;
+      cursor: pointer;
+    }
+  }
+
+  .ui-resizable-se {
+    width: 14px;
+    height: 14px;
+    right: 3px;
+    bottom: 3px;
+  }
+
+  .ui-draggable .ui-dialog-titlebar {
+    cursor: move;
+  }
+
+  @media (min-width: 22.85714em) {
+    min-width: 0;
+  }
+
+  @media (min-width: 28.57143em) {
+    .ui-dialog-titlebar {
+      padding-right: 2em;
+      padding-left: 2em;
+    }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/global.base.scss b/themes/commons/commons_origins/sass/global.base.scss
new file mode 100755
index 0000000..c73a7bd
--- /dev/null
+++ b/themes/commons/commons_origins/sass/global.base.scss
@@ -0,0 +1,587 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ * @file
+ * global.base
+ *
+ * - normalize with small modifications for Drupal and AT: http://necolas.github.com/normalize.css/
+ * - Gutter widths, see $gutter-width in _custom.scss
+ * - Default container alignment.
+ * - Flexible images and media declarations.
+ * - Copies of the SCSS mixins for reference, which includes an improved
+ *   element-invisible and focusable styles.
+ */
+
+/* =============================================================================
+    HTML5 display definitions
+   ========================================================================== */
+
+/*
+ * Corrects block display not defined in IE6/7/8/9 & FF3
+ */
+article,
+aside,
+details,
+figcaption,
+figure,
+footer,
+header,
+hgroup,
+nav,
+section,
+summary {
+  display: block;
+}
+
+
+/*
+ * Corrects inline-block display not defined in IE6/7/8/9 & FF3
+ */
+audio,
+canvas,
+video {
+  display: inline-block;
+  *display: inline;
+  *zoom: 1;
+}
+
+
+/*
+ * Prevents modern browsers from displaying 'audio' without controls
+ * Remove excess height in iOS5 devices
+ */
+audio:not([controls]) {
+  display: none;
+  height: 0;
+}
+
+
+/*
+ * Addresses styling for 'hidden' attribute not present in IE7/8/9, FF3, S4
+ * Known issue: no IE6 support
+ */
+[hidden] {
+  display: none;
+}
+
+
+/* =============================================================================
+    Base
+   ========================================================================== */
+
+/*
+ * If you are using the themes Responsive JS feature (media_queries.js) do not
+ * set a font-family on the html element, use body.
+ *
+ * 1. Corrects text resizing oddly in IE6/7 when body font-size is set using em units
+ *    http://clagnut.com/blog/348/#c790
+ * 2. Prevents iOS text size adjust after orientation change, without disabling user zoom
+ *    www.456bereastreet.com/archive/201012/controlling_text_size_in_safari_for_ios_without_disabling_user_zoom/
+ */
+html {
+  font-size: 100%;
+  -webkit-text-size-adjust: 100%;
+  line-height: 1.7;
+  overflow-y: scroll;
+}
+
+
+/*
+ * 1 . Addresses margins handled incorrectly in IE6/7
+ */
+body {
+  min-height: 100%;
+  margin: 0;
+  padding: 0;
+  -webkit-font-smoothing: antialiased;
+  font-smoothing: antialiased;
+  text-rendering: optimizeLegibility\9; /* Only IE, can mess with Android */
+}
+
+
+/*
+ * Addresses font-family inconsistency between 'textarea' and other form elements.
+ */
+button,
+input,
+select,
+textarea {
+  font-family: sans-serif;
+}
+
+
+/* =============================================================================
+    Links
+   ========================================================================== */
+
+/*
+ * Addresses outline displayed oddly in Chrome
+ */
+a:focus {
+  outline: thin dotted;
+}
+
+
+/*
+ * Improves readability when focused and also mouse hovered in all browsers
+ * people.opera.com/patrickl/experiments/keyboard/test
+ */
+a:hover,
+a:active {
+  outline: 0;
+}
+
+
+/* =============================================================================
+    Typography
+   ========================================================================== */
+
+/*
+ * Headings
+ *
+ * Addresses font sizes and margins set differently in IE6/7
+ * Addresses font sizes within 'section' and 'article' in FF4+, Chrome, S5
+ */
+
+h1 {
+  font-size: 2em;
+  margin: 0.67em 0;
+}
+
+
+h2 {
+  font-size: 1.5em;
+  margin: 0.83em 0;
+}
+
+
+h3 {
+  font-size: 1.17em;
+  margin: 1em 0;
+}
+
+
+h4 {
+  font-size: 1em;
+  margin: 1.33em 0;
+}
+
+
+h5 {
+  font-size: 0.83em;
+  margin: 1.67em 0;
+}
+
+
+h6 {
+  font-size: 0.75em;
+  margin: 2.33em 0;
+}
+
+
+/*
+ * Addresses styling not present in IE7/8/9, S5, Chrome
+ */
+abbr[title] {
+  border-bottom: 1px dotted;
+}
+
+
+/*
+ * Addresses style set to 'bolder' in FF3+, S4/5, Chrome
+ */
+b,
+strong {
+  font-weight: bold;
+}
+
+
+blockquote {
+  margin: 1em 40px;
+}
+
+
+/*
+ * Addresses styling not present in S5, Chrome
+ */
+dfn {
+  font-style: italic;
+}
+
+
+/*
+ * Addresses styling not present in IE6/7/8/9
+ */
+mark {
+  background: #ff0;
+  color: #000;
+}
+
+
+/*
+ * Addresses margins set differently in IE6/7
+ */
+p,
+pre {
+  margin: 0 0 1.5em;
+}
+
+
+/*
+ * Corrects font family set oddly in IE6, S4/5, Chrome
+ * en.wikipedia.org/wiki/User:Davidgothberg/Test59
+ */
+pre,
+code,
+kbd,
+samp {
+  font-family: monospace, serif;
+  _font-family: 'courier new', monospace;
+  font-size: 1em;
+}
+
+
+/*
+ * Improves readability of pre-formatted text in all browsers
+ */
+pre {
+  white-space: pre;
+  white-space: pre-wrap;
+  word-wrap: break-word;
+}
+
+
+/*
+ * 1. Addresses CSS quotes not supported in IE6/7
+ * 2. Addresses quote property not supported in S4
+ */
+
+q {
+  quotes: none;
+}
+
+
+q:before,
+q:after {
+  content: '';
+  content: none;
+}
+
+
+small {
+  font-size: 75%;
+}
+
+
+/*
+ * Prevents sub and sup affecting line-height in all browsers
+ * gist.github.com/413930
+ */
+sub,
+sup {
+  font-size: 75%;
+  line-height: 0;
+  position: relative;
+  vertical-align: baseline;
+}
+
+
+sup {
+  top: -0.5em;
+}
+
+
+sub {
+  bottom: -0.25em;
+}
+
+
+/* =============================================================================
+    Lists
+   ========================================================================== */
+
+/*
+ * Addresses margins set differently in IE6/7
+ */
+dl,
+menu,
+ol,
+ul {
+  margin: 1em 0;
+}
+
+
+dd {
+  margin: 0 0 0 40px;
+}
+
+
+/*
+ * Addresses paddings set differently in IE6/7
+ */
+menu,
+ol,
+ul {
+  padding: 0 0 0 40px;
+}
+
+
+/*
+ * Corrects list images handled incorrectly in IE7
+ */
+nav ul,
+nav ol {
+  list-style: none;
+  list-style-image: none;
+}
+
+
+/* =============================================================================
+    Embedded content
+   ========================================================================== */
+
+/*
+ * 1. Remove border when inside 'a' element in IE6/7/8/9, FF3
+ * 2. Improves image quality when scaled in IE7
+ *    code.flickr.com/blog/2008/11/12/on-ui-quality-the-little-things-client-side-image-resizing/
+ */
+img {
+  /* border: 0; */  /* Drupal core already does this, uncomment if you need it */
+  -ms-interpolation-mode: bicubic;
+}
+
+
+/*
+ * Corrects overflow displayed oddly in IE9
+ */
+svg:not(:root) {
+  overflow: hidden;
+}
+
+
+/* =============================================================================
+    Figures
+   ========================================================================== */
+
+/*
+ * Addresses margin not present in IE6/7/8/9, S5, O11
+ */
+figure {
+  margin: 0;
+}
+
+
+/* =============================================================================
+    Forms
+   ========================================================================== */
+
+/*
+ * 1. Corrects font size not being inherited in all browsers
+ * 2. Addresses margins set differently in IE6/7, FF3+, S5, Chrome
+ * 3. Improves appearance and consistency in all browsers
+ */
+button,
+input,
+select,
+textarea {
+  font-size: 100%;
+  margin: 0;
+  vertical-align: baseline;
+  *vertical-align: middle;
+}
+
+/*
+ * 1. Addresses box sizing set to content-box in IE8/9
+ * 2. Removes excess padding in IE8/9
+ * 3. Removes excess padding in IE7
+ *    Known issue: excess padding remains in IE6
+ */
+input[type="checkbox"],
+input[type="radio"] {
+  box-sizing: border-box;
+  padding: 0;
+  *height: 13px;
+  *width: 13px;
+}
+
+/*
+ * 1. Addresses appearance set to searchfield in S5, Chrome
+ * 2. Addresses box-sizing set to border-box in S5, Chrome (include -moz to future-proof)
+ */
+input[type="search"] {
+  -webkit-appearance: textfield;
+  -moz-box-sizing: content-box;
+  -webkit-box-sizing: content-box;
+  box-sizing: content-box;
+}
+
+/*
+ * Removes inner padding and search cancel button in S5, Chrome on OS X
+ */
+input[type="search"]::-webkit-search-decoration,
+input[type="search"]::-webkit-search-cancel-button {
+  -webkit-appearance: none;
+}
+
+/*
+ * 1. Removes default vertical scrollbar in IE6/7/8/9
+ * 2. Improves readability and alignment in all browsers
+ */
+textarea {
+  overflow: auto;
+  vertical-align: top;
+}
+
+
+/* =============================================================================
+    Tables
+   ========================================================================== */
+
+/*
+ * 1. Remove most spacing between table cells
+ */
+table {
+  border: 1px solid;
+  border-spacing: 0;
+  border-collapse: collapse;
+  font-size: inherit;
+  font: 100%;
+}
+
+
+/* =============================================================================
+    Flexible Media and Cross browser improvements
+   ========================================================================== */
+
+/*
+ * - This can cause issues in table cells where no width is set on the column,
+ *   only in some versions of webkit and IE 7/8.
+ * - declaring the width attribute on image elements and using max-width causes
+ *   the "dissappering images" bug in IE8.
+ * - Mapping services such as Google Maps may break also, see below for fixes.
+ */
+
+img {
+  height: auto;
+  -ms-interpolation-mode: bicubic;
+}
+
+
+/* Ethan Marcotte - http://front.ie/l8rJaA */
+img,
+embed,
+object,
+video {
+  max-width: 100%;
+}
+
+
+/* Disable flexiblity for IE8 and below */
+.lt-ie9 img,
+.lt-ie9 object,
+.lt-ie9 embed,
+.lt-ie9 video {
+  max-width: none;
+}
+
+
+/* Override max-width 100% for map displays */
+#map img,
+.gmap img,
+.view-gmap img,
+.openlayers-map img,
+#getlocations_map_canvas img,
+#locationmap_map img,
+.geofieldMap img,
+.views_horizontal_slider img {
+  max-width: none !important;
+}
+
+
+/* =============================================================================
+    Misc helpers, Accessibility classes etc
+   ========================================================================== */
+
+/* Prevent overflowing content */
+header[role=banner],
+.content-inner,
+.nav,
+.region-sidebar-first,
+.region-sidebar-second,
+.region-secondary-content,
+.region-tertiary-content,
+.region-footer {
+  overflow: visible;
+  word-wrap: break-word;
+}
+
+
+/**
+ * General classes for hiding content. These are all included as SASS mixins.
+ * @SEE: sass/_custom.scss
+ */
+
+/**
+ * Image replacement
+ * Kellum Method: http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement
+ * Additional helpers from http://html5boilerplate.com/docs/css/
+ */
+.ir {
+  /* Kellum Method */
+  display: block !important;
+  text-indent: 100%;
+  white-space: nowrap;
+  overflow: hidden;
+  /* Remove the default border from elements like button */
+  border: 0;
+  /* Crush the text down to take up no space */
+  font: 0/0 a;
+  /* Remove any text shadows */
+  text-shadow: none;
+  /* Hide any residual text in Safari 4 and any mobile devices that may need it */
+  color: transparent;
+  /* Hide the default background color on elements like button */
+  background-color: transparent;
+}
+
+
+/* More robust element-invisible and element-focuable classes */
+.element-invisible {
+  border: 0;
+  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
+  clip: rect(1px, 1px, 1px, 1px);
+  height: 1px;
+  overflow: hidden;
+  padding: 0;
+  position: absolute;
+  width: 1px;
+}
+
+
+.element-invisible.element-focusable:active,
+.element-invisible.element-focusable:focus {
+  clip: auto;
+  height: auto;
+  overflow: visible;
+  position: static;
+  width: auto;
+}
+
+
+/* Shift content offscreen, can be usefull when you reall need to do this */
+.offscreen {
+  position: absolute;
+  top: -99999em;
+  width: 1px;
+  height: 1px;
+  overflow: hidden;
+  outline: 0;
+}
+
+
+/* Hide content from all users */
+.element-hidden {
+  display: none;
+}
diff --git a/themes/commons/commons_origins/sass/global.styles.scss b/themes/commons/commons_origins/sass/global.styles.scss
new file mode 100755
index 0000000..946215b
--- /dev/null
+++ b/themes/commons/commons_origins/sass/global.styles.scss
@@ -0,0 +1,4642 @@
+
+// _base.scss imports _custom.scss (variables and mixins) and other partials.
+@import "base";
+
+/**
+ * @file
+ * global.styles
+ *
+ * Styles you add here will load for all device sizes, they are "global", as
+ * opposed to "responsive" styles, which only load for a given breakpoint (media
+ * query) that you set in theme settings. See the README for more details.
+ *
+ *
+ * How to use this file:
+ * --------------------
+ *
+ * There are many empty selectors and some basic styles to act as a guide.
+ * Nothing is set in stone and you can change anything - even delete all of it
+ * and start with your own clean slate.
+ *
+ * To FORCE PRINT all selectors you can search and replace a single { (opening
+ * curly brace) and insert an empty comment. This is very useful in conjuction
+ * with FireSass: https://addons.mozilla.org/en-US/firefox/addon/firesass-for-firebug/
+ *
+ * See global.base also which includes normalize.css and some additional
+ * helper classes and base styles.
+ */
+
+/* =============================================================================
+ *   Base
+ * ========================================================================== */
+
+/**
+ * To preserve theme settings never apply font properties to the HTML element.
+ * This is critically important if you are using the Responsive JavaScript
+ * feature as this relies on being able to set a pseudo font family on the HTML
+ * element. If you need to set default font properties of any kind use the BODY
+ * element as these can be overridden using font theme settings.
+ */
+
+html {
+  background: $page;
+  font-size: 87.5%;
+  min-height: 100%;
+
+  .cke_editable {
+    @include box-sizing(border-box);
+    padding: 1em;
+    background: $white;
+    min-height: 200px;
+  }
+}
+
+body {
+  font-family: $base-font; // Set from _custom.scss font variables
+  color: $dark_gray;
+  min-width: 18em;
+}
+
+/* =============================================================================
+ *   HTML Elements
+ * ========================================================================== */
+
+h1 {
+  font-size: 30px;
+  line-height: 30px;
+  font-weight: normal;
+  color: $white;
+
+  a {
+    color: $white;
+
+    :hover {
+      text-decoration: none;
+    }
+  }
+
+  .site-name-long & {
+    font-size: 20px;
+    line-height: 25px;
+  }
+
+  .site-name-long-2-lines & {
+    font-size: 20px;
+    line-height: 25px;
+  }
+}
+
+h2 {
+  color: $dark_blue;
+  font-weight: lighter;
+  font-size: 3.8em;
+  font-family: $alt-font;
+}
+
+h3 {
+  color: $light_blue;
+  font-weight: normal;
+  font-size: 1.4em;
+
+  .sidebar & {
+    color: $gray;
+  }
+}
+
+pre,
+code,
+tt,
+samp,
+kbd,
+var {
+  font-family: $mono;
+}
+
+/* =============================================================================
+ *   Wrappers
+ * ========================================================================== */
+
+/**
+ * Page wrapper, includes the .container class which sets the overall page or section width
+ * Main wrapper in page.tpl.php, the .container class sets the width of the page, do not add width to it!
+ */
+
+/**
+ * Wraps all header elements - branding and .region-header
+ */
+
+.header-wrapper {
+  overflow: hidden;
+}
+
+#header {
+  position: relative;
+  @include box-sizing(border-box);
+  color: $white;
+  text-align: left;
+  padding-right: $gutter_width;
+  padding-left: $gutter_width;
+  white-space: nowrap;
+
+  a {
+    color: $white;
+  }
+
+  @include respond(small-medium) {
+    padding: 0;
+  }
+}
+
+.header-color-row-one {
+  border-top: 1.5em solid darken($dark_blue, 50%);
+  background-color: $dark_blue;
+  @include box-shadow($dark_blue 0px -1px 0px);
+
+  @include respond(large) {
+    border-top: none;
+  }
+}
+
+.header-color-row-two {
+  position: relative;
+  background-color: $light_blue;
+  min-height: 2.5em;
+  border-top: 1px solid lighten($light_blue, 10%);
+  border-bottom: 1px solid darken($light_blue, 10%);
+  z-index: 2;
+}
+
+/**
+ * Wraps the sidebars the content column
+ */
+
+#columns {
+  margin-right: $gutter-width;
+  margin-left: $gutter-width;
+}
+
+/**
+ * Footer wrapper
+ */
+
+#footer {
+  border-top: 1px solid $border;
+  @include box-shadow(inset 0 1px 0 $white);
+  margin: 0 $gutter-width;
+}
+
+/**
+ * Default credit block
+ */
+
+#block-block-1 {
+  .block-title,
+  .block-content {
+    color: $light_gray;
+  }
+
+  .block-title {
+    margin: $gutter-width 0 $gutter-width / 2;
+  }
+
+  .block-content {
+    font-size: .88em;
+  }
+
+  #footer & {
+    margin-bottom: 0;
+  }
+}
+
+/**
+ * Generic pod wrappers
+ */
+
+ .commons-pod {
+  @extend %pod;
+  @extend %pod-content;
+
+  /* Prevent pod nesting. */
+  .commons-pod {
+    margin: 0;
+    padding: 0;
+    background: transparent;
+    @include box-shadow(none);
+  }
+}
+
+/* =============================================================================
+ *   Branding
+ * ========================================================================== */
+
+/**
+ * Wraps all the branding elements, logo, name and slogan
+ */
+
+#branding {
+  float: left;
+  @include box-sizing(border-box);
+  width: 100%;
+  padding-left: px-to-em(57px + $gutter_width);
+  text-align: left;
+  margin-right: -36.5em;
+
+  @include respond(only-small) {
+    margin-right: -11.5em;
+  }
+
+  @include respond(only-medium) {
+    margin-right: -19.5em;
+  }
+
+  .people-search-active & {
+    margin-right: -42em;
+
+    @include respond(only-small) {
+      margin-right: -14em;
+    }
+
+    @include respond(only-medium) {
+      margin-right: -24em;
+    }
+  }
+}
+
+/**
+ * Logo
+ */
+
+#logo {
+  position: relative;
+  display: block;
+  float: left;
+  position: relative;
+  margin-bottom: -3em;
+  margin-left: -#{px-to-em(57px + $gutter_width)};
+  z-index: 3;
+}
+
+/**
+ * Wrapper for the site name and slogan (hgroup)
+ */
+
+#name-and-slogan {
+  display: block;
+  @include box-sizing(border-box);
+  width: 100%;
+  vertical-align: top;
+  min-height: 4em;
+  padding-right: 36.5em;
+
+  @include respond(only-small) {
+    padding-right: 11.5em;
+  }
+
+  @include respond(only-medium) {
+    padding-right: 19.5em;
+  }
+
+  @include respond(only-small) {
+    display: none;
+  }
+
+  .people-search-active & {
+    padding-right: 42em;
+
+    @include respond(only-medium) {
+      padding-right: 24em;
+    }
+  }
+}
+
+/**
+ * Site name (h1)
+ */
+
+#site-name {
+  margin: .3em 0 0;
+  font-family:'Trebuchet MS';
+  font-weight:700;
+
+  a {
+    &:link,
+    &:visited {
+      text-decoration: none;
+    }
+
+    &:hover,
+    &:focus {
+      text-decoration: none;
+    }
+  }
+
+  @include respond(medium) {
+    font-size: 1.4em;
+  }
+}
+
+/**
+ * Site slogan (h2)
+ */
+
+#site-slogan {
+  margin: 0 0 .3em;
+  font-size: 1em;
+  color: $white;
+}
+
+#site-name,
+#site-slogan {
+  display: block;
+  overflow: hidden;
+  padding-right: $gutter_width;
+  line-height: 1.2em;
+  white-space: normal;
+}
+
+/* =============================================================================
+ *   Page content header
+ * ========================================================================== */
+
+/**
+ * The main page title (h1)
+ */
+
+#page-title,
+.search-results-title {
+  margin: 0 0 .2em;
+  font-weight:300;
+  font-size: 3.85em;
+  line-height: 1.2em;
+}
+
+.page-messages-view,
+.page-flag-confirm {
+  #page-title {
+    /* Some pages require a smaller title to prevent the equivalent of
+       "yelling". */
+    font-size: 2.5em;
+  }
+}
+
+#page-top {
+  margin: 20px 0 0;
+}
+
+/* =============================================================================
+ *   Misc Global Styles
+ * ========================================================================== */
+
+/**
+ * Generic styles for nodes.
+ */
+
+.node {
+  &.node-event,
+  &.node-poll,
+  &.node-question {
+    @extend %node-space-right;
+  }
+}
+
+.node-actions {
+  @include box-sizing(border-box);
+  float: right;
+  width: 10em;
+  list-style: none;
+  margin: .5em -10em 0 0;
+  padding-left: 1em;
+  text-align: center;
+
+  [class*="action-item"] {
+    &,
+    &[type="submit"] {
+      margin: 0;
+    }
+  }
+
+  @include respond(small-medium) {
+    float: none;
+    width: auto;
+    margin: 1.7em 0;
+    text-align: left;
+  }
+}
+
+.node-teaser {
+  &.node-promoted {
+    background-image: image-url('node-promoted-star.png');
+    background-position: top right;
+    background-repeat: no-repeat;
+    background-color: darken($white, 3%);
+    border: none;
+    padding: 10px;
+    position: relative;
+    @include border-radius(3px);
+
+    &.user-picture-available {
+      @include place-picture(50px, 10px);
+    }
+
+    &.node-event,
+    &.node-poll,
+    &.node-question {
+      @extend %node-space-right;
+    }
+  }
+}
+
+.user-picture,
+.views-field-picture {
+  background:$white;
+  display: inline-block;
+  padding:4px;
+  @include border-radius(3px);
+  @include box-shadow($light_gray 1px 1px 4px);
+  line-height: 0;
+
+  .node &,
+  .comment &,
+  .privatemsg-message & {
+    &:after {
+      content: "";
+      width: 5px;
+      height: 8px;
+      position: absolute;
+      right: -5px;
+      top: 10px;
+      background: image-url('user_img_arrow.png');
+    }
+
+    img {
+      width: 50px;
+    }
+  }
+}
+
+/**
+ * Form styles
+ *
+ * These styles are extracted from the Formalize library by Nathan Smith. The
+ * specific support for IE below 8 is trimmed along with references to font
+ * families and the extra buttons styles.
+ */
+
+input,
+button,
+select,
+textarea,
+[class*=" action-item"] {
+  // Suppress red glow that Firefox
+  // adds to form fields by default.
+  &:invalid {
+    @include box-shadow(none);
+  }
+  // Add blue glow.
+  &:focus {
+    @include box-shadow(#0066ff 0 0 5px 0);
+    // for Opera
+    z-index: 1;
+  }
+}
+
+label {
+  margin-top: .5em;
+  margin-bottom: .5em;
+}
+
+input[type="file"],
+input[type="radio"],
+input[type="checkbox"] {
+  &:focus,
+  &:active {
+    @include box-shadow(none);
+  }
+}
+
+textarea,
+select,
+input[type="date"],
+input[type="datetime"],
+input[type="datetime-local"],
+input[type="email"],
+input[type="month"],
+input[type="number"],
+input[type="password"],
+input[type="search"],
+input[type="tel"],
+input[type="text"],
+input[type="time"],
+input[type="url"],
+input[type="week"] {
+  @include box-sizing(border-box);
+  @include background-clip(padding-box);
+  @include border-radius(2px);
+  -webkit-appearance: none;
+  background-color: white;
+  border: 1px solid $border;
+  color: black;
+  outline: 0;
+  margin: 0;
+  padding: .5em;
+  text-align: left;
+  vertical-align: top;
+  line-height: 1.2em;
+
+  &[disabled] {
+    background-color: #eeeeee;
+  }
+}
+
+input,
+textarea {
+  &::-webkit-input-placeholder {
+    color: #888888;
+  }
+}
+
+input,
+textarea {
+  &:-moz-placeholder {
+    color: #888888;
+  }
+}
+
+textarea,
+input[type="date"],
+input[type="datetime"],
+input[type="datetime-local"],
+input[type="email"],
+input[type="month"],
+input[type="number"],
+input[type="password"],
+input[type="search"],
+input[type="tel"],
+input[type="text"],
+input[type="time"],
+input[type="url"],
+input[type="week"] {
+  width: 100%;
+  max-width: 100%;
+}
+
+textarea,
+select[size],
+select[multiple] {
+  height: auto;
+}
+
+// Tweaks for Safari + Chrome.
+@media (-webkit-min-device-pixel-ratio: 0) {
+  select[size],
+  select[multiple],
+  select[multiple][size] {
+    background-image: none;
+    padding-right: 3px;
+  }
+
+  select,
+  select[size="0"],
+  select[size="1"] {
+    @include border-radius(3px);
+    // Base64 encoded "../images/select_arrow.gif"
+    background-image: url(data:image/png;base64,R0lGODlhDQAEAIAAAAAAAP8A/yH5BAEHAAEALAAAAAANAAQAAAILhA+hG5jMDpxvhgIAOw==);
+    background-repeat: no-repeat;
+    background-position: right center;
+    padding-right: 20px;
+  }
+  ::-webkit-validation-bubble-message {
+    -webkit-box-shadow: none;
+    box-shadow: none;
+    background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #666666), color-stop(1, black));
+    border: 1px solid;
+    border-color: #747474 #5e5e5e #4f4f4f;
+    color: white;
+    overflow: hidden;
+    padding: 15px 15px 17px;
+    text-shadow: black 0 0 1px;
+    height: 16px;
+  }
+  ::-webkit-validation-bubble-arrow,
+  ::-webkit-validation-bubble-top-outer-arrow,
+  ::-webkit-validation-bubble-top-inner-arrow {
+    -webkit-box-shadow: none;
+    box-shadow: none;
+    background: #666666;
+    border: 0;
+  }
+}
+
+textarea {
+  overflow: auto;
+  resize: vertical;
+  width: 100%;
+}
+
+optgroup {
+  color: black;
+  font-style: normal;
+  font-weight: normal;
+
+  &::-moz-focus-inner {
+    border: 0;
+    padding: 0;
+  }
+}
+
+/* Simulate a chosen select form value as inline text. */
+.hidden-select-wrapper {
+  position: relative;
+  display: inline-block;
+  @include single-transition(width, .2s);
+}
+
+.select-status {
+  display: inline-block;
+  white-space: nowrap;
+  @include single-transition(opacity, .2s);
+
+  &:after {
+    content: "";
+    position: relative;
+    top: .2em;
+    display: inline-block;
+    width: 0;
+    height: 0;
+    margin-left: .2em;
+    border: .4em solid transparent;
+    border-top-color: $light_blue;
+  }
+}
+
+.hidden-select {
+  position: absolute;
+  top: -.35em;
+  left: -.35em;
+  margin: 0;
+  @include opacity(0);
+
+  .select-inactive & {
+    width: 100%;
+  }
+}
+
+/* Replace the default Drupal throbber with a custom one. */
+html.js {
+  input.form-autocomplete {
+    background-image: none;
+    background-position: right center;
+    padding-right: 20px;
+
+    &.throbbing {
+      background-image: image-url("commons-throbber.gif");
+      background-position: right center;
+    }
+  }
+}
+
+.general-settings {
+  padding-top: 0;
+  padding-bottom: 0;
+}
+
+.fieldset-outer-wrapper {
+  margin: 1.7em 0;
+  padding: 1.7em 0;
+  border-top: 1px solid $border;
+  border-color: $border;
+  border-style: solid;
+  border-width: 1px 0;
+
+  + .fieldset-outer-wrapper {
+    border-top-width: 0;
+  }
+
+  .general-settings & {
+    margin-top: 0;
+    margin-bottom: 0;
+    padding-left: $gutter-width;
+    padding-right: $gutter-width;
+  }
+
+  .general-settings > & {
+    margin-left: -$gutter-width;
+    margin-right: -$gutter-width;
+
+    &:first-child {
+      border-top: none;
+    }
+
+    &:last-child {
+      border-bottom-width: 0;
+    }
+  }
+
+  /* Some form items have nested fieldsets that mess with the sibling
+     selectors and need some extra love. */
+  .field-name-og-group-ref & {
+    border-top: none;
+    margin-top: 0;
+    padding-top: 0;
+  }
+
+  .field-name-og-group-ref &,
+  .field-type-datetime-form & {
+    border-bottom: none;
+    margin-bottom: 0;
+    padding-bottom: 0;
+  }
+}
+
+fieldset {
+  border: none;
+  margin: 0;
+  padding: .01em 0;
+  @include box-sizing(border-box);
+}
+
+legend {
+  -webkit-padding-start: 0;
+  -webkit-padding-end: 0;
+  line-height: 1.2em;
+
+  // Keep legends from hopping around in Safari.
+  + .fieldset-wrapper {
+    -webkit-margin-top-collapse : separate;
+    margin-top: 1.2em;
+  }
+}
+
+.fieldset-legend {
+  display: block;
+  font-size: 1.2em;
+  line-height: 1.2em;
+  font-weight: light;
+
+  html.js fieldset.collapsed &,
+  html.js fieldset.collapsible & {
+    padding: 0;
+    background: none;
+  }
+
+  span.summary {
+    display: block;
+    margin: 0;
+    font-size: .76em;
+    font-weight: normal;
+  }
+
+  .collapsible > legend & {
+    display: block;
+    text-indent: -.5em;
+    margin-left: .6em;
+
+    span.summary {
+      margin-left: .7em;
+    }
+
+    a:before {
+      display: inline-block;
+      position: relative;
+      margin-right: .2em;
+      width: 0;
+      height: 0;
+      overflow: hidden;
+      border: .2em solid transparent;
+      border-top-color: $dark_gray;
+      content: "";
+      top: -.1em;
+      left: -.1em;
+    }
+  }
+
+  .collapsed > legend & {
+    a:before {
+      border-top-color: transparent;
+      border-left-color: $dark_gray;
+      top: -.2em;
+      left: auto;
+    }
+  }
+}
+
+.form-item {
+  &:first-child {
+    margin-top: 0;
+  }
+
+  &:last-child {
+    margin-bottom: 0;
+  }
+}
+
+.filter-wrapper {
+  margin: 0;
+  padding: 0;
+}
+
+/**
+ * Button styles
+ */
+
+// Generate the invisible classes that we will extend.
+@include buttons;
+
+.button,
+button,
+[type="reset"],
+[type="submit"],
+[type="button"],
+[class*="action-item"] {
+  @extend %button-default-layout;
+  @extend %button-default;
+  max-width: 100%;
+
+  &:not(.action-item-inline, .action-item-merge) {
+    @include respond(only-small) {
+      display: block;
+      width: 100%;
+      margin: .5em 0;
+    }
+  }
+
+  #panels-ipe-control-container & {
+    @include text-shadow(none);
+  }
+}
+
+[class*="action-item-small"] {
+  @extend %button-small-layout;
+}
+
+[class*="action-item-large"] {
+  @extend %button-large-layout;
+}
+
+.action-item-active,
+.action-item-small-active,
+.action-item-large-active {
+  &,
+  &[type="reset"],
+  &[type="submit"],
+  &[type="button"] {
+    @extend %button-active;
+  }
+}
+
+.action-item-primary,
+.action-item-small-primary,
+.action-item-large-primary {
+  &,
+  &[type="reset"],
+  &[type="submit"],
+  &[type="button"] {
+    @extend %button-primary;
+  }
+}
+
+.action-item-primary-active,
+.action-item-small-primary-active,
+.action-item-large-primary-active {
+  &,
+  &[type="reset"],
+  &[type="submit"],
+  &[type="button"] {
+    @extend %button-primary-active;
+  }
+}
+
+.action-item-merge, {
+  .action-item-merge + & {
+    @include border-top-left-radius(0);
+    @include border-bottom-left-radius(0);
+    margin-left: -.5em;
+  }
+}
+
+.action-item-append,
+.action-item-small-append,
+.action-item-large-append {
+  position: relative;
+  padding-right: .5em;
+  padding-left: .5em;
+
+  &,
+  &:active,
+  &:focus,
+  &:hover {
+    background: $border;
+    border-color: $light_gray;
+    color: $dark_gray;
+    cursor: default;
+    @include text-shadow(none);
+  }
+
+  &:before,
+  &:after {
+    content: "";
+    display: block;
+    position: absolute;
+    top: 50%;
+    border-color: transparent;
+    border-style: solid;
+  }
+
+  &:before {
+    left: -10px;
+    margin-top: -5px;
+    border-width: 5px;
+    border-right-color: $light_gray;
+  }
+
+  &:after {
+    left: -8px;
+    margin-top: -4px;
+    border-width: 4px;
+    border-right-color: $border;
+  }
+}
+
+/* Reset some styles for the admin toolbar. */
+.drupal-navbar {
+  .icon.handle {
+    margin: 0;
+    padding: 0;
+
+    &:hover {
+      background: none;
+    }
+  }
+}
+
+/* Make the disabled buttons subdued. */
+[disabled] {
+  &,
+  & option,
+  & optgroup {
+    @include opacity(.6);
+    -moz-user-select: -moz-none;
+    -webkit-user-select: none;
+    -khtml-user-select: none;
+    user-select: none;
+    cursor: normal;
+  }
+}
+
+/**
+ * Specialty buttons
+ */
+
+/* Like widget */
+.rate-widget-commons_like {
+  white-space: nowrap;
+}
+
+.rate-commons-like-btn {
+  &:before {
+    @include sprite_url_height_width($icons, like);
+    content: "";
+    margin-top: -2px;
+    margin-bottom: -2px;
+  }
+}
+
+/* Follow buttons */
+[class*="flag-commons-follow-"] {
+  .flag-action {
+    white-space: nowrap;
+
+    &:before {
+      content: "";
+      @include sprite_url_height_width($icons, follow-large);
+    }
+  }
+
+  a.unflag-action {
+    @extend %button-active;
+  }
+
+  .flag-throbber {
+    display: none;
+  }
+
+  .flag-message {
+    display: none !important;
+  }
+}
+
+/* Report as inappropriate */
+.flag-inappropriate-node,
+.flag-inappropriate-comment, {
+  display: block;
+  clear: both;
+  margin: 1em 0 0;
+
+  .flag-action {
+    &:before {
+      content: "";
+      @include sprite_url_height_width($icons, spam);
+    }
+  }
+}
+
+/* ShareThis */
+.sharethis-buttons {
+  position: relative;
+
+  &:before {
+    content: "";
+    @include sprite_url_height_width($icons, share);
+  }
+}
+
+.sharethis-wrapper {
+  position: absolute;
+  left: 0;
+  bottom: 80%;
+  @include opacity(0);
+  visibility: hidden;
+  white-space: nowrap;
+  background: $white;
+  border: 1px solid $green;
+  @include border-radius(2px);
+  padding: $gutter_width;
+  margin-bottom: $gutter_width;
+  @include transition(opacity .3s ease .4s, bottom .3s ease .4s, visibility .3s ease .4s);
+  z-index: 9;
+
+  &:before,
+  &:after {
+    display: block;
+    content: "";
+    width: 0;
+    height: 0;
+    border-style: solid;
+    border-color: transparent;
+    position: absolute;
+    top: 100%;
+    z-index: 10;
+  }
+
+  &:before {
+    border-width: $gutter_width;
+    border-top-color: $green;
+    left: $gutter_width;
+  }
+
+  &:after {
+    border-width: ($gutter_width - 1);
+    border-top-color: $white;
+    left: ($gutter_width + 1);
+  }
+
+  > span {
+    display: inline-block;
+    margin-top: -5px;
+  }
+
+  .sharethis:hover &,
+  .sharethis-buttons:active & {
+    @include opacity(1);
+    visibility: visible;
+    bottom: 100%;
+  }
+
+  .sharethis-buttons:active & {
+    @include transition-delay(0s);
+  }
+}
+
+/* Comments */
+.comment-comments {
+  white-space: nowrap;
+
+  .action-item-small {
+    padding-top: 0;
+    padding-right: 0;
+    padding-bottom: 0;
+
+    &:before {
+      content: "";
+      @include sprite_url_height_width($icons, comments-dark);
+    }
+  }
+
+  .action-item-small-append {
+    margin: -1px -1px -1px 1em;
+    font-size: 1em;
+    // min-height: 1.8em;
+    @include border-top-left-radius(0);
+    @include border-bottom-left-radius(0);
+  }
+}
+
+/* Drupal specific field styling. */
+.field-label-inline {
+  margin: 1.7em 0;
+
+  .field-label,
+  .field-items,
+  .field-item {
+    display: inline;
+    float: none;
+  }
+
+  .field-item {
+    margin: 0 .1em;
+
+    &:first-child {
+      margin-left: 0;
+    }
+
+    &:last-child {
+      margin-right: 0;
+    }
+
+    &:after {
+      content: ", ";
+    }
+
+    &:last-child {
+      &:after {
+        content: "";
+      }
+    }
+  }
+
+  .field-label {
+    font-weight: bold;
+    color: $dark_gray;
+  }
+}
+
+/**
+ * User avatar
+ */
+
+.user-picture-available {
+  position: relative;
+  @include place-picture;
+}
+
+/**
+ * Filter drawer accessories
+ */
+
+.filter-trigger {
+  display: none;
+  background: white;
+  @include box-sizing(border-box);
+  padding: 5px;
+  position: absolute;
+  top: 0;
+  left: -39px;
+  width: 40px;
+  border: 1px solid $border;
+  border-right: none;
+  @include border-radius(3px 0 0 3px);
+  text-align: center;
+  font: 0/0 a;
+  line-height: 0;
+  color: transparent;
+  @include box-shadow(rgba($dark_gray, .4) -1px 1px 2px);
+  cursor: pointer;
+  z-index: 1;
+
+  &:after {
+    content: "\00ab";
+    display: block;
+    font-size: $base-font-size * 2.4;
+    line-height: .8em;
+    padding-bottom: .15em;
+    color: $dark_blue;
+
+    .expanded & {
+      content: "\00bb";
+    }
+  }
+
+  &.following {
+    position: fixed;
+    right: 0;
+    left: auto;
+  }
+}
+
+.filters-processed {
+  &.expanded {
+    .region-inner {
+      position: relative;
+      border: 1px solid $border;
+      border-right: none;
+      z-index: 0;
+      @include box-shadow(rgba($dark_gray, .4) -1px 1px 2px);
+    }
+  }
+}
+
+.filter-overlay {
+  position: fixed;
+  top: 0;
+  left: 0;
+  display: none;
+  width: 100%;
+  height: 100%;
+  overflow: hidden;
+  background: rgba(255, 255, 255, .8);
+}
+
+/**
+ * Aggregator feed source
+ */
+
+#aggregator .feed-source .feed-icon {
+  display: inline;
+  float: none;
+  margin-right: 10px;
+}
+
+.feed-details dt,
+.feed-details dd {
+  display: inline;
+  margin: 0;
+}
+
+/**
+ * Generic styles for the more link
+ */
+
+.more-link {
+  background-image: image-url('icons/icon-more.png');
+  background-repeat: no-repeat;
+  min-height: 14px;
+  padding: 0 0 0 1.7em;
+  float: right;
+  font-size: 0.85em;
+  line-height: 14px;
+  margin-top: 10px;
+
+  a {
+    color:$light_gray;
+  }
+}
+
+/**
+ * Generic styles for links. See the ul.links declaration in node and comment stylesheets
+ */
+
+ul.links {
+  margin: 0;
+  padding: 0;
+
+  &.inline {
+    display: block;
+  }
+
+  li {
+    display: inline-block;
+    list-style: none;
+  }
+}
+
+.quicktabs-style-commons-pills ul.quicktabs-tabs,
+ul.primary.tabs {
+  border-bottom: none;
+  padding: 0;
+
+  li {
+    margin-bottom: 5px;
+    margin-top: 5px;
+
+    a {
+      background-color: $tab_background;
+      @include border-radius(3px);
+      padding: .3em .8em;
+      display: inline-block;
+      border: none;
+
+      &,
+      span {
+        color: $tab_text;
+      }
+
+      &:hover {
+        text-decoration: none;
+        background-color: $tab_background;
+        color: $tab_text_hover;
+      }
+    }
+
+    &.active a {
+      position: relative;
+      background-color: $tab_active_background;
+      border: none;
+
+      &,
+      &:hover {
+        background-color: $tab_active_background;
+      }
+
+      &,
+      span {
+        color: $tab_active_text;
+      }
+
+      &:after {
+        position: absolute;
+        bottom: -.7em;
+        left: 50%;
+        display: block;
+        width: 0;
+        height: 0;
+        overflow: hidden;
+        margin-left: -.6em;
+        content: "";
+        border-width: .4em .6em;
+        border-style: solid;
+        border-color: $tab_active_background transparent transparent;
+      }
+    }
+  }
+}
+
+.quicktabs-style-commons-pills ul.quicktabs-tabs li {
+  text-transform: uppercase;
+  font-size: .8em;
+}
+
+/**
+ * H1 Node title
+ */
+
+h1.node-title {
+  color: $dark_blue;
+  font-size: 20px;
+
+  a {
+    text-decoration: none;
+    color: $dark_blue;
+
+    &:hover {
+      text-decoration: underline;
+    }
+  }
+}
+
+/**
+ * Main wrapper for most blocks, block_system_main does not have it
+ */
+
+.block {
+  margin-bottom: 20px;
+}
+
+.block-title {
+  font-size: 20px;
+  line-height: 1.2em;
+  margin-top: 0;
+  margin-bottom: .4em;
+  color:$gray;
+}
+
+/**
+ * Match item list and block menu margin and padding
+ */
+
+.block-content {
+  ul,
+  ol {
+    padding: 0 0 0 15px;
+  }
+
+  li {
+    margin: 0;
+    padding: 0;
+  }
+}
+
+/* Views exposed form */
+.views-exposed-form {
+  .views-exposed-widget {
+    float: none;
+    padding: 0;
+    margin: 1.7em 0;
+
+    &:first-child {
+      margin-top: 0;
+    }
+
+    &:last-child {
+      margin-bottom: 0;
+    }
+
+    .form-submit {
+      margin-top: 0;
+    }
+  }
+}
+
+.keyword-filter {
+  .views-widget-filter-keys,
+  .views-submit-button {
+    float: left;
+    @include box-sizing(border-box);
+    margin-top: 0;
+  }
+
+  .views-widget-filter-keys {
+    margin-right: -6.5em;
+    margin-bottom: 0;
+    padding-right: 6.75em;
+    width: 100%;
+
+    label {
+      margin-top: 0;
+    }
+
+    @include respond(small-medium) {
+      margin-right: 0;
+      padding-right: 0;
+    }
+  }
+
+  .views-submit-button {
+    padding-top: 2.15em;
+
+    @include respond(small-medium) {
+      margin-top: .5em;
+      padding-top: 0;
+    }
+  }
+}
+
+/* Generic row styles */
+.views-row {
+  border-bottom: 1px solid $border;
+  padding-bottom: .7em;
+  margin-bottom: .7em;
+  position: relative;
+
+  .views-row {
+    margin-top: .4em;
+    margin-bottom: .4em;
+    padding-bottom: 0;
+  }
+
+  & .views-row,
+  &.views-row-last {
+    border-bottom: none;
+  }
+
+  &.views-row-last {
+    padding-bottom: 0;
+    margin-bottom: 0;
+  }
+
+  .view-plain & {
+    border-bottom: none;
+    padding-bottom: 0;
+    margin: .3em 0;
+
+    &:first-child {
+      margin-top: 0;
+    }
+
+    &:last-child {
+      margin-bottom: 0;
+    }
+  }
+}
+
+// Load the post icon styles.
+@import 'post-icons';
+
+/* Titles fields */
+.views-field-title {
+  font-weight: 500;
+  line-height: 1.4em;
+}
+
+/* Meta data */
+.views-field-field-date,
+.views-field-timestamp,
+.views-field-field-location,
+.views-field-capacity-used,
+.views-field-comment-count {
+  font-size: 0.88em;
+}
+
+.views-field-timestamp,
+.views-field-field-location,
+.views-field-capacity-used,
+.views-field-comment-count {
+  color: $light_gray;
+
+  strong {
+    color: $dark_gray;
+  }
+}
+
+.views-field-timestamp,
+.views-field-field-location,
+.views-field-capacity-used,
+.views-field-comment-count {
+  display: inline-block;
+  margin-right: .3em;
+}
+
+/* User picture wrapping and shadow */
+.view-commons-homepage-content,
+.view-commons-activity-streams-activity,
+.view-activity-group,
+.view-commons-activity-streams-user-activity {
+  .content,
+  .message,
+  .views-field-timestamp,
+  .views-field-nothing {
+    @include place-picture(40px);
+  }
+}
+
+.view-activity-group,
+.view-commons-activity-streams-activity,
+.view-commons-activity-streams-user-activity {
+  .views-row {
+    h2 {
+      display: none;
+    }
+
+    .user-picture {
+      top: 5px;
+
+      img {
+        width: 40px;
+      }
+    }
+  }
+}
+
+.page-node {
+  .field-label {
+    color: #369;
+  }
+
+  .field-name-field-topics,
+  .field-name-og-group-ref {
+    margin: 0;
+
+    .field-label {
+      display: block;
+    }
+
+    &.view-mode-full {
+      float: left;
+      width: 50%;
+
+      .field-items {
+        margin: 0;
+        list-style: none;
+        padding: 0;
+
+        .field-item {
+          display: inline-block;
+          margin: 0 .3em;
+          padding: 0;
+
+          &:first-child {
+            margin-left: 0;
+          }
+
+          &:last-child {
+            margin-right: 0;
+          }
+
+          &:after {
+            content: "";
+          }
+        }
+      }
+
+      @include respond(only-small) {
+        float: none;
+        width: auto;
+        margin: 1.7em 0;
+      }
+    }
+  }
+
+  .field-name-field-topics {
+    .field-item:before {
+      content: "";
+      @include sprite_url_height_width($icons, tags);
+      top: -1px;
+    }
+  }
+
+  .field-name-og-group-ref {
+    .field-item:before {
+      content: "";
+      @include sprite_url_height_width($icons, groups);
+      top: -1px;
+    }
+  }
+
+  .node nav {
+    clear: both;
+    margin-top: 20px;
+    position:relative;
+  }
+}
+
+#comments {
+  margin: 0;
+
+  .form-item-subject input {
+    width: 100%;
+  }
+
+  .rate-widget-commons_like {
+    position: absolute;
+    right: 5px;
+    top: 15px;
+  }
+}
+
+.comments-title,
+.comment-form-title {
+  margin-top: 0;
+  font-size: 2.2em;
+  line-height: 1.2em;
+  color: $dark_gray;
+}
+
+.comments-title {
+  &:before {
+    content: "";
+    @include sprite_url_height_width($icons, comments-large);
+  }
+}
+
+.comment-form {
+  margin-bottom: 0;
+  &:before {
+    display: none;
+  }
+}
+
+.comment {
+  @include place-picture;
+  border-bottom: 1px solid $lighter_gray;
+  padding-bottom: 20px;
+  position: relative;
+
+  .author-datetime {
+    margin-bottom: 1.4em;
+  }
+}
+
+.comment-title,
+.comment .author-datetime {
+  margin-right: 90px;
+}
+
+.comment-title {
+  margin-bottom: .2em;
+}
+
+ul.comment-links {
+  margin: .7em 0;
+
+  li {
+    padding-left: 0;
+  }
+}
+
+.comment-reply {
+  float: right;
+
+  &:before {
+    content: "";
+    @include sprite_url_height_width($icons, comments);
+    margin-right: 8px;
+    top: 3px;
+  }
+}
+
+.comment-form {
+  .form-actions {
+    margin-bottom: 0;
+  }
+}
+
+.primary-fields,
+.supplementary-fields {
+  @include inline-block;
+  @include box-sizing(border-box);
+  float: left;
+
+  .view-commons-question-answers & {
+    display: block;
+    float: none;
+    width: auto;
+    padding: 0;
+  }
+}
+
+.primary-fields {
+  padding-right: $gutter-width;
+  width: 66.666%;
+}
+
+.supplementary-fields {
+  padding-left: $gutter-width;
+  width: 33.333%;
+}
+
+.form-actions {
+  clear: both;
+}
+
+/* Format the date range form items. */
+.start-date-wrapper,
+.end-date-wrapper {
+  clear: none;
+  width: auto;
+  max-width: 49%;
+
+  &,
+  input,
+  .form-item .form-type-textfield,
+  .date-padding,
+  .form-type-textfield {
+    float: none;
+    display: inline-block;
+    min-width: inherit;
+  }
+
+  .form-item {
+    input {
+      margin-right: auto;
+    }
+  }
+
+  .form-type-textfield {
+    max-width: 60%;
+
+    &:last-child {
+      max-width: 30%;
+    }
+  }
+
+  .form-type-date-popup {
+    margin: 0;
+  }
+
+  @include respond(small-medium) {
+    display: block;
+    max-width: inherit;
+    margin: $gutter-width auto;
+  }
+}
+
+.addressfield-container-inline {
+  > div.form-item {
+    display: inline-block;
+    float: none;
+  }
+
+  input[type="text"] {
+    width: auto;
+  }
+
+  &:after {
+    content: "";
+    clear: none;
+    display: none;
+  }
+}
+
+.logo-available {
+  .field-name-field-date,
+  .field-name-field-address,
+  .field-name-field-offsite-url {
+    margin-left: 65px;
+
+    @include respond(only-small) {
+      margin-left: 0;
+    }
+  }
+}
+
+.field-name-field-logo {
+  float: left;
+  width: 70px;
+  margin: .5em 0 0 -70px;
+  position: relative;
+  left: 70px;
+
+  img {
+    display: block;
+    @include box-sizing(border-box);
+    margin-bottom: 1.7em;
+    padding: 4px;
+    @include border-radius(3px);
+    @include box-shadow($light_gray 1px 1px 4px);
+    background: $white;
+  }
+
+  @include respond(only-small) {
+    display: none;
+  }
+}
+
+.field-name-body {
+  margin-top: 1.7em;
+
+  .node-event & {
+    clear: both;
+  }
+}
+
+.field-name-field-date {
+  font-weight: bold;
+}
+
+.adr {
+  .region {
+    &,
+    .node-type-event &,
+    .panel-display .region & {
+      float: none;
+      padding: 0;
+    }
+  }
+}
+
+ul.node-action-links {
+  display: inline-block;
+  margin-top: 1.4em;
+
+  li {
+    padding: 0;
+    vertical-align: baseline;
+  }
+
+  li,
+  a {
+    margin: 0;
+  }
+}
+
+.view-commons-contributors-group {
+  .views-field-picture {
+    margin: 0 0 10px;
+    position: static;
+    line-height:0;
+
+    img {
+      width:40px;
+    }
+  }
+
+  td {
+    padding: 0;
+  }
+
+  tbody tr {
+    background-color: transparent;
+  }
+}
+
+/**
+ * Author/Submit line
+ */
+
+.author-datetime {
+  color:$light_gray;
+  font-size:0.88em;
+}
+
+.node-content-type {
+  color: $dark_gray;
+}
+
+/**
+ * Featured/New Tags
+ */
+
+.tag.featured {
+  width: 58px;
+  height: 22px;
+  display: inline-block;
+  background: {
+    image: image-url('tag-featured.png');
+    repeat: no-repeat;
+  }
+  margin: 6px 0 0 5px;
+}
+
+.tag.new {
+  width: 27px;
+  height: 22px;
+  display: inline-block;
+  background: {
+    image: image-url('tag-new.png');
+    repeat: no-repeat;
+  }
+  margin: 4px 0 0 5px;
+}
+
+/**
+ * User profile
+ */
+
+.page-user {
+  .panel-display {
+    .region-three-33-top {
+      padding-left: 120px + $gutter_width * 3;
+
+      @include respond(only-small) {
+        padding-left: $gutter_width;
+      }
+
+      /* This feels hackish, but it is only for administrating the layout of the
+         page. It is still not ideal as it is inflexible and only works with the
+         current core functionality of commons. */
+      .panels-ipe-portlet-wrapper {
+        &:nth-last-child(-n+5) {
+          display: inline-block;
+        }
+      }
+    }
+  }
+
+  .pane-user-picture {
+    float: left;
+    margin-left: -(120px + $gutter_width * 2);
+
+    .user-picture {
+      background: $white;
+      margin-left: 0;
+      padding: 10px;
+      position: static;
+      @include border-radius(6px);
+      @include box-shadow($light_gray 1px 1px 4px);
+
+      img {
+        display: block;
+      }
+    }
+
+    @include respond(only-small) {
+      float: none;
+      margin-left: 0;
+      text-align: center;
+    }
+  }
+
+  .pane-user-field-facebook-url,
+  .pane-user-field-linkedin-url,
+  .pane-user-field-twitter-url,
+  .pane-user-group-group,
+  .pane-user-flag-commons-follow-user-link {
+    &,
+    a {
+      display: inline-block;
+    }
+  }
+
+  .pane-user-field-facebook-url,
+  .pane-user-field-linkedin-url,
+  .pane-user-field-twitter-url {
+    a {
+      margin-right: 1em;
+
+      &:before {
+        content: "";
+        display: inline-block;
+        vertical-align: middle;
+      }
+    }
+
+    @include respond(only-small) {
+      a {
+        text-indent: 100%;
+        white-space: nowrap;
+        overflow: hidden;
+      }
+
+      a {
+        &:before {
+          content: normal;
+        }
+      }
+    }
+
+    @include respond(only-medium) {
+      display: block;
+    }
+  }
+
+  .pane-user-field-facebook-url {
+    a {
+      &:before {
+        @include sprite_url_height_width($icons, facebook);
+      }
+    }
+
+    @include respond(only-small) {
+      a {
+        @include sprite_url_height_width($icons, facebook);
+      }
+    }
+  }
+
+  .pane-user-field-linkedin-url {
+    a {
+      &:before {
+        @include sprite_url_height_width($icons, linkedin);
+      }
+    }
+
+    @include respond(only-small) {
+      a {
+        @include sprite_url_height_width($icons, linkedin);
+      }
+    }
+  }
+
+  .pane-user-field-twitter-url {
+    a {
+      &:before {
+        @include sprite_url_height_width($icons, twitter);
+      }
+    }
+
+    @include respond(only-small) {
+      a {
+        @include sprite_url_height_width($icons, twitter);
+      }
+    }
+  }
+
+  .pane-user-flag-commons-follow-user-link {
+    clear: both;
+  }
+
+  .pane-views-panes {
+    @extend %pod;
+
+    .block-inner {
+      @extend %pod-content;
+    }
+  }
+}
+
+/**
+ * Group nodes
+ */
+
+.pane-node-commons-groups-group-contributors-count-topics {
+  display: inline-block;
+  margin: 0;
+}
+
+.node-group {
+  .field-name-body {
+    margin-top: 1.4em;
+  }
+
+  .pane-node-flag-commons-follow-group-link {
+    display: inline-block;
+    position: absolute;
+    top: .5em;
+    right: 0;
+    margin: 0;
+
+    @include respond(small-medium) {
+      position: static;
+      top: auto;
+      right: auto;
+    }
+  }
+}
+
+.group-recent-data {
+  display: inlline-block;
+  float: left;
+  @include box-sizing(border-box);
+  width: 48%;
+  margin-bottom: 0;
+  margin-right: 4%;
+
+  @include respond(small-medium) {
+    float: none;
+    width: auto;
+    margin-bottom: 1.7em;
+
+    &:last-child {
+      margin-bottom: 0;
+    }
+  }
+}
+
+.group-recent-data-odd {
+  margin-right: 0;
+}
+
+/* =============================================================================
+ *   Regions
+ * ========================================================================== */
+
+/**
+ * Header region, embedded in the #header
+ */
+
+.region-header {
+  display: inline-block;
+  text-align: left;
+  width: 19.3em;
+
+  @include respond(small-medium) {
+    width: auto;
+    position: absolute;
+    right: $gutter_width;
+    top: -1.5em;
+  }
+}
+
+/* =============================================================================
+ *   Links
+ * ========================================================================== */
+
+a {
+  text-decoration: none;
+  color: $light_blue;
+
+  &:hover,
+  &:focus {
+    text-decoration: underline;
+  }
+}
+
+/* =============================================================================
+ *   Primary, Secondary and Menu Bar region menus
+ * ========================================================================== */
+
+#primary-menu-bar {
+  display: inline-block;
+}
+
+/**
+ * Use one of the following id's for granular control:
+ *  - #menu-bar (menu bar region)
+ *  - #primary-menu (main menu)
+ *  - #secondary-menu (secondary/user menu)
+ * You can target all of these with .nav or div[id$="menu-bar"]
+ */
+
+#menu-bar.nav {
+  display: inline-block;
+  vertical-align: top;
+  margin: 0 0 -9999em;
+  padding-bottom: 9999em;
+  @extend %divider-right;
+
+  h3.block-title {
+    display: none;
+  }
+
+  ul.menu {
+    margin: 0;
+    padding: 0;
+  }
+
+  ul.menu li {
+    display: inline-block;
+    float: left;
+    list-style: none;
+    margin: 0;
+    padding: 0;
+
+    &:hover,
+    &.active-trail {
+      background: image-url('main-nav-hover.png') repeat-x left top;
+      .arrow {
+        &:before {
+          content: "";
+          display: block;
+          position: absolute;
+          bottom: 0px;
+          left: 0px;
+          width: 0px;
+          height: 0px;
+          border-style: solid;
+          border-width: 0 7px 8px 7px;
+          border-color: transparent transparent lighten($light_blue, 10%) transparent;
+        }
+
+        &:after {
+          content: "";
+          display: block;
+          position: absolute;
+          bottom: 0px;
+          left: 1px;
+          width: 0px;
+          height: 0px;
+          border-style: solid;
+          border-width: 0 6px 6px 6px;
+          border-color: transparent transparent $light_blue transparent;
+        }
+      }
+    }
+  }
+
+  ul.menu li a {
+    position: relative;
+    z-index: 1;
+    @include box-sizing(border-box);
+    display: block;
+    white-space: nowrap;
+    margin-bottom: -9998em;
+    padding: px-to-em(31px) px-to-em(13em) 9999em;
+    height: px-to-em(64px);
+    text-transform: uppercase;
+    @include text-shadow(#000 1px 1px 4px);
+    background-position: center 10px;
+    background-repeat: no-repeat;
+    position: relative;
+    @extend %divider-left;
+
+    &:hover,
+    &:focus {
+      text-decoration: none;
+    }
+
+    .arrow {
+      width: 17px;
+      height: 9px;
+      position: absolute;
+      left: 50%;
+      bottom: -1px;
+      margin: 0 0 0 -8px;
+    }
+  }
+
+  .block {
+    margin: 0;
+  }
+
+  @include respond(only-small) {
+    border-right: 0;
+    @include box-shadow(#4082A7 0px 0px 0px);
+
+    ul.menu li {
+      a {
+        font: 0/0 a;
+        width: 40px;
+        height: 50px;
+      }
+    }
+  }
+
+  @include respond(only-medium) {
+    border-right: none;
+
+    ul.menu li {
+      a {
+        padding-right: px-to-em(7px);
+        padding-left: px-to-em(7px);
+      }
+    }
+  }
+}
+
+.main-menu-home a {
+  background: image-url('icons/icon-home.png') no-repeat center 10px;
+}
+
+.main-menu-groups a {
+  background: image-url('icons/icon-groups.png') no-repeat center 10px;
+}
+
+.main-menu-events a {
+  background: image-url('icons/icon-events.png') no-repeat center 10px;
+}
+
+.main-menu-people a {
+  background: image-url('icons/icon-people.png') no-repeat center 10px;
+}
+
+#menu-bar.nav ul.menu li.main-menu-search {
+  display: none;
+
+  a {
+    background: image-url('icons/icon-search.png') no-repeat center 10px;
+  }
+
+  @include respond(small-medium) {
+    display: inline-block;
+  }
+}
+
+#block-commons-utility-links-commons-utility-links {
+  margin: 0;
+
+  .block-inner {
+    margin: 0;
+  }
+}
+
+ul.commons-utility-links {
+  list-style: none;
+  text-align: right;
+  margin: .2em 0;
+  padding: 0;
+  font-size: .875em;
+  line-height: 1;
+
+  .block-content & {
+    padding: 0;
+  }
+
+  li {
+    display: inline-block;
+
+    &.first {
+      .logged-in & {
+        margin-right: 17px;
+        font-weight: bold;
+      }
+    }
+
+    &.last {
+      border-left: 1px solid $light_blue;
+      margin-left: 9px;
+
+      a {
+        margin-left: 9px;
+      }
+    }
+  }
+}
+
+.unread-invitations {
+  a {
+    @include sprite_url_height_width($icons, icon-person);
+  }
+}
+
+.unread-messages,
+.no-unread-messages {
+  a {
+    @include sprite_url_height_width($icons, icon-envelope);
+  }
+}
+
+.unread-invitations,
+.unread-messages,
+.no-unread-messages {
+  a {
+    position: relative;
+    top: .3em;
+    display: inline-block;
+    margin-top: -.2em;
+    margin-right: .8em;
+  }
+}
+
+.no-unread-messages {
+  a {
+    top: -.1em;
+    margin-top: 0;
+    text-indent: 100%;
+    white-space: nowrap;
+    overflow: hidden;
+    @include opacity(.4);
+  }
+}
+
+.notification-count {
+  position: absolute;
+  top: -.2em;
+  right: -.6em;
+  display: inline-block;
+  padding: 0 .2em;
+  font-size: .88em;
+  @include border-radius(.4em);
+  @include box-shadow(0 0 2px $light_blue);
+  background: $green;
+  @include background(linear-gradient($green, darken($green, 20)));
+}
+
+/* =============================================================================
+ *   Superfish
+ * ========================================================================== */
+
+ul.sf-menu {
+  margin-bottom: 0;
+
+  a {
+    border-left: 0;
+    border-top: 0;
+    padding: 0 10px;
+    text-decoration: none;
+    height: 2.5em;
+    line-height: 2.5em;
+  }
+
+  li {
+    &:hover,
+    &.sfHover {
+      outline: 0;
+    }
+  }
+
+  a {
+    &:focus,
+    &:hover,
+    &:active {
+      outline: 0;
+    }
+  }
+}
+
+/**
+ * Superfish blocks
+ */
+
+.block-superfish {
+  ul {
+    margin: 0 !important;
+    padding: 0 !important;
+  }
+
+  li {
+    margin: 0 !important;
+    padding: 0 !important;
+  }
+}
+
+/**
+ * Vertical style
+ */
+
+.sf-vertical {
+  width: 100%;
+
+  li {
+    width: 100%;
+
+    &:hover ul,
+    &.sfHover ul {
+      left: 100%;
+      top: 0;
+      margin: 0;
+      padding: 0;
+    }
+
+    a {
+      padding: 0 10px;
+    }
+  }
+}
+
+/**
+ * Navbar style
+ */
+
+.sf-navbar {
+  padding-bottom: 0 !important;
+}
+
+/**
+ * Sensible padding for the default style
+ */
+
+.sf-menu.sf-style-default a {
+  padding: 0 10px;
+}
+
+/* =============================================================================
+ *   Menus, usually blocks
+ * ========================================================================== */
+
+ul.menu {
+  padding-left: 15px;
+
+  ul {
+    padding-left: 15px;
+
+    li {
+      margin: 0;
+    }
+  }
+}
+
+/* If li.content exists it's a problem, so reset the padding */
+.block .menu li.content {
+  padding: 0;
+}
+
+/* =============================================================================
+ *   Book navigation menu
+ * ========================================================================== */
+
+.book-navigation {
+  .page-up {
+    /* Prevent text wrapping to a new line, assumes English "up" is used (two characters) */
+    min-width: 2em;
+    white-space: nowrap;
+  }
+
+  .menu {
+    margin-left: 0;
+  }
+}
+
+/* =============================================================================
+ *   Breadcrumbs
+ * ========================================================================== */
+
+#breadcrumb {
+  margin: 10px 0;
+
+  /* If the label is set to show in theme settings the label class is added */
+  .breadcrumb-label {
+    font-size: 1em;
+    display: inline;
+    padding-right: 10px;
+
+    &:after {
+      content: ":";
+    }
+  }
+
+  ol {
+    margin: 0;
+    padding: 0;
+  }
+
+  .with-breadcrumb-label ol {
+    display: inline;
+  }
+
+  li {
+    list-style: none;
+    display: inline;
+  }
+}
+
+/* =============================================================================
+ *   Pagers
+ * ========================================================================== */
+
+ul.pager {
+  clear: both;
+  margin: 0;
+  text-align: center;
+}
+
+.item-list ul.pager li {
+  margin: 0;
+}
+
+ul.pager li {
+  background-image: none;
+  display: inline;
+  list-style-type: none;
+  padding: .5em;
+
+  &.pager-current {
+    font-weight: 700;
+  }
+}
+
+.block ul.pager li {
+  margin: 0;
+}
+
+/* =============================================================================
+ *   Skip Navigation
+ * ========================================================================== */
+
+#skip-link {
+  left: 50%;
+  margin-left: -6.5em;
+  margin-top: 0;
+  padding: 0 0.5em;
+  position: absolute;
+  width: 12em;
+  z-index: 50;
+
+  a {
+    background: #444;
+    background: rgba(0, 0, 0, 0.6);
+    color: $page;
+    display: block;
+    line-height: 2;
+    padding: 0;
+    text-align: center;
+    text-decoration: none;
+
+    &:link,
+    &:visited {
+      background: #444;
+      background: rgba(0, 0, 0, 0.6);
+      color: $page;
+      display: block;
+      line-height: 2;
+      padding: 0;
+      text-align: center;
+      text-decoration: none;
+    }
+    &:hover,
+    &:focus,
+    &:active {
+      outline: 0;
+    }
+  }
+}
+
+/* =============================================================================
+ *   Tabs (local tasks)
+ * ========================================================================== */
+
+#tasks {
+  margin-bottom: 15px;
+}
+
+ul.primary {
+  border-bottom-color: $border;
+  margin: 20px 0;
+  padding: 0 0 0 5px;
+
+  li {
+    display: block;
+    float: left;
+    margin: 0 1px -1px;
+
+    a {
+      background-color: $ultralight;
+      border-color: $border;
+      margin-right: 1px;
+      padding: 0 10px;
+      display: block;
+      float: left;
+      height: 1.5em;
+      line-height: 1.5em;
+
+      &:hover,
+      &:focus {
+        background-color: $light;
+        border-color: $border;
+      }
+    }
+  }
+
+  li.active {
+    a,
+    a:hover,
+    a:focus {
+      background-color: $page;
+      border-bottom-color: $page;
+    }
+  }
+}
+
+ul.secondary {
+  border-bottom: 1px solid $border;
+  margin: 1em 0 0;
+  padding: 0 .3em 1em;
+
+  li {
+    border-right: 0;
+    list-style: none;
+    padding: 0 10px 0 0;
+
+    a {
+      &:hover,
+      &.active {
+        border-bottom: none;
+        text-decoration: underline;
+      }
+    }
+  }
+}
+
+/* =============================================================================
+ *   Action links
+ * ========================================================================== */
+
+ul.action-links {
+  margin: 20px 0 0;
+  list-style: none;
+}
+
+/* =============================================================================
+ *  Field Styling
+ * ========================================================================== */
+
+/**
+ * Labels are h2 in Adaptivetheme. Use a strong selector to mitigate unwanted ineritance issues
+ */
+
+.field-label {
+  font-size: 1em;
+  font-weight: 700;
+  font-family: inherit;
+  line-height: inherit;
+  margin-bottom: 0;
+}
+
+/**
+ * Taxonomy
+ */
+
+.field-type-taxonomy-term-reference {
+  /* The same bottom margin as p, blockquote, ul, ol and dl */
+  margin-bottom: 1.5em;
+
+  &.field-label-inline .field-items {
+    margin: 0;
+    padding: 0;
+  }
+
+  &.field-label-inline .field-item {
+    display: inline;
+    list-style: none;
+    padding: 0 10px 0 0;
+  }
+}
+
+/**
+ * Float left setting
+ */
+
+.ia-l .field-type-image figure,
+.iat-l .field-type-image figure {
+  margin: 5px 20px 15px 0;
+}
+
+/**
+ * Centered setting
+ */
+
+.ia-c .field-type-image figure,
+.iat-c .field-type-image figure {
+  margin: 5px auto 15px;
+}
+
+/**
+ * Float right setting
+ */
+
+.ia-r .field-type-image figure,
+.iat-r .field-type-image figure {
+  margin: 5px 0 15px 20px;
+}
+
+/* =============================================================================
+ *   Panels Styling
+ * ========================================================================== */
+
+.node-title,
+.pane-title {
+  font-weight: normal;
+  font-size: 1.6em;
+}
+
+.panel-display {
+  min-width: 100%;
+  margin-right: -$gutter-width;
+  margin-left: -$gutter-width;
+
+  .region {
+    @include box-sizing(border-box);
+    padding-right: $gutter-width;
+    padding-left: $gutter-width;
+  }
+}
+
+.commons-sign-up,
+.commons-login {
+  @extend %button-common;
+  @extend %button-small-layout;
+}
+
+.commons-sign-up {
+  @extend %button-primary;
+}
+
+.commons-login {
+  @extend %button-default;
+}
+
+.pane-views-panes,
+.pane-views,
+body.page-node .pane-views-panes {
+  .front.not-logged-in & {
+    @extend %pod;
+
+    > div {
+      @extend %pod-content;
+    }
+  }
+}
+
+.nodes {
+  margin-top: 1em;
+}
+
+.page-events {
+  .view-commons-events-upcoming {
+    .view-content {
+      @extend %pod;
+      @extend %pod-content;
+    }
+  }
+}
+
+.pane-commons-featured-panel-pane-1,
+.pane-commons-events-upcoming {
+  .block-inner {
+    margin: 0;
+
+    .views-row-last {
+      border-bottom: none;
+    }
+  }
+}
+
+.pane-commons-bw-group {
+  @extend %pod;
+
+  > .block-inner {
+    @extend %pod-content;
+  }
+}
+
+.node-type-group {
+  .node-teaser {
+    position: relative;
+  }
+
+  &.page-node {
+    .pane-node-content {
+      > .block-inner {
+        padding: 0;
+        margin: 0;
+      }
+
+      figure {
+        float: left;
+        margin: 3px 10px 5px 0;
+        background: $white;
+        padding: 4px;
+        @include border-radius(3px);
+        @include box-shadow($light_gray 1px 1px 4px);
+        position: relative;
+        display: block;
+        line-height: 0;
+      }
+    }
+
+    .node-content {
+      margin-left: 0;
+    }
+  }
+}
+
+.pane-commons-groups-directory-panel-pane-1 {
+  background-color: transparent;
+  @include border-radius(0px);
+  @include box-shadow(none);
+  margin-right: 0;
+  margin-bottom: 0;
+}
+
+.page-groups {
+  .region-two-66-33-top {
+    position: relative;
+  }
+}
+
+.pane-commons-groups-commons-groups-create-group {
+  position: absolute;
+  top: -4em;
+  right: $gutter-width;
+  text-align: right;
+
+  @include respond(only-small) {
+    position: static;
+    top: auto;
+    right: auto;
+  }
+
+  a {
+    @extend %button-common;
+    @extend %button-default-layout;
+    @extend %button-primary;
+    margin: 0;
+
+    &:before {
+      @include sprite_url_height_width($icons, icon-groups-small);
+      content: "";
+      top: 3px;
+    }
+
+    @include respond(only-small) {
+      float: none;
+      display: block;
+    }
+  }
+}
+
+/* =============================================================================
+ *   Views Styling
+ * ========================================================================== */
+
+.view-display-id-commons_events_upcoming_page .views-row {
+  @extend %pod;
+
+  article {
+    @extend %pod-content;
+
+    .commons-events-form-float {
+      float: right;
+      margin: -40px 0 0 0;
+    }
+  }
+}
+
+.views-view-grid {
+  border: none;
+  margin: 0;
+
+  tbody {
+    tr {
+      border-top: none;
+      background: none;
+    }
+  }
+
+  td {
+    padding: $gutter-width / 2;
+  }
+}
+
+.grid-grouping-title {
+  font-size: 1em;
+  color: $light_gray;
+  margin-bottom: $gutter-width;
+}
+
+.pager a {
+  // The li parent will handle spacing.
+  margin: 0;
+  // We do not need as much horizontal space on these items.
+  padding-right: .75em;
+  padding-left: .75em;
+}
+
+.view-commons-groups-directory,
+.view-commons-homepage-content .node-teaser.node-group {
+  > .view-content > .views-row {
+    @extend %pod;
+    position: relative;
+
+    > .node-teaser,
+    form {
+      @extend %pod-content;
+    }
+  }
+
+  .pane-node-body {
+    margin-bottom: 0;
+  }
+}
+
+.pane-node-field-group-logo {
+  float: left;
+  margin: 0 $gutter-width $gutter-width 0;
+
+  .field-name-field-group-logo a {
+    display: block;
+    border: 3px solid $white;
+    @include border-radius(2px);
+    box-shadow: 1px 1px 3px $gray;
+
+    img {
+      display: block;
+    }
+  }
+}
+
+.pane-commons-contributors-group-panel-pane-1 {
+  table, tbody {
+    margin: 0;
+    border: none;
+  }
+
+  tbody tr {
+    background-color: transparent;
+    border: none;
+  }
+
+  td {
+    padding: 0;
+    margin: 0 1px 1px 0;
+    float: left;
+    line-height: 0;
+
+    a {
+      position: relative;
+      display: block;
+
+      img {
+        @include opacity(0.5);
+      }
+
+      span {
+        display: none;
+        position: absolute;
+        top: -100%;
+        background-color: rgba(#000, 0.85);
+        white-space: nowrap;
+        font-size: 14px;
+        line-height: 14px;
+        font-weight: bold;
+        padding: 5px 8px;
+        color: $white;
+        @include border-radius(4px);
+        z-index: 15;
+
+        &:after {
+          content: "";
+          display: block;
+          width: 0px;
+          height: 0px;
+          border-style: solid;
+          border-width: 5px 5px 0 5px;
+          border-color: rgba(#000, 0.85) transparent transparent transparent;
+          position: absolute;
+          left: 10px;
+          top: 100%;
+        }
+      }
+
+      &:hover {
+        img {
+          @include opacity(1);
+        }
+
+        span {
+          display: block;
+        }
+      }
+    }
+  }
+}
+
+.region-two-66-33-second .view-commons-contributors-group {
+  table,
+  tbody {
+    margin: 0;
+    border: none;
+  }
+
+  tbody tr {
+    background-color: transparent;
+    border: none;
+  }
+
+  td {
+    padding: 0;
+    line-height: 0;
+
+    &.col-last a {
+      margin-right: 0;
+    }
+
+    .user-picture {
+      margin-bottom: 10px;
+
+      img {
+        width: 40px;
+      }
+    }
+  }
+}
+
+#views-exposed-form-commons-bw-all-page-1 {
+  .views-submit-button {
+    margin-left: 20px;
+  }
+
+  .views-exposed-widget {
+    padding: 0;
+
+    .form-submit {
+      margin-top: 0;
+    }
+  }
+}
+
+.pane-node-commons-groups-group-contributors-count-topics {
+  font-size: 11px;
+}
+
+.dynamic-filter-lists {
+  .views-exposed-widget,
+  .views-widget,
+  label,
+  .form-select-wrapper {
+    display: inline-block;
+    line-height: 1.7em;
+    vertical-align: baseline;
+    white-space: nowrap;
+    // height: 1.7em;
+    // overflow: hidden;
+  }
+
+  .views-exposed-widget {
+    margin-top: 0;
+    margin-bottom: 0;
+    padding: 0;
+
+    label {
+      font-weight: normal;
+      color: $light_gray;
+      margin: 0;
+    }
+  }
+
+  .views-submit-button {
+    position: absolute;
+    visibility: hidden;
+    padding: 0;
+    height: auto;
+
+    .form-submit {
+      margin-top: 0;
+    }
+  }
+}
+
+.widget-changed {
+  .views-submit-button {
+    position: static;
+    visibility: visible;
+  }
+}
+
+.commons-bw-create-choose {
+  cursor: pointer;
+
+  span {
+    @include sprite_url_height_width($icons, ico_arrow_wht);
+    margin-right: 0;
+  }
+}
+
+.commons-bw-create-choose-bg {
+  position: fixed;
+  display: none;
+  top: 0;
+  left: 0;
+  width: 100%;
+  height: 100%;
+  background: rgba(#fff, 0.7);
+  z-index: 10;
+
+  .create-choose-open & {
+    display: block;
+  }
+}
+
+.commons-bw-create-choose-holder {
+  position: relative;
+}
+
+.commons-bw-create-all-widget-types {
+  position: absolute;
+  display: none;
+  left: -50px;
+  top: -50px;
+  z-index: 11;
+  width: 210px;
+  background: $white;
+  border: 1px solid $green;
+  @include border-radius(6px);
+  list-style: none;
+
+  .block-content &,
+  .item-list & {
+    margin: 0;
+    padding: 0;
+  }
+
+  li {
+    border-bottom: 1px solid lighten($light_gray, 20%);
+    position: relative;
+    font-size: 0.85em;
+    color: $light_gray;
+
+    .last {
+      border-bottom: none;
+    }
+
+    .item-list & {
+      margin: 0;
+      padding: 10px 10px 10px 27px;
+    }
+
+    .commons-polls-create:before {
+      @include sprite_url_height_width($icons, polls);
+      content: "";
+      position: absolute;
+      left: 10px;
+      top: 13px;
+    }
+
+    .commons-posts-create:before {
+      @include sprite_url_height_width($icons, posts);
+      content: "";
+      position: absolute;
+      left: 10px;
+      top: 13px;
+    }
+
+    .commons-wikis-create:before {
+      @include sprite_url_height_width($icons, wikis);
+      content: "";
+      position: absolute;
+      left: 10px;
+      top: 13px;
+    }
+
+    .commons-events-create:before {
+      @include sprite_url_height_width($icons, events);
+      content: "";
+      position: absolute;
+      left: 10px;
+      top: 13px;
+    }
+
+    .commons-q-a-create:before {
+      @include sprite_url_height_width($icons, qa);
+      content: "";
+      position: absolute;
+      left: 10px;
+      top: 13px;
+    }
+
+    a {
+      display: block;
+      color: $green;
+      font-size: 1.3em;
+    }
+  }
+
+  .create-choose-open & {
+    display: block;
+  }
+}
+
+#quicktabs-container-commons_bw {
+  .quicktabs-tabpage {
+    .view-filters,
+    .attachment-before {
+      display: block;
+      clear: both;
+      vertical-align: top;
+      margin-bottom: 1.7em;
+      padding: .5em .6em;
+      font-size: .88em;
+      @include border-radius(2px);
+      background: $ultralight;
+    }
+
+    .views-exposed-widgets {
+      margin-bottom: 0;
+    }
+
+    .views-exposed-widget {
+      margin-right: 1.7em;
+    }
+
+    .views-widget-sort-order {
+      display: none;
+    }
+
+    .view-content,
+    .view-empty {
+      clear: both;
+    }
+
+    .views-submit-button {
+      margin-right: 0;
+    }
+
+    .form-submit {
+      margin-top: 0;
+      margin-bottom: .1em;
+    }
+
+    .hidden {
+      display: none;
+    }
+  }
+}
+
+.quicktabs-style-commons-pills {
+  ul.quicktabs-tabs {
+    margin-bottom: 1.7em;
+  }
+}
+
+.commons-bw-partial-node-form {
+  margin-bottom: 1.7em;
+  padding-left: 68px;
+
+  &.compact-form {
+    .form-item {
+      margin: 0;
+    }
+
+    textarea {
+      resize: none;
+    }
+  }
+
+  .user-picture {
+    margin-top: 2.6em;
+  }
+
+  @include respond(only-small) {
+    padding-left: 0;
+
+    .user-picture {
+      display: none;
+    }
+  }
+
+  .field-type-image {
+    margin-top: 1.7em;
+  }
+
+  .field-name-og-group-ref {
+    .fieldset-outer-wrapper {
+      margin-top: 1.7em;
+      margin-bottom: 1.7em;
+      padding-top: 1.7em;
+      border-top: 1px solid $border;
+    }
+  }
+}
+
+.partial-node-form-title {
+  margin-top: 0;
+  margin-bottom: .2em;
+  margin-left: -68px;
+  color: rgb(70, 187, 46);
+
+  @include respond(only-small) {
+    margin-left: 0;
+  }
+}
+
+.trigger-field {
+  &,
+  .form-item {
+    margin-top: 0;
+  }
+
+  input,
+  textarea {
+    .compact-form & {
+      height: 2.2em;
+      overflow: hidden;
+    }
+  }
+}
+
+.expandable-form-toggle {
+  float: right;
+  position: absolute;
+  top: 0;
+  right: 0;
+  margin-top: .6em;
+  overflow: hidden;
+
+  &,
+  &:before {
+    width: 1.4em;
+    height: 1.4em;
+    text-align: center;
+  }
+
+  .expanded-form & {
+    display: block;
+
+    &:before {
+      content: 'x';
+      display: block;
+    }
+  }
+
+  &:hover {
+    text-decoration: none;
+  }
+}
+
+.full-form {
+  .compact-form & {
+    float: right;
+    margin-top: .5em;
+
+    &:after {
+      content: '\2192';
+      display: inline-block;
+      margin-left: .2em;
+    }
+  }
+}
+
+/* =============================================================================
+ *   Block Styling
+ * ========================================================================== */
+
+/**
+ * "Search form" block
+ */
+
+.block-search {
+  display: block;
+  background-color: darken($dark_blue, 12%); // Old browsers
+  @include background-image(linear-gradient(top,  darken($dark_blue, 12%) 0%,darken($dark_blue, 6%)100%));
+  @include border-radius(4px);
+  box-shadow: 1px 1px 2px #000 inset, 2px 3px 3px rgba(#fff, 0.09);
+  height: 30px;
+  margin: 0 0 0 $gutter_width;
+  position: relative;
+
+  .container-inline {
+    label,
+    div {
+      float: left;
+      display: block;
+      margin-top: 0;
+      margin-bottom: 0;
+    }
+
+    .form-item-custom-search-types {
+      position: relative;
+      z-index: 2;
+      display: inline-block;
+      width: 5.5em;
+      margin: .3em 0 .3em -5.8em;
+      padding-left: .3em;
+      left: 5.8em;
+
+      .select-status {
+        &:after {
+          border-top-color: $white;
+        }
+      }
+    }
+  }
+
+  .block-inner {
+    margin-left: 0;
+    margin-right: 0;
+  }
+
+  .form-item-search-block-form {
+    position: relative;
+    z-index: 1;
+    @include box-sizing(border-box);
+    width: 100%;
+    padding-right: 1.5em;
+    padding-left: 5.8em;
+  }
+
+  .form-text {
+    width: 12em;
+    max-width: 100%;
+    color: $white;
+    background: transparent;
+    border: none;
+
+    &:focus {
+      @include box-shadow(none);
+    }
+  }
+
+  .form-actions {
+    position: absolute;
+    right: 1em;
+  }
+
+  .form-actions,
+  .form-submit {
+    @include box-sizing(border-box);
+    width: 1.4em;
+    height: 1.4em;
+  }
+
+  .form-submit {
+    text-indent: -9999em;
+
+    &,
+    &:hover {
+      background: transparent image-url('icons/ico_search_wht.png') no-repeat center center;
+      border: none;
+    }
+  }
+
+  @include respond(small-medium) {
+    display: none;
+  }
+}
+
+/* =============================================================================
+ *   Node Styling
+ * ========================================================================== */
+
+.featured-node-tooltip {
+  position: absolute;
+  left: 100%;
+  top: 1px;
+  background-color: rgba(#000, 0.85);
+  white-space: nowrap;
+  padding: 3px 5px;
+  color: $white;
+  @include border-radius(3px);
+  display: none;
+  margin-left: 5px;
+  z-index: 1;
+
+  &:before {
+    content: "";
+    display: block;
+    width: 0px;
+    height: 0px;
+    border-style: solid;
+    border-width: 5px 5px 5px 0;
+    border-color: transparent rgba(#000, 0.85) transparent transparent;
+    position: absolute;
+    left: -5px;
+    top: 50%;
+    margin-top: -5px;
+  }
+
+  .node-teaser.node-promoted:hover & {
+    display: block;
+  }
+}
+
+.node {
+  .node-title {
+    margin: 0;
+  }
+}
+
+/**
+ * Node forms
+ */
+
+.node-form {
+  /* Polls have some bad, over specific, styles so this is what needs to be
+     done. */
+  #poll-choice-table .form-text {
+    width: 100%;
+  }
+}
+
+/* =============================================================================
+ *   Comment Styling - Comments, comment wrapper, comment form
+ * ========================================================================== */
+
+/**
+ * Wrapper for a single comment
+ */
+
+.comment {
+  margin-bottom: 20px;
+}
+
+/**
+ * "New" marker for comments that are new for the current user
+ */
+
+.new {
+  color: $highlight;
+}
+
+/**
+ * Nested comments are indented
+ */
+
+.indented {
+  margin-left: 40px;
+}
+
+.has-rate-widget {
+  min-height: 4em;
+  margin-right: 6em;
+  position: relative;
+
+  @include respond(small-medium) {
+    min-height: 0;
+    margin-right: 0;
+  }
+}
+
+.rate-widget-commons_thumbs_up_down {
+  float: right;
+  position: absolute;
+  top: 0;
+  right: -6em;
+  margin-top: 0;
+
+  @include respond(small-medium) {
+    position: static;
+    float: left;
+    margin: ($gutter-width * 2) auto;
+  }
+}
+
+.related-information {
+  clear: both;
+  margin: ($gutter-width * 2) 0;
+
+  .field {
+    float: left;
+  }
+}
+
+/* =============================================================================
+ *   Forms
+ * ========================================================================== */
+
+html.js input.form-autocomplete {
+  background-position: 100% 5px;
+}
+
+ html.js input.throbbing {
+  background-position: 100% -15px; /* LTR */
+}
+
+/**
+ * Forms in tables.
+ */
+
+tr {
+  &.odd,
+  &.even {
+    .form-item {
+      white-space: normal;
+    }
+  }
+}
+
+/**
+ * Wrapper for a form element (or group of form elements) and its label
+ */
+
+.form-item {
+  input.error,
+  textarea.error,
+  select.error {
+    border: 1px solid $highlight;
+  }
+
+  label {
+    font-weight: 700;
+  }
+
+  .description {
+    font-size: 0.85em;
+  }
+}
+
+/**
+ * Highlight marks and form required mark
+ */
+
+.marker,
+.form-required {
+  color: $highlight;
+}
+
+/**
+ * Password confirmation
+ */
+
+.password-parent,
+.confirm-parent {
+  margin: 0;
+}
+
+form.commons-events-form-float {
+  background-color:none;
+  padding:0;
+  border:none;
+  border-radius:0;
+  input {
+    margin:0;
+  }
+}
+
+#edit-field-topics-und {
+  border-top: 2px groove #8A8A8A;
+  border-left: 2px groove #8A8A8A;
+}
+
+form.commons-events-form-float {
+  background: none;
+  padding: 0;
+  border: none;
+  max-width: 10em;
+  margin-right: -10em;
+  text-align: center;
+
+  .commons-event-status {
+    font-size: .88em;
+    line-height: 1.2em;
+    margin-top: .3em;
+    text-align: center;
+
+    @include respond(only-medium) {
+      display: inline-block;
+      margin-left: 1em;
+    }
+  }
+
+  @include respond(small-medium) {
+    float: none;
+    margin: 1em 0;
+    max-width: inherit;
+    text-align: left;
+  }
+}
+
+/* =============================================================================
+ *   Tables
+ * ========================================================================== */
+
+table {
+  margin: 10px 0;
+  padding: 0;
+  width: 100%;
+
+  &.sticky-header {
+    z-index: 10;
+  }
+}
+
+table,
+thead,
+tbody,
+tr,
+th,
+td {
+  border-color: $border;
+}
+
+table,
+td,
+th {
+  vertical-align: middle;
+}
+
+caption,
+th,
+td {
+  text-align: left;
+}
+
+thead tr {
+  font-weight: 700;
+  background-color: $medium_dark;
+}
+
+td,
+th {
+  border-bottom: 0;
+  margin: 0;
+  padding: 5px 7px;
+}
+
+tbody tr {
+  border-top: 1px solid $border;
+}
+
+tr {
+  &.odd {
+    background: $page;
+  }
+
+  /* Table row striping */
+  &.info,
+  &.even,
+  &:nth-child(2n+2)  {
+    border-bottom: 0;
+    background-color: $ultralight;
+  }
+
+  &.odd td.active {
+    background-color: $light;
+  }
+
+  &.even td.active {
+    background-color: $medium_light;
+  }
+}
+
+/**
+ * Forum tables
+ * Core sets white-space to nowrap, which makes no sense
+ */
+
+#forum td {
+  .created,
+  .posts,
+  .topics,
+  .last-reply,
+  .replies,
+  .pager {
+     white-space: normal;
+  }
+}
+
+/* =============================================================================
+ *   Messages
+ * ========================================================================== */
+
+div {
+  &.messages {
+  // Left and right margin are set by the global gutter width
+  margin-bottom: 10px;
+  margin-top: 10px;
+
+    ul {
+      margin-top: 0;
+      margin-bottom: 0;
+    }
+  }
+}
+
+/**
+ * Unpublished nodes
+ */
+
+.node-unpublished,
+.comment-unpublished {
+  p.unpublished {
+    @include unpublished;
+  }
+}
+
+/* =============================================================================
+ *    Maintenance pages
+ * ========================================================================== */
+
+.maintenance-page {
+  .container {
+    padding: 40px 0;
+  }
+}
+
+.db-offline {
+  .container {
+    margin: 0 auto;
+    padding: 40px 0;
+    width: 100%;
+    max-width: 960px;
+  }
+
+  div.messages {
+    margin: 20px 0 0;
+  }
+
+  #content {
+    padding: 20px 0;
+  }
+}
+
+/* =============================================================================
+ *   Misc overrides for contrib modules
+ * ========================================================================== */
+
+/**
+ * Admin menu overrides
+ */
+
+#admin-menu {
+  margin: 0;
+  padding: 0;
+}
+
+/**
+ * Devel Module
+ */
+
+.dev-query {
+  background: $light;
+  padding: 30px;
+}
+
+/**
+ * Styleguide module tweaks
+ */
+
+#styleguide-header {
+  padding: 0 10px;
+
+  .item-list {
+    font-family: inherit;
+    margin: 0 20px 20px 0;
+    min-height: 260px;
+    width: auto;
+  }
+}
+
+/* =============================================================================
+ *   Front Page specific
+ * ========================================================================== */
+
+body.front {
+  .region-three-33-top {
+    font-size: 24px;
+    font-weight: 300;
+
+    h1 {
+      color: $dark_gray;
+      font-size: 40px;
+      font-weight: 700;
+      line-height: 50px;
+    }
+
+    .commons_home-welcome-image {
+      float:right;
+    }
+  }
+
+  &.not-logged-in {
+    #block-system-main {
+      .pane-1 {
+        .pane-title {
+          font-weight: 700;
+          font-size: 38px;
+          color: $dark_gray;
+        }
+      }
+    }
+  }
+}
+
+.commons-events-form-float {
+  float: right;
+  margin-left: 15px;
+
+  input {
+    margin: 0;
+  }
+}
+
+.commons-event-count {
+  font-size: 1.2em;
+  font-weight: bold;
+}
+
+body.front.logged-in {
+  .view-commons-homepage-content {
+    > .view-content {
+      @extend %pod;
+      padding: $gutter-width;
+
+      > .views-row {
+        position: relative;
+      }
+    }
+
+    .article.node, .node-teaser.node-group {
+      .node-content {
+        form {
+
+        }
+
+        .field-name-body {
+        }
+      }
+
+      .author-datetime {
+        margin-bottom: 1.5em;
+        clear: both;
+      }
+    }
+
+    .views-row-first {
+      border-top: none;
+    }
+
+    .item-list {
+      padding: 10px 0 0 0;
+    }
+  }
+
+  #views-exposed-form-commons-homepage-content-panel-pane-1 .views-exposed-widgets {
+    padding: $gutter-width 0;
+    margin-bottom: 0;
+
+    &.widgets-active {
+      @extend %pod;
+      @extend %pod-content;
+    }
+  }
+}
+
+body.front.logged-in .view-commons-homepage-content .article.node {
+  &.no-user-picture,
+  &.node-page {
+    .node-header,
+    .node-content,
+    .author-datetime,
+    .links {
+      margin-left: 0;
+    }
+  }
+}
+
+#quicktabs-commons_follow_ui {
+  .flag-email-group,
+  .flag-email-node,
+  .flag-email-user,
+  .flag-email-term {
+    a {
+      cursor: default;
+
+      input {
+        cursor: default;
+      }
+    }
+
+    a,
+    span {
+      span {
+        display: none;
+      }
+    }
+  }
+}
+
+/**
+ *  Placeholder styles
+ */
+
+#menu-bar.nav {
+  .menu-item-193 a {
+    background-image: image-url('icons/icon-home.png');
+  }
+
+  .menu-item-194 a {
+    background-image: image-url('icons/icon-groups.png');
+  }
+
+  .menu-item-195 a {
+    background-image: image-url('icons/icon-events.png');
+  }
+}
+
+/**
+ * Events Page
+ */
+
+.page-events {
+  .region-three-25-50-25-third {
+    .pane-views-panes {
+      @extend %pod;
+      margin-right: 0;
+
+      .block-inner {
+        @extend %pod-content;
+      }
+    }
+  }
+
+  div.search-result-wrapper h3.title {
+    text-decoration: none;
+
+    a {
+      color: $light_blue;
+    }
+  }
+
+  .three-25-50-25 {
+    > {
+      @include filter-drawer(small-medium);
+    }
+  }
+
+  @include filter-overlay(small-medium);
+}
+
+.pane-commons-events-commons-events-create-event-link {
+  text-align: right;
+
+  .block-inner {
+    margin: 0;
+  }
+
+  a {
+    @extend %button-common;
+    @extend %button-default-layout;
+    @extend %button-primary;
+
+    &:before {
+      @include sprite_url_height_width($icons, icon-events);
+      content: "";
+      top: 2px;
+      margin-right: 6px;
+    }
+  }
+}
+
+/**
+ * Search
+ */
+
+.search-form-page {
+  .form-type-textfield {
+    label {
+      white-space: nowrap;
+    }
+
+    input {
+      width: auto;
+    }
+
+    @include respond(only-small) {
+      &,
+      input {
+        display: block;
+        width: 100%;
+      }
+    }
+  }
+
+  @include respond(medium) {
+    .form-item {
+      margin-bottom: 0;
+    }
+  }
+}
+
+// Build the search button base styling.
+@include button_with_icon(nth($buttons, 3), icon-search);
+
+%button-primary-icon-search {
+  &,
+  &:hover,
+  &:active,
+  &:focus {
+    background-position: 1.5em center;
+  }
+}
+
+.action-item-search {
+  float: right;
+  margin-right: 0;
+  margin-bottom: 0;
+
+  &,
+  &[type="submit"] {
+    padding-left: 3em;
+  }
+
+  &[type="submit"] {
+    @extend %button-primary-icon-search;
+  }
+
+  @include respond(only-small) {
+    float: none;
+    clear: both;
+    display: block;
+  }
+
+  @include respond(medium) {
+    margin-top: 0;
+  }
+}
+
+.block-facetapi {
+  margin-bottom: .7em;
+  padding-bottom: .7em;
+  border-bottom: 1px solid $border;
+
+  &:last-child {
+    margin-bottom: 0;
+    padding-bottom: 0;
+    border-bottom: none;
+  }
+
+  .block-title {
+    margin-bottom: $gutter-width;
+    color: $gray;
+    font-size: 1.2em;
+  }
+}
+
+.facetapi-facetapi-links,
+.facetapi-date-range {
+  margin: 0;
+  padding: 0;
+
+  li.leaf {
+    margin-left: 0;
+    list-style-type: none;
+    list-style-image: none;
+  }
+}
+
+.page-search {
+  .two-33-66 {
+    > {
+      @include filter-drawer;
+    }
+  }
+
+  @include filter-overlay;
+}
+
+.facetapi-processed {
+  &,
+  .block-content & {
+    margin-bottom: 0;
+    padding-left: 0;
+
+    li {
+      &.last {
+        margin-bottom: 0;
+      }
+    }
+  }
+}
+
+.search-results-title,
+.search-results-wrapper > h2 {
+  margin-top: .2em;
+}
+
+.search-results {
+  margin-top: 0;
+
+  &,
+  /* The ol styling is a bit specific. */
+  .block-content & {
+    margin-bottom: 0;
+    padding: 0;
+  }
+}
+
+// This is not optimal. Preferably, a class would be placed in the markup, but
+// ctools has hardcoded the output without the chance of override. The other
+// option is to use regex to force in wrappers.
+// @see http://drupal.org/node/1743402
+.pane-search-result {
+  .block-content {
+    .search-results {
+      @extend %pod;
+      @extend %pod-content;
+    }
+  }
+}
+
+.page-search-user, {
+  .user-results {
+    @extend %pod;
+    @extend %pod-content;
+  }
+}
+
+.search-result {
+  border-bottom: 1px solid $border;
+  list-style-type: none;
+
+  &,
+  .block-content & {
+    padding-bottom: .7em;
+    margin-bottom: .7em;
+
+    &:last-child {
+      border-bottom: none;
+      padding-bottom: 0;
+      margin-bottom: 0;
+    }
+  }
+
+  h2 {
+    font-size: 1.429em;
+    line-height: 1.2em;
+    margin: .5em 0 0;
+  }
+
+  .title {
+    margin-top: 0;
+    margin-bottom: .2em;
+  }
+
+  .search-result-url {
+    color: $gray;
+    font-size: .85em;
+    margin-bottom: 1em;
+  }
+
+  .apachesolr_search-results & {
+    .title,
+    .search-result-url,
+    .search-result-date,
+    .search-result-snippet-info {
+      display: none;
+    }
+
+    .pane-node-flag-commons-follow-group-link {
+      position: static;
+      right: auto;
+      top: auto;
+      float: right;
+    }
+  }
+}
+
+/* Search profiles */
+
+.profile-search-result {
+  @include box-sizing(border-box);
+  display: inline-block;
+  padding-bottom: 0;
+  vertical-align: top;
+  width: 48.5%;
+  margin-right: 2%;
+
+  &:nth-child(even) {
+    margin-right: 0;
+  }
+
+  @include respond(only-small) {
+    width: 100%;
+    margin-right: 0;
+  }
+
+  @include respond(large) {
+    width: 31.5%;
+
+    &:nth-child(even) {
+      margin-right: 2%;
+    }
+
+    &:nth-child(3n) {
+      margin-right: 0;
+    }
+  }
+
+  .commons-pod & {
+    width: 100%;
+    margin-right: 0;
+
+    .profile-actions {
+      @include box-sizing(border-box);
+      margin-right: 0;
+      margin-left: 0;
+      border: 1px solid $border;
+      @include border-radius(0);
+    }
+  }
+
+  h4 {
+    margin: 0;
+  }
+}
+
+.profile-header,
+.profile-content {
+  margin-left: 72px;
+}
+
+.profile-header {
+  @include box-sizing(border-box);
+
+  .user-picture {
+    position: relative;
+    top: -1.2em;
+    float: left;
+    margin-bottom: 0;
+    margin-left: -72px;
+  }
+}
+
+@include multiline-ellipsis(profile-content, 2.8em, 1.4em);
+
+.associated-groups-title,
+.associated-groups,
+.group-item {
+  display: inline;
+  margin: 0;
+  color: $light_gray;
+  white-space: normal;
+}
+
+.associated-groups-title {
+  font-weight: normal;
+}
+
+.associated-groups {
+  &,
+  .block-content & {
+    padding-left: 0;
+  }
+}
+
+.associated-groups-title,
+.group-item {
+  margin-right: .2em;
+  font-size: .88em;
+}
+
+.group-item {
+  &:after {
+    content: ",";
+  }
+
+  &:last-child {
+    margin-right: 0;
+
+    &:after {
+      content: ".";
+    }
+  }
+}
+
+.profile-actions {
+  clear: both;
+  width: 100%;
+  margin-top: $gutter_width;
+  margin-left: -$gutter_width;
+  margin-right: -$gutter_width;
+  padding: ($gutter_width / 2) $gutter_width;
+  background: $ultralight;
+  border-top: 1px solid $border;
+  @include border-bottom-right-radius(.4em);
+  @include border-bottom-left-radius(.4em);
+
+  .field {
+    /* Make fields in the wrapper inline. */
+    display: inline-block;
+  }
+}
+
+/**
+ * Notification settings
+ */
+
+.view-commons-follow-node,
+.view-commons-follow-user,
+.view-commons-follow-taxonomy-term {
+  .views-field-ops,
+  .views-field-ops-1 {
+    width: 20%;
+  }
+
+  .views-field-ops {
+    text-align: right;
+  }
+
+  .views-field-ops-1 {
+    text-align: center;
+  }
+}
+
+/**
+ * Trusted contacts
+ */
+
+.views-field-field-membership-token {
+  a {
+    &:first-child {
+      &:after {
+        content: "|";
+        display: inline-block;
+        padding: 0 .3em 0 .5em;
+        color: $dark_gray;
+      }
+    }
+  }
+}
+
+.trusted-status-request {
+  &:before {
+    content: "\271a";
+    position: relative;
+    top: .1em;
+    display: inline-block;
+    margin-right: .2em;
+    font-size: 1.4em;
+    line-height: .6em;
+  }
+}
+
+.message-contact {
+  &:before {
+    content: "";
+    @include sprite_url_height_width($icons, message);
+  }
+}
+
+/**
+ * Private message
+ */
+
+.privatemsg-conversation {
+  .form-actions {
+    &,
+    [class*="action-item"] {
+      margin-bottom: 0;
+    }
+  }
+}
+
+.privatemsg-message-participants {
+  margin-bottom: $gutter_width;
+  padding-bottom: $gutter_width;
+  border-bottom: 1px solid $border;
+}
+
+.privatemsg-message {
+  @include box-sizing(border-box);
+  width: 100%;
+  margin-bottom: $gutter_width;
+  padding-bottom: $gutter_width;
+  padding-left: 72px;
+  border-bottom: 1px solid $border;
+
+  .user-picture {
+    position: relative;
+    float: left;
+    width: 50px;
+    margin-left: -72px;
+  }
+}
+
+.privatemsg-message-links {
+  font-size: .88em;
+  text-align: right;
+}
+
+.message-delete {
+  &:before {
+    content: "\2715";
+    display: inline-block;
+    margin-right: .3em;
+    color: $icon_gray;
+    font-weight: bold;
+  }
+}
+
+/**
+ * Commons Origins Pallete Choices
+ */
+
+#edit-commons-origins-palette {
+  .form-item-commons-origins-palette {
+    clear: both;
+    margin-bottom: 10px;
+
+    input[type="radio"] {
+      float: left;
+    }
+
+    label {
+      margin-left: 20px;
+    }
+  }
+}
+
+/**
+ * Login and signup form
+ */
+
+#user-login, #user-register-form {
+  input[type="text"], input[type="password"] {
+    width: 20em;
+    max-width: 100%;
+  }
+}
+
+/**
+ * Add the color palettes
+ */
+
+@import 'palettes';
diff --git a/themes/commons/commons_origins/sass/lt-ie9.scss b/themes/commons/commons_origins/sass/lt-ie9.scss
new file mode 100755
index 0000000..ded4b6a
--- /dev/null
+++ b/themes/commons/commons_origins/sass/lt-ie9.scss
@@ -0,0 +1,54 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ * Target IE 6, 7 and 8 (less than IE9)
+ */
+
+/*
+ * Assuming a mobile first approach with respond.js OFF, we must reset the font
+ * size for lt IE9
+ */
+html {
+  font-size: 81.3%;
+}
+
+body.front.not-logged-in {
+  #content {
+    background: image-url('commons-drop.png') right top no-repeat;
+  }
+
+  .region-three-33-top {
+    margin-bottom: 24px;
+    min-height: 300px;
+  }
+
+  #block-system-main {
+    .pane-1 {
+      float:left;
+      width:56%;
+    }
+    .pane-2 {
+      float:right;
+      width:40%;
+    }
+  }
+}
+
+.profile-search-result {
+  width: 47%;
+  margin-right: 1%;
+  margin-left: 1%;
+}
+
+/* IE8 and lower do not support :before, So remove them and the margin so that
+   the container touches the button. */
+.sharethis-wrapper {
+  margin-bottom: 0;
+
+  &:before,
+  &:after {
+    border: none;
+  }
+}
diff --git a/themes/commons/commons_origins/sass/mixins/_buttons.scss b/themes/commons/commons_origins/sass/mixins/_buttons.scss
new file mode 100644
index 0000000..1c8a7b4
--- /dev/null
+++ b/themes/commons/commons_origins/sass/mixins/_buttons.scss
@@ -0,0 +1,243 @@
+// @file
+// Generate button css.
+//
+// These mixins will generate invisible classes and not normal classes. This
+// allows for more semantic naming in your markup, but still allows for robotic
+// naming for automatic generation.
+
+// These are the default skins and sizes. They can be overridden with alternate
+// values.
+$buttons: (default, #fefefe) (active, #f3f3f3, true) (primary, rgb(70, 187, 46)) (primary-active, rgb(70, 187, 46), true) !default;
+$button-sizes: (default, 1em, .5em 1.5em) (small, .88em, .3em 1em) (large, 1.2em, .5em 1.5em) !default;
+$button-contrast: 60 !default;
+
+// Bulk generate buttons styles with a list of settings.
+@mixin buttons($buttons: $buttons) {
+  /* Common styles for all buttons. */
+  %button-common {
+    -webkit-appearance: none;
+    display: inline-block;
+    @include box-sizing(border-box);
+    margin: .5em .3em .5em 0;
+    max-width: 100%;
+    overflow: visible;
+    line-height: 1.2em;
+    vertical-align: baseline;
+    border-style: solid;
+    border-width: 1px;
+    @include border-radius(2px);
+    /* Reset all button fonts to a similar baseline in webkit. */
+    font: -webkit-small-control;
+    font-family: "Helvetica Neue", Arial, "Liberation Sans", FreeSans, sans-serif;
+    font-weight: light;
+    letter-spacing: .06em;
+    text-align: center;
+    text-decoration: none;
+    outline: 0;
+    cursor: pointer;
+
+    &:focus,
+    &:hover {
+      text-decoration: none;
+    }
+
+    &:active {
+      @include box-shadow(inset rgba(black, 0.25) 0 1px 2px 0);
+      text-decoration: none;
+    }
+
+    &::-moz-focus-inner {
+      border: 0;
+      padding: 0;
+    }
+  }
+
+  // Generate style for the size variants.
+  @each $size in $button-sizes {
+    @include button-size($size...);
+  }
+
+  // Generate the color styles for the buttons.
+  @each $button in $buttons {
+    @include button($button...);
+  }
+}
+
+// Generate a size variant.
+@mixin button-size($name, $font-size, $padding) {
+  /* Dimensions for the #{$name} button type. */
+  %button-#{$name}-layout {
+    @extend %button-common;
+    padding: $padding;
+    font-size: $font-size;
+  }
+}
+
+// Generate a set of buttons variants.
+@mixin button($name, $base-color, $flat: false) {
+  $text-color: contrast-color($base-color, darken($base-color, 80), lighten($base-color, 80), $button-contrast);
+  $text-shadow: contrast-color($base-color, lighten($base-color, 10), darken($base-color, 10), $button-contrast);
+  $border-color: darken($base-color, 20);
+  $hover-base: darken($base-color, 5);
+  $hover-text: contrast-color($hover-base, darken($hover-base, 70), lighten($hover-base, 70), $button-contrast);
+  $hover-border: darken($border-color, 10);
+  $hover-text-shadow: contrast-color($hover-base, lighten($hover-base, 5), darken($hover-base, 5), $button-contrast);
+
+  %button-#{$name} {
+    background-color: $base-color;
+    @if $flat == false {
+      @include background(linear-gradient(lighten($base-color, 5), darken($base-color, 5)))
+    }
+    @else {
+      @include box-shadow(inset .1em .1em .2em darken($base-color, 30));
+    }
+    border-color: $border-color;
+    // Add a 1px outline around the text to help with legibility.
+    @include text-shadow(
+      -1px 1px 2px $text-shadow,
+      -1px -1px 2px $text-shadow,
+      1px -1px 2px $text-shadow,
+      1px 1px 2px $text-shadow
+    );
+
+    &,
+    &:link,
+    &:visited {
+      color: $text-color;
+    }
+
+    &:hover {
+      color: $hover-text;
+      background-color: $hover-base;
+      @if $flat == false {
+        @include background(linear-gradient(lighten($hover-base, 5), darken($hover-base, 5)))
+      }
+      @else {
+        @include box-shadow(inset .1em .1em .2em darken($hover-base, 30));
+      }
+      border-color: $hover-border;
+      // Add a 1px outline around the text to help with legibility.
+      @include text-shadow(
+        -1px 1px 2px $hover-text-shadow,
+        -1px -1px 2px $hover-text-shadow,
+        1px -1px 2px $hover-text-shadow,
+        1px 1px 2px $hover-text-shadow
+      );
+    }
+
+    &:focus,
+    &:active {
+      background: $base-color;
+      @if $flat == false {
+        @include background(linear-gradient(darken($base-color, 5), lighten($base-color, 5)))
+      }
+      @else {
+        @include box-shadow(inset .1em .1em .2em darken($base-color, 30));
+      }
+      border-color: $border-color;
+      // Add a 1px outline around the text to help with legibility.
+      @include text-shadow(
+        -1px 1px 2px $text-shadow,
+        -1px -1px 2px $text-shadow,
+        1px -1px 2px $text-shadow,
+        1px 1px 2px $text-shadow
+      );
+    }
+
+    &[disabled] {
+      color: contrast-color($base-color, darken($base-color, 20), lighten($base-color, 20), $button-contrast);
+      background: $base-color;
+      border-color: $border-color;
+      @include box-shadow(none);
+      @include text-shadow(none);
+    }
+  }
+}
+
+// Generate a set of buttons variants.
+@mixin button_with_icon($style, $icon) {
+  $name: nth($style, 1);
+  $base-color: nth($style, 2);
+  $flat: false;
+  @if (length($style) == 3) {
+    $flat: nth($style, 3);
+  }
+  $text-color: contrast-color($base-color, darken($base-color, 80), lighten($base-color, 80), $button-contrast);
+  $text-shadow: contrast-color($base-color, lighten($base-color, 10), darken($base-color, 10), $button-contrast);
+  $border-color: darken($base-color, 20);
+  $hover-base: darken($base-color, 5);
+  $hover-text: contrast-color($hover-base, darken($hover-base, 70), lighten($hover-base, 70), $button-contrast);
+  $hover-border: darken($border-color, 10);
+  $hover-text-shadow: contrast-color($hover-base, lighten($hover-base, 5), darken($hover-base, 5), $button-contrast);
+
+  %button-#{$name}-#{$icon} {
+    min-width: image-width("icons/#{$icon}.png");
+    @include background($base-color image-url("icons/#{$icon}.png") no-repeat);
+    @if $flat == false {
+      @include background(image-url("icons/#{$icon}.png") no-repeat, linear-gradient(lighten($base-color, 5), darken($base-color, 5)));
+    }
+    @else {
+      @include box-shadow(inset .1em .1em .2em darken($base-color, 30));
+    }
+    border-color: $border-color;
+    // Add a 1px outline around the text to help with legibility.
+    @include text-shadow(
+      -1px 1px 2px $text-shadow,
+      -1px -1px 2px $text-shadow,
+      1px -1px 2px $text-shadow,
+      1px 1px 2px $text-shadow
+    );
+
+    &,
+    &:link,
+    &:visited {
+      color: $text-color;
+    }
+
+    &:hover {
+      color: $hover-text;
+      background: $hover-base image-url("icons/#{$icon}.png") no-repeat;
+      @if $flat == false {
+        @include background(image-url("icons/#{$icon}.png") no-repeat, linear-gradient(lighten($hover-base, 5), darken($hover-base, 5)))
+      }
+      @else {
+        @include box-shadow(inset .1em .1em .2em darken($hover-base, 30));
+      }
+      border-color: $hover-border;
+      // Add a 1px outline around the text to help with legibility.
+      @include text-shadow(
+        -1px 1px 2px $hover-text-shadow,
+        -1px -1px 2px $hover-text-shadow,
+        1px -1px 2px $hover-text-shadow,
+        1px 1px 2px $hover-text-shadow
+      );
+    }
+
+    &:focus,
+    &:active {
+      background: $base-color image-url("icons/#{$icon}.png") no-repeat;
+      @if $flat == false {
+        @include background(image-url("icons/#{$icon}.png") no-repeat, linear-gradient(darken($base-color, 5), lighten($base-color, 5)))
+      }
+      @else {
+        @include box-shadow(inset .1em .1em .2em darken($base-color, 30));
+      }
+      border-color: $border-color;
+      // Add a 1px outline around the text to help with legibility.
+      @include text-shadow(
+        -1px 1px 2px $text-shadow,
+        -1px -1px 2px $text-shadow,
+        1px -1px 2px $text-shadow,
+        1px 1px 2px $text-shadow
+      );
+    }
+
+    &[disabled] {
+      color: contrast-color($base-color, darken($base-color, 20), lighten($base-color, 20), $button-contrast);
+      background: $base-color;
+      border-color: $border-color;
+      @include box-shadow(none);
+      @include text-shadow(none);
+    }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/mixins/_functions.scss b/themes/commons/commons_origins/sass/mixins/_functions.scss
new file mode 100644
index 0000000..78f2952
--- /dev/null
+++ b/themes/commons/commons_origins/sass/mixins/_functions.scss
@@ -0,0 +1,35 @@
+//
+// @file
+// A set of additional useful functions.
+//
+
+// Strip units from a value.
+@function remove-units($value: 0) {
+  @if not unitless($value) {
+    $unit: unit($value);
+    $divisor: '';
+
+    // Dividing a number by a number with the same unit type will result in a
+    // unitless number.
+    @if $unit == 'px' {
+      $divisor: 1px;
+    }
+    @else if $unit == 'em' {
+      $divisor: 1em;
+    }
+    @else if $unit == '%' {
+      $divisor: 1%;
+    }
+
+    @return $value / $divisor;
+  }
+  @else {
+    @return $value;
+  }
+}
+
+// Translates pixel units to em units based on the $base-font-size variable.
+@function px-to-em($pixels, $factor: 1, $base: $base-font-size) {
+  // Make sure the numbers are unitless and then find the em value.
+  @return (remove-units($pixels) / remove-units($base-font-size) * $factor) * 1em;
+}
diff --git a/themes/commons/commons_origins/sass/mixins/_icons.scss b/themes/commons/commons_origins/sass/mixins/_icons.scss
new file mode 100644
index 0000000..e160720
--- /dev/null
+++ b/themes/commons/commons_origins/sass/mixins/_icons.scss
@@ -0,0 +1,12 @@
+//
+// Display and icon.
+//
+@mixin sprite_url_height_width($sprite_name, $image_name) {
+  background: sprite($sprite_name, $image_name) no-repeat;
+  width: image-width(sprite-file($sprite_name, $image_name));
+  height: image-height(sprite-file($sprite_name, $image_name));
+  display: inline-block;
+  margin-right: 3px;
+  position: relative;
+  top: 1px;
+}
diff --git a/themes/commons/commons_origins/sass/mixins/_mixins.scss b/themes/commons/commons_origins/sass/mixins/_mixins.scss
new file mode 100644
index 0000000..01dae83
--- /dev/null
+++ b/themes/commons/commons_origins/sass/mixins/_mixins.scss
@@ -0,0 +1,109 @@
+//
+// The word "Unpublished" displayed underneath unpublished nodes and comments
+//
+@mixin unpublished {
+  color: pink; // target browsers that do not support rgba
+  color: rgba(239, 170, 170, 0.4);
+  font-family: $impact;
+  font-size: 50px;
+  font-weight: 700;
+  line-height: 1.2;
+  height: 0;
+  margin: 0;
+  padding: 0;
+  overflow: visible;
+  text-align: center;
+  text-transform: uppercase;
+  word-wrap: break-word;
+}
+
+//
+// Position a user picture.
+//
+@mixin place-picture($width: 50px, $extra-padding: 0) {
+  padding-left: $width + 18px + $extra-padding;
+
+  .user-picture {
+    position: absolute;
+    float: left;
+    width: $width;
+    margin-left: -($width + 18px);
+    top: $extra-padding;
+
+    img {
+      width: $width;
+    }
+  }
+
+  @include respond(only-small) {
+    padding-left: $extra-padding;
+
+    .user-picture {
+      display: none;
+    }
+  }
+}
+
+//
+// Styles for the pullout drawer on search.
+//
+@mixin filter-drawer($break: only-small) {
+  @include respond($break) {
+    .filters-processed {
+      clear: none;
+      position: absolute;
+      right: 0;
+      float: right;
+      width: 0;
+      height: 0;
+      margin: 0;
+      padding: 0;
+      font-size: .88em;
+      background: white;
+      border: 1px solid $lighter_gray;
+      z-index: 1;
+
+      .commons-pod {
+        margin: 0;
+        padding: $gutter-width 0;
+        @include border-radius(0 0 0 3px);
+      }
+
+      .panel-pane {
+        display: none;
+      }
+
+      .filter-trigger {
+        display: block;
+      }
+    }
+
+    .expanded {
+      margin-right: 0;
+      width: 75%;
+      height: auto;
+      opacity: 1;
+
+      .commons-pod {
+        padding: $gutter-width;
+      }
+
+      .panel-pane {
+        display: block;
+      }
+    }
+  }
+}
+
+//
+// Styles for the overlay layer when the filter drawer is expanded.
+//
+@mixin filter-overlay($break: only-small) {
+  .filter-overlay {
+    @include respond($break) {
+      &.expanded {
+        display: block;
+      }
+    }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/mixins/_multiline-ellipsis.scss b/themes/commons/commons_origins/sass/mixins/_multiline-ellipsis.scss
new file mode 100644
index 0000000..51f6208
--- /dev/null
+++ b/themes/commons/commons_origins/sass/mixins/_multiline-ellipsis.scss
@@ -0,0 +1,36 @@
+$ellipsiswidth: 3em !default;
+
+@mixin multiline-ellipsis($target, $height, $lineheight, $ellipsiswidth: $ellipsiswidth) {
+  .#{$target} {
+    overflow: hidden;
+    height: $height;
+    line-height: $lineheight;
+
+    &:before {
+      content:"";
+      float: left;
+      width: 5px;
+      height: $height;
+    }
+
+    > *:first-child {
+      float: right;
+      width: 100%;
+      margin-left: -5px;
+    }
+
+    &:after {
+      content: "\02026";
+      float: right;
+      position: relative;
+      top: -$lineheight;
+      left: 100%;
+      width: $ellipsiswidth;
+      margin-left: -$ellipsiswidth;
+      padding-right: 5px;
+      text-align: right;
+      background: #fff;
+      @include background(linear-gradient(left, rgba(#fff, 0), #fff 50%, #fff));
+    }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/mixins/_respond.scss b/themes/commons/commons_origins/sass/mixins/_respond.scss
new file mode 100644
index 0000000..27616b3
--- /dev/null
+++ b/themes/commons/commons_origins/sass/mixins/_respond.scss
@@ -0,0 +1,23 @@
+// @file
+// General logic for responsive layouts.
+
+$screen-small: 480px !default;
+$screen-large: 768px !default;
+
+@mixin respond($media) {
+  @if $media == only-small {
+    @media only screen and (max-width: $screen-small) { @content; }
+  }
+  @else if $media == small-medium {
+    @media only screen and (max-width: $screen-large) { @content; }
+  }
+  @else if $media == only-medium {
+    @media only screen and (min-width: $screen-small + 1) and (max-width: $screen-large) { @content; }
+  }
+  @else if $media == medium {
+    @media only screen and (min-width: $screen-small + 1) { @content; }
+  }
+  @else if $media == large {
+    @media only screen and (min-width: $screen-large + 1) { @content; }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/print.scss b/themes/commons/commons_origins/sass/print.scss
new file mode 100755
index 0000000..96a12bf
--- /dev/null
+++ b/themes/commons/commons_origins/sass/print.scss
@@ -0,0 +1,337 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ * @file
+ * Print Styles
+ * This probably needs work, but it's a good starting point.
+ */
+
+/*
+ * Body
+ */
+body {
+  width: 100% !important;
+  margin: 0 !important;
+  padding: 0 !important;
+  line-height: 1.4;
+  word-spacing: 1.1pt;
+  letter-spacing: 0.2pt;
+  font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
+  color: rgb(0, 0, 0);
+  background: none;
+  font-size: 11pt;
+}
+
+
+/*
+ * Links
+ */
+a {
+  background: transparent;
+  font-weight: 700;
+  text-decoration: underline;
+  color: rgb(0, 0, 238);
+
+  &[href^="http://"] {
+    &:after,
+    &:visited:after {
+      content: "("attr(href)")";
+      font-size: 10pt;
+    }
+  }
+}
+
+/*
+ * Strip background from likely candidates
+ */
+div[id*="wrapper"],
+[class*="title"],
+[class*="inner"],
+header,
+footer,
+#branding,
+#container,
+#columns,
+.columns-inner,
+#content-column,
+.content-inner,
+.region,
+.region-header,
+.region-content,
+.article,
+.article-title,
+.article-content,
+.comment,
+.comment-title,
+.comment-content,
+.block,
+.block-inner,
+.block-title,
+.block-content,
+table,
+table * {
+  background: none !important;
+}
+
+
+/*
+ * Hide various bits of the page
+ */
+.sidebar,
+#breadcrumb,
+.nav,
+.field-type-taxonomy-term-reference,
+ul.links,
+.feed-icon,
+.poll .bar,
+.poll .foreground,
+.comment-form,
+#comment-form,
+.book-navigation,
+.tabs,
+.action-links,
+.pager,
+.messages,
+.help {
+  display: none;
+}
+
+
+/*
+ * Ensure the display the main content region
+ */
+#content {
+  display: block !important;
+}
+
+
+/*
+ * Layout
+ */
+#header {
+  margin-bottom: 20px;
+}
+
+
+.content-inner {
+  margin: 0 !important;
+  padding: 0 !important;
+}
+
+
+/*
+ * HTML elements
+ */
+h1,
+h2,
+h3,
+h4,
+h5,
+h6 {
+  color: rgb(51, 51, 51);
+  margin: 0;
+  padding: 0;
+  line-height: 1;
+}
+
+
+h1 {
+  font-size: 14pt;
+}
+
+
+h2 {
+  font-size: 13pt;
+}
+
+
+h3 {
+  font-size: 12pt;
+}
+
+
+h4,
+h5,
+h6 {
+  font-size: 11pt;
+}
+
+h1 a,
+h2 a,
+h3 a,
+h4 a,
+h5 a,
+h6 a,
+#site-name a,
+#site-slogan {
+  text-decoration: none !important;
+  color: rgb(51, 51, 51);
+}
+
+
+hgroup a {
+  &:link,
+  &:visited {
+    text-decoration: none;
+  }
+}
+
+
+#page-title {
+  margin-top: 20px;
+}
+
+
+pre,
+code,
+tt,
+samp,
+kbd,
+var {
+  font-size: 10pt;
+  font-family: Consolas, "Lucida Console", Menlo, Monaco, "DejaVu Sans Mono", monospace, sans-serif;
+}
+
+
+blockquote {
+  margin: 20px;
+  padding: 10px;
+  font-size: 10pt;
+  font-style: italic;
+  background: rgb(238, 238, 238);
+}
+
+
+hr {
+  background-color: rgb(102, 102, 102);
+}
+
+
+/*
+ * Header, Logo, Site name
+ */
+#header {
+  padding-bottom: 20px;
+}
+
+
+#logo img {
+  padding: 0 10px 0 0;
+  margin: 0 !important;
+  float: none !important;
+}
+
+
+/*
+ * Images
+ */
+img {
+  float: left;
+  margin: 4px 20px 10px 0;
+  page-break-inside: avoid;
+}
+
+
+a img {
+  border: none;
+ }
+
+
+/*
+ * Tables
+ */
+table {
+  margin: 1px;
+  text-align: left;
+}
+
+
+th {
+  border-bottom: 1px solid rgb(51, 51, 51);
+  font-weight: 700;
+}
+
+
+td {
+  border-bottom: 1px solid rgb(51, 51, 51);
+}
+
+
+th,
+td {
+  padding: 4px 10px 4px 0;
+}
+
+
+tfoot {
+  font-style: italic;
+}
+
+
+caption {
+  margin-bottom: 10px;
+  text-align: left;
+}
+
+
+thead {
+  display: table-header-group;
+}
+
+
+tr {
+  page-break-inside: avoid;
+}
+
+
+/*
+ * Forms
+ */
+form {
+  margin-bottom: 10px; }
+
+
+/*
+ * Poll module
+ */
+.poll {
+  .text,
+  .percent,
+  .total {
+    text-align: left;
+  }
+  form {
+    margin-bottom: 0;
+  }
+}
+
+
+/*
+ * Articles
+ */
+.node,
+.comment {
+  margin-bottom: 20px;
+  overflow: hidden;
+  page-break-inside: avoid;
+}
+
+.submitted {
+  color: rgb(102, 102, 102);
+  text-decoration: none;
+  font-size: 9pt;
+  font-weight: 400;
+  margin: 0;
+  padding: 0;
+
+  a {
+    color: rgb(102, 102, 102);
+    text-decoration: none;
+    font-size: 9pt;
+    font-weight: 400;
+    margin: 0;
+    padding: 0;
+  }
+}
diff --git a/themes/commons/commons_origins/sass/responsive.custom.scss b/themes/commons/commons_origins/sass/responsive.custom.scss
new file mode 100755
index 0000000..ad51920
--- /dev/null
+++ b/themes/commons/commons_origins/sass/responsive.custom.scss
@@ -0,0 +1,182 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ * responsive.custom.css is for custom media queries that are not set via the
+ * theme settings, such as cascading media queries.
+ *
+ * By default all the other responsive stylesheets used in Adaptivetheme use a
+ * "stacking method", however cascading media queries use a waterfall method so
+ * you can leverage the cascade and inheritance for all browsers that support
+ * media queries, regardless of screen size.
+ *
+ * @SEE http://zomigi.com/blog/essential-considerations-for-crafting-quality-media-queries/#mq-overlap-stack
+ *
+ * NOTE: this file loads by default, to disable got to your theme settings and
+ * look under the "CSS" settings tab.
+ */
+
+
+/*
+ * Really small screens and up
+ */
+/* @media only screen and (min-width: 220px) {} */
+
+
+/*
+ * Smartphone sizes and up
+ */
+/* @media only screen and (min-width: 320px) {} */
+
+
+/*
+ * Smartphone sizes and down
+ */
+@media only screen and (max-width: 480px) {
+  body {
+    &.toolbar {
+      padding-top: 0 !important;
+    }
+  }
+
+  /*
+   * Float Region blocks example:
+   * In smaller screen sizes we can remove the float and widths so all blocks
+   * stack instead of displaying horizonally. The selector used here is an
+   * "attribute selector" which will match on any float block class. Use your
+   * inspector or Firebug to get the classes from the page output if you need
+   * more granular control over block alignment and stacking.
+   *
+   * "Float Region blocks" is an extension for floating blocks in regions, see
+   * your themes appearance settings, under the Extensions tab.
+   */
+  .region[class*="float-blocks"] .block {
+    float: none;
+    width: 100%;
+  }
+
+  .commons-bw-create-all-widget-types {
+    left: auto;
+  }
+
+  .page-node-add #edit-additional-settings {
+    width: 100%;
+    position: static;
+  }
+
+  .page-node-add .field-type-taxonomy-term-reference-form {
+    width: 100%;
+    position: static;
+  }
+
+  // The toolbar should not be persitently in view on small screens.
+  #toolbar {
+    position: static;
+    margin: 0;
+    padding: 0;
+  }
+
+  #toolbar-user {
+    position: absolute;
+    height: 1px;
+    overflow: hidden;
+    clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
+    clip: rect(1px, 1px, 1px, 1px);
+  }
+
+  // Remove the panels adminstration controls on small screens.
+  div#panels-ipe-control-container {
+    display: none !important;
+  }
+
+  #quicktabs-container-commons_bw .quicktabs-tabpage {
+    .view-filters,
+    .attachment-before {
+      float: none;
+      display: block;
+    }
+  }
+
+  // Notification settings
+  #quicktabs-commons_follow_ui {
+    .quicktabs-style-commons-tabs {
+      li {
+        display: block;
+      }
+    }
+  }
+
+  .view-commons-follow-node,
+  .view-commons-follow-user,
+  .view-commons-follow-taxonomy-term {
+    .views-field-ops,
+    .views-field-ops-1 {
+      width: 33.333%;
+    }
+  }
+
+  .primary-fields,
+  .supplementary-fields {
+    display: block;
+    float: none;
+    width: auto;
+    padding: 0;
+  }
+}
+
+/*
+ * Tablet sizes and down
+ */
+@media only screen and (max-width: 768px) {
+  // Commons quicktab pills are distilled to only icons.
+  .quicktabs-style-commons-pills {
+    ul {
+      &.quicktabs-tabs {
+        li {
+          a {
+            font: 0/30px a;
+            color: transparent;
+            text-align: center;
+            @include box-sizing(border-box);
+            width: 30px;
+            height: 30px;
+            padding: 0;
+
+            &:before {
+              margin-right: 0;
+              vertical-align: middle;
+            }
+          }
+        }
+      }
+    }
+  }
+}
+
+/*
+ * Tablet sizes and up
+ */
+@media only screen and (min-width: 768px) {
+  body.front.not-logged-in {
+    #content {
+      background: image-url('commons-drop.png') right top no-repeat;
+    }
+
+    .region-three-33-top {
+      margin-bottom: 24px;
+      min-height: 300px;
+    }
+
+    #block-system-main {
+      .pane-1 {
+        float:left;
+        width:56%;
+      }
+      .pane-2 {
+        float:right;
+        width:40%;
+      }
+    }
+  }
+}
diff --git a/themes/commons/commons_origins/sass/responsive.desktop.scss b/themes/commons/commons_origins/sass/responsive.desktop.scss
new file mode 100755
index 0000000..75eb2e7
--- /dev/null
+++ b/themes/commons/commons_origins/sass/responsive.desktop.scss
@@ -0,0 +1,13 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/sass/responsive.smartphone.landscape.scss b/themes/commons/commons_origins/sass/responsive.smartphone.landscape.scss
new file mode 100755
index 0000000..36a45ca
--- /dev/null
+++ b/themes/commons/commons_origins/sass/responsive.smartphone.landscape.scss
@@ -0,0 +1,17 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
+
+body.front.logged-in .view-commons-homepage-content .article.node .node-content .field-name-body, body.front.logged-in .view-commons-homepage-content .node-teaser.node-group .node-content .field-name-body {
+  margin-right: 0;
+}
diff --git a/themes/commons/commons_origins/sass/responsive.smartphone.portrait.scss b/themes/commons/commons_origins/sass/responsive.smartphone.portrait.scss
new file mode 100755
index 0000000..75eb2e7
--- /dev/null
+++ b/themes/commons/commons_origins/sass/responsive.smartphone.portrait.scss
@@ -0,0 +1,13 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/sass/responsive.tablet.landscape.scss b/themes/commons/commons_origins/sass/responsive.tablet.landscape.scss
new file mode 100755
index 0000000..b66e471
--- /dev/null
+++ b/themes/commons/commons_origins/sass/responsive.tablet.landscape.scss
@@ -0,0 +1,13 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete 
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/sass/responsive.tablet.portrait.scss b/themes/commons/commons_origins/sass/responsive.tablet.portrait.scss
new file mode 100755
index 0000000..75eb2e7
--- /dev/null
+++ b/themes/commons/commons_origins/sass/responsive.tablet.portrait.scss
@@ -0,0 +1,13 @@
+
+// _base.scss imports _custom.scss and other partials.
+@import "base";
+
+/*
+ *   Important Information about this CSS File
+ *
+ * - Do not delete or rename this file, if you do not use it leave it blank (delete
+ *   everything) and the file will be skipped when you enable Production Mode in
+ *   the Global theme settings.
+ *
+ * - Read the _README file in this directory, it contains useful help and other information.
+ */
diff --git a/themes/commons/commons_origins/screenshot.png b/themes/commons/commons_origins/screenshot.png
new file mode 100755
index 0000000..ce36303
Binary files /dev/null and b/themes/commons/commons_origins/screenshot.png differ
diff --git a/themes/commons/commons_origins/scripts/commons_origins.js b/themes/commons/commons_origins/scripts/commons_origins.js
new file mode 100644
index 0000000..2e05894
--- /dev/null
+++ b/themes/commons/commons_origins/scripts/commons_origins.js
@@ -0,0 +1,223 @@
+syze.sizes(320, 480, 935);
+
+jQuery(document).ready(function($){
+
+  'use strict';
+
+  var set_follow_checkboxes = function(){
+    $('#quicktabs-commons_follow_ui .flag-email-group a, #quicktabs-commons_follow_ui .flag-email-node a, #quicktabs-commons_follow_ui .flag-email-user a, #quicktabs-commons_follow_ui .flag-email-term a').each(function(){
+      var a_target = $(this).addClass('formatted-as-checkbox').removeClass('action-item-small action-item-small-active');
+
+      if (a_target.children('span').length === 0) {
+        a_target.wrapInner('<span></span>');
+      }
+
+      if (a_target.hasClass('flag-action') && a_target.children('input').length === 0) {
+        a_target.prepend('<input type="checkbox">');
+      } else if (a_target.children('input').length === 0) {
+        a_target.prepend('<input type="checkbox" checked>');
+      }
+    });
+  };
+
+  var set_disabled_checkboxes = function(){
+    $('#quicktabs-commons_follow_ui .flag-email-group span, #quicktabs-commons_follow_ui .flag-email-node span, #quicktabs-commons_follow_ui .flag-email-user span, #quicktabs-commons_follow_ui .flag-email-term span').each(function(){
+      var a_target = $(this).addClass('formatted-as-checkbox').removeClass('action-item-small action-item-small-active');
+
+      if (a_target.children('span').length === 0) {
+        a_target.wrapInner('<span></span>');
+      }
+
+      if (a_target.hasClass('flag-action') && a_target.children('input').length === 0) {
+        a_target.prepend('<input type="checkbox" disabled="disabled">');
+      } else if (a_target.children('input').length === 0) {
+        a_target.prepend('<input type="checkbox" disabled="disabled" checked>');
+      }
+    });
+  };
+
+  $(document).delegate('.views-exposed-widgets .form-select', 'change', function() {
+    $('.views-exposed-widgets').addClass('widget-changed');
+  });
+
+  $(document).delegate('.views-exposed-widgets .form-select', 'click', function() {
+    $('.views-exposed-widgets').addClass('widgets-active');
+  });
+
+  if($('#quicktabs-commons_follow_ui a.flag').length > 0) {
+      set_follow_checkboxes();
+
+      $(document).ajaxComplete(function(){
+        set_follow_checkboxes();
+      });
+  } else {
+      set_disabled_checkboxes();
+  }
+});
+
+(function ($) {
+
+  /**
+   * Make select elements simulate an anchor element.
+   */
+  function hiddenSelect (selectContainer) {
+    var select = selectContainer.children('select').addClass('hidden-select').wrap('<span class="hidden-select-wrapper"></span>');
+        val = select.children('option[value="' + select.val() + '"]').text();
+
+    $('<a />', {
+      'class': 'select-status',
+      'href': '#'
+    }).text(val).insertBefore(select);
+
+    var selectStatus = select.siblings('a.select-status'),
+        wrapper = select.parent().addClass('select-inactive');
+
+    select.mousedown(function () {
+      wrapper.addClass('select-active').removeClass('select-inactive');
+      select.focus();
+    }).change(function () {
+      val = select.children('option[value="' + select.val() + '"]').text();
+      selectStatus.text(val);
+      select.blur();
+    }).blur(function () {
+      wrapper.addClass('select-inactive').removeClass('select-active').delay(3000).css('width', selectStatus.outerWidth());
+    });
+  }
+
+  /**
+   * Allow select forms to be styled more directly.
+   */
+  Drupal.behaviors.formSelect = {
+    attach: function (context, settings) {
+      var selects = $('.search-form .form-type-select, .views-exposed-widgets .form-type-select', context),
+          counter = 0;
+
+      if (selects.length > 0) {
+        selects.once('formSelect', function () {
+          hiddenSelect($(this));
+        });
+      }
+    }
+  };
+
+  /**
+   * Define a variable height on fieldsets to accommodate multi-line layouts.
+   */
+  Drupal.behaviors.collapsibleHeight = {
+    attach: function (context, settings) {
+      $('fieldset.collapsible', context).once('collapsibleHeight', function () {
+        var fieldset = $(this),
+            minHeight = fieldset.find('legend').height();
+
+
+        fieldset.css('min-height', minHeight + 'px');
+
+        // Adjust the height on window resize.
+        $(window).resize(function () {
+          var minHeight = fieldset.find('legend').height();
+          fieldset.css('min-height', minHeight + 'px');
+        });
+      });
+    }
+  };
+
+  /**
+   * Make an item follow the page when an item is in view.
+   */
+  function showWithElement(tracker, leader) {
+    if ($(leader).length > 0) {
+      var top = $(leader).offset().top,
+          bottom = $(leader).innerHeight() + top,
+          trackerHeight = $(tracker).innerHeight();
+          position = $(document).scrollTop();
+
+      // Make sure the tracker parent stays aligned with the leader.
+      $(tracker).parent().css('top', top);
+
+      // Keep the trigger visible when the leader is in view.
+      if (top < position && (bottom - trackerHeight) > position && !$(tracker).hasClass('following')) {
+        $(tracker).addClass('following').css('top', $('.region-page-top').offset().top);
+      }
+      else if ((top >= position || (bottom - trackerHeight) <= position) && $(tracker).hasClass('following')) {
+        $(tracker).removeClass('following').css('top', '');
+      }
+    }
+  }
+
+  /**
+   * Collapse the filter options for search.
+   */
+  Drupal.behaviors.filterDrawer = {
+    attach: function (context, settings) {
+      $('.page-search .region-two-33-66-first, .page-events .region-three-25-50-25-first', context).once('filterDrawer', function () {
+        var filters = $(this),
+            filterTrigger = $('<a/>', {'href': '#filter-drawer', 'class': 'filter-trigger', 'id': 'filter-drawer'}).text(Drupal.t('Filter results')),
+            filterOverlay = $('<div/>', {'class': 'filter-overlay'}),
+            results = $('.search-results-content, .pane-search-result'),
+            size = $(window).width(),
+            triggerWidth = '';
+
+        // Only function if there are filters available.
+        if (filters.find('.panel-pane').length > 0) {
+          // Determine if the page is for search or events and set the target
+          // width.
+          if ($('.page-search', context).length > 0) {
+            triggerWidth = 480;
+          }
+          else if ($('.page-events', context).length > 0) {
+            triggerWidth = 768;
+          }
+
+          // Add process flags and styling elements.
+          $(this).prepend(filterTrigger).addClass('filters-processed');
+          $('body').append(filterOverlay);
+
+          // Make sure the trigger is in place on the initial page load.
+          if (size <= triggerWidth) {
+            showWithElement(filterTrigger, results);
+          }
+
+          // Define the clickable areas to control the visibility of the filters.
+          $(filterTrigger).click(function () {
+            if ($(filterTrigger).hasClass('following')) {
+              $(filterTrigger).removeClass('following');
+            }
+            $(filters).toggleClass('expanded');
+            $(filterOverlay).toggleClass('expanded');
+
+            if ($(filters).hasClass('expanded')) {
+              $('html, body').animate({
+                scrollTop: $(filterTrigger).offset().top - $('.region-page-top').offset().top
+              }, 0);
+            }
+
+            return false;
+          });
+          $(filterOverlay).click(function () {
+            $(filters).toggleClass('expanded');
+            $(filterOverlay).toggleClass('expanded');
+            showWithElement(filterTrigger, results);
+          });
+
+          // Make the filterToggle follow the search results when scrolling and
+          // resizing.
+          $(window).resize(function () {
+            size = $(window).width();
+            if (size <= triggerWidth) {
+              showWithElement(filterTrigger, results);
+            }
+            else {
+              $(filters).css('top', '').removeClass('expanded');
+              $(filterOverlay).removeClass('expanded');
+            }
+          });
+          $(document).scroll(function () {
+            if (!$(filters).hasClass('expanded')) {
+              showWithElement(filterTrigger, results);
+            }
+          });
+        }
+      });
+    }
+  };
+})(jQuery);
diff --git a/themes/commons/commons_origins/scripts/media_queries.js b/themes/commons/commons_origins/scripts/media_queries.js
new file mode 100755
index 0000000..a96023c
--- /dev/null
+++ b/themes/commons/commons_origins/scripts/media_queries.js
@@ -0,0 +1,87 @@
+/**
+ * @file
+ * Fire callbacks for media query breakpoints
+ *
+ * To use this file enable the OnMediaQuery.js polyfill in your subthemes
+ * appearance settings - this will load the required plugin and this file.
+ *
+ * This allows you to write context (media query) specific JS without hard
+ * coding the media queries, aka like matchMedia. Each context matches the
+ * media queries you set in theme settings (by adding the font-family
+ * declarations to the responsive layout CSS).
+ *
+ * SEE: https://github.com/JoshBarr/js-media-queries (really, go look, lots of
+ * useful documentation available).
+ *
+ * IMPORTANT: do not rename or move this file, or change the directory name!
+ */
+var queries = [
+  // README! The following are examples, remove what you don't need!
+
+
+  // Smartphone
+  {
+    context: ['smartphone_portrait', 'smartphone_landscape'],
+    call_in_each_context: false,
+    callback: function() {
+      // Debug
+      console.log('smartphone');
+    }
+  },
+  // portrait only
+  {
+    context: 'smartphone_portrait',
+    callback: function() {
+      // Debug
+      console.log('smartphone portrait');
+    }
+  },
+  // landscape only
+  {
+    context: 'smartphone_landscape',
+    callback: function() {
+      // Debug
+      console.log('smartphone_landscape ');
+    }
+  },
+
+
+  // Tablet
+  {
+    context: ['tablet_portrait', 'tablet_landscape'],
+    call_in_each_context: false,
+    callback: function() {
+      // Debug
+      console.log('tablet');
+    }
+  },
+  // portrait only
+  {
+    context: 'tablet_portrait',
+    callback: function() {
+      // Debug
+      console.log('tablet_portrait');
+    }
+  },
+  // landscape only
+  {
+    context: 'tablet_landscape',
+    callback: function() {
+      // Debug
+      console.log('tablet_landscape');
+    }
+  },
+
+
+  // Standard desktop context
+  {
+    context: 'standard',
+    callback: function() {
+      // Debug
+      console.log('standard desktop');
+    }
+  },
+];
+
+// Go!
+MQ.init(queries);
diff --git a/themes/commons/commons_origins/scripts/modernizr.js b/themes/commons/commons_origins/scripts/modernizr.js
new file mode 100644
index 0000000..3d522fa
--- /dev/null
+++ b/themes/commons/commons_origins/scripts/modernizr.js
@@ -0,0 +1,4 @@
+/* Modernizr 2.6.1 (Custom Build) | MIT & BSD
+ * Build: http://modernizr.com/download/#-boxshadow-cssclasses-testprop-testallprops-domprefixes
+ */
+;window.Modernizr=function(a,b,c){function x(a){j.cssText=a}function y(a,b){return x(prefixes.join(a+";")+(b||""))}function z(a,b){return typeof a===b}function A(a,b){return!!~(""+a).indexOf(b)}function B(a,b){for(var d in a){var e=a[d];if(!A(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function C(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:z(f,"function")?f.bind(d||b):f}return!1}function D(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+n.join(d+" ")+d).split(" ");return z(b,"string")||z(b,"undefined")?B(e,b):(e=(a+" "+o.join(d+" ")+d).split(" "),C(e,b,c))}var d="2.6.1",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k,l={}.toString,m="Webkit Moz O ms",n=m.split(" "),o=m.toLowerCase().split(" "),p={},q={},r={},s=[],t=s.slice,u,v={}.hasOwnProperty,w;!z(v,"undefined")&&!z(v.call,"undefined")?w=function(a,b){return v.call(a,b)}:w=function(a,b){return b in a&&z(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=t.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(t.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(t.call(arguments)))};return e}),p.boxshadow=function(){return D("boxShadow")};for(var E in p)w(p,E)&&(u=E.toLowerCase(),e[u]=p[E](),s.push((e[u]?"":"no-")+u));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)w(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},x(""),i=k=null,e._version=d,e._domPrefixes=o,e._cssomPrefixes=n,e.testProp=function(a){return B([a])},e.testAllProps=D,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+s.join(" "):""),e}(this,this.document);
\ No newline at end of file
diff --git a/themes/commons/commons_origins/scripts/syze.min.js b/themes/commons/commons_origins/scripts/syze.min.js
new file mode 100644
index 0000000..cf195e1
--- /dev/null
+++ b/themes/commons/commons_origins/scripts/syze.min.js
@@ -0,0 +1,2 @@
+// syze v1.1.1 MIT/GPL2 @rezitech
+(function(a,b){function j(){var f=/^device$/i.test(String(e))?!a.orientation||orientation==180?screen.width:screen.height:/^browser$/i.test(String(e))?b.clientWidth:e instanceof String?Function("return "+e)():parseInt(e,10)||0,h=b.className.replace(/^\s+|(^|\s)(gt|is|lt)[^\s]+|\s+$/g,"").split(/\s+/),i=[],j=-1,k,l=c,m=l.length;l.sort(function(a,b){return a-b});while(++j<m)if(f<l[j])break;f=l[Math.max(Math.min(--j,m-1),0)];j=-1;while(++j<m){i.push((f>l[j]?"gt":f<l[j]?"lt":"is")+(d[l[j]]||l[j]))}b.className=(!h[0]?[]:h).concat(i).join(" ");if(g)g(f)}function i(a){var b;return function(){function e(){a.apply(c,d);b=null}var c=this,d=arguments;if(b)clearTimeout(b);b=setTimeout(e,f)}}function h(b,c){if(a.addEventListener)addEventListener(b,c,false);else attachEvent("on"+b,c)}var c=[],d={},e="browser",f=50,g;a.syze={sizes:function(a){c=[].concat.apply([],arguments);j();return this},names:function(a){if(a instanceof Object){d=a;j()}return this},from:function(a){e=a;j();return this},debounceRate:function(a){f=parseInt(a,10)||0;j();return this},callback:function(a){if(a instanceof Function){g=a;j()}return this}};h("resize",i(j));h("orientationchange",j);j()})(this,document.documentElement)
\ No newline at end of file
diff --git a/themes/commons/commons_origins/template.php b/themes/commons/commons_origins/template.php
new file mode 100755
index 0000000..c6bdbe4
--- /dev/null
+++ b/themes/commons/commons_origins/template.php
@@ -0,0 +1,1334 @@
+<?php
+
+/**
+ * @file
+ * Process theme data.
+ */
+
+/**
+ * Implements hook_theme().
+ */
+function commons_origins_theme($existing, $type, $theme, $path) {
+  return array(
+    // Register the newly added theme_form_content() hook so we can utilize
+    // theme hook suggestions.
+    // @see commons_origins_form_alter().
+    'form_content' => array(
+      'render element' => 'form',
+      'path' => drupal_get_path('theme', 'commons_origins') . '/templates/form',
+      'template' => 'form-content',
+      'pattern' => 'form_content__',
+    ),
+  );
+}
+
+/**
+ * Implements hook_commons_utility_links_alter().
+ */
+function commons_origins_commons_utility_links_alter(&$element) {
+  // Add wrappers to title elements in notification links so that they can be
+  // replaced with an icon.
+  $iconify = array(
+    'unread-invitations',
+    'unread-messages',
+  );
+  foreach ($iconify as $name) {
+    if (isset($element[$name])) {
+      $words = explode(' ', $element[$name]['title']);
+      foreach($words as &$word) {
+        if(is_numeric($word)) {
+          $word = '<span class="notification-count">' . $word . '</span>';
+        }
+        else {
+          $word = '<span class="notification-label element-invisible">' . $word . '</span>';
+        }
+      }
+      $element[$name]['title'] = implode(' ', $words);
+      $element[$name]['html'] = TRUE;
+    }
+  }
+}
+
+/**
+ * Implements hook_preprocess_media_oembed().
+ */
+function commons_origins_preprocess_media_oembed(&$variables) {
+  $content = $variables['content'];
+  $type = $variables['type'];
+
+  // Video and rich type must have HTML content.
+  // Wrap the HTML content in a <div> to allow it to be made responsive.
+  if (in_array($type, array('video', 'rich'))) {
+    $variables['content'] = '<div class="oembed">' . $content . '</div>';
+  }
+}
+
+/**
+ * Implements hook_preprocess_search_result().
+ */
+function commons_origins_preprocess_search_result(&$variables, $hook) {
+  $variables['title_attributes_array']['class'][] = 'title';
+  $variables['title_attributes_array']['class'][] = 'search-result-title';
+  $variables['content_attributes_array']['class'][] = 'search-result-content';
+}
+
+/**
+ * Implements hook_preprocess_search_results().
+ *
+ * Assemble attributes for styling that core does not do so we can keep the
+ * tpl files simpler and make maintaining it a bit less worrisome since there
+ * are 2 forms of search supported.
+ */
+function commons_origins_preprocess_search_results(&$variables, $hook) {
+  $variables['classes_array'][] = 'search-results-wrapper';
+  $variables['title_attributes_array']['class'][] = 'search-results-title';
+  $variables['content_attributes_array']['class'][] = 'search-results-content';
+  $variables['content_attributes_array']['class'][] = 'commons-pod';
+}
+
+/**
+ * Implements hook_process_search_results().
+ */
+function commons_origins_process_search_results(&$variables, $hook) {
+  // Set the title in preprocess so that it can be overridden by modules
+  // further upstream.
+  if (empty($variables['title'])) {
+    $variables['title'] = t('Search results');
+  }
+}
+
+/**
+ * Shows a groups of blocks for starting a search from a filter.
+ */
+function commons_origins_apachesolr_search_browse_blocks($vars) {
+  $result = '';
+  if ($vars['content']['#children']) {
+    $result .= '<div class="apachesolr-browse-blocks">' . "\n";
+    $result .= '  <h2 class="search-results-title">' . t('Browse available categories') . '</h2>' . "\n";
+    $result .= '  <div class="commons-pod">' . "\n";
+    $result .= '    <p>' . t('Pick a category to launch a search.') . '</p>' . "\n";
+    $result .= $vars['content']['#children'] . "\n";
+    $result .= '  </div>' . "\n";
+    $result .= '</div>';
+  }
+
+  return $result;
+}
+
+/**
+ * Preprocess variables for the html template.
+ */
+function commons_origins_preprocess_html(&$variables, $hook) {
+  global $theme_key;
+
+  $site_name = variable_get('site_name', 'Commons');
+
+  // Add a class to the body so we can adjust styles for the new menu item.
+  if (module_exists('commons_search_solr_user')) {
+    $variables['classes_array'][] = 'people-search-active';
+  }
+
+  $palette = variable_get('commons_origins_palette', 'default');
+  if ($palette != 'default') {
+    $variables['classes_array'][] = 'palette-active';
+    $variables['classes_array'][] = drupal_html_class($palette);
+  }
+
+  // Browser/platform sniff - adds body classes such as ipad, webkit, chrome
+  // etc.
+  $variables['classes_array'][] = css_browser_selector();
+}
+
+/**
+ * Implements hook_privatemsg_view_alter().
+ */
+function commons_origins_privatemsg_view_alter(&$elements) {
+  // Wrap the message view and reply form in a commons pod.
+  $elements['#theme_wrappers'][] = 'container';
+  $elements['#attributes']['class'][] = 'privatemsg-conversation';
+  $elements['#attributes']['class'][] = 'commons-pod';
+
+  // Knock the reply form title down an h-level.
+  if (isset($elements['reply']['reply']['#markup'])) {
+    $elements['reply']['reply']['#markup'] = str_replace('h2', 'h3', $elements['reply']['reply']['#markup']);
+  }
+
+  // Apply classes to the form actions and make sure the submit comes first.
+  if (isset($elements['reply']['actions']['submit'])) {
+    $elements['reply']['actions']['submit']['#attributes']['class'][] = 'action-item-primary';
+    $elements['reply']['actions']['submit']['#weight'] = 0;
+  }
+  if (isset($elements['reply']['actions']['cancel'])) {
+    $elements['reply']['actions']['cancel']['#attributes']['class'][] = 'action-item';
+    $elements['reply']['actions']['cancel']['#weight'] = 1;
+  }
+}
+
+/**
+ * Implements hook_privatemsg_message_view_alter().
+ */
+function commons_origins_privatemsg_message_view_alter(&$elements) {
+  if (isset($elements['message_actions'])) {
+    // Move the message links into a different variable and make it a renderable
+    // array. Privatemsg has the links hardcoded, so this is the only way to
+    // gain control and prevent extra processing.
+    $elements['message_links'] = array(
+      '#theme' => 'links__privatemsg_message',
+      '#links' => $elements['message_actions'],
+      '#attributes' => array(
+        'class' => array('privatemsg-message-links', 'links'),
+      ),
+    );
+    unset($elements['message_actions']);
+  }
+}
+
+/**
+ * Implements hook_preprocess_privatemsg_view().
+ */
+function commons_origins_preprocess_privatemsg_view(&$variables, $hook) {
+  // Make the template conform with Drupal standard attributes.
+  if (isset($variables['message_classes'])) {
+    $variables['classes_array'] = array_merge($variables['classes_array'], $variables['message_classes']);
+  }
+  $variables['classes_array'][] = 'clearfix';
+  $variables['attributes_array']['id'] = 'privatemsg-mid-' . $variables['mid'];
+  $variables['content_attributes_array']['class'][] = 'privatemsg-message-content';
+
+  // Add a distinct class to the "Delete" action.
+  if (isset($variables['message_links']['#links'])) {
+    foreach ($variables['message_links']['#links'] as &$link) {
+      // Due to the lack of a proper key-baed identifier, a string search is the
+      // only flexible way to sniff out the link.
+      if (strpos($link['href'], 'delete')) {
+        $link['attributes']['class'][] = 'message-delete';
+      }
+    }
+  }
+}
+
+/**
+ * Implements theme_menu_link().
+ */
+function commons_origins_menu_link($variables) {
+  $output = '';
+  $path_to_at_core = drupal_get_path('theme', 'adaptivetheme');
+
+  include_once($path_to_at_core . '/inc/get.inc');
+
+  global $theme_key;
+  $theme_name = $theme_key;
+
+  $element = $variables['element'];
+  commons_origins_menu_link_class($element);
+  $sub_menu = '';
+
+  if ($element['#below']) {
+    $sub_menu = drupal_render($element['#below']);
+  }
+
+  if (at_get_setting('extra_menu_classes', $theme_name) == 1 && !empty($element['#original_link'])) {
+    if (!empty($element['#original_link']['depth'])) {
+      $element['#attributes']['class'][] = 'menu-depth-' . $element['#original_link']['depth'];
+    }
+    if (!empty($element['#original_link']['mlid'])) {
+      $element['#attributes']['class'][] = 'menu-item-' . $element['#original_link']['mlid'];
+    }
+  }
+
+  if (at_get_setting('menu_item_span_elements', $theme_name) == 1 && !empty($element['#title'])) {
+    $element['#title'] = '<span>' . $element['#title'] . '</span>';
+    $element['#localized_options']['html'] = TRUE;
+  }
+
+  if (at_get_setting('unset_menu_titles', $theme_name) == 1 && !empty($element['#localized_options']['attributes']['title'])) {
+    unset($element['#localized_options']['attributes']['title']);
+  }
+
+  $output = l($element['#title'], $element['#href'], $element['#localized_options']);
+  return '<li' . drupal_attributes($element['#attributes']) . '>' . $output . $sub_menu . "</li>";
+}
+
+/**
+ * Helper function to examine menu links and return the appropriate class.
+ */
+function commons_origins_menu_link_class(&$element)  {
+  if ($element['#original_link']['menu_name'] == 'main-menu') {
+    $element['#attributes']['class'][] = drupal_html_class($element['#original_link']['menu_name'] . '-' . $element['#original_link']['router_path']);
+  }
+}
+
+/**
+ * Override or insert variables for the page templates.
+ */
+function commons_origins_preprocess_page(&$variables, $hook) {
+  if (module_exists('page_manager')) {
+    $p = page_manager_get_current_page();
+    if (isset($p['name']) && $p['name'] == 'node_view') {
+      $node = $p['contexts']['argument_entity_id:node_1']->data;
+      if (module_exists('og') && !og_is_group('node', $node)) {
+        $variables['hide_panelized_title'] = 1;
+      }
+    }
+  }
+
+  $variables['header_attributes_array']['class'][] = 'container';
+
+  $cf_pos = in_array('clearfix', $variables['branding_attributes_array']['class']);
+  unset($variables['branding_attributes_array']['class'][$cf_pos]);
+
+  // Only load the media styles if Commons Media is enabled.
+  if (module_exists('commons_media')) {
+    drupal_add_css(drupal_get_path('theme', 'commons_origins') . '/css/commons-media.css', array('media' => 'screen', 'group' => CSS_THEME));
+  }
+}
+
+/**
+ * Override or insert variables into the node templates.
+ */
+function commons_origins_preprocess_node(&$variables, $hook) {
+  $node = $variables['node'];
+
+  // Some content does not get a user image on the full node.
+  $no_avatar = array(
+    'event',
+    'group',
+    'page',
+    'wiki',
+  );
+  if (!$variables['teaser'] && in_array($node->type, $no_avatar)) {
+    $variables['user_picture'] = '';
+  }
+
+  // If there does happen to be a user image, add a class for styling purposes.
+  if (!empty($variables['user_picture'])) {
+    $variables['classes_array'][] = 'user-picture-available';
+  }
+
+  // Style node links like buttons.
+  if (isset($variables['content']['links'])) {
+    foreach ($variables['content']['links'] as $type => &$linkgroup) {
+      // Button styling for the "rate" and "flag" types will be handled
+      // separately.
+      if ($type != 'rate' && $type != 'flag' && substr($type, 0, 1) != '#') {
+        foreach ($linkgroup['#links'] as $name => &$link) {
+          // Prevent errors when no classes have been defined.
+          if (!isset($link['attributes']['class'])) {
+            $link['attributes']['class'] = array();
+          }
+
+          // Apply button classes to everything but comment_forbidden.
+          if ($name != 'comment_forbidden' && $name != 'answer-add' && !is_string($link['attributes']['class'])) {
+            $link['attributes']['class'][] = 'action-item-small';
+            $link['attributes']['class'][] = 'action-item-inline';
+          }
+          elseif ($name != 'comment_forbidden' && $name != 'answer-add') {
+            $link['attributes']['class'] .= ' action-item-small action-item-inline';
+          }
+        }
+        // Clean the reference so it does not confuse things further down.
+        unset($link);
+      }
+    }
+  }
+
+  // Add classes to render the comment-comments link as a button with a number
+  // attached.
+  if (!empty($variables['content']['links']['comment']['#links']['comment-comments'])) {
+    $comments_link = &$variables['content']['links']['comment']['#links']['comment-comments'];
+    $comments_link['attributes']['class'][] = 'link-with-counter';
+    $chunks = explode(' ', $comments_link['title']);
+
+    // Add appropriate classes to words in the title.
+    foreach ($chunks as &$chunk) {
+      if ($chunk == $variables['comment_count']) {
+        $chunk = '<span class="action-item-small-append">' . $variables['comment_count'] . '</span>';
+      }
+      else {
+        $chunk = '<span class="element-invisible">' . $chunk . '</span>';
+      }
+    }
+    $comments_link['title'] = implode(' ', $chunks);
+  }
+
+  // Push the reporting link to the end.
+  if (!empty($variables['content']['links']['flag']['#links']['flag-inappropriate_node'])) {
+    $variables['content']['report_link'] = array('#markup' => $variables['content']['links']['flag']['#links']['flag-inappropriate_node']['title']);
+  }
+
+  if (!empty($variables['content']['links'])) {
+    // Hide some of the node links.
+    $hidden_links = array(
+      'node' => array(
+        'node-readmore',
+      ),
+      'comment' => array(
+        'comment-add',
+        'comment-new-comments'
+      ),
+      'flag' => array(
+        'flag-inappropriate_node',
+      ),
+    );
+    foreach ($hidden_links as $element => $links) {
+      foreach ($links as $link) {
+        if (!empty($variables['content']['links'][$element]['#links'][$link])) {
+          $variables['content']['links'][$element]['#links'][$link]['#access'] = FALSE;
+        }
+      }
+    }
+  }
+
+  // Add a class to the node when there is a logo image.
+  if (!empty($variables['field_logo'])) {
+    $variables['classes_array'][] = 'logo-available';
+  }
+
+  // Move the answer link on question nodes to the top of the content.
+  if ($variables['node']->type == 'question' && !empty($variables['content']['links']['answer'])) {
+    $variables['content']['answer'] = $variables['content']['links']['answer'];
+    $variables['content']['answer']['#attributes']['class'][] = 'node-actions';
+    $variables['content']['answer']['#links']['answer-add']['attributes']['class'][] = 'action-item-primary';
+    $variables['content']['answer']['#weight'] = -100;
+    $variables['content']['links']['answer']['#access'] = FALSE;
+  }
+
+  // Groups the related fields into their own container.
+  $related_information = array(
+    'og_group_ref',
+    'field_related_question',
+    'field_topics',
+  );
+  foreach($related_information as $field) {
+    if (!empty($variables['content'][$field])) {
+      $variables['content']['related_information'][$field] = $variables['content'][$field];
+      hide($variables['content'][$field]);
+    }
+  }
+  if (!empty($variables['content']['related_information'])) {
+    $variables['content']['related_information'] += array(
+      '#theme_wrappers' => array('container'),
+      '#attributes' => array(
+        'class' => array('related-information', 'clearfix'),
+      ),
+      '#weight' => 1000,
+    );
+  }
+
+  // Add classes when there is a voting widget present.
+  if (!empty($variables['content']['rate_commons_answer'])) {
+    $variables['content_attributes_array']['class'][] = 'has-rate-widget';
+    $variables['content']['rate_commons_answer']['#weight'] = 999;
+  }
+
+  // Add a general class to the node links.
+  if (!empty($variables['content']['links'])) {
+    $variables['content']['links']['#attributes']['class'][] = 'node-action-links';
+
+    // For some reason, the node links processing is not always added and
+    // multiple ul elements are output instead of a single.
+    if (!isset($variables['content']['links']['#pre_render']) || !in_array('drupal_pre_render_links', $variables['content']['links']['#pre_render'])) {
+      $variables['content']['links']['#pre_render'][] = 'drupal_pre_render_links';
+    }
+  }
+}
+
+/**
+ * Implements hook_preprocess_comment_wrapper().
+ */
+function commons_origins_preprocess_comment_wrapper(&$variables, $hook) {
+  // Change things around to use the attribute arrays for the titles.
+  $variables['title_attributes_array']['class'][] = 'comments-title';
+  $variables['form_title_attributes_array'] = array(
+    'class' => array('comment-title', 'title', 'comment-form', 'comment-form-title')
+  );
+}
+
+/**
+ * Implements hook_process_comment_wrapper().
+ */
+function commons_origins_process_comment_wrapper(&$variables, $hook) {
+  // Make sure the form_title_attributes_array is rendered into a single string.
+  $variables['form_title_attributes'] = drupal_attributes($variables['form_title_attributes_array']);
+}
+
+/**
+ * Implements hook_preprocess_comment().
+ */
+function commons_origins_preprocess_comment(&$variables, $hook) {
+  $variables['content']['links']['#attributes']['class'][] = 'comment-links';
+
+  // Push the reporting link to the end.
+  if (!empty($variables['content']['links']['flag']['#links']['flag-inappropriate_comment'])) {
+    $variables['content']['report_link'] = array('#markup' => $variables['content']['links']['flag']['#links']['flag-inappropriate_comment']['title']);
+    $variables['content']['links']['flag']['#links']['flag-inappropriate_comment']['#access'] = FALSE;
+  }
+}
+
+/**
+ * Implements hook_preprocess_flag().
+ */
+function commons_origins_preprocess_flag(&$variables, $hook) {
+  if (strpos($variables['flag_name_css'], 'inappropriate-') !== 0) {
+    // Style the flag links like buttons.
+    if ($variables['last_action'] == 'flagged') {
+      $variables['flag_classes_array'][] = 'action-item-small-active';
+    }
+    else {
+      $variables['flag_classes_array'][] = 'action-item-small';
+    }
+    $variables['flag_classes'] = implode(' ', $variables['flag_classes_array']);
+  }
+}
+
+/**
+ * Implements hook_preprocess_two_33_66().
+ */
+function commons_origins_preprocess_two_33_66(&$variables, $hook) {
+  $menu = menu_get_item();
+
+  // Suggest a variant for the search page so the facets will be wrapped in pod
+  // styling.
+  if (strpos($menu['path'], 'search') === 0) {
+    $variables['theme_hook_suggestions'][] = 'two_33_66__search';
+  }
+}
+
+function commons_origins_preprocess_three_25_50_25(&$variables, $hook) {
+  $menu = menu_get_item();
+
+  // Suggest a variant for the search page so the facets will be wrapped in pod
+  // styling.
+  if (isset($menu['page_arguments']) && $menu['page_arguments'][0] == 'solr_events') {
+    $variables['theme_hook_suggestions'][] = 'three_25_50_25__events';
+  }
+}
+
+/**
+ * Implements hook_preprocess_panelizer_view_mode().
+ */
+function commons_origins_preprocess_panelizer_view_mode(&$variables, $hook) {
+  // Add classed to identity the entity type being overridden.
+  $variables['classes_array'][] = drupal_html_class('panelizer-' . $variables['element']['#entity_type']);
+  $variables['title_attributes_array']['class'][] = drupal_html_class($variables['element']['#entity_type'] . '-title');
+  $variables['title_attributes_array']['class'][] = drupal_html_class('panelizer-' . $variables['element']['#entity_type'] . '-title');
+
+  // Add some extra theme hooks for the subthemers.
+  $variables['hook_theme_suggestions'][] = $hook . '__' . $variables['element']['#entity_type'];
+  $variables['hook_theme_suggestions'][] = $hook . '__' . $variables['element']['#entity_type'] . '__' . $variables['element']['#bundle'];
+}
+
+/**
+ * Implements hook_preprocess_panels_pane().
+ */
+function commons_origins_preprocess_panels_pane(&$variables, $hook) {
+  $pane = $variables['pane'];
+
+  // Add pod styling to some of the panels panes.
+  $not_pods = array(
+    'commons_events-commons_events_create_event_link',
+  );
+  $content_pods = array(
+    'commons_question_answers-panel_pane_1',
+  );
+  if (($pane->panel == 'two_66_33_second' && !in_array($pane->subtype, $not_pods)) || in_array($pane->subtype, $content_pods)) {
+    $variables['attributes_array']['class'][] = 'commons-pod';
+  }
+
+  // Mimic the class for the facetapi blocks on the panel variant.
+  if (strpos($pane->subtype, 'facetapi-') === 0) {
+    $variables['attributes_array']['class'][] = 'block-facetapi';
+  }
+
+  // Hide the pane title for the group contributor count.
+  if ($pane->subtype == 'node:commons-groups-group-contributors-count-topics') {
+    $variables['title_attributes_array']['class'][] = 'element-invisible';
+  }
+
+  // Apply common classes to the recent items related to a group.
+  static $recent_count = 0;
+  if ($pane->subtype == 'commons_groups_recent_content' || $pane->subtype == 'commons_contributors_group-panel_pane_1') {
+    $variables['attributes_array']['class'][] = 'group-recent-data';
+    $variables['attributes_array']['class'][] = $recent_count % 2 == 0 ? 'group-recent-data-even' : 'group-recent-data-odd';
+    $recent_count++;
+  }
+
+  // Hide the groups view title since it is redundant.
+  if ($pane->subtype == 'commons_groups_directory-panel_pane_1') {
+    $variables['title_attributes_array']['class'][] = 'element-invisible';
+  }
+}
+
+/**
+ * Overrides theme_panels_default_style_render_region();
+ */
+function commons_origins_panels_default_style_render_region($variables) {
+  $output = '';
+  // Remove the empty panels-separator div.
+  $output .= implode("\n", $variables['panes']);
+  return $output;
+}
+
+/**
+ * Implements hook_preprocess_views_view().
+ */
+function commons_origins_preprocess_views_view(&$variables, $hook) {
+  $view = $variables['view'];
+
+  // Wrap page views in pod styling.
+  if ($view->display_handler->plugin_name == 'page') {
+    $variables['classes_array'][] = 'commons-pod';
+    $variables['classes_array'][] = 'clearfix';
+  }
+
+  // Style some views without bottom borders and padding.
+  $plain = array(
+    'commons_groups_directory' => array('panel_pane_1'),
+    'commons_groups_recent_content' => array('block'),
+    'commons_groups_user_groups' => array('panel_pane_1'),
+    'commons_radioactivity_groups_active_in_group' => array('panel_pane_1'),
+  );
+  if (isset($plain[$variables['name']]) && in_array($variables['display_id'], $plain[$variables['name']])) {
+    $variables['classes_array'][] = 'view-plain';
+  }
+}
+
+/**
+ * Implements hook_preprocess_views_view_unformatted().
+ */
+function commons_origins_preprocess_views_view_unformatted(&$variables, $hook) {
+  $view = $variables['view'];
+
+  // Prevent the avatars in the activity stream blocks from bleeding into the
+  // rows below them.
+  if ($view->name == 'commons_activity_streams_activity') {
+    foreach ($variables['classes_array'] as &$classes) {
+      $classes .= ' clearfix';
+    }
+  }
+
+  // Add a class to rows designating the node type for the rows that give us the
+  // node type information.
+  foreach ($view->result as $id => $result) {
+    if (isset($result->node_type)) {
+      $variables['classes_array'][$id] .= ' ' . drupal_html_class('row-type-' . $result->node_type);
+    }
+    else if (($view->name == 'commons_events_upcoming' && $view->override_path != 'events') || $view->name == 'commons_events_user_upcoming_events') {
+      $variables['classes_array'][$id] .= ' ' . drupal_html_class('row-type-event');
+    }
+  }
+}
+
+/**
+ * Implements hook_preprocess_pager().
+ */
+function commons_origins_preprocess_pager_link (&$variables, $hook) {
+  // Style pager links like buttons.
+  $variables['attributes']['class'][] = 'action-item';
+  $variables['attributes']['class'][] = 'action-item-inline';
+}
+
+/**
+ * Implements hook_preprocess_form().
+ *
+ * Since Commons Origins overrides the default theme_form() function, we will
+ * need to perform some processing on attributes to make it work in a template.
+ */
+function commons_origins_preprocess_form(&$variables, $hook) {
+  // Bootstrap the with some of Drupal's default variables.
+  template_preprocess($variables, $hook);
+
+  $element = &$variables['element'];
+  if (isset($element['#action'])) {
+    $element['#attributes']['action'] = drupal_strip_dangerous_protocols($element['#action']);
+  }
+  element_set_attributes($element, array('method', 'id'));
+  if (empty($element['#attributes']['accept-charset'])) {
+    $element['#attributes']['accept-charset'] = "UTF-8";
+  }
+  $variables['attributes_array'] = $element['#attributes'];
+
+  // Roll the classes into the attributes.
+  if (empty($variables['attributes_array']['class'])) {
+    $variables['attributes_array']['class'] = $variables['classes_array'];
+  }
+  else {
+    $variables['attributes_array']['class'] = array_merge($variables['attributes_array']['class'], $variables['classes_array']);
+  }
+
+  // Give the search form on the search page pod styling.
+  if (isset($element['#search_page']) || (isset($element['module']) && ($element['module']['#value'] == 'search_facetapi' || $element['module']['#value'] == 'user'))) {
+    $variables['attributes_array']['class'][] = 'search-form-page';
+    $variables['attributes_array']['class'][] = 'commons-pod';
+    $variables['attributes_array']['class'][] = 'clearfix';
+  }
+
+  // Wrap some forms in the commons pod styling.
+  $pods = array(
+    'user-login',
+    'user-pass',
+    'user-register-form',
+  );
+  if (in_array($element['#id'], $pods)) {
+    $variables['attributes_array']['class'][] = 'commons-pod';
+  }
+
+  // Give the dynamic filters a special class to target.
+  if (strpos($element['#id'], 'views-exposed-form-commons-homepage-content') === 0 || strpos($element['#id'], 'views-exposed-form-commons-events-upcoming') === 0 || strpos($element['#id'], 'views-exposed-form-commons-bw') === 0) {
+    $variables['attributes_array']['class'][] = 'dynamic-filter-lists';
+  }
+
+  // Give the keyword filter a pod wrapper.
+  if (strpos($element['#id'], 'views-exposed-form-commons-groups') === 0) {
+    $variables['attributes_array']['class'][] = 'keyword-filter';
+    $variables['attributes_array']['class'][] = 'commons-pod';
+  }
+
+  // Set an identifying class to the event attendance form.
+  if(strpos($element['#id'], 'commons-events-attend-event-form') === 0) {
+    $variables['attributes_array']['class'][] = 'node-actions';
+  }
+
+  // Make sure the bottom of the partial node form clears all content.
+  if (strpos($element['#form_id'], 'commons_bw_partial_node_form_') === 0) {
+    $variables['attributes_array']['class'][] = 'user-picture-available';
+    $variables['attributes_array']['class'][] = 'clearfix';
+  }
+
+  // Place the user avatar to the left of the private message form content.
+  if ($variables['element']['#form_id'] == 'commons_trusted_contacts_messages_popup') {
+    $variables['content_attributes_array']['class'][] = 'user-picture-available';
+  }
+}
+
+/**
+ * Implements hook_process_form().
+ *
+ * Since Commons Origins overrides the default theme_form() function, we will
+ * need to perform some processing on attributes to make it work in a template.
+ */
+function commons_origins_process_form(&$variables, $hook) {
+  // Crunch down attribute arrays.
+  template_process($variables, $hook);
+}
+
+/**
+ * Implements hook_preprocess_form_content().
+ */
+function commons_origins_preprocess_form_content(&$variables, $hook) {
+  // Bootstrap the with some of Drupal's default variables.
+  template_preprocess($variables, $hook);
+
+  if (isset($variables['form']['supplementary'])) {
+    foreach ($variables['form']['supplementary'] as &$field) {
+      if (is_array($field) && isset($field['#theme_wrappers'])) {
+        $field['#theme_wrappers'][] = 'container';
+        $field['#attributes']['class'][] = 'commons-pod';
+      }
+    }
+  }
+
+  // The buttons for toggling event attendance should be large and noticeable.
+  // These forms have a varying form id, so check for if the id contains a
+  // string instead of the whole thing.
+  if (strpos($variables['form']['#form_id'], 'commons_events_attend_event_form') === 0) {
+    $variables['form']['submit']['#attributes']['class'][] = 'action-item-primary';
+  }
+  if (strpos($variables['form']['#form_id'], 'commons_events_cancel_event_form') === 0) {
+    $variables['form']['submit']['#attributes']['class'][] = 'action-item-active';
+  }
+
+  // Make the "Save" button more noticeable.
+  if (isset($variables['form']['#node_edit_form']) && $variables['form']['#node_edit_form']) {
+    $variables['form']['actions']['submit']['#attributes']['class'][] = 'action-item-primary';
+  }
+
+  // Make the comment form "Save" button more noticeable.
+  if ($variables['form']['#id'] == 'comment-form') {
+    $variables['form']['actions']['submit']['#attributes']['class'][] = 'action-item-primary';
+  }
+
+  // Hide the label and make the search button primary.
+  if (isset($variables['form']['#search_page']) || (isset($variables['form']['module']) && ($variables['form']['module']['#value'] == 'search_facetapi' || $variables['form']['module']['#value'] == 'user'))) {
+    $variables['form']['basic']['keys']['#title_display'] = 'invisible';
+    $variables['form']['basic']['submit']['#attributes']['class'][] = 'action-item-search';
+  }
+
+  // Make the partial post form submit button a primary action and give some
+  // theme hook suggestions for easy overriding.
+  if (strpos($variables['form']['#form_id'], 'commons_bw_partial_node_form_') === 0) {
+    $variables['form']['actions']['submit']['#attributes']['class'][] = 'action-item-primary';
+    $variables['form']['title']['#markup'] = str_replace('<h3>', '<h3 class="partial-node-form-title">', $variables['form']['title']['#markup']);
+  }
+
+  // Make the links and buttons on the private message forms have the
+  // appropriate styles.
+  if ($variables['form']['#form_id'] == 'commons_trusted_contacts_messages_popup' || $variables['form']['#form_id'] == 'privatemsg_new') {
+    if (isset($variables['form']['actions']['submit'])) {
+      $variables['form']['actions']['submit']['#attributes']['class'][] = 'action-item-primary';
+    }
+    if (isset($variables['form']['actions']['full_form'])) {
+      $variables['form']['actions']['full_form']['#attributes']['class'][] = 'action-item';
+    }
+    if (isset($variables['form']['actions']['cancel'])) {
+      $variables['form']['actions']['cancel']['#attributes']['class'][] = 'action-item';
+      $variables['form']['actions']['cancel']['#weight'] = $variables['form']['actions']['submit']['#weight'] + 1;
+    }
+  }
+}
+
+/**
+ * Implements hook_process_form_content().
+ */
+function commons_origins_process_form_content(&$variables, $hook) {
+  // Crunch down attribute arrays.
+  template_process($variables, $hook);
+}
+
+/**
+ * Implements hook_preprocess_rate_template_commons_like().
+ */
+function commons_origins_preprocess_rate_template_commons_like(&$variables, $hook) {
+  // Roll the content into a renderable array to make the template simpler.
+  $variables['content'] = array(
+    'link' => array(
+      '#theme' => 'rate_button__commons_like',
+      '#text' => $variables['links'][0]['text'],
+      '#href' => $variables['links'][0]['href'],
+      '#class' => 'rate-commons-like-btn action-item-small action-item-merge',
+    ),
+    'count' => array(
+      '#theme' => 'html_tag',
+      '#tag' => 'span',
+      '#value' => $variables['results']['count'],
+      '#attributes' => array(
+        'class' => array(
+          'rate-commons-like-count',
+          'action-item-small-append',
+          'action-item-merge',
+        ),
+      ),
+    ),
+  );
+}
+
+/**
+ * Overrides hook_rate_button() for commons_like.
+ */
+function commons_origins_rate_button__commons_like($variables) {
+  $text = $variables['text'];
+  $href = $variables['href'];
+  $class = $variables['class'];
+  static $id = 0;
+  $id++;
+
+  $classes = 'rate-button';
+  if ($class) {
+    $classes .= ' ' . $class;
+  }
+  if (empty($href)) {
+    // Widget is disabled or closed.
+    return '<span class="' . $classes . '" id="rate-button-' . $id . '">' .
+      '<span class="element-invisible">' . check_plain($text) . '</span>' .
+      '</span>';
+  }
+  else {
+    return '<a class="' . $classes . '" id="rate-button-' . $id . '" rel="nofollow" href="' . htmlentities($href) . '" title="' . check_plain($text) . '">' .
+      '<span class="element-invisible">' . check_plain($text) . '</span>' .
+      '</a>';
+  }
+}
+
+/**
+ * Implements hook_form_alter().
+ */
+function commons_origins_form_alter(&$form, &$form_state, $form_id) {
+  // Give forms a common theme function so we do not have to declare every
+  // single form we want to override in hook_theme().
+  if (is_array($form['#theme'])) {
+    $hooks = array('form_content');
+    $form['#theme'] = array_merge($form['#theme'], $hooks);
+  }
+  else {
+    $form['#theme'] = array(
+      $form['#theme'],
+      'form_content',
+    );
+  }
+
+  // Description text on these fields is redundant.
+  if ($form_id == 'user_login') {
+    $form['name']['#description'] = '';
+    $form['pass']['#description'] = '';
+  }
+
+  if ($form_id == 'user_register_form') {
+    $form['account']['mail']['#description'] = t('Password reset and notification emails will be sent to this address.');
+  }
+
+  if (isset($form['#node_edit_form']) && $form['#node_edit_form']) {
+    // Vertical tabs muck things up, so things need to be shuffled to get rid
+    // of them.
+    $general_settings = array();
+    foreach ($form as $id => $field) {
+      if (is_array($field) && isset($field['#group']) && $field['#group'] == 'additional_settings' && (!isset($field['#access']) || $field['#access'] !== FALSE)) {
+        $general_settings[$id] = $field;
+        $general_settings[$id]['#collapsible'] = TRUE;
+        $general_settings[$id]['#collapsed'] = TRUE;
+        unset($general_settings[$id]['#group']);
+      }
+    }
+    if (!empty($general_settings)) {
+      $form['general_settings'] = array(
+        '#theme_wrappers' => array('container'),
+        '#attributes' => array(
+          'class' => array('general-settings'),
+        ),
+        '#weight' => 100,
+        'general_settings' => $general_settings,
+      );
+      $form['additional_settings']['#access'] = FALSE;
+    }
+
+    // Declare the fields to go into each column.
+    $supplementary = array(
+      'event_topics',
+      'field_topics',
+      'general_settings',
+    );
+
+    foreach ($supplementary as $field) {
+      if (isset($form[$field])) {
+        // Translate the field to the appropriate container.
+        $form['supplementary'][$field] = $form[$field];
+
+        // Remove access to the old placement instead of unset() to maintain
+        // the legacy information.
+        $form[$field]['#access'] = FALSE;
+      }
+    }
+  }
+}
+
+/**
+ * Implements hook_views_bulk_operations_form_Alter().
+ */
+function commons_origins_views_bulk_operations_form_alter(&$form, $form_state, $vbo) {
+  // change the buttons' fieldset wrapper to a div and push it to the bottom of
+  // the form.
+  $form['select']['#type'] = 'container';
+  $form['select']['#weight'] = 9999;
+}
+
+/**
+ * Implements hook_css_alter().
+ */
+function commons_origins_css_alter(&$css) {
+  // Remove preset styles that interfere with theming.
+  $unset = array(
+    drupal_get_path('module', 'search') . '/search.css',
+    drupal_get_path('module', 'rich_snippets') . '/rich_snippets.css',
+    drupal_get_path('module', 'commons_like') . '/commons-like.css',
+    drupal_get_path('module', 'panels') . '/css/panels.css',
+  );
+  foreach ($unset as $path) {
+    if (isset($css[$path])) {
+      unset($css[$path]);
+    }
+  }
+}
+
+/**
+ * Overrides theme_links() for nodes.
+ *
+ * This allows for the theme to set a link's #access argument to FALSE so it
+ * will not render.
+ */
+function commons_origins_links($variables) {
+  $links = $variables['links'];
+  $attributes = $variables['attributes'];
+  $heading = $variables['heading'];
+  global $language_url;
+  $output = '';
+
+  if (count($links) > 0) {
+    $output = '';
+
+    // Treat the heading first if it is present to prepend it to the
+    // list of links.
+    if (!empty($heading)) {
+      if (is_string($heading)) {
+        // Prepare the array that will be used when the passed heading
+        // is a string.
+        $heading = array(
+          'text' => $heading,
+          // Set the default level of the heading.
+          'level' => 'h2',
+        );
+      }
+      $output .= '<' . $heading['level'];
+      if (!empty($heading['class'])) {
+        $output .= drupal_attributes(array('class' => $heading['class']));
+      }
+      $output .= '>' . check_plain($heading['text']) . '</' . $heading['level'] . '>';
+    }
+
+    $output .= '<ul' . drupal_attributes($attributes) . '>';
+
+    $num_links = count($links);
+    $i = 1;
+
+    foreach ($links as $key => $link) {
+      if (!isset($link['#access']) || $link['#access'] !== FALSE) {
+        $class = array($key);
+
+        // Add first, last and active classes to the list of links to help out themers.
+        if ($i == 1) {
+          $class[] = 'first';
+        }
+        if ($i == $num_links) {
+          $class[] = 'last';
+        }
+        if (isset($link['href']) && ($link['href'] == $_GET['q'] || ($link['href'] == '<front>' && drupal_is_front_page())) && (empty($link['language']) || $link['language']->language == $language_url->language)) {
+          $class[] = 'active';
+        }
+        $output .= '<li' . drupal_attributes(array('class' => $class)) . '>';
+
+        if (isset($link['href'])) {
+          // Pass in $link as $options, they share the same keys.
+          $output .= l($link['title'], $link['href'], $link);
+        }
+        elseif (!empty($link['title'])) {
+          // Some links are actually not links, but we wrap these in <span> for adding title and class attributes.
+          if (empty($link['html'])) {
+            $link['title'] = check_plain($link['title']);
+          }
+          $span_attributes = '';
+          if (isset($link['attributes'])) {
+            $span_attributes = drupal_attributes($link['attributes']);
+          }
+          $output .= '<span' . $span_attributes . '>' . $link['title'] . '</span>';
+        }
+
+        $i++;
+        $output .= "</li>\n";
+      }
+    }
+
+    $output .= '</ul>';
+  }
+
+  return $output;
+}
+
+/**
+ * Overrides theme_fieldset().
+ *
+ * Add another div wrapper around fieldsets for styling purposes.
+ */
+function commons_origins_fieldset($variables) {
+  $element = $variables['element'];
+  element_set_attributes($element, array('id'));
+  _form_set_class($element, array('form-wrapper'));
+
+  $output = '<fieldset' . drupal_attributes($element['#attributes']) . '>';
+  if (!empty($element['#title'])) {
+    // Always wrap fieldset legends in a SPAN for CSS positioning.
+    $output .= '<legend><span class="fieldset-legend">' . $element['#title'] . '</span></legend>';
+  }
+  $output .= '<div class="fieldset-wrapper">';
+  if (!empty($element['#description'])) {
+    $output .= '<div class="fieldset-description">' . $element['#description'] . '</div>';
+  }
+  $output .= $element['#children'];
+  if (isset($element['#value'])) {
+    $output .= $element['#value'];
+  }
+  $output .= '</div>';
+  $output .= "</fieldset>\n";
+  return '<div class="fieldset-outer-wrapper">' . $output . '</div>';
+}
+
+/**
+ * Process an address to add microformat structure and remove &nbsp;
+ * characters.
+ */
+function _commons_origins_format_address(&$address) {
+  $address['#theme_wrappers'][] = 'container';
+  $address['#attributes']['class'][] = 'adr';
+  if (!empty($address['street_block']['thoroughfare'])) {
+    $address['street_block']['thoroughfare']['#attributes']['class'][] = 'street-address';
+  }
+  if (!empty($address['street_block']['premise'])) {
+    $address['street_block']['premise']['#attributes']['class'][] = 'extended-address';
+  }
+  if (!empty($address['locality_block']['locality'])) {
+    $address['locality_block']['locality']['#suffix'] = ',';
+  }
+  if (!empty($address['locality_block']['administrative_area'])) {
+    $address['locality_block']['administrative_area']['#attributes']['class'][] = 'region';
+    // Remove the hardcoded "&nbsp;&nbsp;" as it causes issues with
+    // formatting.
+    $address['locality_block']['administrative_area']['#prefix'] = ' ';
+  }
+  if (!empty($address['locality_block']['postal_code'])) {
+    // Remove the hardcoded "&nbsp;&nbsp;" as it causes issues with
+    // formatting.
+    $address['locality_block']['postal_code']['#prefix'] = ' ';
+  }
+  if (!empty($address['country'])) {
+    $address['country']['#attributes']['class'][] = 'country-name';
+  }
+}
+
+/**
+ * Implements hook_preprocess_field().
+ */
+function commons_origins_preprocess_field(&$variables, $hook) {
+  // Style the trusted contact link like a button.
+  if ($variables['element']['#formatter'] == 'trusted_contact') {
+    foreach ($variables['items'] as &$item) {
+      if (isset($item['#options'])) {
+        $item['#options']['attributes']['class'][] = 'action-item-small';
+      }
+      if (isset($item['#href']) && strpos($item['#href'], 'messages')) {
+        $item['#options']['attributes']['class'][] = 'message-contact';
+      }
+      elseif (isset($item['#href'])) {
+        $item['#options']['attributes']['class'][] = 'trusted-status-request';
+      }
+    }
+  }
+}
+
+/**
+ * Override theme_html_tag__request_pending().
+ */
+function commons_origins_html_tag__request_pending($variables) {
+  $element = $variables['element'];
+  $element['#attributes']['class'][] = 'action-item-small-active';
+  $element['#attributes']['class'][] = 'trusted-status-pending';
+  $attributes = drupal_attributes($element['#attributes']);
+
+  if (!isset($element['#value'])) {
+    return '<' . $element['#tag'] . $attributes . " />\n";
+  }
+  else {
+    $output = '<' . $element['#tag'] . $attributes . '>';
+    if (isset($element['#value_prefix'])) {
+      $output .= $element['#value_prefix'];
+    }
+    $output .= $element['#value'];
+    if (isset($element['#value_suffix'])) {
+      $output .= $element['#value_suffix'];
+    }
+    $output .= '</' . $element['#tag'] . ">\n";
+    return $output;
+  }
+}
+
+/**
+ * Overrides theme_field() for group fields.
+ *
+ * This will apply button styling to the links for leaving and joining a group.
+ */
+function commons_origins_field__group_group__group($variables) {
+  $output = '';
+
+  // Render the label, if it's not hidden.
+  if (!$variables['label_hidden']) {
+    $output .= '<div class="field-label"' . $variables['title_attributes'] . '>' . $variables['label'] . ':&nbsp;</div>';
+  }
+
+  // Render the items.
+  $output .= '<div class="field-items"' . $variables['content_attributes'] . '>';
+  foreach ($variables['items'] as $delta => $item) {
+    if (isset($item['#type']) && $item['#type'] == 'link') {
+      if (strpos($item['#href'], '/subscribe')) {
+        $item['#options']['attributes']['class'][] = 'action-item-primary';
+      }
+      else {
+        $item['#options']['attributes']['class'][] = 'action-item';
+      }
+    }
+
+    $classes = 'field-item ' . ($delta % 2 ? 'odd' : 'even');
+    $output .= '<div class="' . $classes . '"' . $variables['item_attributes'][$delta] . '>' . drupal_render($item) . '</div>';
+  }
+  $output .= '</div>';
+
+  // Render the top-level DIV.
+  $output = '<div class="' . $variables['classes'] . '"' . $variables['attributes'] . '>' . $output . '</div>';
+
+  return $output;
+}
+
+/**
+ * Overrides theme_field__addressfield().
+ */
+function commons_origins_field__addressfield($variables) {
+  $output = '';
+
+  // Add Microformat classes to each address.
+  foreach($variables['items'] as &$address) {
+    // Only display an address if it has been populated. We determine this by
+    // validating that the administrative area has been populated.
+    if (!empty($address['#address']['administrative_area'])) {
+      _commons_origins_format_address($address);
+    }
+    else {
+      // Deny access to incomplete addresses.
+      $address['#access'] = FALSE;
+    }
+  }
+
+  // Render the label, if it's not hidden.
+  if (!$variables['label_hidden']) {
+    $output .= '<div class="field-label"' . $variables['title_attributes'] . '>' . $variables['label'] . ':</div> ';
+  }
+
+  // Render the items.
+  $output .= '<div class="field-items"' . $variables['content_attributes'] . '>';
+  foreach ($variables['items'] as $delta => $item) {
+    $classes = 'field-item ' . ($delta % 2 ? 'odd' : 'even');
+    $output .= '<div class="' . $classes . '"' . $variables['item_attributes'][$delta] . '>' . drupal_render($item) . '</div>';
+  }
+  $output .= '</div>';
+
+  // Render the top-level DIV.
+  $output = '<div class="' . $variables['classes'] . '"' . $variables['attributes'] . '>' . $output . '</div>';
+
+  return $output;
+}
+
+/**
+ * Implements hook_preprocess_views_view_field().
+ */
+function commons_origins_preprocess_views_view_field(&$variables, $hook) {
+  // Make sure empty addresses are not displayed.
+  // Views does not use theme_field__addressfield(), so we need to process
+  // these implementations separately.
+  if (isset($variables['theme_hook_suggestion']) && $variables['theme_hook_suggestion'] == 'views_view_field__field_address') {
+    foreach ($variables['row']->field_field_address as $key => &$address) {
+      if (!$address['raw']['administrative_area']) {
+        // If an address is incomplete, remove it and tell the system a
+        // rebuild is needed.
+        unset($variables['row']->field_field_address[$key]);
+      }
+      else {
+        _commons_origins_format_address($address['rendered']);
+      }
+    }
+
+    // The output will need rebuilt to get the changes applied.
+    $variables['output'] = $variables['field']->advanced_render($variables['row']);
+  }
+}
+
+/**
+ * Implements hook_preprocess_user_profile().
+ */
+function commons_origins_preprocess_user_profile(&$variables, $hook) {
+  if (in_array('user_profile__search_results', $variables['theme_hook_suggestions'])) {
+    // Give the profile a distinctive class to target and wrap the display in
+    // pod styling.
+    $variables['classes_array'][] = 'profile-search-result';
+    $variables['classes_array'][] = 'commons-pod';
+
+    // Wrap the group list and related title in a div.
+    if (isset($variables['user_profile']['group_membership'])) {
+      $variables['user_profile']['group_membership']['#theme_wrappers'][] = 'container';
+      $variables['user_profile']['group_membership']['#attributes']['class'][] = 'profile-groups';
+    }
+
+    // Group actionable items together in a container.
+    $variables['user_profile']['user_actions'] = array();
+    $user_actions = array(
+      'flags',
+      'privatemsg_send_new_message',
+      'group_group',
+    );
+    foreach ($user_actions as $action) {
+      if (isset($variables['user_profile'][$action])) {
+        $variables['user_profile']['user_actions'][$action] = $variables['user_profile'][$action];
+        $variables['user_profile'][$action]['#access'] = FALSE;
+      }
+    }
+    if (!module_exists('commons_trusted_contacts') && isset(  $variables['user_profile']['user_actions']['group_group'])) {
+      $variables['user_profile']['user_actions']['group_group']['#access'] = FALSE;
+    }
+    if (!empty($variables['user_profile']['user_actions'])) {
+      $variables['user_profile']['user_actions'] += array(
+        '#theme_wrappers' => array('container'),
+        '#attributes' => array(
+          'class' => array('profile-actions'),
+        ),
+      );
+    }
+  }
+}
+
+/**
+ * Implements hook_preprocess_commons_search_solr_user_results().
+ */
+function commons_origins_preprocess_commons_search_solr_user_results(&$variables, $hook) {
+  // Hide the results title.
+  $variables['title_attributes_array']['class'][] = 'element-invisible';
+}
+
+/**
+ * Implements hook_process_node().
+ */
+function commons_origins_process_node(&$variables, $hook) {
+  $node = $variables['node'];
+  $wrapper = entity_metadata_wrapper('node', $node);
+
+  // Use timeago module for formatting node submission date
+  // if it is enabled and also configured to be used on nodes.
+  if (module_exists('timeago') && variable_get('timeago_node', 1)) {
+    $variables['date'] = timeago_format_date($node->created, $variables['date']);
+    $use_timeago_date_format = TRUE;
+  }
+  else {
+    $use_timeago_date_format = FALSE;
+  }
+
+  // Replace the submitted text on nodes with something a bit more pertinent to
+  // the content type.
+  if (variable_get('node_submitted_' . $node->type, TRUE)) {
+    $node_type_info = node_type_get_type($variables['node']);
+    $type_attributes = array('class' => array(
+      'node-content-type',
+      drupal_html_class('node-content-type-' . $node->type),
+    ));
+    $placeholders = array(
+      '!type' => '<span' . drupal_attributes($type_attributes) . '>' . check_plain($node_type_info->name) . '</span>',
+      '!user' => $variables['name'],
+      '!date' => $variables['date'],
+      '@interval' => format_interval(REQUEST_TIME - $node->created),
+    );
+    // Show what group the content belongs to if applicable.
+    if (!empty($node->{OG_AUDIENCE_FIELD}) && $wrapper->{OG_AUDIENCE_FIELD}->count() == 1) {
+      $placeholders['!group'] = l($wrapper->{OG_AUDIENCE_FIELD}->get(0)->label(), 'node/' . $wrapper->{OG_AUDIENCE_FIELD}->get(0)->getIdentifier());
+      if ($use_timeago_date_format == TRUE) {
+        $variables['submitted'] = t('!type created !date in the !group group by !user', $placeholders);
+      }
+      else {
+        $variables['submitted'] = t('!type created @interval ago in the !group group by !user', $placeholders);
+      }
+    }
+    else {
+      if ($use_timeago_date_format == TRUE) {
+        $variables['submitted'] = t('!type created !date by !user', $placeholders);
+      }
+      else {
+        $variables['submitted'] = t('!type created @interval ago by !user', $placeholders);
+      }
+    }
+  }
+
+  // Append a feature label to featured node teasers.
+  if ($variables['teaser'] && $variables['promote']) {
+    $variables['submitted'] .= ' <span class="featured-node-tooltip">' . t('Featured') . ' ' . $variables['type'] . '</span>';
+  }
+}
diff --git a/themes/commons/commons_origins/templates/block/block.tpl.php b/themes/commons/commons_origins/templates/block/block.tpl.php
new file mode 100755
index 0000000..d4166fd
--- /dev/null
+++ b/themes/commons/commons_origins/templates/block/block.tpl.php
@@ -0,0 +1,94 @@
+<?php
+/**
+ * @file
+ * Adativetheme implementation to display a block.
+ *
+ * The block template in Adaptivetheme is a little different to most other themes.
+ * Instead of hard coding its markup Adaptivetheme generates most of it in
+ * adaptivetheme_process_block(), conditionally printing outer and inner wrappers.
+ *
+ * This allows the core theme to have just one template instead of five.
+ *
+ * You can override this in your sub-theme with a normal block suggestion and use
+ * a standard block template if you prefer, or use your own themeName_process_block()
+ * function to control the markup. For example a typical navigation tempate might look
+ * like this:
+ *
+ * @code
+ * <nav id="<?php print $block_html_id; ?>" class="<?php print $classes; ?>"<?php print $attributes; ?>>
+ *   <div class="block-inner clearfix">
+ *     <?php print render($title_prefix); ?>
+ *     <?php if ($block->subject): ?>
+ *       <h2<?php print $title_attributes; ?>><?php print $block->subject; ?></h2>
+ *     <?php endif; ?>
+ *     <?php print render($title_suffix); ?>
+ *     <div<?php print $content_attributes; ?>>
+ *       <?php print $content ?>
+ *     </div>
+ *   </div>
+ * </nav>
+ * @endcode
+ *
+ * Adativetheme supplied variables:
+ * - $outer_prefix: Holds a conditional element such as nav, section or div and
+ *                  includes the block id, classes and attributes.
+ * - $outer_suffix: Closing element.
+ * - $inner_prefix: Inner div with .block-inner and .clearfix classes.
+ * - $inner_suffix: Closing div.
+ * - $title: Holds the block->subject.
+ * - $content_processed: Pre-wrapped in div and attributes, but for some
+ *   blocks these are stripped away, e.g. menu bar and main content.
+ * - $is_mobile: Bool, requires the Browscap module to return TRUE for mobile
+ *   devices. Use to test for a mobile context.
+ *
+ * Available variables:
+ * - $block->subject: Block title.
+ * - $content: Block content.
+ * - $block->module: Module that generated the block.
+ * - $block->delta: An ID for the block, unique within each module.
+ * - $block->region: The block region embedding the current block.
+ * - $classes: String of classes that can be used to style contextually through
+ *   CSS. It can be manipulated through the variable $classes_array from
+ *   preprocess functions. The default values can be one or more of the
+ *   following:
+ *   - block: The current template type, i.e., "theming hook".
+ *   - block-[module]: The module generating the block. For example, the user
+ *     module is responsible for handling the default user navigation block. In
+ *     that case the class would be 'block-user'.
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * Helper variables:
+ * - $classes_array: Array of html class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ * - $block_zebra: Outputs 'odd' and 'even' dependent on each block region.
+ * - $zebra: Same output as $block_zebra but independent of any block region.
+ * - $block_id: Counter dependent on each block region.
+ * - $id: Same output as $block_id but independent of any block region.
+ * - $is_front: Flags true when presented in the front page.
+ * - $logged_in: Flags true when the current user is a logged-in member.
+ * - $is_admin: Flags true when the current user is an administrator.
+ * - $block_html_id: A valid HTML ID and guaranteed unique.
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_block()
+ * @see template_process()
+ * @see adaptivetheme_preprocess_block()
+ * @see adaptivetheme_process_block()
+ */
+?>
+<?php print $outer_prefix . $inner_prefix; ?>
+  <?php print render($title_prefix); ?>
+
+  <?php if ($title): ?>
+    <h3<?php print $title_attributes; ?>><?php print $title; ?></h3>
+  <?php endif; ?>
+
+  <?php print $content_processed; ?>
+
+  <?php print render($title_suffix); ?>
+<?php print $inner_suffix . $outer_suffix; ?>
diff --git a/themes/commons/commons_origins/templates/comment/comment-wrapper--node-question.tpl.php b/themes/commons/commons_origins/templates/comment/comment-wrapper--node-question.tpl.php
new file mode 100644
index 0000000..388885e
--- /dev/null
+++ b/themes/commons/commons_origins/templates/comment/comment-wrapper--node-question.tpl.php
@@ -0,0 +1,51 @@
+<?php
+
+/**
+ * @file
+ * Default theme implementation to provide an HTML container for comments.
+ *
+ * Available variables:
+ * - $content: The array of content-related elements for the node. Use
+ *   render($content) to print them all, or
+ *   print a subset such as render($content['comment_form']).
+ * - $classes: String of classes that can be used to style contextually through
+ *   CSS. It can be manipulated through the variable $classes_array from
+ *   preprocess functions. The default value has the following:
+ *   - comment-wrapper: The current template type, i.e., "theming hook".
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * The following variables are provided for contextual information.
+ * - $node: Node object the comments are attached to.
+ * The constants below the variables show the possible values and should be
+ * used for comparison.
+ * - $display_mode
+ *   - COMMENT_MODE_FLAT
+ *   - COMMENT_MODE_THREADED
+ *
+ * Other variables:
+ * - $classes_array: Array of html class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ *
+ * @see template_preprocess_comment_wrapper()
+ *
+ * @ingroup themeable
+ */
+?>
+<div id="comments" class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <?php if ($content['comments'] && $node->type != 'forum'): ?>
+    <?php print render($title_prefix); ?>
+    <h3 class="title element-invisible"><?php print t('Comments'); ?></h3>
+    <?php print render($title_suffix); ?>
+  <?php endif; ?>
+
+  <?php print render($content['comments']); ?>
+
+  <?php if ($content['comment_form']): ?>
+    <?php print render($content['comment_form']); ?>
+  <?php endif; ?>
+</div>
diff --git a/themes/commons/commons_origins/templates/comment/comment-wrapper.tpl.php b/themes/commons/commons_origins/templates/comment/comment-wrapper.tpl.php
new file mode 100644
index 0000000..0f88142
--- /dev/null
+++ b/themes/commons/commons_origins/templates/comment/comment-wrapper.tpl.php
@@ -0,0 +1,59 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme implementation to provide an HTML container for comments.
+ *
+ * Adaptivetheme variables:
+ * - $is_mobile: Mixed, requires the Mobile Detect or Browscap module to return
+ *   TRUE for mobile.  Note that tablets are also considered mobile devices.
+ *   Returns NULL if the feature could not be detected.
+ * - $is_tablet: Mixed, requires the Mobile Detect to return TRUE for tablets.
+ *   Returns NULL if the feature could not be detected.
+ *
+ * Available variables:
+ * - $content: The array of content-related elements for the node. Use
+ *   render($content) to print them all, or
+ *   print a subset such as render($content['comment_form']).
+ * - $classes: String of classes that can be used to style contextually through
+ *   CSS. It can be manipulated through the variable $classes_array from
+ *   preprocess functions. The default value has the following:
+ *   - comment-wrapper: The current template type, i.e., "theming hook".
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * The following variables are provided for contextual information.
+ * - $node: Node object the comments are attached to.
+ * The constants below the variables show the possible values and should be
+ * used for comparison.
+ * - $display_mode
+ *   - COMMENT_MODE_FLAT
+ *   - COMMENT_MODE_THREADED
+ *
+ * Other variables:
+ * - $classes_array: Array of html class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ *
+ * @see template_preprocess_comment_wrapper()
+ * @see theme_comment_wrapper()
+ */
+?>
+<section id="comments" class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <?php if ($content['comments'] && $node->type != 'forum'): ?>
+    <?php print render($title_prefix); ?>
+    <h2<?php print $title_attributes; ?>><?php print t('Comments'); ?></h2>
+    <?php print render($title_suffix); ?>
+  <?php endif; ?>
+
+  <div<?php print $content_attributes; ?>>
+    <?php print render($content['comments']); ?>
+  </div>
+
+  <?php if ($content['comment_form']): ?>
+    <h2<?php print $form_title_attributes; ?>><?php print t('Add new comment'); ?></h2>
+    <?php print render($content['comment_form']); ?>
+  <?php endif; ?>
+</section>
diff --git a/themes/commons/commons_origins/templates/comment/comment.tpl.php b/themes/commons/commons_origins/templates/comment/comment.tpl.php
new file mode 100644
index 0000000..9c4c7d8
--- /dev/null
+++ b/themes/commons/commons_origins/templates/comment/comment.tpl.php
@@ -0,0 +1,83 @@
+<?php
+
+/**
+ * @file
+ * Default theme implementation for comments.
+ *
+ * Available variables:
+ * - $author: Comment author. Can be link or plain text.
+ * - $content: An array of comment items. Use render($content) to print them all, or
+ *   print a subset such as render($content['field_example']). Use
+ *   hide($content['field_example']) to temporarily suppress the printing of a
+ *   given element.
+ * - $created: Formatted date and time for when the comment was created.
+ *   Preprocess functions can reformat it by calling format_date() with the
+ *   desired parameters on the $comment->created variable.
+ * - $changed: Formatted date and time for when the comment was last changed.
+ *   Preprocess functions can reformat it by calling format_date() with the
+ *   desired parameters on the $comment->changed variable.
+ * - $new: New comment marker.
+ * - $permalink: Comment permalink.
+ * - $submitted: Submission information created from $author and $created during
+ *   template_preprocess_comment().
+ * - $picture: Authors picture.
+ * - $signature: Authors signature.
+ * - $status: Comment status. Possible values are:
+ *   comment-unpublished, comment-published or comment-preview.
+ * - $title: Linked title.
+ * - $classes: String of classes that can be used to style contextually through
+ *   CSS. It can be manipulated through the variable $classes_array from
+ *   preprocess functions. The default values can be one or more of the following:
+ *   - comment: The current template type, i.e., "theming hook".
+ *   - comment-by-anonymous: Comment by an unregistered user.
+ *   - comment-by-node-author: Comment by the author of the parent node.
+ *   - comment-preview: When previewing a new or edited comment.
+ *   The following applies only to viewers who are registered users:
+ *   - comment-unpublished: An unpublished comment visible only to administrators.
+ *   - comment-by-viewer: Comment by the user currently viewing the page.
+ *   - comment-new: New comment since last the visit.
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * These two variables are provided for context:
+ * - $comment: Full comment object.
+ * - $node: Node object the comments are attached to.
+ *
+ * Other variables:
+ * - $classes_array: Array of html class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_comment()
+ * @see template_process()
+ * @see theme_comment()
+ *
+ * @ingroup themeable
+ */
+
+hide($content['report_link']);
+?>
+<div class="<?php print $classes; ?> clearfix"<?php print $attributes; ?>>
+  <h3 class="comment-title"><?php print $title; ?></h3>
+  <div class="author-datetime submitted">
+    <?php print $submitted; ?>
+    <?php if ($new): ?>
+      <span class="new"><?php print $new ?></span>
+    <?php endif; ?>
+  </div>
+  <?php print $picture; ?>
+
+  <div class="content"<?php print $content_attributes; ?>>
+    <?php
+      // We hide the comments and links now so that we can render them later.
+      hide($content['links']);
+      print render($content);
+    ?>
+  </div>
+  <?php print render($content['links']) ?>
+  <?php print render($content['report_link']); ?>
+</div>
diff --git a/themes/commons/commons_origins/templates/commons/rate-template-commons-like.tpl.php b/themes/commons/commons_origins/templates/commons/rate-template-commons-like.tpl.php
new file mode 100644
index 0000000..3123b61
--- /dev/null
+++ b/themes/commons/commons_origins/templates/commons/rate-template-commons-like.tpl.php
@@ -0,0 +1,42 @@
+<?php
+/**
+ * @file
+ * Rate widget theme
+ *
+ * This is the default template for rate widgets. See section 3 of the README
+ * file for information on theming widgets.
+ *
+ * Available variables:
+ * - $links: Array with vote links
+ *     array(
+ *       array(
+ *         'text' => 'Button label',
+ *         'href' => 'Link href',
+ *         'value' => 20,
+ *         'votes' => 6,
+ *       ),
+ *     )
+ * - $results: Array with voting results
+ *     array(
+ *       'rating' => 12, // Average rating
+ *       'options' => array( // Votes per option. Only available when value_type == 'options'
+ *         1 => 234,
+ *         2 => 34,
+ *       ),
+ *       'count' => 23, // Number of votes
+ *       'up' => 2, // Number of up votes. Only available for thumbs up / down.
+ *       'down' => 3, // Number of down votes. Only available for thumbs up / down.
+ *       'up_percent' => 40, // Percentage of up votes. Only available for thumbs up / down.
+ *       'down_percent' => 60, // Percentage of down votes. Only available for thumbs up / down.
+ *       'user_vote' => 80, // Value for user vote. Only available when user has voted.
+ *     )
+ * - $mode: Display mode.
+ * - $just_voted: Indicator whether the user has just voted (boolean).
+ * - $content_type: "node" or "comment".
+ * - $content_id: Node or comment id.
+ * - $buttons: Array with themed buttons (built in preprocess function).
+ * - $info: String with user readable information (built in preprocess function).
+ */
+?>
+
+<?php print render($content); ?>
diff --git a/themes/commons/commons_origins/templates/form/form-content.tpl.php b/themes/commons/commons_origins/templates/form/form-content.tpl.php
new file mode 100644
index 0000000..4b5d319
--- /dev/null
+++ b/themes/commons/commons_origins/templates/form/form-content.tpl.php
@@ -0,0 +1,35 @@
+<?php
+/**
+ * @file form-content.tpl.php
+ * Default template implementation to display the content of a form.
+ *
+ * Available variables:
+ * - $form: An array of form elements. Use render() to output individual
+ *   elements, but drupal_render_children() to render the whole item.
+ */
+?>
+
+<?php
+  // Some nodes are multicolumn, so check for the second column. 
+  if (!empty($form['supplementary'])):
+?>
+  <?php 
+    hide($form['supplementary']); 
+    hide($form['actions']);
+  ?>
+  <div class="columns clearfix">
+    <div class="primary-fields">
+      <?php print drupal_render_children($form); ?>
+    </div>
+    <div class="supplementary-fields">
+      <?php print render($form['supplementary']); ?>
+    </div>
+  </div>
+  <?php print render($form['actions']); ?>
+<?php 
+  // If there is no second column, print everything as normal.
+  else:
+?>
+  <?php print drupal_render_children($form); ?>
+<?php endif; ?>
+
diff --git a/themes/commons/commons_origins/templates/form/form.tpl.php b/themes/commons/commons_origins/templates/form/form.tpl.php
new file mode 100644
index 0000000..b9e41a8
--- /dev/null
+++ b/themes/commons/commons_origins/templates/form/form.tpl.php
@@ -0,0 +1,21 @@
+<?php
+/**
+ * @file
+ * Output a form.
+ *
+ * @see theme_form()
+ * @see commons_origins_preprocess_form()
+ * @see commons_origins_process_form()
+ */
+?>
+<form<?php print $attributes; ?>>
+  <div<?php print $content_attributes; ?>>
+    <?php
+      // Due to the way the Drupal renders forms, we cannot control individual
+      // form elements in this template. If you would like to have more granular
+      // control of the form elements, use form-content.tpl.php or variant.
+    ?>
+    <?php print $element['#children']; ?>
+  </div>
+</form>
+
diff --git a/themes/commons/commons_origins/templates/html/html.tpl.php b/themes/commons/commons_origins/templates/html/html.tpl.php
new file mode 100755
index 0000000..9b535c7
--- /dev/null
+++ b/themes/commons/commons_origins/templates/html/html.tpl.php
@@ -0,0 +1,75 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme implementation to display the basic html structure of a single
+ * Drupal page.
+ *
+ * Adaptivetheme Variables:
+ * - $html_attributes: structure attributes, includes the lang and dir attributes
+ *   by default, use $vars['html_attributes_array'] to add attributes in preprcess
+ * - $polyfills: prints IE conditional polyfill scripts enabled via theme
+ *   settings.
+ * - $skip_link_target: prints an ID for the skip navigation target, set in
+ *   theme settings.
+ * - $is_mobile: Bool, requires the Browscap module to return TRUE for mobile
+ *   devices. Use to test for a mobile context.
+ *
+ * Available Variables:
+ * - $css: An array of CSS files for the current page.
+ * - $language: (object) The language the site is being displayed in.
+ *   $language->language contains its textual representation.
+ *   $language->dir contains the language direction. It will either be 'ltr' or 'rtl'.
+ * - $rdf_namespaces: All the RDF namespace prefixes used in the HTML document.
+ * - $grddl_profile: A GRDDL profile allowing agents to extract the RDF data.
+ * - $head_title: A modified version of the page title, for use in the TITLE
+ *   tag.
+ * - $head_title_array: (array) An associative array containing the string parts
+ *   that were used to generate the $head_title variable, already prepared to be
+ *   output as TITLE tag. The key/value pairs may contain one or more of the
+ *   following, depending on conditions:
+ *   - title: The title of the current page, if any.
+ *   - name: The name of the site.
+ *   - slogan: The slogan of the site, if any, and if there is no title.
+ * - $head: Markup for the HEAD section (including meta tags, keyword tags, and
+ *   so on).
+ * - $styles: Style tags necessary to import all CSS files for the page.
+ * - $scripts: Script tags necessary to load the JavaScript files and settings
+ *   for the page.
+ * - $page_top: Initial markup from any modules that have altered the
+ *   page. This variable should always be output first, before all other dynamic
+ *   content.
+ * - $page: The rendered page content.
+ * - $page_bottom: Final closing markup from any modules that have altered the
+ *   page. This variable should always be output last, after all other dynamic
+ *   content.
+ * - $classes String of classes that can be used to style contextually through
+ *   CSS.
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_html()
+ * @see template_process()
+ * @see adaptivetheme_preprocess_html()
+ * @see adaptivetheme_process_html()
+ */
+?><!DOCTYPE html>
+<!--[if IEMobile 7]><html class="iem7"<?php print $html_attributes; ?>><![endif]-->
+<!--[if lte IE 6]><html class="lt-ie9 lt-ie8 lt-ie7"<?php print $html_attributes; ?>><![endif]-->
+<!--[if (IE 7)&(!IEMobile)]><html class="lt-ie9 lt-ie8"<?php print $html_attributes; ?>><![endif]-->
+<!--[if IE 8]><html class="lt-ie9"<?php print $html_attributes; ?>><![endif]-->
+<!--[if (gte IE 9)|(gt IEMobile 7)]><!--><html<?php print $html_attributes . $rdf_namespaces; ?>><!--<![endif]-->
+<head>
+<?php print $head; ?>
+<title><?php print $head_title; ?></title>
+<?php print $styles; ?>
+<?php print $scripts; ?>
+<?php print $polyfills; ?>
+</head>
+<body class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <div id="skip-link">
+    <a href="<?php print $skip_link_target; ?>" class="element-invisible element-focusable"><?php print t('Skip to main content'); ?></a>
+  </div>
+  <?php print $page_top; ?>
+  <?php print $page; ?>
+  <?php print $page_bottom; ?>
+</body>
+</html>
diff --git a/themes/commons/commons_origins/templates/node/node.tpl.php b/themes/commons/commons_origins/templates/node/node.tpl.php
new file mode 100755
index 0000000..89132d7
--- /dev/null
+++ b/themes/commons/commons_origins/templates/node/node.tpl.php
@@ -0,0 +1,145 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme implementation to display a node.
+ *
+ * Adaptivetheme variables:
+ * AT Core sets special time and date variables for use in templates:
+ * - $submitted: Submission information created from $name and $date during
+ *   adaptivetheme_preprocess_node(), uses the $publication_date variable.
+ * - $datetime: datetime stamp formatted correctly to ISO8601.
+ * - $publication_date: publication date, formatted with time element and
+ *   pubdate attribute.
+ * - $datetime_updated: datetime stamp formatted correctly to ISO8601.
+ * - $last_update: last updated date/time, formatted with time element and
+ *   pubdate attribute.
+ * - $custom_date_and_time: date time string used in $last_update.
+ * - $header_attributes: attributes such as classes to apply to the header element.
+ * - $footer_attributes: attributes such as classes to apply to the footer element.
+ * - $links_attributes: attributes such as classes to apply to the nav element.
+ * - $is_mobile: Mixed, requires the Mobile Detect or Browscap module to return
+ *   TRUE for mobile.  Note that tablets are also considered mobile devices.
+ *   Returns NULL if the feature could not be detected.
+ * - $is_tablet: Mixed, requires the Mobile Detect to return TRUE for tablets.
+ *   Returns NULL if the feature could not be detected.
+ *
+ * Available variables:
+ * - $title: the (sanitized) title of the node.
+ * - $content: An array of node items. Use render($content) to print them all,
+ *   or print a subset such as render($content['field_example']). Use
+ *   hide($content['field_example']) to temporarily suppress the printing of a
+ *   given element.
+ * - $user_picture: The node author's picture from user-picture.tpl.php.
+ * - $date: Formatted creation date. Preprocess functions can reformat it by
+ *   calling format_date() with the desired parameters on the $created variable.
+ * - $name: Themed username of node author output from theme_username().
+ * - $node_url: Direct url of the current node.
+ * - $display_submitted: Whether submission information should be displayed.
+ * - $classes: String of classes that can be used to style contextually through
+ *   CSS. It can be manipulated through the variable $classes_array from
+ *   preprocess functions. The default values can be one or more of the
+ *   following:
+ *   - node: The current template type, i.e., "theming hook".
+ *   - node-[type]: The current node type. For example, if the node is a
+ *     "Blog entry" it would result in "node-blog". Note that the machine
+ *     name will often be in a short form of the human readable label.
+ *   - node-teaser: Nodes in teaser form.
+ *   - node-preview: Nodes in preview mode.
+ *   The following are controlled through the node publishing options.
+ *   - node-promoted: Nodes promoted to the front page.
+ *   - node-sticky: Nodes ordered above other non-sticky nodes in teaser
+ *     listings.
+ *   - node-unpublished: Unpublished nodes visible only to administrators.
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * Other variables:
+ * - $node: Full node object. Contains data that may not be safe.
+ * - $type: Node type, i.e. story, page, blog, etc.
+ * - $comment_count: Number of comments attached to the node.
+ * - $uid: User ID of the node author.
+ * - $created: Time the node was published formatted in Unix timestamp.
+ * - $classes_array: Array of html class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ * - $zebra: Outputs either "even" or "odd". Useful for zebra striping in
+ *   teaser listings.
+ * - $id: Position of the node. Increments each time it's output.
+ *
+ * Node status variables:
+ * - $view_mode: View mode, e.g. 'full', 'teaser'...
+ * - $teaser: Flag for the teaser state (shortcut for $view_mode == 'teaser').
+ * - $page: Flag for the full page state.
+ * - $promote: Flag for front page promotion state.
+ * - $sticky: Flags for sticky post setting.
+ * - $status: Flag for published status.
+ * - $comment: State of comment settings for the node.
+ * - $readmore: Flags true if the teaser content of the node cannot hold the
+ *   main body content.
+ * - $is_front: Flags true when presented in the front page.
+ * - $logged_in: Flags true when the current user is a logged-in member.
+ * - $is_admin: Flags true when the current user is an administrator.
+ *
+ * Field variables: for each field instance attached to the node a corresponding
+ * variable is defined, e.g. $node->body becomes $body. When needing to access
+ * a field's raw values, developers/themers are strongly encouraged to use these
+ * variables. Otherwise they will have to explicitly specify the desired field
+ * language, e.g. $node->body['en'], thus overriding any language negotiation
+ * rule that was previously applied.
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_node()
+ * @see template_process()
+ * @see adaptivetheme_preprocess_node()
+ * @see adaptivetheme_process_node()
+ */
+
+/**
+ * Hiding Content and Printing it Separately
+ *
+ * Use the hide() function to hide fields and other content, you can render it
+ * later using the render() function. Install the Devel module and use
+ * <?php print dsm($content); ?> to find variable names to hide() or render().
+ */
+hide($content['comments']);
+hide($content['links']);
+hide($content['report_link']);
+?>
+<article id="node-<?php print $node->nid; ?>" class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <?php if ($title && !$page): ?>
+    <header<?php print $header_attributes; ?>>
+      <?php print render($title_prefix); ?>
+        <h1<?php print $title_attributes; ?>>
+          <a href="<?php print $node_url; ?>" rel="bookmark"><?php print $title; ?></a>
+        </h1>
+      <?php print render($title_suffix); ?>
+    </header>
+  <?php endif; ?>
+
+  <?php if(!empty($user_picture) || $display_submitted): ?>
+    <footer<?php print $footer_attributes; ?>>
+      <?php print $user_picture; ?>
+      <p class="author-datetime"><?php print $submitted; ?></p>
+    </footer>
+  <?php endif; ?>
+
+  <div<?php print $content_attributes; ?>>
+    <?php print render($content); ?>
+  </div>
+
+  <?php if (($links = render($content['links'])) || $content['report_link']): ?>
+    <nav<?php print $links_attributes; ?>>
+      <?php print $links; ?>
+      <?php print render($content['report_link']); ?>
+    </nav>
+  <?php endif; ?>
+
+  <?php if (isset($content['comments']['comments'])): ?>
+    <div class="commons-pod commons-pod-comments">
+      <?php print render($content['comments']); ?>
+    </div>
+  <?php endif; ?>
+</article>
diff --git a/themes/commons/commons_origins/templates/page/page.tpl.php b/themes/commons/commons_origins/templates/page/page.tpl.php
new file mode 100755
index 0000000..caf21bd
--- /dev/null
+++ b/themes/commons/commons_origins/templates/page/page.tpl.php
@@ -0,0 +1,222 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme implementation to display a single Drupal page.
+ *
+ * Available variables:
+ *
+ * Adaptivetheme supplied variables:
+ * - $site_logo: Themed logo - linked to front with alt attribute.
+ * - $site_name: Site name linked to the homepage.
+ * - $site_name_unlinked: Site name without any link.
+ * - $hide_site_name: Toggles the visibility of the site name.
+ * - $visibility: Holds the class .element-invisible or is empty.
+ * - $primary_navigation: Themed Main menu.
+ * - $secondary_navigation: Themed Secondary/user menu.
+ * - $primary_local_tasks: Split local tasks - primary.
+ * - $secondary_local_tasks: Split local tasks - secondary.
+ * - $tag: Prints the wrapper element for the main content.
+ * - $is_mobile: Bool, requires the Browscap module to return TRUE for mobile
+ *   devices. Use to test for a mobile context.
+ * - *_attributes: attributes for various site elements, usually holds id, class
+ *   or role attributes.
+ *
+ * General utility variables:
+ * - $base_path: The base URL path of the Drupal installation. At the very
+ *   least, this will always default to /.
+ * - $directory: The directory the template is located in, e.g. modules/system
+ *   or themes/bartik.
+ * - $is_front: TRUE if the current page is the front page.
+ * - $logged_in: TRUE if the user is registered and signed in.
+ * - $is_admin: TRUE if the user has permission to access administration pages.
+ *
+ * Site identity:
+ * - $front_page: The URL of the front page. Use this instead of $base_path,
+ *   when linking to the front page. This includes the language domain or
+ *   prefix.
+ * - $logo: The path to the logo image, as defined in theme configuration.
+ * - $site_slogan: The slogan of the site, empty when display has been disabled
+ *   in theme settings.
+ *
+ * Navigation:
+ * - $main_menu (array): An array containing the Main menu links for the
+ *   site, if they have been configured.
+ * - $secondary_menu (array): An array containing the Secondary menu links for
+ *   the site, if they have been configured.
+ * - $breadcrumb: The breadcrumb trail for the current page.
+ *
+ * Page content (in order of occurrence in the default page.tpl.php):
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title: The page title, for use in the actual HTML content.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ * - $messages: HTML for status and error messages. Should be displayed
+ *   prominently.
+ * - $tabs (array): Tabs linking to any sub-pages beneath the current page
+ *   (e.g., the view and edit tabs when displaying a node).
+ * - $action_links (array): Actions local to the page, such as 'Add menu' on the
+ *   menu administration interface.
+ * - $feed_icons: A string of all feed icons for the current page.
+ * - $node: The node object, if there is an automatically-loaded node
+ *   associated with the page, and the node ID is the second argument
+ *   in the page's path (e.g. node/12345 and node/12345/revisions, but not
+ *   comment/reply/12345).
+ *
+ * Core Regions:
+ * - $page['help']: Dynamic help text, mostly for admin pages.
+ * - $page['highlighted']: Items for the highlighted content region.
+ * - $page['content']: The main content of the current page.
+ * - $page['sidebar_first']: Items for the first sidebar.
+ * - $page['sidebar_second']: Items for the second sidebar.
+ * - $page['header']: Items for the header region.
+ * - $page['footer']: Items for the footer region.
+ *
+ * Adaptivetheme Regions:
+ * - $page['leaderboard']: full width at the very top of the page
+ * - $page['menu_bar']: menu blocks placed here will be styled horizontal
+ * - $page['secondary_content']: full width just above the main columns
+ * - $page['content_aside']: like a main content bottom region
+ * - $page['tertiary_content']: full width just above the footer
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_page()
+ * @see template_process()
+ * @see adaptivetheme_preprocess_page()
+ * @see adaptivetheme_process_page()
+ */
+?>
+<div class="header-wrapper">
+  <div class="header-color-row-one">
+    <header<?php print $header_attributes; ?>>
+
+      <?php if ($site_logo || $site_name || $site_slogan): ?>
+        <!-- start: Branding -->
+        <div<?php print $branding_attributes; ?>>
+
+          <?php if ($site_logo): ?>
+            <div id="logo">
+              <?php print $site_logo; ?>
+            </div>
+          <?php endif; ?>
+
+          <?php if ($site_name || $site_slogan): ?>
+            <!-- start: Site name and Slogan hgroup -->
+            <hgroup<?php print $hgroup_attributes; ?>>
+
+              <?php if ($site_name): ?>
+                <h1<?php print $site_name_attributes; ?>><?php print $site_name; ?></h1>
+              <?php endif; ?>
+
+              <?php if ($site_slogan): ?>
+                <h2<?php print $site_slogan_attributes; ?>><?php print $site_slogan; ?></h2>
+              <?php endif; ?>
+
+            </hgroup><!-- /end #name-and-slogan -->
+          <?php endif; ?>
+
+        </div><!-- /end #branding -->
+      <?php endif; ?>
+
+      <!-- Navigation elements -->
+      <?php print render($page['menu_bar']); ?>
+
+      <!-- region: Header -->
+      <?php print render($page['header']); ?>
+    </header>
+  </div>
+  <div class="header-color-row-two"></div>
+</div>
+<div id="page" class="container <?php print $classes; ?>">
+
+  <div id="columns" class="columns clearfix">
+    <!-- Messages and Help -->
+    <?php print $messages; ?>
+
+    <!-- region: Secondary Content -->
+    <?php print render($page['secondary_content']); ?>
+
+    <div id="page-top">
+      <!-- Breadcrumbs -->
+      <?php if ($breadcrumb): print $breadcrumb; endif; ?>
+
+      <?php print render($title_prefix); // Does nothing by default in D7 core ?>
+
+      <?php if ($title || $primary_local_tasks || $secondary_local_tasks || $action_links = render($action_links)): ?>
+        <header<?php print $content_header_attributes; ?>>
+
+          <?php if ($title && !isset($hide_panelized_title)): ?>
+            <h2 id="page-title">
+              <?php print $title; ?>
+            </h2>
+          <?php endif; ?>
+
+          <?php if ($primary_local_tasks || $secondary_local_tasks || $action_links): ?>
+            <div id="tasks">
+
+              <?php if ($primary_local_tasks): ?>
+                <ul class="tabs primary clearfix"><?php print render($primary_local_tasks); ?></ul>
+              <?php endif; ?>
+
+              <?php if ($secondary_local_tasks): ?>
+                <ul class="tabs secondary clearfix"><?php print render($secondary_local_tasks); ?></ul>
+              <?php endif; ?>
+
+              <?php if ($action_links = render($action_links)): ?>
+                <ul class="action-links clearfix"><?php print $action_links; ?></ul>
+              <?php endif; ?>
+
+            </div>
+          <?php endif; ?>
+
+        </header>
+      <?php endif; ?>
+    </div>
+    <div id="content-column" class="content-column" role="main">
+      <div class="content-inner">
+        <?php print render($page['help']); ?>
+
+        <!-- region: Highlighted -->
+        <?php print render($page['highlighted']); ?>
+
+        <<?php print $tag; ?> id="main-content">
+
+          <!-- region: Main Content -->
+          <?php if ($content = render($page['content'])): ?>
+            <div id="content" class="region">
+              <?php print $content; ?>
+            </div>
+          <?php endif; ?>
+
+          <!-- Feed icons (RSS, Atom icons etc -->
+          <?php print $feed_icons; ?>
+
+          <?php print render($title_suffix); // Prints page level contextual links ?>
+
+        </<?php print $tag; ?>><!-- /end #main-content -->
+
+        <!-- region: Content Aside -->
+        <?php print render($page['content_aside']); ?>
+
+      </div><!-- /end .content-inner -->
+    </div><!-- /end #content-column -->
+
+    <!-- regions: Sidebar first and Sidebar second -->
+    <?php $sidebar_first = render($page['sidebar_first']); print $sidebar_first; ?>
+    <?php $sidebar_second = render($page['sidebar_second']); print $sidebar_second; ?>
+
+  </div><!-- /end #columns -->
+
+  <!-- region: Tertiary Content -->
+  <?php print render($page['tertiary_content']); ?>
+
+  <!-- region: Footer -->
+  <?php if ($page['footer']): ?>
+    <footer<?php print $footer_attributes; ?>>
+      <?php print render($page['footer']); ?>
+    </footer>
+  <?php endif; ?>
+
+</div>
diff --git a/themes/commons/commons_origins/templates/panels/node--panel--fallback.tpl.php b/themes/commons/commons_origins/templates/panels/node--panel--fallback.tpl.php
new file mode 100644
index 0000000..70dc9d1
--- /dev/null
+++ b/themes/commons/commons_origins/templates/panels/node--panel--fallback.tpl.php
@@ -0,0 +1,143 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme implementation to display a node.
+ *
+ * Adaptivetheme variables:
+ * AT Core sets special time and date variables for use in templates:
+ * - $submitted: Submission information created from $name and $date during
+ *   adaptivetheme_preprocess_node(), uses the $publication_date variable.
+ * - $datetime: datetime stamp formatted correctly to ISO8601.
+ * - $publication_date: publication date, formatted with time element and
+ *   pubdate attribute.
+ * - $datetime_updated: datetime stamp formatted correctly to ISO8601.
+ * - $last_update: last updated date/time, formatted with time element and
+ *   pubdate attribute.
+ * - $custom_date_and_time: date time string used in $last_update.
+ * - $header_attributes: attributes such as classes to apply to the header element.
+ * - $footer_attributes: attributes such as classes to apply to the footer element.
+ * - $links_attributes: attributes such as classes to apply to the nav element.
+ * - $is_mobile: Mixed, requires the Mobile Detect or Browscap module to return
+ *   TRUE for mobile.  Note that tablets are also considered mobile devices.
+ *   Returns NULL if the feature could not be detected.
+ * - $is_tablet: Mixed, requires the Mobile Detect to return TRUE for tablets.
+ *   Returns NULL if the feature could not be detected.
+ *
+ * Available variables:
+ * - $title: the (sanitized) title of the node.
+ * - $content: An array of node items. Use render($content) to print them all,
+ *   or print a subset such as render($content['field_example']). Use
+ *   hide($content['field_example']) to temporarily suppress the printing of a
+ *   given element.
+ * - $user_picture: The node author's picture from user-picture.tpl.php.
+ * - $date: Formatted creation date. Preprocess functions can reformat it by
+ *   calling format_date() with the desired parameters on the $created variable.
+ * - $name: Themed username of node author output from theme_username().
+ * - $node_url: Direct url of the current node.
+ * - $display_submitted: Whether submission information should be displayed.
+ * - $classes: String of classes that can be used to style contextually through
+ *   CSS. It can be manipulated through the variable $classes_array from
+ *   preprocess functions. The default values can be one or more of the
+ *   following:
+ *   - node: The current template type, i.e., "theming hook".
+ *   - node-[type]: The current node type. For example, if the node is a
+ *     "Blog entry" it would result in "node-blog". Note that the machine
+ *     name will often be in a short form of the human readable label.
+ *   - node-teaser: Nodes in teaser form.
+ *   - node-preview: Nodes in preview mode.
+ *   The following are controlled through the node publishing options.
+ *   - node-promoted: Nodes promoted to the front page.
+ *   - node-sticky: Nodes ordered above other non-sticky nodes in teaser
+ *     listings.
+ *   - node-unpublished: Unpublished nodes visible only to administrators.
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * Other variables:
+ * - $node: Full node object. Contains data that may not be safe.
+ * - $type: Node type, i.e. story, page, blog, etc.
+ * - $comment_count: Number of comments attached to the node.
+ * - $uid: User ID of the node author.
+ * - $created: Time the node was published formatted in Unix timestamp.
+ * - $classes_array: Array of html class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ * - $zebra: Outputs either "even" or "odd". Useful for zebra striping in
+ *   teaser listings.
+ * - $id: Position of the node. Increments each time it's output.
+ *
+ * Node status variables:
+ * - $view_mode: View mode, e.g. 'full', 'teaser'...
+ * - $teaser: Flag for the teaser state (shortcut for $view_mode == 'teaser').
+ * - $page: Flag for the full page state.
+ * - $promote: Flag for front page promotion state.
+ * - $sticky: Flags for sticky post setting.
+ * - $status: Flag for published status.
+ * - $comment: State of comment settings for the node.
+ * - $readmore: Flags true if the teaser content of the node cannot hold the
+ *   main body content.
+ * - $is_front: Flags true when presented in the front page.
+ * - $logged_in: Flags true when the current user is a logged-in member.
+ * - $is_admin: Flags true when the current user is an administrator.
+ *
+ * Field variables: for each field instance attached to the node a corresponding
+ * variable is defined, e.g. $node->body becomes $body. When needing to access
+ * a field's raw values, developers/themers are strongly encouraged to use these
+ * variables. Otherwise they will have to explicitly specify the desired field
+ * language, e.g. $node->body['en'], thus overriding any language negotiation
+ * rule that was previously applied.
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_node()
+ * @see template_process()
+ * @see adaptivetheme_preprocess_node()
+ * @see adaptivetheme_process_node()
+ */
+
+/**
+ * Hiding Content and Printing it Separately
+ *
+ * Use the hide() function to hide fields and other content, you can render it
+ * later using the render() function. Install the Devel module and use
+ * <?php print dsm($content); ?> to find variable names to hide() or render().
+ */
+hide($content['comments']);
+hide($content['links']);
+hide($content['report_link']);
+?>
+<article id="node-<?php print $node->nid; ?>" class="<?php print $classes; ?> clearfix"<?php print $attributes; ?>>
+  <header<?php print $header_attributes; ?>>
+    <?php print render($title_prefix); ?>
+    <h2<?php print $title_attributes; ?>>
+      <?php print $title; ?>
+    </h2>
+    <?php print render($title_suffix); ?>
+  </header>
+
+  <?php if(!empty($user_picture) || $display_submitted): ?>
+    <footer<?php print $footer_attributes; ?>>
+      <?php print $user_picture; ?>
+      <p class="author-datetime"><?php print $submitted; ?></p>
+    </footer>
+  <?php endif; ?>
+
+  <div<?php print $content_attributes; ?>>
+    <?php print render($content); ?>
+  </div>
+
+  <?php if (($links = render($content['links'])) || $content['report_link']): ?>
+    <nav<?php print $links_attributes; ?>>
+      <?php print $links; ?>
+      <?php print render($content['report_link']); ?>
+    </nav>
+  <?php endif; ?>
+
+  <?php if (isset($content['comments']['comments'])): ?>
+    <div class="commons-pod commons-pod-comments">
+      <?php print render($content['comments']); ?>
+    </div>
+  <?php endif; ?>
+</article>
diff --git a/themes/commons/commons_origins/templates/panels/panels-pane--block.tpl.php b/themes/commons/commons_origins/templates/panels/panels-pane--block.tpl.php
new file mode 100644
index 0000000..e6fed33
--- /dev/null
+++ b/themes/commons/commons_origins/templates/panels/panels-pane--block.tpl.php
@@ -0,0 +1,74 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme panel pane template.
+ *
+ * This template has block type classes to they react to styles applied to blocks,
+ * saving the trouble of having to style multiple selectors to target blocks
+ * and panel panes. This template also makes use the attributes arrays for the
+ * wrapper and content wrapper.
+ *
+ * Adaptivetheme variables:
+ * - $is_mobile: Mixed, requires the Mobile Detect or Browscap module to return
+ *   TRUE for mobile.  Note that tablets are also considered mobile devices.  
+ *   Returns NULL if the feature could not be detected.
+ * - $is_tablet: Mixed, requires the Mobile Detect to return TRUE for tablets.
+ *   Returns NULL if the feature could not be detected.
+ * - $tag: top level wrapper element, section or div.
+ *
+ * Variables available:
+ * - $pane->type: the content type inside this pane
+ * - $pane->subtype: The subtype, if applicable. If a view it will be the
+ *   view name; if a node it will be the nid, etc.
+ * - $title: The title of the content
+ * - $content: The actual content
+ * - $links: Any links associated with the content
+ * - $more: An optional 'more' link (destination only)
+ * - $admin_links: Administrative links associated with the content
+ * - $feeds: Any feed icons or associated with the content
+ * - $display: The complete panels display object containing all kinds of
+ *   data including the contexts and all of the other panes being displayed.
+ */
+?>
+<?php if ($pane_prefix): ?>
+  <?php print $pane_prefix; ?>
+<?php endif; ?>
+<<?php print $tag . $attributes . $id; ?>>
+  <div class="block-inner clearfix">
+    <?php if ($admin_links): ?>
+      <?php print $admin_links; ?>
+    <?php endif; ?>
+
+    <?php print render($title_prefix); ?>
+    <?php if ($title): ?>
+      <h3<?php print $title_attributes; ?>><?php print $title; ?></h3>
+    <?php endif; ?>
+    <?php print render($title_suffix); ?>
+
+    <?php if ($feeds): ?>
+      <div class="feed">
+        <?php print $feeds; ?>
+      </div>
+    <?php endif; ?>
+
+    <div<?php print $content_attributes; ?>>
+      <?php print render($content); ?>
+    </div>
+
+    <?php if ($links): ?>
+      <nav class="links">
+        <?php print $links; ?>
+      </nav>
+    <?php endif; ?>
+
+    <?php if ($more): ?>
+      <div class="more-link">
+        <?php print $more; ?>
+      </div>
+    <?php endif; ?>
+
+  </div>
+</<?php print $tag; ?>>
+<?php if ($pane_suffix): ?>
+  <?php print $pane_suffix; ?>
+<?php endif; ?>
diff --git a/themes/commons/commons_origins/templates/panels/three-25-50-25--events.tpl.php b/themes/commons/commons_origins/templates/panels/three-25-50-25--events.tpl.php
new file mode 100755
index 0000000..24cb7de
--- /dev/null
+++ b/themes/commons/commons_origins/templates/panels/three-25-50-25--events.tpl.php
@@ -0,0 +1,59 @@
+<?php
+/**
+ * @file
+ * Adativetheme implementation to present a Panels layout.
+ *
+ * Available variables:
+ * - $content: An array of content, each item in the array is keyed to one
+ *   panel of the layout.
+ * - $css_id: unique id if present.
+ * - $panel_prefix: prints a wrapper when this template is used in certain context,
+ *   such as when rendered by Display Suite or other module - the wrapper is
+ *   added by Adaptivetheme in the appropriate process function.
+ * - $panel_suffix: closing element for the $prefix.
+ *
+ * @see adaptivetheme_preprocess_three_25_50_25()
+ * @see adaptivetheme_preprocess_node()
+ * @see adaptivetheme_process_node()
+ */
+
+// Ensure variables are always set. In the last hours before cutting a stable
+// release I found these are not set when inside a Field Collection using Display
+// Suite, even though they are initialized in the templates preprocess function.
+// This is a workaround, that may or may not go away.
+$panel_prefix = isset($panel_prefix) ? $panel_prefix : '';
+$panel_suffix = isset($panel_suffix) ? $panel_suffix : '';
+?>
+<?php print $panel_prefix; ?>
+<div class="three-25-50-25 at-panel panel-display clearfix" <?php if (!empty($css_id)): print "id=\"$css_id\""; endif; ?>>
+  <?php if ($content['three_25_50_25_top']): ?>
+    <div class="region region-three-25-50-25-top region-conditional-stack">
+      <div class="region-inner clearfix">
+        <?php print $content['three_25_50_25_top']; ?>
+      </div>
+    </div>
+  <?php endif; ?>
+  <div class="region region-three-25-50-25-first">
+    <div class="region-inner commons-pod clearfix">
+      <?php print $content['three_25_50_25_first']; ?>
+    </div>
+  </div>
+  <div class="region region-three-25-50-25-second">
+    <div class="region-inner clearfix">
+      <?php print $content['three_25_50_25_second']; ?>
+    </div>
+  </div>
+  <div class="region region-three-25-50-25-third">
+    <div class="region-inner clearfix">
+      <?php print $content['three_25_50_25_third']; ?>
+    </div>
+  </div>
+  <?php if ($content['three_25_50_25_bottom']): ?>
+    <div class="region region-three-25-50-25-bottom region-conditional-stack">
+      <div class="region-inner clearfix">
+        <?php print $content['three_25_50_25_bottom']; ?>
+      </div>
+    </div>
+  <?php endif; ?>
+</div>
+<?php print $panel_suffix; ?>
diff --git a/themes/commons/commons_origins/templates/panels/two-33-66--search.tpl.php b/themes/commons/commons_origins/templates/panels/two-33-66--search.tpl.php
new file mode 100644
index 0000000..3e11c0b
--- /dev/null
+++ b/themes/commons/commons_origins/templates/panels/two-33-66--search.tpl.php
@@ -0,0 +1,54 @@
+<?php
+/**
+ * @file
+ * Adativetheme implementation to present a Panels layout.
+ *
+ * Available variables:
+ * - $content: An array of content, each item in the array is keyed to one
+ *   panel of the layout.
+ * - $css_id: unique id if present.
+ * - $panel_prefix: prints a wrapper when this template is used in certain context,
+ *   such as when rendered by Display Suite or other module - the wrapper is
+ *   added by Adaptivetheme in the appropriate process function.
+ * - $panel_suffix: closing element for the $prefix.
+ *
+ * @see adaptivetheme_preprocess_two_33_66()
+ * @see adaptivetheme_preprocess_node()
+ * @see adaptivetheme_process_node()
+ */
+
+// Ensure variables are always set. In the last hours before cutting a stable
+// release I found these are not set when inside a Field Collection using Display
+// Suite, even though they are initialized in the templates preprocess function.
+// This is a workaround, that may or may not go away.
+$panel_prefix = isset($panel_prefix) ? $panel_prefix : '';
+$panel_suffix = isset($panel_suffix) ? $panel_suffix : '';
+?>
+<?php print $panel_prefix; ?>
+<div class="two-33-66 at-panel panel-display clearfix" <?php if (!empty($css_id)): print "id=\"$css_id\""; endif; ?>>
+  <?php if ($content['two_33_66_top']): ?>
+    <div class="region region-two-33-66-top region-conditional-stack">
+      <div class="region-inner clearfix">
+        <?php print $content['two_33_66_top']; ?>
+      </div>
+    </div>
+  <?php endif; ?>
+  <div class="region region-two-33-66-first">
+    <div class="region-inner commons-pod clearfix">
+      <?php print $content['two_33_66_first']; ?>
+    </div>
+  </div>
+  <div class="region region-two-33-66-second">
+    <div class="region-inner clearfix">
+      <?php print $content['two_33_66_second']; ?>
+    </div>
+  </div>
+  <?php if ($content['two_33_66_bottom']): ?>
+    <div class="region region-two-33-66-bottom region-conditional-stack">
+      <div class="region-inner clearfix">
+        <?php print $content['two_33_66_bottom']; ?>
+      </div>
+    </div>
+  <?php endif; ?>
+</div>
+<?php print $panel_suffix; ?>
diff --git a/themes/commons/commons_origins/templates/privatemsg/privatemsg-recipients.tpl.php b/themes/commons/commons_origins/templates/privatemsg/privatemsg-recipients.tpl.php
new file mode 100644
index 0000000..98aa66c
--- /dev/null
+++ b/themes/commons/commons_origins/templates/privatemsg/privatemsg-recipients.tpl.php
@@ -0,0 +1,3 @@
+<div class="privatemsg-message-participants">
+  <?php print $participants; ?>
+</div>
diff --git a/themes/commons/commons_origins/templates/privatemsg/privatemsg-view.tpl.php b/themes/commons/commons_origins/templates/privatemsg/privatemsg-view.tpl.php
new file mode 100644
index 0000000..705f709
--- /dev/null
+++ b/themes/commons/commons_origins/templates/privatemsg/privatemsg-view.tpl.php
@@ -0,0 +1,19 @@
+<?php print $anchors; ?>
+<div class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <div class="privatemsg-message-information author-datetime">
+    <span class="privatemsg-author-name"><?php print $author_name_link; ?></span> <span class="privatemsg-message-date"><?php print $message_timestamp; ?></span>
+    <?php print $author_picture; ?>
+    <?php if (isset($new)): ?>
+      <span class="new privatemsg-message-new"><?php print $new ?></span>
+    <?php endif ?>
+  </div>
+  <div <?php print $content_attributes; ?>>
+    <div class="privatemsg-message-body">
+      <?php print $message_body; ?>
+    </div>
+  </div>
+  <?php print render($message_links); ?>
+  <?php if (isset($message_actions)): ?>
+    <?php print $message_actions ?>
+  <?php endif ?>
+</div>
diff --git a/themes/commons/commons_origins/templates/profile/user-profile--search_results.tpl.php b/themes/commons/commons_origins/templates/profile/user-profile--search_results.tpl.php
new file mode 100644
index 0000000..8eac94f
--- /dev/null
+++ b/themes/commons/commons_origins/templates/profile/user-profile--search_results.tpl.php
@@ -0,0 +1,53 @@
+<?php
+/**
+ * @file
+ * Adaptivetheme implementation to present all user profile data.
+ *
+ * This template is used when viewing a registered member's profile page,
+ * e.g., example.com/user/123. 123 being the users ID.
+ *
+ * Use render($user_profile) to print all profile items, or print a subset
+ * such as render($user_profile['user_picture']). Always call
+ * render($user_profile) at the end in order to print all remaining items. If
+ * the item is a category, it will contain all its profile items. By default,
+ * $user_profile['summary'] is provided, which contains data on the user's
+ * history. Other data can be included by modules. $user_profile['user_picture']
+ * is available for showing the account picture.
+ *
+ * Adaptivetheme variables:
+ * - $is_mobile: Mixed, requires the Mobile Detect or Browscap module to return
+ *   TRUE for mobile.  Note that tablets are also considered mobile devices.
+ *   Returns NULL if the feature could not be detected.
+ * - $is_tablet: Mixed, requires the Mobile Detect to return TRUE for tablets.
+ *   Returns NULL if the feature could not be detected.
+ *
+ * Available variables:
+ *   - $user_profile: An array of profile items. Use render() to print them.
+ *   - Field variables: for each field instance attached to the user a
+ *     corresponding variable is defined; e.g., $account->field_example has a
+ *     variable $field_example defined. When needing to access a field's raw
+ *     values, developers/themers are strongly encouraged to use these
+ *     variables. Otherwise they will have to explicitly specify the desired
+ *     field language, e.g. $account->field_example['en'], thus overriding any
+ *     language negotiation rule that was previously applied.
+ *
+ * @see user-profile-category.tpl.php
+ *   Where the html is handled for the group.
+ * @see user-profile-item.tpl.php
+ *   Where the html is handled for each item in the group.
+ * @see template_preprocess_user_profile()
+ */
+
+// Hide the flags for printing later.
+hide($user_profile['user_actions']);
+?>
+<article id="user-<?php print $user->uid; ?>" class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <header class="profile-header">
+    <?php print render($user_profile['username']); ?>
+    <?php print render($user_profile['user_picture']); ?>
+  </header>
+  <div class="profile-content">
+    <?php print render($user_profile); ?>
+  </div>
+  <?php print render($user_profile['user_actions']); ?>
+</article>
diff --git a/themes/commons/commons_origins/templates/search/search-result.tpl.php b/themes/commons/commons_origins/templates/search/search-result.tpl.php
new file mode 100644
index 0000000..9c7e9e7
--- /dev/null
+++ b/themes/commons/commons_origins/templates/search/search-result.tpl.php
@@ -0,0 +1,74 @@
+<?php
+
+/**
+ * @file
+ * Overrides modules/search/search-result.tpl.php.
+ *
+ * Variables provided by the Rich Snippets module:
+ * - $url_shortened: The shortened URL of the result.
+ * - $alternate_links: Alternate links to the result, such as links to a cached
+ *   version of the page or a link to similar results.
+ * - $image:
+ *
+ * Available variables:
+ * - $url: URL of the result.
+ * - $title: Title of the result.
+ * - $snippet: A small preview of the result. Does not apply to user searches.
+ * - $info: String of all the meta information ready for print. Does not apply
+ *   to user searches.
+ * - $info_split: Contains same data as $info, split into a keyed array.
+ * - $module: The machine-readable name of the module (tab) being searched, such
+ *   as "node" or "user".
+ * - $title_prefix (array): An array containing additional output populated by
+ *   modules, intended to be displayed in front of the main title tag that
+ *   appears in the template.
+ * - $title_suffix (array): An array containing additional output populated by
+ *   modules, intended to be displayed after the main title tag that appears in
+ *   the template.
+ *
+ * Default keys within $info_split:
+ * - $info_split['type']: Node type (or item type string supplied by module).
+ * - $info_split['user']: Author of the node linked to users profile. Depends
+ *   on permission.
+ * - $info_split['date']: Last update of the node. Short formatted.
+ * - $info_split['comment']: Number of comments output as "% comments", %
+ *   being the count. Depends on comment.module.
+ *
+ * Other variables:
+ * - $classes_array: Array of HTML class attribute values. It is flattened
+ *   into a string within the variable $classes.
+ * - $title_attributes_array: Array of HTML attributes for the title. It is
+ *   flattened into a string within the variable $title_attributes.
+ * - $content_attributes_array: Array of HTML attributes for the content. It is
+ *   flattened into a string within the variable $content_attributes.
+ *
+ * Since $info_split is keyed, a direct print of the item is possible.
+ * This array does not apply to user searches so it is recommended to check
+ * for its existence before printing. The default keys of 'type', 'user' and
+ * 'date' always exist for node searches. Modules may provide other data.
+ * @code
+ *   <?php if (isset($info_split['comment'])): ?>
+ *     <span class="info-comment">
+ *       <?php print $info_split['comment']; ?>
+ *     </span>
+ *   <?php endif; ?>
+ * @endcode
+ *
+ * To check for all available data within $info_split, use the code below.
+ * @code
+ *   <?php print '<pre>'. check_plain(print_r($info_split, 1)) .'</pre>'; ?>
+ * @endcode
+ *
+ * @see template_preprocess()
+ * @see template_preprocess_search_result()
+ * @see template_process()
+ */
+?>
+<li class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <h3<?php print $title_attributes; ?>><a href="<?php print $url; ?>"><?php print $title; ?></a></h3>
+  <div class="search-result-wrapper">
+      <?php if ($snippet): ?>
+        <span class="search-result-snippet"<?php print $content_attributes; ?>><?php print $snippet; ?></span>
+      <?php endif; ?>
+  </div>
+</li>
diff --git a/themes/commons/commons_origins/templates/search/search-results--apachesolr-search.tpl.php b/themes/commons/commons_origins/templates/search/search-results--apachesolr-search.tpl.php
new file mode 100644
index 0000000..42b1be3
--- /dev/null
+++ b/themes/commons/commons_origins/templates/search/search-results--apachesolr-search.tpl.php
@@ -0,0 +1,43 @@
+<?php
+
+/**
+ * @file
+ * Default theme implementation for displaying search results.
+ *
+ * This template collects each invocation of theme_search_result(). This and
+ * the child template are dependent to one another sharing the markup for
+ * definition lists.
+ *
+ * Note that modules may implement their own search type and theme function
+ * completely bypassing this template.
+ *
+ * Available variables:
+ * - $search_results: All results as it is rendered through
+ *   search-result.tpl.php
+ * - $module: The machine-readable name of the module (tab) being searched, such
+ *   as "node" or "user".
+ *
+ *
+ * @see template_preprocess_search_results()
+ *
+ * @ingroup themeable
+ */
+?>
+<div class="<?php print $classes; ?>"<?php print $attributes; ?>>
+  <?php if ($search_results): ?>
+    <?php if (!empty($title)): ?>
+      <h2<?php print $title_attributes; ?>><?php print $title; ?></h2>
+    <?php endif; ?>
+    <div<?php print $content_attributes; ?>>
+      <ol class="search-results <?php print $module; ?>-results">
+        <?php print $search_results; ?>
+      </ol>
+    </div>
+    <?php print $pager; ?>
+  <?php else : ?>
+    <h2<?php print $title_attributes; ?>><?php print t('Your search yielded no results');?></h2>
+    <div<?php print $content_attributes; ?>>
+      <?php print search_help('search#noresults', drupal_help_arg()); ?>
+    </div>
+  <?php endif; ?>
+</div>
diff --git a/themes/commons/commons_origins/templates/views/views-view-field--field-address.tpl.php b/themes/commons/commons_origins/templates/views/views-view-field--field-address.tpl.php
new file mode 100644
index 0000000..91d92ee
--- /dev/null
+++ b/themes/commons/commons_origins/templates/views/views-view-field--field-address.tpl.php
@@ -0,0 +1,25 @@
+<?php
+
+/**
+ * @file
+ * This template is used to print a single field in a view.
+ *
+ * It is not actually used in default Views, as this is registered as a theme
+ * function which has better performance. For single overrides, the template is
+ * perfectly okay.
+ *
+ * Variables available:
+ * - $view: The view object
+ * - $field: The field handler object that can process the input
+ * - $row: The raw SQL result that can be used
+ * - $output: The processed output that will normally be used.
+ *
+ * When fetching output from the $row, this construct should be used:
+ * $data = $row->{$field->field_alias}
+ *
+ * The above will guarantee that you'll always get the correct data,
+ * regardless of any changes in the aliasing that might happen if
+ * the view is modified.
+ */
+?>
+<?php print $output; ?>
